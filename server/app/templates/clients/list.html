{% extends "base.html" %}
{% block title %}Clientes{% endblock %}

{% block content %}
<div class="client-container">
    <!-- Cabecera con controles -->
    <div class="controls-section">
        <h2 class="client-title">Clientes</h2>
        
        <div class="view-type-controls">
            <button id="listViewBtn" class="view-btn active">
                <i data-lucide="layout-list"></i>
            </button>
            <button id="kanbanViewBtn" class="view-btn">
                <i data-lucide="grid"></i>
            </button>
        </div>
        
        <a href="/clients/create" class="new-client-btn">
            <i data-lucide="plus"></i>
            Nuevo Cliente
        </a>
    </div>

    <!-- Vista Lista -->
    <div id="listView">
        <table class="client-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Token</th>
                    <th>Estado</th>
                    <th class="actions-cell">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for client in clients %}
                <tr>
                    <td>{{ client.id }}</td>
                    <td>{{ client.name }}</td>
                    <td class="token-cell">{{ client.token }}</td>
                    <td>
                        <span class="status-badge {% if client.is_active %}active{% else %}inactive{% endif %}">
                            <span class="status-dot"></span>
                            {{ "Activo" if client.is_active else "Inactivo" }}
                        </span>
                    </td>
                    <td class="actions-cell">
                        <div class="action-buttons">
                            <a href="/clients/{{ client.id }}/edit" class="action-btn edit" title="Editar">
                                <i data-lucide="edit-2"></i>
                            </a>
                            <button onclick="confirmDelete('{{ client.id }}')" class="action-btn delete" title="Eliminar">
                                <i data-lucide="trash-2"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Vista Kanban -->
    <div id="kanbanView" class="kanban-view hidden">
        {% for client in clients %}
        <div class="client-card">
            <div class="card-header">
                <span class="client-name">{{ client.name }}</span>
                <span class="status-badge {% if client.is_active %}active{% else %}inactive{% endif %}">
                    <span class="status-dot"></span>
                    {{ "Activo" if client.is_active else "Inactivo" }}
                </span>
            </div>
            <div class="card-body">
                <div class="token-info">
                    <span class="token-label">Token:</span>
                    <span class="token-value">{{ client.token }}</span>
                </div>
            </div>
            <div class="card-footer">
                <div class="action-buttons">
                    <a href="/clients/{{ client.id }}/edit" class="action-btn edit" title="Editar">
                        <i data-lucide="edit-2"></i>
                    </a>
                    <button onclick="confirmDelete('{{ client.id }}')" class="action-btn delete" title="Eliminar">
                        <i data-lucide="trash-2"></i>
                    </button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const listView = document.getElementById('listView');
    const kanbanView = document.getElementById('kanbanView');
    const listViewBtn = document.getElementById('listViewBtn');
    const kanbanViewBtn = document.getElementById('kanbanViewBtn');

    // Función para cambiar entre vistas
    function switchView(view) {
        if (view === 'list') {
            listView.classList.remove('hidden');
            kanbanView.classList.add('hidden');
            listViewBtn.classList.add('active');
            kanbanViewBtn.classList.remove('active');
        } else {
            kanbanView.classList.remove('hidden');
            listView.classList.add('hidden');
            kanbanViewBtn.classList.add('active');
            listViewBtn.classList.remove('active');
        }
        localStorage.setItem('preferredView', view);
    }

    // Manejadores de eventos para los botones
    listViewBtn.addEventListener('click', () => switchView('list'));
    kanbanViewBtn.addEventListener('click', () => switchView('kanban'));

    // Restaurar la vista preferida del usuario
    const preferredView = localStorage.getItem('preferredView') || 'list';
    switchView(preferredView);
});

// Función para confirmar eliminación
function confirmDelete(id) {
    if (confirm('¿Estás seguro de que deseas eliminar este cliente?')) {
        console.log('Eliminando cliente:', id);
    }
}
</script>
{% endblock %}