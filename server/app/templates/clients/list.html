{% extends "base.html" %}
{% block title %}Clientes{% endblock %}

{% block content %}
<div class="bg-white shadow-lg rounded-lg p-6 mx-auto max-w-7xl">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
        <h2 class="text-2xl font-bold text-gray-800">Clientes</h2>
        
        <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-4 w-full sm:w-auto">
            <!-- Barra de bÃºsqueda -->
            <div class="relative flex-grow sm:flex-grow-0">
                <input type="text" 
                       id="searchInput" 
                       placeholder="Buscar clientes..." 
                       class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                <i class="fas fa-search absolute right-3 top-2.5 h-5 w-5 text-gray-400"></i>
            </div>

            <!-- Controles de vista -->
            <div class="flex items-center gap-2">
                <div class="flex bg-gray-100 p-1 rounded-lg">
                    <button id="listViewBtn" 
                            class="flex items-center p-2 rounded-md transition-all"
                            aria-label="Vista Lista">
                        <i class="fas fa-list h-5 w-5"></i>
                    </button>
                    <button id="kanbanViewBtn"
                            class="flex items-center p-2 rounded-md transition-all"
                            aria-label="Vista Kanban">
                        <i class="fas fa-th h-5 w-5"></i>
                    </button>
                </div>
                
                <a href="/clients/create" 
                   class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors">
                    <i class="fas fa-plus h-5 w-5"></i>
                    <span>Nuevo Cliente</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Vista Lista -->
    <div id="listView" class="overflow-x-auto shadow ring-1 ring-black ring-opacity-5 rounded-lg">
        <table class="w-full border-collapse">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Token</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for client in clients %}
                <tr class="hover:bg-gray-50 transition-colors" data-client-id="{{ client.id }}">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ client.id }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ client.name }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-500">{{ client.token }}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                                   {% if client.is_active %}
                                   bg-green-100 text-green-800
                                   {% else %}
                                   bg-red-100 text-red-800
                                   {% endif %}">
                            <span class="w-2 h-2 mr-2 rounded-full
                                   {% if client.is_active %}
                                   bg-green-400
                                   {% else %}
                                   bg-red-400
                                   {% endif %}"></span>
                            {{ "Activo" if client.is_active else "Inactivo" }}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <div class="flex items-center justify-end space-x-2">
                            <a href="/clients/{{ client.id }}/edit" 
                               class="inline-flex items-center px-3 py-2 bg-amber-100 text-amber-700 rounded-lg hover:bg-amber-200 transition-colors">
                                <i class="fas fa-pencil-alt h-4 w-4"></i>
                                <span class="ml-1">Editar</span>
                            </a>
                            <button onclick="confirmDelete('{{ client.id }}')"
                                    class="inline-flex items-center px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors">
                                <i class="fas fa-trash h-4 w-4"></i>
                                <span class="ml-1">Eliminar</span>
                            </button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if not clients %}
        <div class="text-center py-8">
            <p class="text-gray-500">No hay clientes registrados</p>
        </div>
        {% endif %}
    </div>

    <!-- Vista Kanban -->
    <div id="kanbanView" class="hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-6">
        {% for client in clients %}
        <div class="bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow" 
             data-client-id="{{ client.id }}">
            <div class="p-5">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <i class="fas fa-user h-6 w-6 text-gray-400"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium text-gray-900">{{ client.name }}</h3>
                            <p class="text-sm text-gray-500">#{{ client.id }}</p>
                        </div>
                    </div>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                               {% if client.is_active %}
                               bg-green-100 text-green-800
                               {% else %}
                               bg-red-100 text-red-800
                               {% endif %}">
                        <span class="w-2 h-2 mr-2 rounded-full
                               {% if client.is_active %}
                               bg-green-400
                               {% else %}
                               bg-red-400
                               {% endif %}"></span>
                        {{ "Activo" if client.is_active else "Inactivo" }}
                    </span>
                </div>
                <div class="mt-4">
                    <div class="text-sm text-gray-500">Token</div>
                    <div class="mt-1 font-mono text-sm text-gray-900">{{ client.token }}</div>
                </div>
                <div class="mt-6 flex justify-end space-x-2">
                    <a href="/clients/{{ client.id }}/edit" 
                       class="inline-flex items-center px-3 py-2 bg-amber-100 text-amber-700 rounded-lg hover:bg-amber-200 transition-colors">
                        <i class="fas fa-pencil-alt h-4 w-4"></i>
                        <span class="ml-1">Editar</span>
                    </a>
                    <button onclick="confirmDelete('{{ client.id }}')"
                            class="inline-flex items-center px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors">
                        <i class="fas fa-trash h-4 w-4"></i>
                        <span class="ml-1">Eliminar</span>
                    </button>
                </div>
            </div>
        </div>
        {% endfor %}

        {% if not clients %}
        <div class="col-span-full text-center py-8">
            <p class="text-gray-500">No hay clientes registrados</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
<script src="/static/js/clients.js"></script>
{% endblock %}