2025-02-07 13:51:48,382 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 13:51:48,411 - DEBUG - [printer_monitor_service.py:43] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 13:51:48,422 - DEBUG - [printer_monitor_service.py:46] -   SNMP Community: public
2025-02-07 13:51:48,422 - DEBUG - [printer_monitor_service.py:47] -   SNMP Port: 161
2025-02-07 13:51:48,422 - DEBUG - [printer_monitor_service.py:48] -   SNMP Timeout: 2s
2025-02-07 13:51:48,422 - DEBUG - [printer_monitor_service.py:49] -   SNMP Retries: 1
2025-02-07 13:51:48,463 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 13:51:48,467 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 13:51:48,469 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 13:51:48,470 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 13:51:48,472 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 13:51:48,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: SqQIeGWwwRbXyBwfAj9LVg==
2025-02-07 13:51:48,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 13:51:48,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 13:51:48,473 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 13:51:48,501 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 13:51:48,503 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 13:51:48,503 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 13:51:48,503 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: Y8n37JH31M6z1MRH1uAIbLh6q28=
2025-02-07 13:51:48,503 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 13:51:48,506 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 18:51:47 GMT
2025-02-07 13:51:48,506 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 13:51:48,506 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 13:51:51,319 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 13:52:08,573 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:52:08,573 - DEBUG - [protocol.py:745] - > PING 67 31 88 85 [binary, 4 bytes]
2025-02-07 13:52:08,582 - DEBUG - [protocol.py:599] - < PONG 67 31 88 85 [binary, 4 bytes]
2025-02-07 13:52:08,582 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:52:28,579 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:52:28,579 - DEBUG - [protocol.py:745] - > PING 7f a4 92 37 [binary, 4 bytes]
2025-02-07 13:52:28,579 - DEBUG - [protocol.py:599] - < PING e3 56 8d 9b [binary, 4 bytes]
2025-02-07 13:52:28,584 - DEBUG - [protocol.py:745] - > PONG e3 56 8d 9b [binary, 4 bytes]
2025-02-07 13:52:28,584 - DEBUG - [protocol.py:599] - < PONG 7f a4 92 37 [binary, 4 bytes]
2025-02-07 13:52:28,584 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:52:48,579 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:52:48,579 - DEBUG - [protocol.py:745] - > PING df 28 49 c3 [binary, 4 bytes]
2025-02-07 13:52:48,585 - DEBUG - [protocol.py:599] - < PONG df 28 49 c3 [binary, 4 bytes]
2025-02-07 13:52:48,586 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:52:48,594 - DEBUG - [protocol.py:599] - < PING '\x7ft\x15b' [text, 4 bytes]
2025-02-07 13:52:48,595 - DEBUG - [protocol.py:745] - > PONG '\x7ft\x15b' [text, 4 bytes]
2025-02-07 13:53:08,589 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:53:08,591 - DEBUG - [protocol.py:745] - > PING '0M"T' [text, 4 bytes]
2025-02-07 13:53:08,600 - DEBUG - [protocol.py:599] - < PONG '0M"T' [text, 4 bytes]
2025-02-07 13:53:08,601 - DEBUG - [protocol.py:599] - < PING 0b d6 ff a7 [binary, 4 bytes]
2025-02-07 13:53:08,604 - DEBUG - [protocol.py:745] - > PONG 0b d6 ff a7 [binary, 4 bytes]
2025-02-07 13:53:08,610 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:53:28,605 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:53:28,610 - DEBUG - [protocol.py:745] - > PING 72 a1 bc 9b [binary, 4 bytes]
2025-02-07 13:53:28,616 - DEBUG - [protocol.py:599] - < PING 92 dd d2 80 [binary, 4 bytes]
2025-02-07 13:53:28,616 - DEBUG - [protocol.py:745] - > PONG 92 dd d2 80 [binary, 4 bytes]
2025-02-07 13:53:28,621 - DEBUG - [protocol.py:599] - < PONG 72 a1 bc 9b [binary, 4 bytes]
2025-02-07 13:53:28,622 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:53:48,610 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:53:48,613 - DEBUG - [protocol.py:745] - > PING e0 58 7d 2b [binary, 4 bytes]
2025-02-07 13:53:48,619 - DEBUG - [protocol.py:599] - < PONG e0 58 7d 2b [binary, 4 bytes]
2025-02-07 13:53:48,625 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:54:08,628 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:54:08,630 - DEBUG - [protocol.py:745] - > PING cf 15 9b d9 [binary, 4 bytes]
2025-02-07 13:54:08,638 - DEBUG - [protocol.py:599] - < PONG cf 15 9b d9 [binary, 4 bytes]
2025-02-07 13:54:08,639 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:54:08,658 - DEBUG - [protocol.py:599] - < PING dc ca 60 a4 [binary, 4 bytes]
2025-02-07 13:54:08,661 - DEBUG - [protocol.py:745] - > PONG dc ca 60 a4 [binary, 4 bytes]
2025-02-07 13:54:28,644 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:54:28,645 - DEBUG - [protocol.py:745] - > PING d8 ee 07 f1 [binary, 4 bytes]
2025-02-07 13:54:28,653 - DEBUG - [protocol.py:599] - < PONG d8 ee 07 f1 [binary, 4 bytes]
2025-02-07 13:54:28,653 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:54:28,666 - DEBUG - [protocol.py:599] - < PING b6 27 67 65 [binary, 4 bytes]
2025-02-07 13:54:28,666 - DEBUG - [protocol.py:745] - > PONG b6 27 67 65 [binary, 4 bytes]
2025-02-07 13:54:48,650 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:54:48,652 - DEBUG - [protocol.py:745] - > PING 5e 5d 61 b6 [binary, 4 bytes]
2025-02-07 13:54:48,661 - DEBUG - [protocol.py:599] - < PONG 5e 5d 61 b6 [binary, 4 bytes]
2025-02-07 13:54:48,663 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:54:48,675 - DEBUG - [protocol.py:599] - < PING de ea ec 49 [binary, 4 bytes]
2025-02-07 13:54:48,676 - DEBUG - [protocol.py:745] - > PONG de ea ec 49 [binary, 4 bytes]
2025-02-07 13:55:08,650 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:55:08,651 - DEBUG - [protocol.py:745] - > PING d5 ba a6 de [binary, 4 bytes]
2025-02-07 13:55:08,657 - DEBUG - [protocol.py:599] - < PONG d5 ba a6 de [binary, 4 bytes]
2025-02-07 13:55:08,658 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:55:08,683 - DEBUG - [protocol.py:599] - < PING 2f 34 6a ed [binary, 4 bytes]
2025-02-07 13:55:08,683 - DEBUG - [protocol.py:745] - > PONG 2f 34 6a ed [binary, 4 bytes]
2025-02-07 13:55:23,987 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 13:55:23,987 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 13:55:23,992 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 13:55:23,994 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 13:55:23,994 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 13:55:23,994 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 13:55:23,996 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 13:55:33,431 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 13:55:33,431 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 13:55:33,431 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 13:55:33,444 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 13:55:33,444 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 13:55:33,473 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 13:55:33,473 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: irr6r1WL+kuLFkRFi+NgZw==
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 13:55:33,503 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 13:55:33,504 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 13:55:33,504 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 13:55:33,505 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: ZhzeohlcV+7Uzy3r9rHNczdwapw=
2025-02-07 13:55:33,505 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 13:55:33,505 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 18:55:32 GMT
2025-02-07 13:55:33,506 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 13:55:33,506 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 13:55:33,506 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 13:55:34,584 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 13:55:34,585 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 13:55:34,585 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 13:55:34,585 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 13:55:34,610 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 13:55:34,610 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 13:55:34,610 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 13:55:34,610 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 13:55:34,610 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 13:55:34,610 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 13:55:34,768 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 13:55:34,768 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 13:55:34,768 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 13:55:34,768 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 13:55:34,804 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 13:55:34,805 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 13:55:34,805 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 13:55:34,807 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 13:55:34,808 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 13:55:34,809 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 13:55:34,984 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 13:55:34,984 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,169 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,169 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 13:55:35,169 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 13:55:35,169 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 13:55:35,181 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 13:55:35,181 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,319 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,319 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,470 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,470 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,683 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,683 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,848 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,848 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 13:55:35,849 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 13:55:35,849 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 13:55:36,012 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 13:55:36,012 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 13:55:36,013 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 13:55:36,013 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T18:55:36.013107",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 13:55:36,014 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 13:55:36,014 - DEBUG - [printer_monitor_service.py:418] - Datos procesados para enviar: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T18:55:36.013107",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 13:55:36,014 - DEBUG - [printer_monitor_service.py:446] - Enviando datos a ws://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 13:55:36,015 - DEBUG - [printer_monitor_service.py:447] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 13:55:36,015 - DEBUG - [printer_monitor_service.py:448] - Params: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5'}
2025-02-07 13:55:36,024 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 13:55:36,035 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 13:55:36,035 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 13:55:36,036 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 13:55:53,503 - DEBUG - [protocol.py:599] - < PING bd 69 7a 40 [binary, 4 bytes]
2025-02-07 13:55:53,507 - DEBUG - [protocol.py:745] - > PONG bd 69 7a 40 [binary, 4 bytes]
2025-02-07 13:55:53,507 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:55:53,507 - DEBUG - [protocol.py:745] - > PING 9a 47 0c cf [binary, 4 bytes]
2025-02-07 13:55:53,514 - DEBUG - [protocol.py:599] - < PONG 9a 47 0c cf [binary, 4 bytes]
2025-02-07 13:55:53,514 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:56:13,513 - DEBUG - [protocol.py:599] - < PING fa 91 3a 1c [binary, 4 bytes]
2025-02-07 13:56:13,514 - DEBUG - [protocol.py:745] - > PONG fa 91 3a 1c [binary, 4 bytes]
2025-02-07 13:56:13,515 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:56:13,515 - DEBUG - [protocol.py:745] - > PING 0c dc 75 2c [binary, 4 bytes]
2025-02-07 13:56:13,520 - DEBUG - [protocol.py:599] - < PONG 0c dc 75 2c [binary, 4 bytes]
2025-02-07 13:56:13,521 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:56:33,509 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:56:33,512 - DEBUG - [protocol.py:745] - > PING 0f 71 25 ff [binary, 4 bytes]
2025-02-07 13:56:33,522 - DEBUG - [protocol.py:599] - < PONG 0f 71 25 ff [binary, 4 bytes]
2025-02-07 13:56:33,523 - DEBUG - [protocol.py:599] - < PING 83 7f 8b a9 [binary, 4 bytes]
2025-02-07 13:56:33,528 - DEBUG - [protocol.py:745] - > PONG 83 7f 8b a9 [binary, 4 bytes]
2025-02-07 13:56:33,532 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:56:53,528 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:56:53,531 - DEBUG - [protocol.py:745] - > PING 37 76 e7 e0 [binary, 4 bytes]
2025-02-07 13:56:53,536 - DEBUG - [protocol.py:599] - < PING b5 da 26 a9 [binary, 4 bytes]
2025-02-07 13:56:53,538 - DEBUG - [protocol.py:745] - > PONG b5 da 26 a9 [binary, 4 bytes]
2025-02-07 13:56:53,541 - DEBUG - [protocol.py:599] - < PONG 37 76 e7 e0 [binary, 4 bytes]
2025-02-07 13:56:53,545 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:57:13,535 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:57:13,536 - DEBUG - [protocol.py:745] - > PING f1 90 9e c3 [binary, 4 bytes]
2025-02-07 13:57:13,544 - DEBUG - [protocol.py:599] - < PONG f1 90 9e c3 [binary, 4 bytes]
2025-02-07 13:57:13,550 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:57:13,550 - DEBUG - [protocol.py:599] - < PING 61 97 2f ed [binary, 4 bytes]
2025-02-07 13:57:13,551 - DEBUG - [protocol.py:745] - > PONG 61 97 2f ed [binary, 4 bytes]
2025-02-07 13:57:33,548 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:57:33,549 - DEBUG - [protocol.py:745] - > PING 68 e2 84 3f [binary, 4 bytes]
2025-02-07 13:57:33,556 - DEBUG - [protocol.py:599] - < PING df b6 47 e4 [binary, 4 bytes]
2025-02-07 13:57:33,557 - DEBUG - [protocol.py:745] - > PONG df b6 47 e4 [binary, 4 bytes]
2025-02-07 13:57:33,559 - DEBUG - [protocol.py:599] - < PONG 68 e2 84 3f [binary, 4 bytes]
2025-02-07 13:57:33,566 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:57:53,551 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:57:53,553 - DEBUG - [protocol.py:745] - > PING 0f 2d 0c 95 [binary, 4 bytes]
2025-02-07 13:57:53,555 - DEBUG - [protocol.py:599] - < PONG 0f 2d 0c 95 [binary, 4 bytes]
2025-02-07 13:57:53,559 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:57:53,568 - DEBUG - [protocol.py:599] - < PING a2 e6 af b5 [binary, 4 bytes]
2025-02-07 13:57:53,568 - DEBUG - [protocol.py:745] - > PONG a2 e6 af b5 [binary, 4 bytes]
2025-02-07 13:58:13,555 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:58:13,555 - DEBUG - [protocol.py:745] - > PING 9e 1c e9 6a [binary, 4 bytes]
2025-02-07 13:58:13,562 - DEBUG - [protocol.py:599] - < PONG 9e 1c e9 6a [binary, 4 bytes]
2025-02-07 13:58:13,562 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:58:13,574 - DEBUG - [protocol.py:599] - < PING fc cc 83 af [binary, 4 bytes]
2025-02-07 13:58:13,576 - DEBUG - [protocol.py:745] - > PONG fc cc 83 af [binary, 4 bytes]
2025-02-07 13:58:33,563 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:58:33,565 - DEBUG - [protocol.py:745] - > PING c4 15 83 e9 [binary, 4 bytes]
2025-02-07 13:58:33,572 - DEBUG - [protocol.py:599] - < PONG c4 15 83 e9 [binary, 4 bytes]
2025-02-07 13:58:33,576 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:58:33,583 - DEBUG - [protocol.py:599] - < PING e5 9b 9d ff [binary, 4 bytes]
2025-02-07 13:58:33,583 - DEBUG - [protocol.py:745] - > PONG e5 9b 9d ff [binary, 4 bytes]
2025-02-07 13:58:53,573 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:58:53,576 - DEBUG - [protocol.py:745] - > PING 52 ba c9 bf [binary, 4 bytes]
2025-02-07 13:58:53,584 - DEBUG - [protocol.py:599] - < PONG 52 ba c9 bf [binary, 4 bytes]
2025-02-07 13:58:53,586 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:58:53,608 - DEBUG - [protocol.py:599] - < PING 5a 61 8e df [binary, 4 bytes]
2025-02-07 13:58:53,609 - DEBUG - [protocol.py:745] - > PONG 5a 61 8e df [binary, 4 bytes]
2025-02-07 13:59:13,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:59:13,594 - DEBUG - [protocol.py:745] - > PING 35 b5 b9 68 [binary, 4 bytes]
2025-02-07 13:59:13,602 - DEBUG - [protocol.py:599] - < PONG 35 b5 b9 68 [binary, 4 bytes]
2025-02-07 13:59:13,604 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:59:13,619 - DEBUG - [protocol.py:599] - < PING 77 2d 29 e3 [binary, 4 bytes]
2025-02-07 13:59:13,622 - DEBUG - [protocol.py:745] - > PONG 77 2d 29 e3 [binary, 4 bytes]
2025-02-07 13:59:33,610 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:59:33,611 - DEBUG - [protocol.py:745] - > PING 17 d8 38 26 [binary, 4 bytes]
2025-02-07 13:59:33,619 - DEBUG - [protocol.py:599] - < PONG 17 d8 38 26 [binary, 4 bytes]
2025-02-07 13:59:33,621 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:59:33,636 - DEBUG - [protocol.py:599] - < PING e9 09 de a3 [binary, 4 bytes]
2025-02-07 13:59:33,638 - DEBUG - [protocol.py:745] - > PONG e9 09 de a3 [binary, 4 bytes]
2025-02-07 13:59:53,618 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:59:53,618 - DEBUG - [protocol.py:745] - > PING 5e e7 47 78 [binary, 4 bytes]
2025-02-07 13:59:53,626 - DEBUG - [protocol.py:599] - < PONG 5e e7 47 78 [binary, 4 bytes]
2025-02-07 13:59:53,627 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:59:53,646 - DEBUG - [protocol.py:599] - < PING 'Ւv\x05' [text, 4 bytes]
2025-02-07 13:59:53,647 - DEBUG - [protocol.py:745] - > PONG 'Ւv\x05' [text, 4 bytes]
2025-02-07 14:00:13,647 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:00:13,648 - DEBUG - [protocol.py:745] - > PING 7f 43 1d 91 [binary, 4 bytes]
2025-02-07 14:00:13,650 - DEBUG - [protocol.py:599] - < PING 6b 89 b0 90 [binary, 4 bytes]
2025-02-07 14:00:13,650 - DEBUG - [protocol.py:745] - > PONG 6b 89 b0 90 [binary, 4 bytes]
2025-02-07 14:00:13,650 - DEBUG - [protocol.py:599] - < PONG 7f 43 1d 91 [binary, 4 bytes]
2025-02-07 14:00:13,650 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:00:33,660 - DEBUG - [protocol.py:599] - < PING 6a 2f ed 54 [binary, 4 bytes]
2025-02-07 14:00:33,660 - DEBUG - [protocol.py:745] - > PONG 6a 2f ed 54 [binary, 4 bytes]
2025-02-07 14:00:33,660 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:00:33,660 - DEBUG - [protocol.py:745] - > PING c8 c1 a8 ce [binary, 4 bytes]
2025-02-07 14:00:33,671 - DEBUG - [protocol.py:599] - < PONG c8 c1 a8 ce [binary, 4 bytes]
2025-02-07 14:00:33,671 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:00:37,190 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:00:37,191 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:00:37,191 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:00:37,191 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:00:37,224 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:00:37,224 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:00:37,229 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:00:37,229 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:00:37,229 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:00:37,229 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:00:37,458 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:00:37,761 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:00:37,761 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:37,995 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:37,995 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:00:37,995 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:00:37,995 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:00:38,010 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:00:38,010 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:38,225 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:38,225 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:38,523 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:38,523 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:38,745 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:38,745 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:38,966 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:38,966 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:00:38,966 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:00:38,966 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:00:39,184 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:00:39,185 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:00:39,185 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:00:39,186 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:00:39.185225",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:00:39,186 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:00:39,187 - DEBUG - [printer_monitor_service.py:418] - Datos procesados para enviar: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:00:39.185225",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:00:39,188 - DEBUG - [printer_monitor_service.py:446] - Enviando datos a ws://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:00:39,189 - DEBUG - [printer_monitor_service.py:447] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:00:39,189 - DEBUG - [printer_monitor_service.py:448] - Params: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5'}
2025-02-07 14:00:39,283 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 14:00:39,283 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 14:00:39,283 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 14:00:39,283 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:00:53,671 - DEBUG - [protocol.py:599] - < PING e9 72 c7 94 [binary, 4 bytes]
2025-02-07 14:00:53,672 - DEBUG - [protocol.py:745] - > PONG e9 72 c7 94 [binary, 4 bytes]
2025-02-07 14:00:53,674 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:00:53,675 - DEBUG - [protocol.py:745] - > PING f2 51 09 d2 [binary, 4 bytes]
2025-02-07 14:00:53,682 - DEBUG - [protocol.py:599] - < PONG f2 51 09 d2 [binary, 4 bytes]
2025-02-07 14:00:53,686 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:01:13,673 - DEBUG - [protocol.py:599] - < PING f1 8e f9 c6 [binary, 4 bytes]
2025-02-07 14:01:13,673 - DEBUG - [protocol.py:745] - > PONG f1 8e f9 c6 [binary, 4 bytes]
2025-02-07 14:01:13,673 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:01:13,673 - DEBUG - [protocol.py:745] - > PING dc 60 20 1b [binary, 4 bytes]
2025-02-07 14:01:13,689 - DEBUG - [protocol.py:599] - < PONG dc 60 20 1b [binary, 4 bytes]
2025-02-07 14:01:13,692 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:01:33,673 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:01:33,677 - DEBUG - [protocol.py:745] - > PING 8a d8 8c 98 [binary, 4 bytes]
2025-02-07 14:01:33,683 - DEBUG - [protocol.py:599] - < PONG 8a d8 8c 98 [binary, 4 bytes]
2025-02-07 14:01:33,688 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:01:33,690 - DEBUG - [protocol.py:599] - < PING 27 86 c6 76 [binary, 4 bytes]
2025-02-07 14:01:33,691 - DEBUG - [protocol.py:745] - > PONG 27 86 c6 76 [binary, 4 bytes]
2025-02-07 14:01:53,693 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:01:53,695 - DEBUG - [protocol.py:745] - > PING 29 a6 f7 41 [binary, 4 bytes]
2025-02-07 14:01:53,695 - DEBUG - [protocol.py:599] - < PING 't\x18e\x10' [text, 4 bytes]
2025-02-07 14:01:53,695 - DEBUG - [protocol.py:745] - > PONG 't\x18e\x10' [text, 4 bytes]
2025-02-07 14:01:53,701 - DEBUG - [protocol.py:599] - < PONG 29 a6 f7 41 [binary, 4 bytes]
2025-02-07 14:01:53,707 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:02:13,707 - DEBUG - [protocol.py:599] - < PING 21 18 82 66 [binary, 4 bytes]
2025-02-07 14:02:13,707 - DEBUG - [protocol.py:745] - > PONG 21 18 82 66 [binary, 4 bytes]
2025-02-07 14:02:13,707 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:02:13,707 - DEBUG - [protocol.py:745] - > PING 80 2a 9e 59 [binary, 4 bytes]
2025-02-07 14:02:13,722 - DEBUG - [protocol.py:599] - < PONG 80 2a 9e 59 [binary, 4 bytes]
2025-02-07 14:02:13,723 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:02:33,710 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:02:33,711 - DEBUG - [protocol.py:745] - > PING 11 ff 42 0d [binary, 4 bytes]
2025-02-07 14:02:33,717 - DEBUG - [protocol.py:599] - < PONG 11 ff 42 0d [binary, 4 bytes]
2025-02-07 14:02:33,717 - DEBUG - [protocol.py:599] - < PING df de 54 bb [binary, 4 bytes]
2025-02-07 14:02:33,717 - DEBUG - [protocol.py:745] - > PONG df de 54 bb [binary, 4 bytes]
2025-02-07 14:02:33,720 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:02:53,718 - DEBUG - [protocol.py:599] - < PING '@O\x14[' [text, 4 bytes]
2025-02-07 14:02:53,718 - DEBUG - [protocol.py:745] - > PONG '@O\x14[' [text, 4 bytes]
2025-02-07 14:02:53,718 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:02:53,718 - DEBUG - [protocol.py:745] - > PING 70 92 c7 a6 [binary, 4 bytes]
2025-02-07 14:02:53,736 - DEBUG - [protocol.py:599] - < PONG 70 92 c7 a6 [binary, 4 bytes]
2025-02-07 14:02:53,736 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:03:13,724 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:03:13,725 - DEBUG - [protocol.py:745] - > PING 8c af c7 fb [binary, 4 bytes]
2025-02-07 14:03:13,733 - DEBUG - [protocol.py:599] - < PONG 8c af c7 fb [binary, 4 bytes]
2025-02-07 14:03:13,734 - DEBUG - [protocol.py:599] - < PING 'zm\x10x' [text, 4 bytes]
2025-02-07 14:03:13,734 - DEBUG - [protocol.py:745] - > PONG 'zm\x10x' [text, 4 bytes]
2025-02-07 14:03:13,736 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:03:33,737 - DEBUG - [protocol.py:599] - < PING 4b 60 0c 95 [binary, 4 bytes]
2025-02-07 14:03:33,737 - DEBUG - [protocol.py:745] - > PONG 4b 60 0c 95 [binary, 4 bytes]
2025-02-07 14:03:33,737 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:03:33,737 - DEBUG - [protocol.py:745] - > PING 35 58 a1 56 [binary, 4 bytes]
2025-02-07 14:03:33,747 - DEBUG - [protocol.py:599] - < PONG 35 58 a1 56 [binary, 4 bytes]
2025-02-07 14:03:33,748 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:03:53,737 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:03:53,739 - DEBUG - [protocol.py:745] - > PING cd 1b 11 a3 [binary, 4 bytes]
2025-02-07 14:03:53,746 - DEBUG - [protocol.py:599] - < PONG cd 1b 11 a3 [binary, 4 bytes]
2025-02-07 14:03:53,748 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:03:53,757 - DEBUG - [protocol.py:599] - < PING db 93 42 d8 [binary, 4 bytes]
2025-02-07 14:03:53,760 - DEBUG - [protocol.py:745] - > PONG db 93 42 d8 [binary, 4 bytes]
2025-02-07 14:04:13,756 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:04:13,758 - DEBUG - [protocol.py:745] - > PING 69 05 9b 66 [binary, 4 bytes]
2025-02-07 14:04:13,766 - DEBUG - [protocol.py:599] - < PONG 69 05 9b 66 [binary, 4 bytes]
2025-02-07 14:04:13,766 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:04:13,773 - DEBUG - [protocol.py:599] - < PING 23 2d 11 dc [binary, 4 bytes]
2025-02-07 14:04:13,773 - DEBUG - [protocol.py:745] - > PONG 23 2d 11 dc [binary, 4 bytes]
2025-02-07 14:04:33,773 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:04:33,773 - DEBUG - [protocol.py:745] - > PING bf ec 8f 2d [binary, 4 bytes]
2025-02-07 14:04:33,773 - DEBUG - [protocol.py:599] - < PONG bf ec 8f 2d [binary, 4 bytes]
2025-02-07 14:04:33,773 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:04:33,773 - DEBUG - [protocol.py:599] - < PING 83 4c fa 81 [binary, 4 bytes]
2025-02-07 14:04:33,790 - DEBUG - [protocol.py:745] - > PONG 83 4c fa 81 [binary, 4 bytes]
2025-02-07 14:04:53,790 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:04:53,790 - DEBUG - [protocol.py:745] - > PING 9d 4e 7a 7f [binary, 4 bytes]
2025-02-07 14:04:53,794 - DEBUG - [protocol.py:599] - < PONG 9d 4e 7a 7f [binary, 4 bytes]
2025-02-07 14:04:53,794 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:04:53,794 - DEBUG - [protocol.py:599] - < PING 22 c0 d7 e2 [binary, 4 bytes]
2025-02-07 14:04:53,801 - DEBUG - [protocol.py:745] - > PONG 22 c0 d7 e2 [binary, 4 bytes]
2025-02-07 14:05:13,790 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:05:13,792 - DEBUG - [protocol.py:745] - > PING c6 a0 bd 67 [binary, 4 bytes]
2025-02-07 14:05:13,802 - DEBUG - [protocol.py:599] - < PONG c6 a0 bd 67 [binary, 4 bytes]
2025-02-07 14:05:13,804 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:05:13,808 - DEBUG - [protocol.py:599] - < PING 'vF\x04%' [text, 4 bytes]
2025-02-07 14:05:13,809 - DEBUG - [protocol.py:745] - > PONG 'vF\x04%' [text, 4 bytes]
2025-02-07 14:05:33,810 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:05:33,810 - DEBUG - [protocol.py:745] - > PING 40 d4 19 e0 [binary, 4 bytes]
2025-02-07 14:05:33,817 - DEBUG - [protocol.py:599] - < PONG 40 d4 19 e0 [binary, 4 bytes]
2025-02-07 14:05:33,817 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:05:33,821 - DEBUG - [protocol.py:599] - < PING bc f4 82 f2 [binary, 4 bytes]
2025-02-07 14:05:33,821 - DEBUG - [protocol.py:745] - > PONG bc f4 82 f2 [binary, 4 bytes]
2025-02-07 14:05:40,374 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:05:40,375 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:05:40,376 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:05:40,376 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:05:40,409 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:05:40,409 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:05:40,410 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:05:40,411 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:05:40,411 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:05:40,412 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:05:40,715 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:05:40,715 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:05:40,716 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:05:40,716 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:05:40,716 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:05:40,717 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:05:40,956 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:05:40,957 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:41,187 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:41,187 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:05:41,187 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:05:41,188 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:05:41,189 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:05:41,189 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:41,489 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:41,490 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:41,717 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:41,717 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:41,949 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:41,950 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:42,207 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:42,208 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:05:42,208 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:05:42,210 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:05:42,427 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:05:42,428 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:05:42,428 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:05:42,429 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:05:42.428708",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:05:42,431 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:05:42,432 - DEBUG - [printer_monitor_service.py:418] - Datos procesados para enviar: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:05:42.428708",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:05:42,433 - DEBUG - [printer_monitor_service.py:446] - Enviando datos a ws://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:05:42,434 - DEBUG - [printer_monitor_service.py:447] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:05:42,435 - DEBUG - [printer_monitor_service.py:448] - Params: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5'}
2025-02-07 14:05:42,454 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 14:05:42,455 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 14:05:42,455 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 14:05:42,455 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:05:53,801 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:05:53,805 - DEBUG - [protocol.py:745] - > PING 8a 8d 6a 38 [binary, 4 bytes]
2025-02-07 14:05:53,813 - DEBUG - [protocol.py:599] - < PONG 8a 8d 6a 38 [binary, 4 bytes]
2025-02-07 14:05:53,820 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:05:53,827 - DEBUG - [protocol.py:599] - < PING 4c da 08 b7 [binary, 4 bytes]
2025-02-07 14:05:53,828 - DEBUG - [protocol.py:745] - > PONG 4c da 08 b7 [binary, 4 bytes]
2025-02-07 14:06:13,830 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:06:13,831 - DEBUG - [protocol.py:745] - > PING ec 02 29 f7 [binary, 4 bytes]
2025-02-07 14:06:13,836 - DEBUG - [protocol.py:599] - < PING 81 5a 2a 00 [binary, 4 bytes]
2025-02-07 14:06:13,837 - DEBUG - [protocol.py:745] - > PONG 81 5a 2a 00 [binary, 4 bytes]
2025-02-07 14:06:13,838 - DEBUG - [protocol.py:599] - < PONG ec 02 29 f7 [binary, 4 bytes]
2025-02-07 14:06:13,840 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:06:33,835 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:06:33,838 - DEBUG - [protocol.py:745] - > PING 30 3f 71 a6 [binary, 4 bytes]
2025-02-07 14:06:33,845 - DEBUG - [protocol.py:599] - < PING 'ge@\x05' [text, 4 bytes]
2025-02-07 14:06:33,846 - DEBUG - [protocol.py:745] - > PONG 'ge@\x05' [text, 4 bytes]
2025-02-07 14:06:33,850 - DEBUG - [protocol.py:599] - < PONG 30 3f 71 a6 [binary, 4 bytes]
2025-02-07 14:06:33,869 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:06:53,847 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:06:53,849 - DEBUG - [protocol.py:745] - > PING 7b 91 88 7d [binary, 4 bytes]
2025-02-07 14:06:53,857 - DEBUG - [protocol.py:599] - < PING 38 9c df a8 [binary, 4 bytes]
2025-02-07 14:06:53,859 - DEBUG - [protocol.py:745] - > PONG 38 9c df a8 [binary, 4 bytes]
2025-02-07 14:06:53,863 - DEBUG - [protocol.py:599] - < PONG 7b 91 88 7d [binary, 4 bytes]
2025-02-07 14:06:53,865 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:07:13,867 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:07:13,867 - DEBUG - [protocol.py:745] - > PING ec 24 ac 22 [binary, 4 bytes]
2025-02-07 14:07:13,867 - DEBUG - [protocol.py:599] - < PING 8b 04 1e 6c [binary, 4 bytes]
2025-02-07 14:07:13,873 - DEBUG - [protocol.py:745] - > PONG 8b 04 1e 6c [binary, 4 bytes]
2025-02-07 14:07:13,873 - DEBUG - [protocol.py:599] - < PONG ec 24 ac 22 [binary, 4 bytes]
2025-02-07 14:07:13,873 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:07:33,877 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:07:33,878 - DEBUG - [protocol.py:745] - > PING 65 91 04 85 [binary, 4 bytes]
2025-02-07 14:07:33,880 - DEBUG - [protocol.py:599] - < PING e7 7f 08 4f [binary, 4 bytes]
2025-02-07 14:07:33,880 - DEBUG - [protocol.py:745] - > PONG e7 7f 08 4f [binary, 4 bytes]
2025-02-07 14:07:33,880 - DEBUG - [protocol.py:599] - < PONG 65 91 04 85 [binary, 4 bytes]
2025-02-07 14:07:33,880 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:07:53,866 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:07:53,866 - DEBUG - [protocol.py:745] - > PING d3 23 3d 97 [binary, 4 bytes]
2025-02-07 14:07:53,866 - DEBUG - [protocol.py:599] - < PONG d3 23 3d 97 [binary, 4 bytes]
2025-02-07 14:07:53,866 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:07:53,887 - DEBUG - [protocol.py:599] - < PING '\n\x17Oz' [text, 4 bytes]
2025-02-07 14:07:53,889 - DEBUG - [protocol.py:745] - > PONG '\n\x17Oz' [text, 4 bytes]
2025-02-07 14:08:13,885 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:08:13,890 - DEBUG - [protocol.py:745] - > PING 8f 49 68 74 [binary, 4 bytes]
2025-02-07 14:08:13,896 - DEBUG - [protocol.py:599] - < PING 00 e2 c6 69 [binary, 4 bytes]
2025-02-07 14:08:13,898 - DEBUG - [protocol.py:745] - > PONG 00 e2 c6 69 [binary, 4 bytes]
2025-02-07 14:08:13,899 - DEBUG - [protocol.py:599] - < PONG 8f 49 68 74 [binary, 4 bytes]
2025-02-07 14:08:13,902 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:08:33,905 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:08:33,905 - DEBUG - [protocol.py:745] - > PING 16 61 e1 4c [binary, 4 bytes]
2025-02-07 14:08:33,905 - DEBUG - [protocol.py:599] - < PING 55 e0 18 d5 [binary, 4 bytes]
2025-02-07 14:08:33,905 - DEBUG - [protocol.py:745] - > PONG 55 e0 18 d5 [binary, 4 bytes]
2025-02-07 14:08:33,913 - DEBUG - [protocol.py:599] - < PONG 16 61 e1 4c [binary, 4 bytes]
2025-02-07 14:08:33,915 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:08:53,910 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:08:53,911 - DEBUG - [protocol.py:745] - > PING 25 d4 79 89 [binary, 4 bytes]
2025-02-07 14:08:53,917 - DEBUG - [protocol.py:599] - < PING 0a 7f f8 31 [binary, 4 bytes]
2025-02-07 14:08:53,919 - DEBUG - [protocol.py:745] - > PONG 0a 7f f8 31 [binary, 4 bytes]
2025-02-07 14:08:53,921 - DEBUG - [protocol.py:599] - < PONG 25 d4 79 89 [binary, 4 bytes]
2025-02-07 14:08:53,922 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:09:13,925 - DEBUG - [protocol.py:599] - < PING 20 25 b2 0f [binary, 4 bytes]
2025-02-07 14:09:13,926 - DEBUG - [protocol.py:745] - > PONG 20 25 b2 0f [binary, 4 bytes]
2025-02-07 14:09:13,926 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:09:13,927 - DEBUG - [protocol.py:745] - > PING 13 32 4e a3 [binary, 4 bytes]
2025-02-07 14:09:13,933 - DEBUG - [protocol.py:599] - < PONG 13 32 4e a3 [binary, 4 bytes]
2025-02-07 14:09:13,933 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:09:33,935 - DEBUG - [protocol.py:599] - < PING 65 9f 26 ad [binary, 4 bytes]
2025-02-07 14:09:33,937 - DEBUG - [protocol.py:745] - > PONG 65 9f 26 ad [binary, 4 bytes]
2025-02-07 14:09:33,939 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:09:33,940 - DEBUG - [protocol.py:745] - > PING f3 6d 86 a6 [binary, 4 bytes]
2025-02-07 14:09:33,947 - DEBUG - [protocol.py:599] - < PONG f3 6d 86 a6 [binary, 4 bytes]
2025-02-07 14:09:33,949 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:09:53,938 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:09:53,940 - DEBUG - [protocol.py:745] - > PING 76 b5 c4 4f [binary, 4 bytes]
2025-02-07 14:09:53,943 - DEBUG - [protocol.py:599] - < PING bc 19 1c 6d [binary, 4 bytes]
2025-02-07 14:09:53,946 - DEBUG - [protocol.py:745] - > PONG bc 19 1c 6d [binary, 4 bytes]
2025-02-07 14:09:53,949 - DEBUG - [protocol.py:599] - < PONG 76 b5 c4 4f [binary, 4 bytes]
2025-02-07 14:09:53,951 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:10:13,950 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:10:13,952 - DEBUG - [protocol.py:745] - > PING 54 ef c9 cb [binary, 4 bytes]
2025-02-07 14:10:13,955 - DEBUG - [protocol.py:599] - < PING 2d f6 7a f9 [binary, 4 bytes]
2025-02-07 14:10:13,957 - DEBUG - [protocol.py:745] - > PONG 2d f6 7a f9 [binary, 4 bytes]
2025-02-07 14:10:13,960 - DEBUG - [protocol.py:599] - < PONG 54 ef c9 cb [binary, 4 bytes]
2025-02-07 14:10:13,963 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:10:33,955 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:10:33,956 - DEBUG - [protocol.py:745] - > PING 0f c5 52 3a [binary, 4 bytes]
2025-02-07 14:10:33,964 - DEBUG - [protocol.py:599] - < PONG 0f c5 52 3a [binary, 4 bytes]
2025-02-07 14:10:33,965 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:10:33,967 - DEBUG - [protocol.py:599] - < PING 32 d1 ba ce [binary, 4 bytes]
2025-02-07 14:10:33,968 - DEBUG - [protocol.py:745] - > PONG 32 d1 ba ce [binary, 4 bytes]
2025-02-07 14:10:43,613 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:10:43,615 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:10:43,615 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:10:43,616 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:10:43,651 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:10:43,652 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:10:43,655 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:10:43,655 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:10:43,655 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:10:43,655 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:10:43,827 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:10:43,982 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:10:43,984 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,156 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,156 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:10:44,156 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:10:44,156 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:10:44,169 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:10:44,169 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,326 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,327 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,490 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,490 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,688 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,688 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,862 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,862 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:10:44,862 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:10:44,862 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:10:45,025 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:10:45,025 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:10:45,025 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:10:45,028 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:10:45.025677",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:10:45,028 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:10:45,029 - DEBUG - [printer_monitor_service.py:418] - Datos procesados para enviar: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:10:45.025677",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:10:45,029 - DEBUG - [printer_monitor_service.py:446] - Enviando datos a ws://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:10:45,029 - DEBUG - [printer_monitor_service.py:447] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:10:45,029 - DEBUG - [printer_monitor_service.py:448] - Params: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5'}
2025-02-07 14:10:45,054 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 14:10:45,055 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 14:10:45,056 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 14:10:45,058 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:10:53,975 - DEBUG - [protocol.py:599] - < PING 52 b7 ca c2 [binary, 4 bytes]
2025-02-07 14:10:53,976 - DEBUG - [protocol.py:745] - > PONG 52 b7 ca c2 [binary, 4 bytes]
2025-02-07 14:10:53,977 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:10:53,978 - DEBUG - [protocol.py:745] - > PING ff af fa 9e [binary, 4 bytes]
2025-02-07 14:10:53,985 - DEBUG - [protocol.py:599] - < PONG ff af fa 9e [binary, 4 bytes]
2025-02-07 14:10:53,987 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:11:13,981 - DEBUG - [protocol.py:599] - < PING 15 a3 3e 1f [binary, 4 bytes]
2025-02-07 14:11:13,981 - DEBUG - [protocol.py:745] - > PONG 15 a3 3e 1f [binary, 4 bytes]
2025-02-07 14:11:13,998 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:11:13,998 - DEBUG - [protocol.py:745] - > PING b7 ea 2d 20 [binary, 4 bytes]
2025-02-07 14:11:14,004 - DEBUG - [protocol.py:599] - < PONG b7 ea 2d 20 [binary, 4 bytes]
2025-02-07 14:11:14,004 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:11:21,025 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:11:21,026 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:11:21,031 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:11:21,031 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:11:21,033 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:11:21,033 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:11:21,033 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:11:26,399 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:11:26,400 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:11:26,402 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:11:26,433 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:11:26,433 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: gANiWwPstKN+XF+XiWU81w==
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:11:26,455 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:11:26,455 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:11:26,455 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:11:26,456 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: kKT3HpqjZ64sETGZZuEY9iM98K4=
2025-02-07 14:11:26,456 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:11:26,456 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:11:25 GMT
2025-02-07 14:11:26,456 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:11:26,457 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:11:26,457 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:11:27,534 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:11:27,535 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:11:27,535 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:11:27,535 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:11:27,562 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:11:27,562 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:11:27,562 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:11:27,563 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:11:27,563 - INFO - [printer_monitor_service.py:472] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:11:27,564 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:11:27,732 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:11:27,732 - INFO - [printer_monitor_service.py:481] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:11:27,732 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:11:27,732 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:11:27,765 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:11:27,766 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:11:27,769 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:11:27,771 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:11:27,771 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:11:27,774 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:11:27,965 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:11:27,966 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,145 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,311 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,311 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,463 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,463 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,645 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,645 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,799 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,799 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:11:28,799 - INFO - [printer_monitor_service.py:502] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:11:28,802 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:11:28,951 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:11:28,951 - INFO - [printer_monitor_service.py:533] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:11:28,951 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:11:28,953 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:11:28.951712",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:11:28,953 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:11:28,953 - DEBUG - [printer_monitor_service.py:438] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:11:28,953 - DEBUG - [printer_monitor_service.py:439] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:11:28,953 - DEBUG - [printer_monitor_service.py:440] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:11:28.953412",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:11:28,973 - ERROR - [printer_monitor_service.py:449] - Error actualizando datos para 192.168.18.79
2025-02-07 14:11:28,973 - ERROR - [printer_monitor_service.py:450] - Status: 422
2025-02-07 14:11:28,973 - ERROR - [printer_monitor_service.py:451] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"missing","loc":["query","agent_id"],"msg":"Field required","input":null}]}
2025-02-07 14:11:28,974 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:11:46,458 - DEBUG - [protocol.py:599] - < PING 4b 05 86 d2 [binary, 4 bytes]
2025-02-07 14:11:46,460 - DEBUG - [protocol.py:745] - > PONG 4b 05 86 d2 [binary, 4 bytes]
2025-02-07 14:11:46,462 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:11:46,464 - DEBUG - [protocol.py:745] - > PING b6 8f 54 8b [binary, 4 bytes]
2025-02-07 14:11:46,473 - DEBUG - [protocol.py:599] - < PONG b6 8f 54 8b [binary, 4 bytes]
2025-02-07 14:11:46,475 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:12:06,472 - DEBUG - [protocol.py:599] - < PING 45 0e c6 e3 [binary, 4 bytes]
2025-02-07 14:12:06,474 - DEBUG - [protocol.py:745] - > PONG 45 0e c6 e3 [binary, 4 bytes]
2025-02-07 14:12:06,476 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:12:06,478 - DEBUG - [protocol.py:745] - > PING aa e1 89 69 [binary, 4 bytes]
2025-02-07 14:12:06,483 - DEBUG - [protocol.py:599] - < PONG aa e1 89 69 [binary, 4 bytes]
2025-02-07 14:12:06,486 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:12:26,482 - DEBUG - [protocol.py:599] - < PING e9 49 06 11 [binary, 4 bytes]
2025-02-07 14:12:26,482 - DEBUG - [protocol.py:745] - > PONG e9 49 06 11 [binary, 4 bytes]
2025-02-07 14:12:26,483 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:12:26,483 - DEBUG - [protocol.py:745] - > PING 67 ba 00 c1 [binary, 4 bytes]
2025-02-07 14:12:26,489 - DEBUG - [protocol.py:599] - < PONG 67 ba 00 c1 [binary, 4 bytes]
2025-02-07 14:12:26,490 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:12:46,478 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:12:46,481 - DEBUG - [protocol.py:745] - > PING bc 03 3e fd [binary, 4 bytes]
2025-02-07 14:12:46,488 - DEBUG - [protocol.py:599] - < PING 8f 42 fd 20 [binary, 4 bytes]
2025-02-07 14:12:46,489 - DEBUG - [protocol.py:745] - > PONG 8f 42 fd 20 [binary, 4 bytes]
2025-02-07 14:12:46,490 - DEBUG - [protocol.py:599] - < PONG bc 03 3e fd [binary, 4 bytes]
2025-02-07 14:12:46,491 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:13:06,477 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:13:06,481 - DEBUG - [protocol.py:745] - > PING 16 ca a0 ca [binary, 4 bytes]
2025-02-07 14:13:06,488 - DEBUG - [protocol.py:599] - < PONG 16 ca a0 ca [binary, 4 bytes]
2025-02-07 14:13:06,491 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:13:06,494 - DEBUG - [protocol.py:599] - < PING 'S?~l' [text, 4 bytes]
2025-02-07 14:13:06,496 - DEBUG - [protocol.py:745] - > PONG 'S?~l' [text, 4 bytes]
2025-02-07 14:13:15,637 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:13:15,637 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:13:15,641 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:13:15,643 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:13:15,643 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:13:15,643 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:13:15,644 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:13:19,773 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:13:19,773 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:13:19,773 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:13:19,784 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:13:19,812 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:13:19,812 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 9i9VBC3U+e+b6/+pYNyHEg==
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:13:19,844 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:13:19,844 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:13:19,845 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:13:19,845 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: BWXPUFcE1t1yzWRASOwPbm82zlM=
2025-02-07 14:13:19,845 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:13:19,846 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:13:18 GMT
2025-02-07 14:13:19,846 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:13:19,846 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:13:19,847 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:13:20,939 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:13:20,939 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:13:20,944 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:13:20,944 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:13:20,967 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:13:20,967 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:13:20,967 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:13:20,967 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:13:20,974 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:13:20,974 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:13:21,126 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:13:21,126 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:13:21,126 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:13:21,126 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:13:21,162 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:13:21,163 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:13:21,163 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:13:21,165 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:13:21,165 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:13:21,167 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:13:21,327 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:13:21,327 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:21,508 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:21,657 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:21,657 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:21,812 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:21,812 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:21,992 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:21,992 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:22,204 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:22,204 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:13:22,205 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:13:22,205 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:13:22,385 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:13:22,385 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:13:22,386 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:13:22,386 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:13:22.386564",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:13:22,387 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:13:22,387 - DEBUG - [printer_monitor_service.py:445] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:13:22,387 - DEBUG - [printer_monitor_service.py:446] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:13:22,388 - DEBUG - [printer_monitor_service.py:447] - Parámetros: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5', 'self': 'true'}
2025-02-07 14:13:22,388 - DEBUG - [printer_monitor_service.py:448] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:13:22.387559",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:13:22,408 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 14:13:22,409 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 14:13:22,409 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 14:13:22,411 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:13:39,845 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:13:39,847 - DEBUG - [protocol.py:745] - > PING c1 2c e9 24 [binary, 4 bytes]
2025-02-07 14:13:39,852 - DEBUG - [protocol.py:599] - < PING e9 c8 2c 6e [binary, 4 bytes]
2025-02-07 14:13:39,855 - DEBUG - [protocol.py:745] - > PONG e9 c8 2c 6e [binary, 4 bytes]
2025-02-07 14:13:39,858 - DEBUG - [protocol.py:599] - < PONG c1 2c e9 24 [binary, 4 bytes]
2025-02-07 14:13:39,861 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:13:59,865 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:13:59,867 - DEBUG - [protocol.py:745] - > PING 78 8f 8d f1 [binary, 4 bytes]
2025-02-07 14:13:59,869 - DEBUG - [protocol.py:599] - < PING 70 58 88 09 [binary, 4 bytes]
2025-02-07 14:13:59,871 - DEBUG - [protocol.py:745] - > PONG 70 58 88 09 [binary, 4 bytes]
2025-02-07 14:13:59,875 - DEBUG - [protocol.py:599] - < PONG 78 8f 8d f1 [binary, 4 bytes]
2025-02-07 14:13:59,877 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:14:19,880 - DEBUG - [protocol.py:599] - < PING 'Z\u0590N' [text, 4 bytes]
2025-02-07 14:14:19,880 - DEBUG - [protocol.py:745] - > PONG 'Z\u0590N' [text, 4 bytes]
2025-02-07 14:14:19,881 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:14:19,881 - DEBUG - [protocol.py:745] - > PING a6 05 1e 40 [binary, 4 bytes]
2025-02-07 14:14:19,887 - DEBUG - [protocol.py:599] - < PONG a6 05 1e 40 [binary, 4 bytes]
2025-02-07 14:14:19,887 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:14:39,887 - DEBUG - [protocol.py:599] - < PING c5 b3 80 16 [binary, 4 bytes]
2025-02-07 14:14:39,888 - DEBUG - [protocol.py:745] - > PONG c5 b3 80 16 [binary, 4 bytes]
2025-02-07 14:14:39,891 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:14:39,892 - DEBUG - [protocol.py:745] - > PING 7a 82 f3 7b [binary, 4 bytes]
2025-02-07 14:14:39,898 - DEBUG - [protocol.py:599] - < PONG 7a 82 f3 7b [binary, 4 bytes]
2025-02-07 14:14:39,900 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:14:59,894 - DEBUG - [protocol.py:599] - < PING 7c b0 c0 5a [binary, 4 bytes]
2025-02-07 14:14:59,895 - DEBUG - [protocol.py:745] - > PONG 7c b0 c0 5a [binary, 4 bytes]
2025-02-07 14:14:59,895 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:14:59,897 - DEBUG - [protocol.py:745] - > PING 7a 95 ab 18 [binary, 4 bytes]
2025-02-07 14:14:59,903 - DEBUG - [protocol.py:599] - < PONG 7a 95 ab 18 [binary, 4 bytes]
2025-02-07 14:14:59,904 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:15:12,521 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:15:12,525 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:15:12,533 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:15:12,534 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:15:12,536 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:15:12,537 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:15:12,539 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:15:17,632 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:15:17,632 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:15:17,632 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:15:17,671 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:15:17,676 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:15:17,677 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:15:17,677 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:15:17,679 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:15:17,679 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 7/jX6VecZxV/AQc7Kn6gvA==
2025-02-07 14:15:17,680 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:15:17,680 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:15:17,680 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:15:17,707 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:15:17,708 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:15:17,709 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:15:17,709 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: WdQZGgcwmvtr0o+ocxTSLuofhRM=
2025-02-07 14:15:17,709 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:15:17,710 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:15:16 GMT
2025-02-07 14:15:17,710 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:15:17,711 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:15:17,711 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:15:18,791 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:15:18,791 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:15:18,791 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:15:18,791 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:15:18,823 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:15:18,824 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:15:18,825 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:15:18,826 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:15:18,826 - INFO - [printer_monitor_service.py:498] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:15:18,826 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:15:18,996 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:15:18,997 - INFO - [printer_monitor_service.py:507] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:15:18,997 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:15:18,997 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:15:19,021 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:15:19,021 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:15:19,023 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:15:19,023 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:15:19,023 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:15:19,023 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:15:19,179 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:15:19,179 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:19,353 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:19,353 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:15:19,355 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:15:19,355 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:15:19,355 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:15:19,357 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:19,502 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:19,502 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:19,652 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:19,652 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:19,836 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:19,836 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:20,001 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:20,001 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:15:20,003 - INFO - [printer_monitor_service.py:528] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:15:20,003 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:15:20,157 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:15:20,158 - INFO - [printer_monitor_service.py:559] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:15:20,158 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:15:20,158 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:15:20.158529",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:15:20,158 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:15:20,160 - DEBUG - [printer_monitor_service.py:459] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:15:20,160 - DEBUG - [printer_monitor_service.py:460] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:15:20,160 - DEBUG - [printer_monitor_service.py:461] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:15:20,161 - DEBUG - [printer_monitor_service.py:462] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:15:20.160134",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:15:20,191 - ERROR - [printer_monitor_service.py:476] - Error actualizando datos para 192.168.18.79
2025-02-07 14:15:20,191 - ERROR - [printer_monitor_service.py:477] - Status: 500
2025-02-07 14:15:20,191 - ERROR - [printer_monitor_service.py:478] - Respuesta: Internal Server Error
2025-02-07 14:15:20,191 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:15:37,697 - DEBUG - [protocol.py:599] - < PING a1 14 ba bc [binary, 4 bytes]
2025-02-07 14:15:37,697 - DEBUG - [protocol.py:745] - > PONG a1 14 ba bc [binary, 4 bytes]
2025-02-07 14:15:37,728 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:15:37,731 - DEBUG - [protocol.py:745] - > PING 45 0b a2 02 [binary, 4 bytes]
2025-02-07 14:15:37,732 - DEBUG - [protocol.py:599] - < PONG 45 0b a2 02 [binary, 4 bytes]
2025-02-07 14:15:37,732 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:15:57,713 - DEBUG - [protocol.py:599] - < PING 6e 54 cb de [binary, 4 bytes]
2025-02-07 14:15:57,714 - DEBUG - [protocol.py:745] - > PONG 6e 54 cb de [binary, 4 bytes]
2025-02-07 14:15:57,714 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:15:57,716 - DEBUG - [protocol.py:745] - > PING 'AЊl' [text, 4 bytes]
2025-02-07 14:15:57,718 - DEBUG - [protocol.py:599] - < PONG 'AЊl' [text, 4 bytes]
2025-02-07 14:15:57,719 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:16:17,718 - DEBUG - [protocol.py:599] - < PING 'e\x03\x02\x17' [text, 4 bytes]
2025-02-07 14:16:17,718 - DEBUG - [protocol.py:745] - > PONG 'e\x03\x02\x17' [text, 4 bytes]
2025-02-07 14:16:17,719 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:16:17,719 - DEBUG - [protocol.py:745] - > PING 'F\x1f"9' [text, 4 bytes]
2025-02-07 14:16:17,725 - DEBUG - [protocol.py:599] - < PONG 'F\x1f"9' [text, 4 bytes]
2025-02-07 14:16:17,726 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:16:37,724 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:16:37,726 - DEBUG - [protocol.py:745] - > PING 39 5e e3 62 [binary, 4 bytes]
2025-02-07 14:16:37,729 - DEBUG - [protocol.py:599] - < PING b5 0f d0 e5 [binary, 4 bytes]
2025-02-07 14:16:37,732 - DEBUG - [protocol.py:745] - > PONG b5 0f d0 e5 [binary, 4 bytes]
2025-02-07 14:16:37,737 - DEBUG - [protocol.py:599] - < PONG 39 5e e3 62 [binary, 4 bytes]
2025-02-07 14:16:37,740 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:16:57,731 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:16:57,732 - DEBUG - [protocol.py:745] - > PING 31 e2 ec c1 [binary, 4 bytes]
2025-02-07 14:16:57,738 - DEBUG - [protocol.py:599] - < PONG 31 e2 ec c1 [binary, 4 bytes]
2025-02-07 14:16:57,738 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:16:57,738 - DEBUG - [protocol.py:599] - < PING d1 37 8d 3a [binary, 4 bytes]
2025-02-07 14:16:57,738 - DEBUG - [protocol.py:745] - > PONG d1 37 8d 3a [binary, 4 bytes]
2025-02-07 14:17:17,734 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:17:17,735 - DEBUG - [protocol.py:745] - > PING 95 75 46 0f [binary, 4 bytes]
2025-02-07 14:17:17,739 - DEBUG - [protocol.py:599] - < PONG 95 75 46 0f [binary, 4 bytes]
2025-02-07 14:17:17,743 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:17:17,745 - DEBUG - [protocol.py:599] - < PING 9c ea 28 aa [binary, 4 bytes]
2025-02-07 14:17:17,745 - DEBUG - [protocol.py:745] - > PONG 9c ea 28 aa [binary, 4 bytes]
2025-02-07 14:17:37,736 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:17:37,738 - DEBUG - [protocol.py:745] - > PING 24 02 bf ef [binary, 4 bytes]
2025-02-07 14:17:37,744 - DEBUG - [protocol.py:599] - < PONG 24 02 bf ef [binary, 4 bytes]
2025-02-07 14:17:37,744 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:17:37,744 - DEBUG - [protocol.py:599] - < PING 72 9c 61 d6 [binary, 4 bytes]
2025-02-07 14:17:37,744 - DEBUG - [protocol.py:745] - > PONG 72 9c 61 d6 [binary, 4 bytes]
2025-02-07 14:17:42,808 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:17:42,811 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:17:42,819 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:17:42,823 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:17:42,826 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:17:42,826 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:17:42,828 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:18:15,088 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:18:15,089 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:18:15,089 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:18:15,091 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:18:15,126 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:18:15,126 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:18:15,127 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:18:15,127 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:18:15,127 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:18:15,127 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: ewD7cDfLOZMfNDdSvFFCHA==
2025-02-07 14:18:15,128 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:18:15,128 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:18:15,128 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:18:15,153 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:18:15,154 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:18:15,154 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:18:15,154 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: lfO83YktQuk36OYt/rlclhmR/sQ=
2025-02-07 14:18:15,155 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:18:15,155 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:18:14 GMT
2025-02-07 14:18:15,155 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:18:15,156 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:18:15,157 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:18:16,231 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:18:16,231 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:18:16,231 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:18:16,231 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:18:16,259 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:18:16,259 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:18:16,259 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:18:16,259 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:18:16,259 - INFO - [printer_monitor_service.py:501] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:18:16,259 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:18:16,453 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:18:16,455 - INFO - [printer_monitor_service.py:510] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:18:16,455 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:18:16,455 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:18:16,481 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:18:16,481 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:18:16,481 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:18:16,482 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:18:16,482 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:18:16,482 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:18:16,642 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:18:16,642 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:16,807 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:16,956 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:16,956 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:17,105 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:17,105 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:17,286 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:17,286 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:17,453 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:17,453 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:18:17,453 - INFO - [printer_monitor_service.py:531] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:18:17,453 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:18:17,589 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:18:17,589 - INFO - [printer_monitor_service.py:562] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:18:17,589 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:18:17,589 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:18:17.589687",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:18:17,589 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:18:17,605 - DEBUG - [printer_monitor_service.py:462] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:18:17,605 - DEBUG - [printer_monitor_service.py:463] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:18:17,605 - DEBUG - [printer_monitor_service.py:464] - Parámetros: {'agent_id': '1'}
2025-02-07 14:18:17,605 - DEBUG - [printer_monitor_service.py:465] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:18:17.589687",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null,
  "name": "Unknown Printer",
  "model": "Unknown",
  "client_id": null
}
2025-02-07 14:18:17,624 - ERROR - [printer_monitor_service.py:479] - Error actualizando datos para 192.168.18.79
2025-02-07 14:18:17,624 - ERROR - [printer_monitor_service.py:480] - Status: 422
2025-02-07 14:18:17,625 - ERROR - [printer_monitor_service.py:481] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null}]}
2025-02-07 14:18:17,625 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:18:35,155 - DEBUG - [protocol.py:599] - < PING 1e 3e 72 91 [binary, 4 bytes]
2025-02-07 14:18:35,157 - DEBUG - [protocol.py:745] - > PONG 1e 3e 72 91 [binary, 4 bytes]
2025-02-07 14:18:35,160 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:18:35,162 - DEBUG - [protocol.py:745] - > PING 6c 07 af 85 [binary, 4 bytes]
2025-02-07 14:18:35,171 - DEBUG - [protocol.py:599] - < PONG 6c 07 af 85 [binary, 4 bytes]
2025-02-07 14:18:35,173 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:18:55,165 - DEBUG - [protocol.py:599] - < PING f9 e3 20 6d [binary, 4 bytes]
2025-02-07 14:18:55,167 - DEBUG - [protocol.py:745] - > PONG f9 e3 20 6d [binary, 4 bytes]
2025-02-07 14:18:55,170 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:18:55,171 - DEBUG - [protocol.py:745] - > PING 29 ec 60 99 [binary, 4 bytes]
2025-02-07 14:18:55,180 - DEBUG - [protocol.py:599] - < PONG 29 ec 60 99 [binary, 4 bytes]
2025-02-07 14:18:55,182 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:19:15,174 - DEBUG - [protocol.py:599] - < PING 30 a5 32 49 [binary, 4 bytes]
2025-02-07 14:19:15,175 - DEBUG - [protocol.py:745] - > PONG 30 a5 32 49 [binary, 4 bytes]
2025-02-07 14:19:15,176 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:19:15,177 - DEBUG - [protocol.py:745] - > PING 57 e1 f3 ef [binary, 4 bytes]
2025-02-07 14:19:15,181 - DEBUG - [protocol.py:599] - < PONG 57 e1 f3 ef [binary, 4 bytes]
2025-02-07 14:19:15,183 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:19:35,181 - DEBUG - [protocol.py:599] - < PING 7c 6d 55 f4 [binary, 4 bytes]
2025-02-07 14:19:35,183 - DEBUG - [protocol.py:745] - > PONG 7c 6d 55 f4 [binary, 4 bytes]
2025-02-07 14:19:35,185 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:19:35,186 - DEBUG - [protocol.py:745] - > PING '\x7f\x0cϦ' [text, 4 bytes]
2025-02-07 14:19:35,194 - DEBUG - [protocol.py:599] - < PONG '\x7f\x0cϦ' [text, 4 bytes]
2025-02-07 14:19:35,196 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:19:55,190 - DEBUG - [protocol.py:599] - < PING 5e b1 6c cc [binary, 4 bytes]
2025-02-07 14:19:55,191 - DEBUG - [protocol.py:745] - > PONG 5e b1 6c cc [binary, 4 bytes]
2025-02-07 14:19:55,195 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:19:55,196 - DEBUG - [protocol.py:745] - > PING 61 5e 6a a4 [binary, 4 bytes]
2025-02-07 14:19:55,201 - DEBUG - [protocol.py:599] - < PONG 61 5e 6a a4 [binary, 4 bytes]
2025-02-07 14:19:55,204 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:20:10,558 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:20:10,558 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:20:10,563 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:20:10,563 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:20:10,563 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:20:10,563 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:20:10,565 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:20:14,835 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:20:14,835 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:20:14,846 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:20:14,882 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:20:14,882 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:20:14,882 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:20:14,884 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:20:14,884 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:20:14,885 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 4Lki/kp5c0Fgu6/W9XX8Rw==
2025-02-07 14:20:14,885 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:20:14,885 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:20:14,886 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:20:14,914 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:20:14,914 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:20:14,914 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:20:14,916 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: gQ2ZJNX1zaXTyf5R0IdUPVhwgTc=
2025-02-07 14:20:14,916 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:20:14,916 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:20:13 GMT
2025-02-07 14:20:14,918 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:20:14,919 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:20:14,920 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:20:16,044 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:20:16,045 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:20:16,045 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:20:16,046 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:20:16,088 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:20:16,091 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:20:16,092 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:20:16,094 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:20:16,096 - INFO - [printer_monitor_service.py:510] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:20:16,096 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:20:16,292 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:20:16,293 - INFO - [printer_monitor_service.py:519] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:20:16,293 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:20:16,293 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:20:16,340 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:20:16,340 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:20:16,340 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:20:16,342 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:20:16,342 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:20:16,342 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:20:16,501 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:20:16,501 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:16,684 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:16,840 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:16,840 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:16,988 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:16,990 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:17,172 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:17,172 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:17,319 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:17,319 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:20:17,319 - INFO - [printer_monitor_service.py:540] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:20:17,319 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:20:17,470 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:20:17,470 - INFO - [printer_monitor_service.py:571] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:20:17,470 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:20:17,473 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:20:17.470744",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:20:17,473 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:20:17,473 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:20:17,473 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:20:17,473 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:20:17,504 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:20:17,504 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:20:17,504 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:20:17,511 - DEBUG - [printer_monitor_service.py:471] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:20:17,511 - DEBUG - [printer_monitor_service.py:472] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:20:17,511 - DEBUG - [printer_monitor_service.py:473] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:20:17,511 - DEBUG - [printer_monitor_service.py:474] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:20:17.511695",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null,
  "name": "RRHH",
  "model": "MPC 307",
  "client_id": 4
}
2025-02-07 14:20:17,537 - ERROR - [printer_monitor_service.py:488] - Error actualizando datos para 192.168.18.79
2025-02-07 14:20:17,537 - ERROR - [printer_monitor_service.py:489] - Status: 500
2025-02-07 14:20:17,537 - ERROR - [printer_monitor_service.py:490] - Respuesta: Internal Server Error
2025-02-07 14:20:17,537 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:20:34,914 - DEBUG - [protocol.py:599] - < PING 51 79 78 be [binary, 4 bytes]
2025-02-07 14:20:34,916 - DEBUG - [protocol.py:745] - > PONG 51 79 78 be [binary, 4 bytes]
2025-02-07 14:20:34,919 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:20:34,920 - DEBUG - [protocol.py:745] - > PING d5 97 bd 1d [binary, 4 bytes]
2025-02-07 14:20:34,927 - DEBUG - [protocol.py:599] - < PONG d5 97 bd 1d [binary, 4 bytes]
2025-02-07 14:20:34,929 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:20:54,919 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:20:54,920 - DEBUG - [protocol.py:745] - > PING ea 94 d4 15 [binary, 4 bytes]
2025-02-07 14:20:54,923 - DEBUG - [protocol.py:599] - < PING 2c 78 96 25 [binary, 4 bytes]
2025-02-07 14:20:54,923 - DEBUG - [protocol.py:745] - > PONG 2c 78 96 25 [binary, 4 bytes]
2025-02-07 14:20:54,925 - DEBUG - [protocol.py:599] - < PONG ea 94 d4 15 [binary, 4 bytes]
2025-02-07 14:20:54,926 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:21:14,919 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:21:14,919 - DEBUG - [protocol.py:745] - > PING 33 32 75 a4 [binary, 4 bytes]
2025-02-07 14:21:14,926 - DEBUG - [protocol.py:599] - < PONG 33 32 75 a4 [binary, 4 bytes]
2025-02-07 14:21:14,926 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:21:14,932 - DEBUG - [protocol.py:599] - < PING cc 7a f2 9d [binary, 4 bytes]
2025-02-07 14:21:14,933 - DEBUG - [protocol.py:745] - > PONG cc 7a f2 9d [binary, 4 bytes]
2025-02-07 14:21:34,934 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:21:34,936 - DEBUG - [protocol.py:745] - > PING c3 5d f7 a7 [binary, 4 bytes]
2025-02-07 14:21:34,939 - DEBUG - [protocol.py:599] - < PING 'ɕ.j' [text, 4 bytes]
2025-02-07 14:21:34,940 - DEBUG - [protocol.py:745] - > PONG 'ɕ.j' [text, 4 bytes]
2025-02-07 14:21:34,943 - DEBUG - [protocol.py:599] - < PONG c3 5d f7 a7 [binary, 4 bytes]
2025-02-07 14:21:34,946 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:21:54,942 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:21:54,944 - DEBUG - [protocol.py:745] - > PING 2f f2 7a f8 [binary, 4 bytes]
2025-02-07 14:21:54,947 - DEBUG - [protocol.py:599] - < PING 86 19 6e ff [binary, 4 bytes]
2025-02-07 14:21:54,948 - DEBUG - [protocol.py:745] - > PONG 86 19 6e ff [binary, 4 bytes]
2025-02-07 14:21:54,951 - DEBUG - [protocol.py:599] - < PONG 2f f2 7a f8 [binary, 4 bytes]
2025-02-07 14:21:54,953 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:22:14,955 - DEBUG - [protocol.py:599] - < PING 91 41 47 35 [binary, 4 bytes]
2025-02-07 14:22:14,955 - DEBUG - [protocol.py:745] - > PONG 91 41 47 35 [binary, 4 bytes]
2025-02-07 14:22:14,956 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:22:14,957 - DEBUG - [protocol.py:745] - > PING f8 d9 b8 8e [binary, 4 bytes]
2025-02-07 14:22:14,962 - DEBUG - [protocol.py:599] - < PONG f8 d9 b8 8e [binary, 4 bytes]
2025-02-07 14:22:14,963 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:22:34,962 - DEBUG - [protocol.py:599] - < PING 72 1e 08 d8 [binary, 4 bytes]
2025-02-07 14:22:34,964 - DEBUG - [protocol.py:745] - > PONG 72 1e 08 d8 [binary, 4 bytes]
2025-02-07 14:22:34,966 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:22:34,968 - DEBUG - [protocol.py:745] - > PING ef 1a 3e f2 [binary, 4 bytes]
2025-02-07 14:22:34,975 - DEBUG - [protocol.py:599] - < PONG ef 1a 3e f2 [binary, 4 bytes]
2025-02-07 14:22:34,979 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:22:54,966 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:22:54,968 - DEBUG - [protocol.py:745] - > PING f6 00 ea e1 [binary, 4 bytes]
2025-02-07 14:22:54,973 - DEBUG - [protocol.py:599] - < PING 3f a3 e0 6d [binary, 4 bytes]
2025-02-07 14:22:54,974 - DEBUG - [protocol.py:745] - > PONG 3f a3 e0 6d [binary, 4 bytes]
2025-02-07 14:22:54,977 - DEBUG - [protocol.py:599] - < PONG f6 00 ea e1 [binary, 4 bytes]
2025-02-07 14:22:54,979 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:23:14,971 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:23:14,973 - DEBUG - [protocol.py:745] - > PING bb 99 c1 d5 [binary, 4 bytes]
2025-02-07 14:23:14,978 - DEBUG - [protocol.py:599] - < PONG bb 99 c1 d5 [binary, 4 bytes]
2025-02-07 14:23:14,979 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:23:14,984 - DEBUG - [protocol.py:599] - < PING 39 45 c0 26 [binary, 4 bytes]
2025-02-07 14:23:14,985 - DEBUG - [protocol.py:745] - > PONG 39 45 c0 26 [binary, 4 bytes]
2025-02-07 14:23:34,992 - DEBUG - [protocol.py:599] - < PING c1 b7 c0 1c [binary, 4 bytes]
2025-02-07 14:23:34,993 - DEBUG - [protocol.py:745] - > PONG c1 b7 c0 1c [binary, 4 bytes]
2025-02-07 14:23:34,995 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:23:34,996 - DEBUG - [protocol.py:745] - > PING c5 c7 c6 33 [binary, 4 bytes]
2025-02-07 14:23:35,001 - DEBUG - [protocol.py:599] - < PONG c5 c7 c6 33 [binary, 4 bytes]
2025-02-07 14:23:35,003 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:23:54,998 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:23:55,000 - DEBUG - [protocol.py:745] - > PING fe c7 f6 a0 [binary, 4 bytes]
2025-02-07 14:23:55,002 - DEBUG - [protocol.py:599] - < PING a9 96 46 6a [binary, 4 bytes]
2025-02-07 14:23:55,003 - DEBUG - [protocol.py:745] - > PONG a9 96 46 6a [binary, 4 bytes]
2025-02-07 14:23:55,012 - DEBUG - [protocol.py:599] - < PONG fe c7 f6 a0 [binary, 4 bytes]
2025-02-07 14:23:55,015 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:24:15,010 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:24:15,013 - DEBUG - [protocol.py:745] - > PING fb 58 0a f0 [binary, 4 bytes]
2025-02-07 14:24:15,017 - DEBUG - [protocol.py:599] - < PING 28 0b f1 5d [binary, 4 bytes]
2025-02-07 14:24:15,018 - DEBUG - [protocol.py:745] - > PONG 28 0b f1 5d [binary, 4 bytes]
2025-02-07 14:24:15,021 - DEBUG - [protocol.py:599] - < PONG fb 58 0a f0 [binary, 4 bytes]
2025-02-07 14:24:15,023 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:24:35,023 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:24:35,037 - DEBUG - [protocol.py:745] - > PING d9 2a 11 78 [binary, 4 bytes]
2025-02-07 14:24:35,038 - DEBUG - [protocol.py:599] - < PING 3a a3 ac cd [binary, 4 bytes]
2025-02-07 14:24:35,039 - DEBUG - [protocol.py:745] - > PONG 3a a3 ac cd [binary, 4 bytes]
2025-02-07 14:24:35,100 - DEBUG - [protocol.py:599] - < PONG d9 2a 11 78 [binary, 4 bytes]
2025-02-07 14:24:35,100 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:24:55,051 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:24:55,053 - DEBUG - [protocol.py:745] - > PING f8 8f a8 22 [binary, 4 bytes]
2025-02-07 14:24:55,061 - DEBUG - [protocol.py:599] - < PONG f8 8f a8 22 [binary, 4 bytes]
2025-02-07 14:24:55,063 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:24:55,101 - DEBUG - [protocol.py:599] - < PING 8e 25 ae 17 [binary, 4 bytes]
2025-02-07 14:24:55,103 - DEBUG - [protocol.py:745] - > PONG 8e 25 ae 17 [binary, 4 bytes]
2025-02-07 14:25:15,061 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:25:15,063 - DEBUG - [protocol.py:745] - > PING 80 0f fc 5b [binary, 4 bytes]
2025-02-07 14:25:15,069 - DEBUG - [protocol.py:599] - < PONG 80 0f fc 5b [binary, 4 bytes]
2025-02-07 14:25:15,070 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:25:15,110 - DEBUG - [protocol.py:599] - < PING f6 6a 68 69 [binary, 4 bytes]
2025-02-07 14:25:15,112 - DEBUG - [protocol.py:745] - > PONG f6 6a 68 69 [binary, 4 bytes]
2025-02-07 14:25:18,669 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:25:18,671 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:25:18,672 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:25:18,673 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:25:18,766 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:25:18,767 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:25:18,768 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:25:18,769 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:25:18,770 - INFO - [printer_monitor_service.py:510] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:25:18,770 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:25:18,998 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:25:18,998 - INFO - [printer_monitor_service.py:519] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:25:18,999 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:25:18,999 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:25:19,000 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:25:19,000 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:25:19,279 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:25:19,280 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:19,504 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:19,505 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:25:19,505 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:25:19,506 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:25:19,506 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:25:19,507 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:19,727 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:19,727 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:20,001 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:20,002 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:20,288 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:20,289 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:20,497 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:20,498 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:25:20,498 - INFO - [printer_monitor_service.py:540] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:25:20,498 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:25:20,706 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:25:20,706 - INFO - [printer_monitor_service.py:571] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:25:20,706 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:25:20,707 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:25:20.706681",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:25:20,708 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:25:20,708 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:25:20,708 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:25:20,709 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:25:20,740 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:25:20,742 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:25:20,742 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:25:20,745 - DEBUG - [printer_monitor_service.py:471] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:25:20,746 - DEBUG - [printer_monitor_service.py:472] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:25:20,748 - DEBUG - [printer_monitor_service.py:473] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:25:20,749 - DEBUG - [printer_monitor_service.py:474] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:25:20.744967",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null,
  "name": "RRHH",
  "model": "MPC 307",
  "client_id": 4
}
2025-02-07 14:25:20,775 - ERROR - [printer_monitor_service.py:488] - Error actualizando datos para 192.168.18.79
2025-02-07 14:25:20,776 - ERROR - [printer_monitor_service.py:489] - Status: 500
2025-02-07 14:25:20,776 - ERROR - [printer_monitor_service.py:490] - Respuesta: Internal Server Error
2025-02-07 14:25:20,778 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:25:35,068 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:25:35,070 - DEBUG - [protocol.py:745] - > PING 22 90 8f bf [binary, 4 bytes]
2025-02-07 14:25:35,076 - DEBUG - [protocol.py:599] - < PONG 22 90 8f bf [binary, 4 bytes]
2025-02-07 14:25:35,078 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:25:35,120 - DEBUG - [protocol.py:599] - < PING 9b 99 b5 cf [binary, 4 bytes]
2025-02-07 14:25:35,122 - DEBUG - [protocol.py:745] - > PONG 9b 99 b5 cf [binary, 4 bytes]
2025-02-07 14:25:55,087 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:25:55,088 - DEBUG - [protocol.py:745] - > PING d7 3b b5 4b [binary, 4 bytes]
2025-02-07 14:25:55,095 - DEBUG - [protocol.py:599] - < PONG d7 3b b5 4b [binary, 4 bytes]
2025-02-07 14:25:55,097 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:25:55,126 - DEBUG - [protocol.py:599] - < PING 0c f2 d0 35 [binary, 4 bytes]
2025-02-07 14:25:55,128 - DEBUG - [protocol.py:745] - > PONG 0c f2 d0 35 [binary, 4 bytes]
2025-02-07 14:26:15,095 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:26:15,097 - DEBUG - [protocol.py:745] - > PING 7c 35 d9 df [binary, 4 bytes]
2025-02-07 14:26:15,104 - DEBUG - [protocol.py:599] - < PONG 7c 35 d9 df [binary, 4 bytes]
2025-02-07 14:26:15,107 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:26:15,136 - DEBUG - [protocol.py:599] - < PING 81 a2 a2 f7 [binary, 4 bytes]
2025-02-07 14:26:15,138 - DEBUG - [protocol.py:745] - > PONG 81 a2 a2 f7 [binary, 4 bytes]
2025-02-07 14:26:35,116 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:26:35,118 - DEBUG - [protocol.py:745] - > PING 89 68 39 86 [binary, 4 bytes]
2025-02-07 14:26:35,126 - DEBUG - [protocol.py:599] - < PONG 89 68 39 86 [binary, 4 bytes]
2025-02-07 14:26:35,128 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:26:35,145 - DEBUG - [protocol.py:599] - < PING 'o~ka' [text, 4 bytes]
2025-02-07 14:26:35,147 - DEBUG - [protocol.py:745] - > PONG 'o~ka' [text, 4 bytes]
2025-02-07 14:26:55,149 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:26:55,150 - DEBUG - [protocol.py:745] - > PING f4 4b c6 ae [binary, 4 bytes]
2025-02-07 14:26:55,156 - DEBUG - [protocol.py:599] - < PING 36 04 3b 97 [binary, 4 bytes]
2025-02-07 14:26:55,157 - DEBUG - [protocol.py:745] - > PONG 36 04 3b 97 [binary, 4 bytes]
2025-02-07 14:26:55,158 - DEBUG - [protocol.py:599] - < PONG f4 4b c6 ae [binary, 4 bytes]
2025-02-07 14:26:55,159 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:27:15,163 - DEBUG - [protocol.py:599] - < PING 9d 18 cf 0a [binary, 4 bytes]
2025-02-07 14:27:15,163 - DEBUG - [protocol.py:745] - > PONG 9d 18 cf 0a [binary, 4 bytes]
2025-02-07 14:27:15,164 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:27:15,164 - DEBUG - [protocol.py:745] - > PING c6 5d 11 ee [binary, 4 bytes]
2025-02-07 14:27:15,169 - DEBUG - [protocol.py:599] - < PONG c6 5d 11 ee [binary, 4 bytes]
2025-02-07 14:27:15,170 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:27:35,168 - DEBUG - [protocol.py:599] - < PING 09 b4 5c 2d [binary, 4 bytes]
2025-02-07 14:27:35,169 - DEBUG - [protocol.py:745] - > PONG 09 b4 5c 2d [binary, 4 bytes]
2025-02-07 14:27:35,170 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:27:35,171 - DEBUG - [protocol.py:745] - > PING d8 63 88 fc [binary, 4 bytes]
2025-02-07 14:27:35,175 - DEBUG - [protocol.py:599] - < PONG d8 63 88 fc [binary, 4 bytes]
2025-02-07 14:27:35,176 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:27:55,170 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:27:55,172 - DEBUG - [protocol.py:745] - > PING cb 72 db d3 [binary, 4 bytes]
2025-02-07 14:27:55,174 - DEBUG - [protocol.py:599] - < PING '9\x7fl>' [text, 4 bytes]
2025-02-07 14:27:55,176 - DEBUG - [protocol.py:745] - > PONG '9\x7fl>' [text, 4 bytes]
2025-02-07 14:27:55,180 - DEBUG - [protocol.py:599] - < PONG cb 72 db d3 [binary, 4 bytes]
2025-02-07 14:27:55,182 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:28:15,173 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:28:15,175 - DEBUG - [protocol.py:745] - > PING 'RD#\x10' [text, 4 bytes]
2025-02-07 14:28:15,180 - DEBUG - [protocol.py:599] - < PONG 'RD#\x10' [text, 4 bytes]
2025-02-07 14:28:15,182 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:28:15,184 - DEBUG - [protocol.py:599] - < PING a9 f4 9e 05 [binary, 4 bytes]
2025-02-07 14:28:15,186 - DEBUG - [protocol.py:745] - > PONG a9 f4 9e 05 [binary, 4 bytes]
2025-02-07 14:28:35,187 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:28:35,189 - DEBUG - [protocol.py:745] - > PING 7b e7 a0 f1 [binary, 4 bytes]
2025-02-07 14:28:35,196 - DEBUG - [protocol.py:599] - < PING b5 ca 05 c6 [binary, 4 bytes]
2025-02-07 14:28:35,197 - DEBUG - [protocol.py:745] - > PONG b5 ca 05 c6 [binary, 4 bytes]
2025-02-07 14:28:35,199 - DEBUG - [protocol.py:599] - < PONG 7b e7 a0 f1 [binary, 4 bytes]
2025-02-07 14:28:35,202 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:28:55,199 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:28:55,201 - DEBUG - [protocol.py:745] - > PING 55 25 66 a7 [binary, 4 bytes]
2025-02-07 14:28:55,204 - DEBUG - [protocol.py:599] - < PING 35 5e 63 b2 [binary, 4 bytes]
2025-02-07 14:28:55,208 - DEBUG - [protocol.py:745] - > PONG 35 5e 63 b2 [binary, 4 bytes]
2025-02-07 14:28:55,211 - DEBUG - [protocol.py:599] - < PONG 55 25 66 a7 [binary, 4 bytes]
2025-02-07 14:28:55,213 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:29:15,213 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:29:15,215 - DEBUG - [protocol.py:745] - > PING ab 35 11 15 [binary, 4 bytes]
2025-02-07 14:29:15,217 - DEBUG - [protocol.py:599] - < PING 82 55 74 23 [binary, 4 bytes]
2025-02-07 14:29:15,219 - DEBUG - [protocol.py:745] - > PONG 82 55 74 23 [binary, 4 bytes]
2025-02-07 14:29:15,222 - DEBUG - [protocol.py:599] - < PONG ab 35 11 15 [binary, 4 bytes]
2025-02-07 14:29:15,224 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:29:35,219 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:29:35,221 - DEBUG - [protocol.py:745] - > PING f7 45 9d 30 [binary, 4 bytes]
2025-02-07 14:29:35,226 - DEBUG - [protocol.py:599] - < PING db 05 95 0f [binary, 4 bytes]
2025-02-07 14:29:35,231 - DEBUG - [protocol.py:745] - > PONG db 05 95 0f [binary, 4 bytes]
2025-02-07 14:29:35,233 - DEBUG - [protocol.py:599] - < PONG f7 45 9d 30 [binary, 4 bytes]
2025-02-07 14:29:35,235 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:29:55,230 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:29:55,231 - DEBUG - [protocol.py:745] - > PING fb 7a 5c 58 [binary, 4 bytes]
2025-02-07 14:29:55,239 - DEBUG - [protocol.py:599] - < PONG fb 7a 5c 58 [binary, 4 bytes]
2025-02-07 14:29:55,240 - DEBUG - [protocol.py:599] - < PING 3a 9d 42 08 [binary, 4 bytes]
2025-02-07 14:29:55,240 - DEBUG - [protocol.py:745] - > PONG 3a 9d 42 08 [binary, 4 bytes]
2025-02-07 14:29:55,241 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:30:00,765 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:30:00,767 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:30:00,773 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:30:00,775 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:30:00,777 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:30:00,779 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:30:00,781 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:30:05,305 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:30:05,305 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:30:05,321 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:30:05,345 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:30:05,345 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: QJk+ofxWcAxT71Q7ErUMWA==
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:30:05,360 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:30:05,360 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:30:05,429 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:30:05,429 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:30:05,429 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:30:05,429 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: ZV6/Da84T66zn3QvJGRs+krLezQ=
2025-02-07 14:30:05,434 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:30:05,434 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:30:04 GMT
2025-02-07 14:30:05,434 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:30:05,435 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:30:05,435 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:30:06,547 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:30:06,550 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:30:06,550 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:30:06,550 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:30:06,620 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:30:06,620 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:30:06,620 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:30:06,620 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:30:06,620 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:30:06,622 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:30:06,793 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:30:06,793 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:30:06,794 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:30:06,794 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:30:06,834 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:30:06,834 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:30:06,834 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:30:06,837 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:30:06,837 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:30:06,838 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:30:06,997 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:30:06,997 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,175 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,342 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,343 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,512 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,512 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,708 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,710 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,886 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,886 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:30:07,886 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:30:07,886 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:30:08,049 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:30:08,050 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:30:08,050 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:30:08,051 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:30:08.050440",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:30:08,051 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:30:08,051 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:30:08,052 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:30:08,052 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:30:08,096 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:30:08.096695",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:30:08,116 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:30:08,116 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:30:08,126 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:30:08,126 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:30:25,419 - DEBUG - [protocol.py:599] - < PING e9 a3 6a 37 [binary, 4 bytes]
2025-02-07 14:30:25,419 - DEBUG - [protocol.py:745] - > PONG e9 a3 6a 37 [binary, 4 bytes]
2025-02-07 14:30:25,419 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:30:25,419 - DEBUG - [protocol.py:745] - > PING bb 99 20 c5 [binary, 4 bytes]
2025-02-07 14:30:25,436 - DEBUG - [protocol.py:599] - < PONG bb 99 20 c5 [binary, 4 bytes]
2025-02-07 14:30:25,436 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:30:45,429 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:30:45,431 - DEBUG - [protocol.py:745] - > PING e5 72 94 c1 [binary, 4 bytes]
2025-02-07 14:30:45,434 - DEBUG - [protocol.py:599] - < PONG e5 72 94 c1 [binary, 4 bytes]
2025-02-07 14:30:45,434 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:30:45,434 - DEBUG - [protocol.py:599] - < PING 16 36 3e 95 [binary, 4 bytes]
2025-02-07 14:30:45,446 - DEBUG - [protocol.py:745] - > PONG 16 36 3e 95 [binary, 4 bytes]
2025-02-07 14:31:05,440 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:31:05,441 - DEBUG - [protocol.py:745] - > PING 11 9f 88 a6 [binary, 4 bytes]
2025-02-07 14:31:05,446 - DEBUG - [protocol.py:599] - < PONG 11 9f 88 a6 [binary, 4 bytes]
2025-02-07 14:31:05,446 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:31:05,455 - DEBUG - [protocol.py:599] - < PING 9b db c3 ca [binary, 4 bytes]
2025-02-07 14:31:05,457 - DEBUG - [protocol.py:745] - > PONG 9b db c3 ca [binary, 4 bytes]
2025-02-07 14:31:25,433 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:31:25,435 - DEBUG - [protocol.py:745] - > PING 09 c2 2b b9 [binary, 4 bytes]
2025-02-07 14:31:25,444 - DEBUG - [protocol.py:599] - < PONG 09 c2 2b b9 [binary, 4 bytes]
2025-02-07 14:31:25,447 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:31:25,466 - DEBUG - [protocol.py:599] - < PING a0 38 f2 38 [binary, 4 bytes]
2025-02-07 14:31:25,469 - DEBUG - [protocol.py:745] - > PONG a0 38 f2 38 [binary, 4 bytes]
2025-02-07 14:31:45,453 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:31:45,454 - DEBUG - [protocol.py:745] - > PING 1d d2 15 ba [binary, 4 bytes]
2025-02-07 14:31:45,460 - DEBUG - [protocol.py:599] - < PONG 1d d2 15 ba [binary, 4 bytes]
2025-02-07 14:31:45,460 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:31:45,477 - DEBUG - [protocol.py:599] - < PING 1a 70 09 fe [binary, 4 bytes]
2025-02-07 14:31:45,478 - DEBUG - [protocol.py:745] - > PONG 1a 70 09 fe [binary, 4 bytes]
2025-02-07 14:32:05,457 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:32:05,457 - DEBUG - [protocol.py:745] - > PING 1d 05 12 e8 [binary, 4 bytes]
2025-02-07 14:32:05,464 - DEBUG - [protocol.py:599] - < PONG 1d 05 12 e8 [binary, 4 bytes]
2025-02-07 14:32:05,465 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:32:05,487 - DEBUG - [protocol.py:599] - < PING db cb af 68 [binary, 4 bytes]
2025-02-07 14:32:05,488 - DEBUG - [protocol.py:745] - > PONG db cb af 68 [binary, 4 bytes]
2025-02-07 14:32:25,468 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:32:25,470 - DEBUG - [protocol.py:745] - > PING 93 ee 95 ee [binary, 4 bytes]
2025-02-07 14:32:25,479 - DEBUG - [protocol.py:599] - < PONG 93 ee 95 ee [binary, 4 bytes]
2025-02-07 14:32:25,481 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:32:25,494 - DEBUG - [protocol.py:599] - < PING '`ؽ ' [text, 4 bytes]
2025-02-07 14:32:25,495 - DEBUG - [protocol.py:745] - > PONG '`ؽ ' [text, 4 bytes]
2025-02-07 14:32:45,479 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:32:45,483 - DEBUG - [protocol.py:745] - > PING 8f d0 be c5 [binary, 4 bytes]
2025-02-07 14:32:45,489 - DEBUG - [protocol.py:599] - < PONG 8f d0 be c5 [binary, 4 bytes]
2025-02-07 14:32:45,490 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:32:45,503 - DEBUG - [protocol.py:599] - < PING 28 61 7c ee [binary, 4 bytes]
2025-02-07 14:32:45,505 - DEBUG - [protocol.py:745] - > PONG 28 61 7c ee [binary, 4 bytes]
2025-02-07 14:33:05,489 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:33:05,490 - DEBUG - [protocol.py:745] - > PING 54 ce d1 8a [binary, 4 bytes]
2025-02-07 14:33:05,497 - DEBUG - [protocol.py:599] - < PONG 54 ce d1 8a [binary, 4 bytes]
2025-02-07 14:33:05,498 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:33:05,511 - DEBUG - [protocol.py:599] - < PING f8 ab 50 b4 [binary, 4 bytes]
2025-02-07 14:33:05,511 - DEBUG - [protocol.py:745] - > PONG f8 ab 50 b4 [binary, 4 bytes]
2025-02-07 14:33:25,504 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:33:25,506 - DEBUG - [protocol.py:745] - > PING c9 24 e1 8c [binary, 4 bytes]
2025-02-07 14:33:25,511 - DEBUG - [protocol.py:599] - < PONG c9 24 e1 8c [binary, 4 bytes]
2025-02-07 14:33:25,513 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:33:25,516 - DEBUG - [protocol.py:599] - < PING a5 4f 14 ce [binary, 4 bytes]
2025-02-07 14:33:25,518 - DEBUG - [protocol.py:745] - > PONG a5 4f 14 ce [binary, 4 bytes]
2025-02-07 14:33:45,508 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:33:45,508 - DEBUG - [protocol.py:745] - > PING 30 ce fe 65 [binary, 4 bytes]
2025-02-07 14:33:45,518 - DEBUG - [protocol.py:599] - < PONG 30 ce fe 65 [binary, 4 bytes]
2025-02-07 14:33:45,518 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:33:45,523 - DEBUG - [protocol.py:599] - < PING 'QRbw' [text, 4 bytes]
2025-02-07 14:33:45,525 - DEBUG - [protocol.py:745] - > PONG 'QRbw' [text, 4 bytes]
2025-02-07 14:34:05,524 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:34:05,527 - DEBUG - [protocol.py:745] - > PING '\n?sq' [text, 4 bytes]
2025-02-07 14:34:05,535 - DEBUG - [protocol.py:599] - < PONG '\n?sq' [text, 4 bytes]
2025-02-07 14:34:05,537 - DEBUG - [protocol.py:599] - < PING c5 b5 81 3d [binary, 4 bytes]
2025-02-07 14:34:05,538 - DEBUG - [protocol.py:745] - > PONG c5 b5 81 3d [binary, 4 bytes]
2025-02-07 14:34:05,541 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:34:25,535 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:34:25,538 - DEBUG - [protocol.py:745] - > PING ed e2 59 d4 [binary, 4 bytes]
2025-02-07 14:34:25,538 - DEBUG - [protocol.py:599] - < PONG ed e2 59 d4 [binary, 4 bytes]
2025-02-07 14:34:25,538 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:34:25,538 - DEBUG - [protocol.py:599] - < PING 4c 7c fc 10 [binary, 4 bytes]
2025-02-07 14:34:25,551 - DEBUG - [protocol.py:745] - > PONG 4c 7c fc 10 [binary, 4 bytes]
2025-02-07 14:34:45,541 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:34:45,543 - DEBUG - [protocol.py:745] - > PING 96 00 16 56 [binary, 4 bytes]
2025-02-07 14:34:45,551 - DEBUG - [protocol.py:599] - < PONG 96 00 16 56 [binary, 4 bytes]
2025-02-07 14:34:45,553 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:34:45,560 - DEBUG - [protocol.py:599] - < PING 1e 3b 1d ad [binary, 4 bytes]
2025-02-07 14:34:45,562 - DEBUG - [protocol.py:745] - > PONG 1e 3b 1d ad [binary, 4 bytes]
2025-02-07 14:35:05,557 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:35:05,557 - DEBUG - [protocol.py:745] - > PING fa fc dd 3e [binary, 4 bytes]
2025-02-07 14:35:05,560 - DEBUG - [protocol.py:599] - < PONG fa fc dd 3e [binary, 4 bytes]
2025-02-07 14:35:05,560 - DEBUG - [protocol.py:599] - < PING a8 a3 b0 29 [binary, 4 bytes]
2025-02-07 14:35:05,573 - DEBUG - [protocol.py:745] - > PONG a8 a3 b0 29 [binary, 4 bytes]
2025-02-07 14:35:05,575 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:35:09,268 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:35:09,268 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:35:09,280 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:35:09,282 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:35:09,334 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:35:09,334 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:35:09,338 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:35:09,338 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:35:09,342 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:35:09,342 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:35:09,693 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:35:09,693 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:35:09,693 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:35:09,693 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:35:09,696 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:35:09,696 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:35:09,993 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:35:09,993 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:10,188 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:10,410 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:10,410 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:10,664 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:10,664 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:10,887 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:10,887 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:11,094 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:11,094 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:35:11,094 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:35:11,094 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:35:11,301 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:35:11,301 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:35:11,301 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:35:11,301 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:35:11.301341",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:35:11,301 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:35:11,301 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:35:11,301 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:35:11,301 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:35:11,381 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:35:11.381550",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:35:11,414 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:35:11,414 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:35:11,414 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:35:11,414 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:35:25,563 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:35:25,563 - DEBUG - [protocol.py:745] - > PING 6c 5c a5 2d [binary, 4 bytes]
2025-02-07 14:35:25,567 - DEBUG - [protocol.py:599] - < PONG 6c 5c a5 2d [binary, 4 bytes]
2025-02-07 14:35:25,567 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:35:25,581 - DEBUG - [protocol.py:599] - < PING '\x02魷' [text, 4 bytes]
2025-02-07 14:35:25,585 - DEBUG - [protocol.py:745] - > PONG '\x02魷' [text, 4 bytes]
2025-02-07 14:35:45,567 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:35:45,568 - DEBUG - [protocol.py:745] - > PING '獟f' [text, 4 bytes]
2025-02-07 14:35:45,574 - DEBUG - [protocol.py:599] - < PONG '獟f' [text, 4 bytes]
2025-02-07 14:35:45,576 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:35:45,592 - DEBUG - [protocol.py:599] - < PING c1 6a 7d 93 [binary, 4 bytes]
2025-02-07 14:35:45,593 - DEBUG - [protocol.py:745] - > PONG c1 6a 7d 93 [binary, 4 bytes]
2025-02-07 14:36:05,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:36:05,595 - DEBUG - [protocol.py:745] - > PING b0 a6 d0 64 [binary, 4 bytes]
2025-02-07 14:36:05,601 - DEBUG - [protocol.py:599] - < PING 07 4b b9 5d [binary, 4 bytes]
2025-02-07 14:36:05,603 - DEBUG - [protocol.py:745] - > PONG 07 4b b9 5d [binary, 4 bytes]
2025-02-07 14:36:05,605 - DEBUG - [protocol.py:599] - < PONG b0 a6 d0 64 [binary, 4 bytes]
2025-02-07 14:36:05,607 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:36:25,606 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:36:25,606 - DEBUG - [protocol.py:745] - > PING d5 ea 36 2f [binary, 4 bytes]
2025-02-07 14:36:25,609 - DEBUG - [protocol.py:599] - < PING 'K౨' [text, 4 bytes]
2025-02-07 14:36:25,613 - DEBUG - [protocol.py:745] - > PONG 'K౨' [text, 4 bytes]
2025-02-07 14:36:25,615 - DEBUG - [protocol.py:599] - < PONG d5 ea 36 2f [binary, 4 bytes]
2025-02-07 14:36:25,616 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:36:45,605 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:36:45,606 - DEBUG - [protocol.py:745] - > PING 5c d3 ec 84 [binary, 4 bytes]
2025-02-07 14:36:45,612 - DEBUG - [protocol.py:599] - < PONG 5c d3 ec 84 [binary, 4 bytes]
2025-02-07 14:36:45,613 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:36:45,621 - DEBUG - [protocol.py:599] - < PING 36 21 70 f7 [binary, 4 bytes]
2025-02-07 14:36:45,622 - DEBUG - [protocol.py:745] - > PONG 36 21 70 f7 [binary, 4 bytes]
2025-02-07 14:37:05,612 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:37:05,614 - DEBUG - [protocol.py:745] - > PING 9e e0 cc 61 [binary, 4 bytes]
2025-02-07 14:37:05,622 - DEBUG - [protocol.py:599] - < PONG 9e e0 cc 61 [binary, 4 bytes]
2025-02-07 14:37:05,624 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:37:05,629 - DEBUG - [protocol.py:599] - < PING 9a ef 88 cb [binary, 4 bytes]
2025-02-07 14:37:05,631 - DEBUG - [protocol.py:745] - > PONG 9a ef 88 cb [binary, 4 bytes]
2025-02-07 14:37:25,622 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:37:25,625 - DEBUG - [protocol.py:745] - > PING aa 44 74 d8 [binary, 4 bytes]
2025-02-07 14:37:25,632 - DEBUG - [protocol.py:599] - < PONG aa 44 74 d8 [binary, 4 bytes]
2025-02-07 14:37:25,634 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:37:25,638 - DEBUG - [protocol.py:599] - < PING df a1 86 6b [binary, 4 bytes]
2025-02-07 14:37:25,640 - DEBUG - [protocol.py:745] - > PONG df a1 86 6b [binary, 4 bytes]
2025-02-07 14:37:45,636 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:37:45,637 - DEBUG - [protocol.py:745] - > PING 6c b7 c6 da [binary, 4 bytes]
2025-02-07 14:37:45,644 - DEBUG - [protocol.py:599] - < PONG 6c b7 c6 da [binary, 4 bytes]
2025-02-07 14:37:45,645 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:37:45,646 - DEBUG - [protocol.py:599] - < PING bf 9c 16 b9 [binary, 4 bytes]
2025-02-07 14:37:45,647 - DEBUG - [protocol.py:745] - > PONG bf 9c 16 b9 [binary, 4 bytes]
2025-02-07 14:38:05,648 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:38:05,650 - DEBUG - [protocol.py:745] - > PING fc d0 59 e8 [binary, 4 bytes]
2025-02-07 14:38:05,655 - DEBUG - [protocol.py:599] - < PING b7 16 bd 27 [binary, 4 bytes]
2025-02-07 14:38:05,656 - DEBUG - [protocol.py:745] - > PONG b7 16 bd 27 [binary, 4 bytes]
2025-02-07 14:38:05,660 - DEBUG - [protocol.py:599] - < PONG fc d0 59 e8 [binary, 4 bytes]
2025-02-07 14:38:05,661 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:38:25,651 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:38:25,652 - DEBUG - [protocol.py:745] - > PING b3 ab 93 33 [binary, 4 bytes]
2025-02-07 14:38:25,659 - DEBUG - [protocol.py:599] - < PONG b3 ab 93 33 [binary, 4 bytes]
2025-02-07 14:38:25,660 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:38:25,664 - DEBUG - [protocol.py:599] - < PING d6 81 f6 79 [binary, 4 bytes]
2025-02-07 14:38:25,664 - DEBUG - [protocol.py:745] - > PONG d6 81 f6 79 [binary, 4 bytes]
2025-02-07 14:38:45,651 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:38:45,653 - DEBUG - [protocol.py:745] - > PING 0a 63 ef e5 [binary, 4 bytes]
2025-02-07 14:38:45,661 - DEBUG - [protocol.py:599] - < PONG 0a 63 ef e5 [binary, 4 bytes]
2025-02-07 14:38:45,663 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:38:45,672 - DEBUG - [protocol.py:599] - < PING 25 53 71 f9 [binary, 4 bytes]
2025-02-07 14:38:45,673 - DEBUG - [protocol.py:745] - > PONG 25 53 71 f9 [binary, 4 bytes]
2025-02-07 14:39:05,672 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:39:05,673 - DEBUG - [protocol.py:745] - > PING 6d 20 91 84 [binary, 4 bytes]
2025-02-07 14:39:05,678 - DEBUG - [protocol.py:599] - < PING b6 00 7f 71 [binary, 4 bytes]
2025-02-07 14:39:05,679 - DEBUG - [protocol.py:745] - > PONG b6 00 7f 71 [binary, 4 bytes]
2025-02-07 14:39:05,680 - DEBUG - [protocol.py:599] - < PONG 6d 20 91 84 [binary, 4 bytes]
2025-02-07 14:39:05,681 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:39:25,667 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:39:25,668 - DEBUG - [protocol.py:745] - > PING de bc ef df [binary, 4 bytes]
2025-02-07 14:39:25,674 - DEBUG - [protocol.py:599] - < PONG de bc ef df [binary, 4 bytes]
2025-02-07 14:39:25,675 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:39:25,687 - DEBUG - [protocol.py:599] - < PING 33 32 7c de [binary, 4 bytes]
2025-02-07 14:39:25,687 - DEBUG - [protocol.py:745] - > PONG 33 32 7c de [binary, 4 bytes]
2025-02-07 14:39:45,681 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:39:45,684 - DEBUG - [protocol.py:745] - > PING 8b 29 3c bc [binary, 4 bytes]
2025-02-07 14:39:45,699 - DEBUG - [protocol.py:599] - < PONG 8b 29 3c bc [binary, 4 bytes]
2025-02-07 14:39:45,700 - DEBUG - [protocol.py:599] - < PING 1a 92 3d f1 [binary, 4 bytes]
2025-02-07 14:39:45,702 - DEBUG - [protocol.py:745] - > PONG 1a 92 3d f1 [binary, 4 bytes]
2025-02-07 14:39:45,704 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:40:05,692 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:40:05,695 - DEBUG - [protocol.py:745] - > PING 22 11 9a 39 [binary, 4 bytes]
2025-02-07 14:40:05,702 - DEBUG - [protocol.py:599] - < PONG 22 11 9a 39 [binary, 4 bytes]
2025-02-07 14:40:05,703 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:40:05,710 - DEBUG - [protocol.py:599] - < PING 07 28 fc 7e [binary, 4 bytes]
2025-02-07 14:40:05,711 - DEBUG - [protocol.py:745] - > PONG 07 28 fc 7e [binary, 4 bytes]
2025-02-07 14:40:12,534 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:40:12,535 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:40:12,536 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:40:12,537 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:40:12,574 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:40:12,574 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:40:12,575 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:40:12,576 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:40:12,576 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:40:12,577 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:40:12,874 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:40:12,875 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:40:12,875 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:40:12,875 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:40:12,876 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:40:12,876 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:40:13,105 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:40:13,106 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:13,328 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:13,329 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:40:13,329 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:40:13,330 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:40:13,330 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:40:13,331 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:13,608 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:13,608 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:13,830 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:13,830 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:14,054 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:14,054 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:14,312 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:14,313 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:40:14,313 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:40:14,314 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:40:14,531 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:40:14,531 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:40:14,532 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:40:14,532 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:40:14.532763",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:40:14,533 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:40:14,533 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:40:14,534 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:40:14,534 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:40:14,569 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:40:14,570 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:40:14,570 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:40:14,571 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:40:14,572 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:40:14,572 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:40:14,572 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:40:14.571186",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:40:14,605 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:40:14,605 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:40:14,605 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:40:14,606 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:40:25,708 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:40:25,709 - DEBUG - [protocol.py:745] - > PING e9 e4 af 23 [binary, 4 bytes]
2025-02-07 14:40:25,716 - DEBUG - [protocol.py:599] - < PONG e9 e4 af 23 [binary, 4 bytes]
2025-02-07 14:40:25,717 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:40:25,719 - DEBUG - [protocol.py:599] - < PING 8a 45 b9 12 [binary, 4 bytes]
2025-02-07 14:40:25,719 - DEBUG - [protocol.py:745] - > PONG 8a 45 b9 12 [binary, 4 bytes]
2025-02-07 14:40:45,726 - DEBUG - [protocol.py:599] - < PING 90 61 a3 a6 [binary, 4 bytes]
2025-02-07 14:40:45,727 - DEBUG - [protocol.py:745] - > PONG 90 61 a3 a6 [binary, 4 bytes]
2025-02-07 14:40:45,730 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:40:45,731 - DEBUG - [protocol.py:745] - > PING 66 f2 b1 3b [binary, 4 bytes]
2025-02-07 14:40:45,737 - DEBUG - [protocol.py:599] - < PONG 66 f2 b1 3b [binary, 4 bytes]
2025-02-07 14:40:45,739 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:41:05,728 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:41:05,729 - DEBUG - [protocol.py:745] - > PING 7f 4b a7 7d [binary, 4 bytes]
2025-02-07 14:41:05,735 - DEBUG - [protocol.py:599] - < PONG 7f 4b a7 7d [binary, 4 bytes]
2025-02-07 14:41:05,735 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:41:05,735 - DEBUG - [protocol.py:599] - < PING eb 2b fb 57 [binary, 4 bytes]
2025-02-07 14:41:05,735 - DEBUG - [protocol.py:745] - > PONG eb 2b fb 57 [binary, 4 bytes]
2025-02-07 14:41:25,743 - DEBUG - [protocol.py:599] - < PING 93 5e fd 7d [binary, 4 bytes]
2025-02-07 14:41:25,745 - DEBUG - [protocol.py:745] - > PONG 93 5e fd 7d [binary, 4 bytes]
2025-02-07 14:41:25,747 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:41:25,748 - DEBUG - [protocol.py:745] - > PING ce a2 7a d4 [binary, 4 bytes]
2025-02-07 14:41:25,756 - DEBUG - [protocol.py:599] - < PONG ce a2 7a d4 [binary, 4 bytes]
2025-02-07 14:41:25,758 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:41:45,751 - DEBUG - [protocol.py:599] - < PING 2d 96 0c 17 [binary, 4 bytes]
2025-02-07 14:41:45,752 - DEBUG - [protocol.py:745] - > PONG 2d 96 0c 17 [binary, 4 bytes]
2025-02-07 14:41:45,753 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:41:45,753 - DEBUG - [protocol.py:745] - > PING 73 c1 f7 9d [binary, 4 bytes]
2025-02-07 14:41:45,757 - DEBUG - [protocol.py:599] - < PONG 73 c1 f7 9d [binary, 4 bytes]
2025-02-07 14:41:45,759 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:42:05,760 - DEBUG - [protocol.py:599] - < PING d9 59 61 91 [binary, 4 bytes]
2025-02-07 14:42:05,761 - DEBUG - [protocol.py:745] - > PONG d9 59 61 91 [binary, 4 bytes]
2025-02-07 14:42:05,763 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:42:05,765 - DEBUG - [protocol.py:745] - > PING 31 82 60 56 [binary, 4 bytes]
2025-02-07 14:42:05,772 - DEBUG - [protocol.py:599] - < PONG 31 82 60 56 [binary, 4 bytes]
2025-02-07 14:42:05,774 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:42:25,770 - DEBUG - [protocol.py:599] - < PING b2 d2 27 15 [binary, 4 bytes]
2025-02-07 14:42:25,772 - DEBUG - [protocol.py:745] - > PONG b2 d2 27 15 [binary, 4 bytes]
2025-02-07 14:42:25,774 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:42:25,776 - DEBUG - [protocol.py:745] - > PING f1 0f 8a a0 [binary, 4 bytes]
2025-02-07 14:42:25,784 - DEBUG - [protocol.py:599] - < PONG f1 0f 8a a0 [binary, 4 bytes]
2025-02-07 14:42:25,786 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:42:45,775 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:42:45,776 - DEBUG - [protocol.py:745] - > PING 61 da bf cf [binary, 4 bytes]
2025-02-07 14:42:45,781 - DEBUG - [protocol.py:599] - < PING 81 1a 1f 00 [binary, 4 bytes]
2025-02-07 14:42:45,783 - DEBUG - [protocol.py:745] - > PONG 81 1a 1f 00 [binary, 4 bytes]
2025-02-07 14:42:45,786 - DEBUG - [protocol.py:599] - < PONG 61 da bf cf [binary, 4 bytes]
2025-02-07 14:42:45,788 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:43:05,778 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:43:05,779 - DEBUG - [protocol.py:745] - > PING '#G˦' [text, 4 bytes]
2025-02-07 14:43:05,786 - DEBUG - [protocol.py:599] - < PONG '#G˦' [text, 4 bytes]
2025-02-07 14:43:05,787 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:43:05,792 - DEBUG - [protocol.py:599] - < PING ce 6b 1f 87 [binary, 4 bytes]
2025-02-07 14:43:05,793 - DEBUG - [protocol.py:745] - > PONG ce 6b 1f 87 [binary, 4 bytes]
2025-02-07 14:43:25,785 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:43:25,785 - DEBUG - [protocol.py:745] - > PING da d7 ba 08 [binary, 4 bytes]
2025-02-07 14:43:25,785 - DEBUG - [protocol.py:599] - < PONG da d7 ba 08 [binary, 4 bytes]
2025-02-07 14:43:25,785 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:43:25,801 - DEBUG - [protocol.py:599] - < PING 35 91 6d 26 [binary, 4 bytes]
2025-02-07 14:43:25,802 - DEBUG - [protocol.py:745] - > PONG 35 91 6d 26 [binary, 4 bytes]
2025-02-07 14:43:40,101 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:43:40,101 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:43:40,110 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:43:40,110 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:43:40,113 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:43:40,114 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:43:40,114 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:43:47,784 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:43:47,784 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:43:47,784 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:43:47,816 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:43:47,816 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:43:47,827 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:43:47,827 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:43:47,827 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:43:47,828 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: w3sasLisE9PppB4yrz/XLg==
2025-02-07 14:43:47,828 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:43:47,828 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:43:47,829 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:43:47,848 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:43:47,848 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:43:47,848 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:43:47,848 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: SLpuefphZ/hbuk1p3wCGmOphdjE=
2025-02-07 14:43:47,848 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:43:47,849 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:43:46 GMT
2025-02-07 14:43:47,849 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:43:47,849 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:43:47,850 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:43:48,925 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:43:48,925 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:43:48,925 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:43:48,925 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:43:48,961 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:43:48,961 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:43:48,962 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:43:48,962 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:43:48,964 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:43:48,964 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:43:49,137 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:43:49,143 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:43:49,147 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:43:49,147 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:43:49,173 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:43:49,173 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:43:49,173 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:43:49,175 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:43:49,175 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:43:49,177 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:43:49,447 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:43:49,447 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:49,658 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:49,658 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:43:49,658 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:43:49,658 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:43:49,658 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:43:49,660 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:49,919 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:49,919 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:50,094 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:50,094 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:50,317 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:50,317 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:50,476 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:50,476 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:43:50,476 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:43:50,476 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:43:50,611 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:43:50,611 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:43:50,611 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:43:50,611 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:43:50.611152",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:43:50,622 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:43:50,622 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:43:50,622 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:43:50,624 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:43:50,648 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:43:50.648455",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:43:50,679 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:43:50,680 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:43:50,680 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:43:50,681 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:44:07,846 - DEBUG - [protocol.py:599] - < PING e8 68 af 06 [binary, 4 bytes]
2025-02-07 14:44:07,848 - DEBUG - [protocol.py:745] - > PONG e8 68 af 06 [binary, 4 bytes]
2025-02-07 14:44:07,849 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:44:07,849 - DEBUG - [protocol.py:745] - > PING 10 29 eb 1f [binary, 4 bytes]
2025-02-07 14:44:07,855 - DEBUG - [protocol.py:599] - < PONG 10 29 eb 1f [binary, 4 bytes]
2025-02-07 14:44:07,857 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:44:27,852 - DEBUG - [protocol.py:599] - < PING bf b3 ee af [binary, 4 bytes]
2025-02-07 14:44:27,852 - DEBUG - [protocol.py:745] - > PONG bf b3 ee af [binary, 4 bytes]
2025-02-07 14:44:27,852 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:44:27,852 - DEBUG - [protocol.py:745] - > PING ac 4b 19 b7 [binary, 4 bytes]
2025-02-07 14:44:27,852 - DEBUG - [protocol.py:599] - < PONG ac 4b 19 b7 [binary, 4 bytes]
2025-02-07 14:44:27,852 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:44:47,857 - DEBUG - [protocol.py:599] - < PING '(*9\x06' [text, 4 bytes]
2025-02-07 14:44:47,860 - DEBUG - [protocol.py:745] - > PONG '(*9\x06' [text, 4 bytes]
2025-02-07 14:44:47,890 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:44:47,892 - DEBUG - [protocol.py:745] - > PING f9 e8 71 de [binary, 4 bytes]
2025-02-07 14:44:47,892 - DEBUG - [protocol.py:599] - < PONG f9 e8 71 de [binary, 4 bytes]
2025-02-07 14:44:47,901 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:44:49,921 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:44:49,921 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:44:49,921 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:44:49,921 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:44:49,933 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:44:49,936 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:44:49,942 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:45:18,684 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:45:18,685 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:45:18,688 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:45:18,688 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:45:18,688 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:45:18,688 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:45:18,721 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:45:18,722 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:45:18,722 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:45:18,723 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:45:18,723 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:45:18,723 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: i38PpzLI1PilS7mL9jr6eg==
2025-02-07 14:45:18,724 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:45:18,724 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:45:18,724 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:45:18,905 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:45:18,905 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:45:18,906 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:45:18,906 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: pS6ishYSTQvyMiQ0sEK4aAID8Ao=
2025-02-07 14:45:18,907 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:45:18,908 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:45:17 GMT
2025-02-07 14:45:18,909 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:45:18,910 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:45:18,910 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:45:20,077 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:45:20,078 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:45:20,078 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:45:20,078 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:45:20,108 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:45:20,108 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:45:20,109 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:45:20,110 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:45:20,111 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:45:20,111 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:45:20,299 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:45:20,299 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:45:20,299 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:45:20,300 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:45:20,331 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:45:20,332 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:45:20,332 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:45:20,333 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:45:20,334 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:45:20,334 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:45:20,506 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:45:20,507 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:20,704 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:20,704 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:45:20,704 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:45:20,705 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:45:20,705 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:45:20,706 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:20,865 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:20,866 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:21,028 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:21,029 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:21,229 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:21,229 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:21,392 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:21,392 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:45:21,392 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:45:21,393 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:45:21,548 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:45:21,549 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:45:21,549 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:45:21,549 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:45:21.549589",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:45:21,551 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:45:21,551 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:45:21,551 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:45:21,552 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:45:21,579 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:45:21,580 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:45:21,580 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:45:21,581 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:45:21,582 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:45:21,582 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:45:21,582 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:45:21.581576",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:45:21,607 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:45:21,607 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:45:21,608 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:45:21,608 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:45:38,885 - DEBUG - [protocol.py:599] - < PING 2e 70 c2 29 [binary, 4 bytes]
2025-02-07 14:45:38,887 - DEBUG - [protocol.py:745] - > PONG 2e 70 c2 29 [binary, 4 bytes]
2025-02-07 14:45:38,932 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:45:38,933 - DEBUG - [protocol.py:745] - > PING fb 57 99 f6 [binary, 4 bytes]
2025-02-07 14:45:38,939 - DEBUG - [protocol.py:599] - < PONG fb 57 99 f6 [binary, 4 bytes]
2025-02-07 14:45:38,940 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:45:58,897 - DEBUG - [protocol.py:599] - < PING 78 53 f0 ae [binary, 4 bytes]
2025-02-07 14:45:58,899 - DEBUG - [protocol.py:745] - > PONG 78 53 f0 ae [binary, 4 bytes]
2025-02-07 14:45:58,938 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:45:58,944 - DEBUG - [protocol.py:745] - > PING 51 4d b7 fa [binary, 4 bytes]
2025-02-07 14:45:58,952 - DEBUG - [protocol.py:599] - < PONG 51 4d b7 fa [binary, 4 bytes]
2025-02-07 14:45:58,954 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:46:18,904 - DEBUG - [protocol.py:599] - < PING '9\x07w\x13' [text, 4 bytes]
2025-02-07 14:46:18,905 - DEBUG - [protocol.py:745] - > PONG '9\x07w\x13' [text, 4 bytes]
2025-02-07 14:46:18,961 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:46:18,961 - DEBUG - [protocol.py:745] - > PING 8a 7e 55 c8 [binary, 4 bytes]
2025-02-07 14:46:18,964 - DEBUG - [protocol.py:599] - < PONG 8a 7e 55 c8 [binary, 4 bytes]
2025-02-07 14:46:18,965 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:46:38,911 - DEBUG - [protocol.py:599] - < PING 9e 7c b8 37 [binary, 4 bytes]
2025-02-07 14:46:38,914 - DEBUG - [protocol.py:745] - > PONG 9e 7c b8 37 [binary, 4 bytes]
2025-02-07 14:46:38,975 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:46:38,976 - DEBUG - [protocol.py:745] - > PING c3 f8 90 85 [binary, 4 bytes]
2025-02-07 14:46:38,984 - DEBUG - [protocol.py:599] - < PONG c3 f8 90 85 [binary, 4 bytes]
2025-02-07 14:46:38,985 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:46:58,915 - DEBUG - [protocol.py:599] - < PING a6 e8 d7 a1 [binary, 4 bytes]
2025-02-07 14:46:58,915 - DEBUG - [protocol.py:745] - > PONG a6 e8 d7 a1 [binary, 4 bytes]
2025-02-07 14:46:58,981 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:46:58,985 - DEBUG - [protocol.py:745] - > PING 54 2d e4 cf [binary, 4 bytes]
2025-02-07 14:46:58,987 - DEBUG - [protocol.py:599] - < PONG 54 2d e4 cf [binary, 4 bytes]
2025-02-07 14:46:58,987 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:47:18,931 - DEBUG - [protocol.py:599] - < PING 90 5f a6 0f [binary, 4 bytes]
2025-02-07 14:47:18,933 - DEBUG - [protocol.py:745] - > PONG 90 5f a6 0f [binary, 4 bytes]
2025-02-07 14:47:19,014 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:47:19,017 - DEBUG - [protocol.py:745] - > PING d5 87 04 86 [binary, 4 bytes]
2025-02-07 14:47:19,026 - DEBUG - [protocol.py:599] - < PONG d5 87 04 86 [binary, 4 bytes]
2025-02-07 14:47:19,034 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:47:38,941 - DEBUG - [protocol.py:599] - < PING e5 bf 5f 00 [binary, 4 bytes]
2025-02-07 14:47:38,943 - DEBUG - [protocol.py:745] - > PONG e5 bf 5f 00 [binary, 4 bytes]
2025-02-07 14:47:39,027 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:47:39,029 - DEBUG - [protocol.py:745] - > PING c7 cd 1e 28 [binary, 4 bytes]
2025-02-07 14:47:39,035 - DEBUG - [protocol.py:599] - < PONG c7 cd 1e 28 [binary, 4 bytes]
2025-02-07 14:47:39,037 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:47:58,950 - DEBUG - [protocol.py:599] - < PING d4 3e 69 70 [binary, 4 bytes]
2025-02-07 14:47:58,951 - DEBUG - [protocol.py:745] - > PONG d4 3e 69 70 [binary, 4 bytes]
2025-02-07 14:47:59,045 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:47:59,046 - DEBUG - [protocol.py:745] - > PING b4 67 88 a7 [binary, 4 bytes]
2025-02-07 14:47:59,053 - DEBUG - [protocol.py:599] - < PONG b4 67 88 a7 [binary, 4 bytes]
2025-02-07 14:47:59,055 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:48:18,959 - DEBUG - [protocol.py:599] - < PING 50 e9 9b 2e [binary, 4 bytes]
2025-02-07 14:48:18,959 - DEBUG - [protocol.py:745] - > PONG 50 e9 9b 2e [binary, 4 bytes]
2025-02-07 14:48:19,039 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:48:19,044 - DEBUG - [protocol.py:745] - > PING 'L{A\x03' [text, 4 bytes]
2025-02-07 14:48:19,044 - DEBUG - [protocol.py:599] - < PONG 'L{A\x03' [text, 4 bytes]
2025-02-07 14:48:19,044 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:48:38,969 - DEBUG - [protocol.py:599] - < PING d3 9a d3 70 [binary, 4 bytes]
2025-02-07 14:48:38,969 - DEBUG - [protocol.py:745] - > PONG d3 9a d3 70 [binary, 4 bytes]
2025-02-07 14:48:39,026 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:48:39,028 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:48:39,028 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 14:48:55,299 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:48:55,301 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:48:55,303 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:48:55,335 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:48:55,338 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:48:55,339 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:48:55,341 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:48:55,341 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:48:55,342 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 6rqNU191LO2/TKPPnXU3nA==
2025-02-07 14:48:55,343 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:48:55,344 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:48:55,345 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:48:55,495 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:48:55,497 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:48:55,498 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:48:55,499 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: rzWqA3+hrZIFq0+GngEsa5hXg7w=
2025-02-07 14:48:55,500 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:48:55,503 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:48:53 GMT
2025-02-07 14:48:55,504 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:48:55,506 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:48:55,507 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:48:56,638 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:48:56,640 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:48:56,642 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:48:56,643 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:48:56,731 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:48:56,731 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:48:56,732 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:48:56,733 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:48:56,733 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:48:56,733 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:48:56,967 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:48:56,967 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:48:56,967 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:48:56,967 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:48:56,999 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:48:56,999 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:48:57,000 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:48:57,000 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:48:57,001 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:48:57,001 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:48:57,174 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:48:57,175 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:57,361 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:57,361 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:48:57,362 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:48:57,363 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:48:57,363 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:48:57,364 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:57,515 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:57,516 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:57,664 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:57,664 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:57,851 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:57,851 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:58,005 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:58,005 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:48:58,005 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:48:58,005 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:48:58,160 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:48:58,160 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:48:58,161 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:48:58,161 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:48:58.161383",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:48:58,162 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:48:58,162 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:48:58,162 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:48:58,162 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:48:58,198 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:48:58,200 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:48:58,200 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:48:58,201 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:48:58,201 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:48:58,202 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:48:58,202 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:48:58.201296",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:48:58,232 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:48:58,233 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:48:58,233 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:48:58,234 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:49:15,495 - DEBUG - [protocol.py:599] - < PING c5 c4 cd bf [binary, 4 bytes]
2025-02-07 14:49:15,497 - DEBUG - [protocol.py:745] - > PONG c5 c4 cd bf [binary, 4 bytes]
2025-02-07 14:49:15,520 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:49:15,521 - DEBUG - [protocol.py:745] - > PING f6 74 17 c9 [binary, 4 bytes]
2025-02-07 14:49:15,529 - DEBUG - [protocol.py:599] - < PONG f6 74 17 c9 [binary, 4 bytes]
2025-02-07 14:49:15,530 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:49:35,507 - DEBUG - [protocol.py:599] - < PING 18 c7 f2 ad [binary, 4 bytes]
2025-02-07 14:49:35,509 - DEBUG - [protocol.py:745] - > PONG 18 c7 f2 ad [binary, 4 bytes]
2025-02-07 14:49:35,511 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:49:35,513 - DEBUG - [protocol.py:745] - > PING 74 c2 6d f4 [binary, 4 bytes]
2025-02-07 14:49:35,524 - DEBUG - [protocol.py:599] - < PONG 74 c2 6d f4 [binary, 4 bytes]
2025-02-07 14:49:35,525 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:49:55,515 - DEBUG - [protocol.py:599] - < PING 13 b4 bb c3 [binary, 4 bytes]
2025-02-07 14:49:55,516 - DEBUG - [protocol.py:745] - > PONG 13 b4 bb c3 [binary, 4 bytes]
2025-02-07 14:49:55,517 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:49:55,517 - DEBUG - [protocol.py:745] - > PING 30 02 29 a2 [binary, 4 bytes]
2025-02-07 14:49:55,524 - DEBUG - [protocol.py:599] - < PONG 30 02 29 a2 [binary, 4 bytes]
2025-02-07 14:49:55,524 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:50:15,524 - DEBUG - [protocol.py:599] - < PING e3 2f 70 c2 [binary, 4 bytes]
2025-02-07 14:50:15,525 - DEBUG - [protocol.py:745] - > PONG e3 2f 70 c2 [binary, 4 bytes]
2025-02-07 14:50:15,526 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:50:15,526 - DEBUG - [protocol.py:745] - > PING 30 f6 2d ba [binary, 4 bytes]
2025-02-07 14:50:15,532 - DEBUG - [protocol.py:599] - < PONG 30 f6 2d ba [binary, 4 bytes]
2025-02-07 14:50:15,533 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:50:35,532 - DEBUG - [protocol.py:599] - < PING 52 50 e1 eb [binary, 4 bytes]
2025-02-07 14:50:35,534 - DEBUG - [protocol.py:745] - > PONG 52 50 e1 eb [binary, 4 bytes]
2025-02-07 14:50:35,536 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:50:35,538 - DEBUG - [protocol.py:745] - > PING 04 44 88 26 [binary, 4 bytes]
2025-02-07 14:50:35,547 - DEBUG - [protocol.py:599] - < PONG 04 44 88 26 [binary, 4 bytes]
2025-02-07 14:50:35,549 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:50:55,541 - DEBUG - [protocol.py:599] - < PING b6 73 12 2f [binary, 4 bytes]
2025-02-07 14:50:55,543 - DEBUG - [protocol.py:745] - > PONG b6 73 12 2f [binary, 4 bytes]
2025-02-07 14:50:55,545 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:50:55,546 - DEBUG - [protocol.py:745] - > PING 64 04 7a 85 [binary, 4 bytes]
2025-02-07 14:50:55,554 - DEBUG - [protocol.py:599] - < PONG 64 04 7a 85 [binary, 4 bytes]
2025-02-07 14:50:55,558 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:51:15,553 - DEBUG - [protocol.py:599] - < PING 5d 9e 5b cd [binary, 4 bytes]
2025-02-07 14:51:15,554 - DEBUG - [protocol.py:745] - > PONG 5d 9e 5b cd [binary, 4 bytes]
2025-02-07 14:51:15,556 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:51:15,557 - DEBUG - [protocol.py:745] - > PING 3b 3a 8b c1 [binary, 4 bytes]
2025-02-07 14:51:15,565 - DEBUG - [protocol.py:599] - < PONG 3b 3a 8b c1 [binary, 4 bytes]
2025-02-07 14:51:15,566 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:51:35,558 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:51:35,562 - DEBUG - [protocol.py:745] - > PING b2 41 8b fa [binary, 4 bytes]
2025-02-07 14:51:35,564 - DEBUG - [protocol.py:599] - < PING cd fe d7 5a [binary, 4 bytes]
2025-02-07 14:51:35,567 - DEBUG - [protocol.py:745] - > PONG cd fe d7 5a [binary, 4 bytes]
2025-02-07 14:51:35,572 - DEBUG - [protocol.py:599] - < PONG b2 41 8b fa [binary, 4 bytes]
2025-02-07 14:51:35,574 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:51:55,572 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:51:55,572 - DEBUG - [protocol.py:745] - > PING 36 5e c2 15 [binary, 4 bytes]
2025-02-07 14:51:55,572 - DEBUG - [protocol.py:599] - < PING 51 b3 57 a1 [binary, 4 bytes]
2025-02-07 14:51:55,577 - DEBUG - [protocol.py:745] - > PONG 51 b3 57 a1 [binary, 4 bytes]
2025-02-07 14:51:55,582 - DEBUG - [protocol.py:599] - < PONG 36 5e c2 15 [binary, 4 bytes]
2025-02-07 14:51:55,586 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:52:06,281 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:52:06,282 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:52:06,284 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:52:06,285 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:52:06,286 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:52:06,287 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:52:06,287 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:52:06,289 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 14:52:56,299 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:52:56,301 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:52:56,301 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:52:56,301 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:52:56,301 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:52:56,303 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:52:56,334 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:52:56,335 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:52:56,336 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:52:56,336 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:52:56,336 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:52:56,337 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: L/J+f9wyO9XZ7J9fBoxWCw==
2025-02-07 14:52:56,337 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:52:56,337 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:52:56,337 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:52:56,528 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:52:56,530 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:52:56,530 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:52:56,531 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: OL9S9X3SkFf456dPt2AKfDYWzJk=
2025-02-07 14:52:56,531 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:52:56,532 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:52:54 GMT
2025-02-07 14:52:56,533 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:52:56,534 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:52:56,534 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:52:57,685 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:52:57,687 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:52:57,687 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:52:57,689 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:52:57,725 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:52:57,726 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:52:57,727 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:52:57,728 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:52:57,729 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:52:57,729 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:52:57,903 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:52:57,903 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:52:57,904 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:52:57,904 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:52:57,940 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:52:57,941 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:52:57,942 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:52:57,944 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:52:57,945 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:52:57,947 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:52:58,132 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:52:58,132 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,313 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,313 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:52:58,313 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:52:58,314 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:52:58,314 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:52:58,314 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,468 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,469 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,621 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,622 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,807 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,808 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,958 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,958 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:52:58,959 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:52:58,959 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:52:59,112 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:52:59,113 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:52:59,113 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:52:59,114 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:52:59.113256",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:52:59,114 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:52:59,114 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:52:59,115 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:52:59,115 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:52:59,147 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:52:59,147 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:52:59,147 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:52:59,148 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:52:59,148 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:52:59,150 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 14:52:59,150 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T19:52:59.148936",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:52:59,171 - ERROR - [printer_monitor_service.py:492] - Error actualizando datos para 192.168.18.79
2025-02-07 14:52:59,171 - ERROR - [printer_monitor_service.py:493] - Status: 500
2025-02-07 14:52:59,171 - ERROR - [printer_monitor_service.py:494] - Respuesta: {"detail":"PrinterMonitorService.update_printer_data() got an unexpected keyword argument 'agent_id'"}
2025-02-07 14:52:59,172 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:53:09,533 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:53:09,535 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:53:09,536 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:53:09,537 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:53:09,538 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:53:09,539 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:53:09,541 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:53:09,542 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 14:56:06,868 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:56:06,868 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:56:06,871 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:56:06,871 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:56:06,871 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:56:06,905 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:56:06,907 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:56:06,909 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:56:06,909 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:56:06,910 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:56:06,910 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: O8g57aOwf8A5fPbVk5sIVA==
2025-02-07 14:56:06,911 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:56:06,911 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:56:06,912 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:56:07,076 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: qZuNsbgJgV9q4BGzPZ4upgYkktw=
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:56:06 GMT
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:56:07,078 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:56:07,080 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:56:08,271 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:56:08,276 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:56:08,276 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:56:08,278 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:56:08,328 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:56:08,328 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:56:08,328 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:56:08,329 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:56:08,329 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:56:08,330 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:56:08,506 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:56:08,506 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:56:08,506 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:56:08,507 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:56:08,540 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:56:08,540 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:56:08,540 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:56:08,547 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:56:08,547 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:56:08,547 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:56:08,703 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:56:08,703 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:08,900 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:08,900 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:56:08,900 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:56:08,903 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:56:08,903 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:56:08,903 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:09,052 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:09,052 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:09,202 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:09,202 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:09,403 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:09,403 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:09,561 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:09,561 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:56:09,561 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:56:09,562 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:56:09,708 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:56:09,708 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:56:09,708 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:56:09,708 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:56:09.708566",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:56:09,717 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:56:09,717 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:56:09,717 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:56:09,717 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:56:09,744 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:56:09,751 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:56:09,752 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:56:09,753 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:56:09,753 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:56:09,754 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 14:56:09,754 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T19:56:09.753973",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:56:09,790 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 14:56:09,790 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:56:27,067 - DEBUG - [protocol.py:599] - < PING 04 45 60 99 [binary, 4 bytes]
2025-02-07 14:56:27,081 - DEBUG - [protocol.py:745] - > PONG 04 45 60 99 [binary, 4 bytes]
2025-02-07 14:56:27,081 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:56:27,084 - DEBUG - [protocol.py:745] - > PING 48 a9 ad f6 [binary, 4 bytes]
2025-02-07 14:56:27,089 - DEBUG - [protocol.py:599] - < PONG 48 a9 ad f6 [binary, 4 bytes]
2025-02-07 14:56:27,096 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:56:47,081 - DEBUG - [protocol.py:599] - < PING 1d b1 c3 c2 [binary, 4 bytes]
2025-02-07 14:56:47,081 - DEBUG - [protocol.py:745] - > PONG 1d b1 c3 c2 [binary, 4 bytes]
2025-02-07 14:56:47,097 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:56:47,097 - DEBUG - [protocol.py:745] - > PING a3 6c d7 e4 [binary, 4 bytes]
2025-02-07 14:56:47,097 - DEBUG - [protocol.py:599] - < PONG a3 6c d7 e4 [binary, 4 bytes]
2025-02-07 14:56:47,097 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:57:07,103 - DEBUG - [protocol.py:599] - < PING 45 0b 80 dd [binary, 4 bytes]
2025-02-07 14:57:07,103 - DEBUG - [protocol.py:745] - > PONG 45 0b 80 dd [binary, 4 bytes]
2025-02-07 14:57:07,103 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:57:07,103 - DEBUG - [protocol.py:745] - > PING 5f 76 48 94 [binary, 4 bytes]
2025-02-07 14:57:07,113 - DEBUG - [protocol.py:599] - < PONG 5f 76 48 94 [binary, 4 bytes]
2025-02-07 14:57:07,113 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:57:27,111 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:57:27,113 - DEBUG - [protocol.py:745] - > PING 7e 3e bb 95 [binary, 4 bytes]
2025-02-07 14:57:27,116 - DEBUG - [protocol.py:599] - < PING 8b 3d aa c0 [binary, 4 bytes]
2025-02-07 14:57:27,117 - DEBUG - [protocol.py:745] - > PONG 8b 3d aa c0 [binary, 4 bytes]
2025-02-07 14:57:27,121 - DEBUG - [protocol.py:599] - < PONG 7e 3e bb 95 [binary, 4 bytes]
2025-02-07 14:57:27,123 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:57:47,121 - DEBUG - [protocol.py:599] - < PING 29 47 a7 2b [binary, 4 bytes]
2025-02-07 14:57:47,121 - DEBUG - [protocol.py:745] - > PONG 29 47 a7 2b [binary, 4 bytes]
2025-02-07 14:57:47,129 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:57:47,129 - DEBUG - [protocol.py:745] - > PING bc b7 a0 ad [binary, 4 bytes]
2025-02-07 14:57:47,137 - DEBUG - [protocol.py:599] - < PONG bc b7 a0 ad [binary, 4 bytes]
2025-02-07 14:57:47,139 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:58:07,134 - DEBUG - [protocol.py:599] - < PING 66 fb 4c be [binary, 4 bytes]
2025-02-07 14:58:07,138 - DEBUG - [protocol.py:745] - > PONG 66 fb 4c be [binary, 4 bytes]
2025-02-07 14:58:07,138 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:58:07,142 - DEBUG - [protocol.py:745] - > PING 7c fe fb 4a [binary, 4 bytes]
2025-02-07 14:58:07,148 - DEBUG - [protocol.py:599] - < PONG 7c fe fb 4a [binary, 4 bytes]
2025-02-07 14:58:07,151 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:58:21,369 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:58:21,371 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:58:21,371 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:58:21,373 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:58:21,373 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:58:21,373 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:58:21,373 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:58:21,375 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 15:00:11,639 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 15:00:11,639 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 15:00:11,653 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 15:00:11,653 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 15:00:11,653 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 15:00:11,653 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:00:21,682 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: timed out during handshake
2025-02-07 15:00:31,686 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:00:33,756 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:00:43,758 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:00:45,820 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:00:55,829 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:00:57,873 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:07,890 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:09,942 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:19,945 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:22,015 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:32,023 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:34,082 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:44,088 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:46,157 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:56,170 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:58,222 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:08,225 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:10,286 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:20,290 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:22,367 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:32,381 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:34,438 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:44,453 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:46,534 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:56,549 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:58,606 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:08,617 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:10,662 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:20,666 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:22,729 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:32,737 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:34,809 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:44,824 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:46,888 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:56,904 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:58,971 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:08,981 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:11,034 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:21,041 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:23,089 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:33,092 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:35,151 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:45,155 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:47,221 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:57,236 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:59,299 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:09,314 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:11,394 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:21,417 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:23,477 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:33,479 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:35,561 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:45,567 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:47,640 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:57,654 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:59,720 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:09,737 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:06:11,793 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:21,797 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:06:23,858 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:33,870 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:06:35,947 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:45,958 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:06:48,017 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:58,027 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:00,097 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:10,107 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:12,196 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:22,208 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:24,282 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:34,293 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:36,362 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:46,371 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:48,443 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:58,455 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:00,502 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:10,514 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:12,587 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:22,594 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:24,666 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:34,668 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:36,737 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:46,746 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:48,826 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:58,829 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:00,900 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:10,908 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:12,971 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:22,977 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:25,054 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:35,057 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:37,115 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:47,124 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:49,191 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:59,202 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:01,261 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:11,272 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:13,330 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:23,331 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:25,391 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:35,401 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:37,475 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:47,479 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:49,537 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:59,542 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:01,603 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:11,609 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:13,687 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:23,692 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:25,776 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:35,796 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:37,862 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:47,875 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:49,933 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:59,937 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:02,008 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:12:12,017 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:14,105 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:12:24,108 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:26,164 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:12:36,170 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:38,244 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:12:48,252 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:50,318 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:00,327 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:02,391 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:12,399 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:14,463 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:24,477 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:26,521 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:36,529 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:38,614 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:48,624 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:50,676 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:00,683 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:02,745 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:12,751 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:14,815 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:24,827 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:26,891 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:36,906 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:38,950 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:48,964 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:51,015 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:01,024 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:03,110 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:13,123 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:15,180 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:25,182 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:27,238 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:37,250 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:39,310 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:49,313 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:51,381 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:01,384 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:03,454 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:13,461 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:15,535 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:25,542 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:27,588 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:37,597 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:39,652 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:49,661 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:51,708 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:01,717 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:03,776 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:13,788 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:15,847 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:25,857 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:27,904 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:37,916 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:39,954 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:49,962 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:52,009 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:02,017 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:04,106 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:14,112 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:16,183 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:26,191 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:28,265 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:38,275 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:40,339 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:50,354 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:52,431 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:02,438 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:04,483 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:14,491 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:16,566 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:26,577 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:28,637 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:38,649 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:40,731 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:50,736 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:52,800 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:02,807 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:04,881 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:14,884 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:16,957 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:26,965 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:29,027 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:39,041 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:41,105 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:51,107 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:53,171 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:03,174 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:05,223 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:15,234 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:17,312 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:27,329 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:29,401 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:39,411 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:41,476 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:51,487 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:53,544 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:03,559 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:05,631 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:15,641 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:17,705 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:27,719 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:29,776 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:39,782 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:41,841 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:51,854 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:53,928 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:03,929 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:05,999 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:16,007 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:18,055 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:28,066 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:30,127 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:40,139 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:42,199 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:52,213 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:52,218 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 15:23:52,223 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 15:23:52,226 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 15:23:52,226 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 15:23:52,229 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 15:23:52,230 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: wlGOlR013GVEEntaZdlnHg==
2025-02-07 15:23:52,232 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 15:23:52,234 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 15:23:52,238 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 15:23:52,418 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 15:23:52,426 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 15:23:52,428 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 15:23:52,429 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: 1XME3Q8037uUQo2Lr4vFSxV3t28=
2025-02-07 15:23:52,430 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 15:23:52,431 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 20:23:51 GMT
2025-02-07 15:23:52,431 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 15:23:52,433 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 15:23:52,434 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 15:23:53,578 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:23:53,580 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:23:53,580 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:23:53,582 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:23:53,620 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:23:53,622 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:23:53,623 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:23:53,625 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:23:53,626 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:23:53,627 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:23:53,805 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:23:53,806 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:23:53,806 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 15:23:53,807 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 15:23:53,837 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 15:23:53,839 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 15:23:53,840 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:23:53,841 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:23:53,841 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:23:53,842 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:23:54,009 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:23:54,009 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,206 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,206 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:23:54,207 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:23:54,207 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:23:54,207 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:23:54,208 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,366 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,367 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,532 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,532 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,727 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,728 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,883 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,883 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:23:54,883 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:23:54,885 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:23:55,039 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:23:55,040 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:23:55,041 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:23:55,041 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:23:55.041373",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:23:55,042 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:23:55,042 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:23:55,042 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:23:55,043 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:23:55,070 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:23:55,072 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:23:55,072 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:23:55,073 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:23:55,074 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:23:55,074 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:23:55,074 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:23:55.073444",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:23:55,104 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:23:55,105 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:24:12,417 - DEBUG - [protocol.py:599] - < PING 2b 47 6b d6 [binary, 4 bytes]
2025-02-07 15:24:12,418 - DEBUG - [protocol.py:745] - > PONG 2b 47 6b d6 [binary, 4 bytes]
2025-02-07 15:24:12,420 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:24:12,421 - DEBUG - [protocol.py:745] - > PING dd 4e 8f e5 [binary, 4 bytes]
2025-02-07 15:24:12,426 - DEBUG - [protocol.py:599] - < PONG dd 4e 8f e5 [binary, 4 bytes]
2025-02-07 15:24:12,427 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:24:18,696 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 15:24:18,699 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 15:24:18,705 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 15:24:18,707 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 15:24:18,707 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 15:24:18,709 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 15:24:18,710 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 15:24:25,556 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 15:24:25,558 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 15:24:25,558 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:24:25,594 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 15:24:25,596 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: /AIMAaCtYaIPu0DC0+BcwA==
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 15:24:25,620 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 15:24:25,620 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 15:24:25,620 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 15:24:25,622 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: wjLoCqBMYgJn6yiMp+RvBbHa7wo=
2025-02-07 15:24:25,622 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 15:24:25,623 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 20:24:24 GMT
2025-02-07 15:24:25,623 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 15:24:25,623 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 15:24:25,625 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 15:24:26,716 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:24:26,716 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:24:26,716 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:24:26,719 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:24:26,746 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:24:26,746 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:24:26,751 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:24:26,751 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:24:26,751 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:24:26,751 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:24:28,582 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:24:28,585 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:24:28,586 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 15:24:28,588 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 15:24:28,611 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 15:24:28,615 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 15:24:28,615 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:24:28,617 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:24:28,617 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:24:28,618 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:24:28,777 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:24:28,777 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:28,966 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:28,966 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:24:28,966 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:24:28,969 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:24:28,969 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:24:28,969 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:29,127 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:29,127 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:29,279 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:29,279 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:29,476 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:29,476 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:29,627 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:29,627 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:24:29,627 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:24:29,627 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:24:29,777 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:24:29,781 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:24:29,781 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:24:29,781 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:24:29.781829",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:24:29,781 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:24:29,781 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:24:29,781 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:24:29,781 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:24:29,816 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:24:29.816692",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:24:29,856 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:24:29,857 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:24:45,623 - DEBUG - [protocol.py:599] - < PING b3 5e 1a 49 [binary, 4 bytes]
2025-02-07 15:24:45,623 - DEBUG - [protocol.py:745] - > PONG b3 5e 1a 49 [binary, 4 bytes]
2025-02-07 15:24:45,623 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:24:45,628 - DEBUG - [protocol.py:745] - > PING 11 d0 c3 91 [binary, 4 bytes]
2025-02-07 15:24:45,636 - DEBUG - [protocol.py:599] - < PONG 11 d0 c3 91 [binary, 4 bytes]
2025-02-07 15:24:45,636 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:25:05,629 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:25:05,629 - DEBUG - [protocol.py:745] - > PING 07 18 48 dd [binary, 4 bytes]
2025-02-07 15:25:05,629 - DEBUG - [protocol.py:599] - < PING f5 d6 b9 90 [binary, 4 bytes]
2025-02-07 15:25:05,629 - DEBUG - [protocol.py:745] - > PONG f5 d6 b9 90 [binary, 4 bytes]
2025-02-07 15:25:05,641 - DEBUG - [protocol.py:599] - < PONG 07 18 48 dd [binary, 4 bytes]
2025-02-07 15:25:05,642 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:25:25,635 - DEBUG - [protocol.py:599] - < PING 22 95 8a 3c [binary, 4 bytes]
2025-02-07 15:25:25,635 - DEBUG - [protocol.py:745] - > PONG 22 95 8a 3c [binary, 4 bytes]
2025-02-07 15:25:25,651 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:25:25,651 - DEBUG - [protocol.py:745] - > PING 1f c3 10 4c [binary, 4 bytes]
2025-02-07 15:25:25,658 - DEBUG - [protocol.py:599] - < PONG 1f c3 10 4c [binary, 4 bytes]
2025-02-07 15:25:25,659 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:25:45,657 - DEBUG - [protocol.py:599] - < PING 91 e7 8a 90 [binary, 4 bytes]
2025-02-07 15:25:45,657 - DEBUG - [protocol.py:745] - > PONG 91 e7 8a 90 [binary, 4 bytes]
2025-02-07 15:25:45,679 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:25:45,681 - DEBUG - [protocol.py:745] - > PING c9 de 20 da [binary, 4 bytes]
2025-02-07 15:25:45,692 - DEBUG - [protocol.py:599] - < PONG c9 de 20 da [binary, 4 bytes]
2025-02-07 15:25:45,695 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:26:05,669 - DEBUG - [protocol.py:599] - < PING 7d 45 ec 53 [binary, 4 bytes]
2025-02-07 15:26:05,671 - DEBUG - [protocol.py:745] - > PONG 7d 45 ec 53 [binary, 4 bytes]
2025-02-07 15:26:05,673 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:26:05,674 - DEBUG - [protocol.py:745] - > PING 1c 0e af 3d [binary, 4 bytes]
2025-02-07 15:26:05,680 - DEBUG - [protocol.py:599] - < PONG 1c 0e af 3d [binary, 4 bytes]
2025-02-07 15:26:05,683 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:26:25,678 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:26:25,680 - DEBUG - [protocol.py:745] - > PING b3 9c 03 a8 [binary, 4 bytes]
2025-02-07 15:26:25,682 - DEBUG - [protocol.py:599] - < PING 2c dd a3 bf [binary, 4 bytes]
2025-02-07 15:26:25,684 - DEBUG - [protocol.py:745] - > PONG 2c dd a3 bf [binary, 4 bytes]
2025-02-07 15:26:25,687 - DEBUG - [protocol.py:599] - < PONG b3 9c 03 a8 [binary, 4 bytes]
2025-02-07 15:26:25,689 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:26:25,743 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 15:26:25,744 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 15:26:25,752 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 15:26:25,753 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 15:26:25,754 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 15:26:25,754 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 15:26:25,755 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 15:26:30,472 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 15:26:30,475 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 15:26:30,475 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 15:26:30,477 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:26:30,507 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 15:26:30,507 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: ECSX/Fqh97Ag/yb+L6tV7A==
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 15:26:30,536 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: l/huP7yeBc+Ufp551ZpEf/MHbgY=
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 20:26:29 GMT
2025-02-07 15:26:30,538 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 15:26:30,538 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 15:26:30,538 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 15:26:31,621 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:26:31,621 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:26:31,622 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:26:31,623 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:26:31,644 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:26:31,644 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:26:31,652 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:26:31,653 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:26:31,653 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:26:31,654 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:26:31,832 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:26:31,833 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:26:31,833 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 15:26:31,833 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 15:26:31,854 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 15:26:31,855 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 15:26:31,855 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:26:31,855 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:26:31,856 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:26:31,856 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:26:32,023 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:26:32,024 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,261 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,261 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:26:32,261 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:26:32,261 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:26:32,263 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:26:32,263 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,424 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,425 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,586 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,586 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,783 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,784 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,942 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,942 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:26:32,942 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:26:32,943 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:26:33,086 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:26:33,086 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:26:33,086 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:26:33,086 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:26:33.086764",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:26:33,100 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:26:33,100 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:26:33,101 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:26:33,101 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:26:33,125 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:26:33.125214",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:26:33,154 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:26:33,154 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:26:50,539 - DEBUG - [protocol.py:599] - < PING 21 00 cd f7 [binary, 4 bytes]
2025-02-07 15:26:50,540 - DEBUG - [protocol.py:745] - > PONG 21 00 cd f7 [binary, 4 bytes]
2025-02-07 15:26:50,544 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:26:50,544 - DEBUG - [protocol.py:745] - > PING 03 5a 01 e2 [binary, 4 bytes]
2025-02-07 15:26:50,556 - DEBUG - [protocol.py:599] - < PONG 03 5a 01 e2 [binary, 4 bytes]
2025-02-07 15:26:50,558 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:27:10,546 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:27:10,548 - DEBUG - [protocol.py:745] - > PING 4a a0 cb 1d [binary, 4 bytes]
2025-02-07 15:27:10,549 - DEBUG - [protocol.py:599] - < PING a6 0a 51 ab [binary, 4 bytes]
2025-02-07 15:27:10,550 - DEBUG - [protocol.py:745] - > PONG a6 0a 51 ab [binary, 4 bytes]
2025-02-07 15:27:10,552 - DEBUG - [protocol.py:599] - < PONG 4a a0 cb 1d [binary, 4 bytes]
2025-02-07 15:27:10,554 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:27:30,542 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:27:30,542 - DEBUG - [protocol.py:745] - > PING a8 36 fb 99 [binary, 4 bytes]
2025-02-07 15:27:30,542 - DEBUG - [protocol.py:599] - < PONG a8 36 fb 99 [binary, 4 bytes]
2025-02-07 15:27:30,542 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:27:30,558 - DEBUG - [protocol.py:599] - < PING f8 07 08 8c [binary, 4 bytes]
2025-02-07 15:27:30,558 - DEBUG - [protocol.py:745] - > PONG f8 07 08 8c [binary, 4 bytes]
2025-02-07 15:27:50,559 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:27:50,559 - DEBUG - [protocol.py:745] - > PING 49 9f 16 98 [binary, 4 bytes]
2025-02-07 15:27:50,559 - DEBUG - [protocol.py:599] - < PING 3a e0 24 1b [binary, 4 bytes]
2025-02-07 15:27:50,559 - DEBUG - [protocol.py:745] - > PONG 3a e0 24 1b [binary, 4 bytes]
2025-02-07 15:27:50,573 - DEBUG - [protocol.py:599] - < PONG 49 9f 16 98 [binary, 4 bytes]
2025-02-07 15:27:50,575 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:28:10,572 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:28:10,572 - DEBUG - [protocol.py:745] - > PING 03 ea 15 3a [binary, 4 bytes]
2025-02-07 15:28:10,572 - DEBUG - [protocol.py:599] - < PING 11 8c 25 36 [binary, 4 bytes]
2025-02-07 15:28:10,572 - DEBUG - [protocol.py:745] - > PONG 11 8c 25 36 [binary, 4 bytes]
2025-02-07 15:28:10,572 - DEBUG - [protocol.py:599] - < PONG 03 ea 15 3a [binary, 4 bytes]
2025-02-07 15:28:10,572 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:28:30,584 - DEBUG - [protocol.py:599] - < PING f7 fb c2 01 [binary, 4 bytes]
2025-02-07 15:28:30,584 - DEBUG - [protocol.py:745] - > PONG f7 fb c2 01 [binary, 4 bytes]
2025-02-07 15:28:30,584 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:28:30,584 - DEBUG - [protocol.py:745] - > PING 'zȼ]' [text, 4 bytes]
2025-02-07 15:28:30,584 - DEBUG - [protocol.py:599] - < PONG 'zȼ]' [text, 4 bytes]
2025-02-07 15:28:30,584 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:28:50,594 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:28:50,596 - DEBUG - [protocol.py:745] - > PING 9b 2b f4 e6 [binary, 4 bytes]
2025-02-07 15:28:50,598 - DEBUG - [protocol.py:599] - < PING '`݄V' [text, 4 bytes]
2025-02-07 15:28:50,600 - DEBUG - [protocol.py:745] - > PONG '`݄V' [text, 4 bytes]
2025-02-07 15:28:50,604 - DEBUG - [protocol.py:599] - < PONG 9b 2b f4 e6 [binary, 4 bytes]
2025-02-07 15:28:50,606 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:29:10,598 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:29:10,600 - DEBUG - [protocol.py:745] - > PING 88 94 c5 9b [binary, 4 bytes]
2025-02-07 15:29:10,608 - DEBUG - [protocol.py:599] - < PING 91 25 09 3f [binary, 4 bytes]
2025-02-07 15:29:10,609 - DEBUG - [protocol.py:745] - > PONG 91 25 09 3f [binary, 4 bytes]
2025-02-07 15:29:10,612 - DEBUG - [protocol.py:599] - < PONG 88 94 c5 9b [binary, 4 bytes]
2025-02-07 15:29:10,616 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:29:30,606 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:29:30,607 - DEBUG - [protocol.py:745] - > PING 2a 1d 87 2f [binary, 4 bytes]
2025-02-07 15:29:30,615 - DEBUG - [protocol.py:599] - < PING b8 18 3e 79 [binary, 4 bytes]
2025-02-07 15:29:30,616 - DEBUG - [protocol.py:745] - > PONG b8 18 3e 79 [binary, 4 bytes]
2025-02-07 15:29:30,618 - DEBUG - [protocol.py:599] - < PONG 2a 1d 87 2f [binary, 4 bytes]
2025-02-07 15:29:30,619 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:29:50,612 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:29:50,615 - DEBUG - [protocol.py:745] - > PING 01 a2 b8 f7 [binary, 4 bytes]
2025-02-07 15:29:50,623 - DEBUG - [protocol.py:599] - < PONG 01 a2 b8 f7 [binary, 4 bytes]
2025-02-07 15:29:50,625 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:29:50,627 - DEBUG - [protocol.py:599] - < PING b3 38 e2 e7 [binary, 4 bytes]
2025-02-07 15:29:50,631 - DEBUG - [protocol.py:745] - > PONG b3 38 e2 e7 [binary, 4 bytes]
2025-02-07 15:30:10,632 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:30:10,634 - DEBUG - [protocol.py:745] - > PING e8 f7 6f c7 [binary, 4 bytes]
2025-02-07 15:30:10,642 - DEBUG - [protocol.py:599] - < PING 80 7f 13 be [binary, 4 bytes]
2025-02-07 15:30:10,644 - DEBUG - [protocol.py:745] - > PONG 80 7f 13 be [binary, 4 bytes]
2025-02-07 15:30:10,649 - DEBUG - [protocol.py:599] - < PONG e8 f7 6f c7 [binary, 4 bytes]
2025-02-07 15:30:10,651 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:30:30,654 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:30:30,656 - DEBUG - [protocol.py:745] - > PING 9e 30 63 ad [binary, 4 bytes]
2025-02-07 15:30:30,658 - DEBUG - [protocol.py:599] - < PING 85 f9 81 f0 [binary, 4 bytes]
2025-02-07 15:30:30,660 - DEBUG - [protocol.py:745] - > PONG 85 f9 81 f0 [binary, 4 bytes]
2025-02-07 15:30:30,665 - DEBUG - [protocol.py:599] - < PONG 9e 30 63 ad [binary, 4 bytes]
2025-02-07 15:30:30,667 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:30:50,658 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:30:50,660 - DEBUG - [protocol.py:745] - > PING 81 92 8d d5 [binary, 4 bytes]
2025-02-07 15:30:50,668 - DEBUG - [protocol.py:599] - < PING b1 a0 e8 86 [binary, 4 bytes]
2025-02-07 15:30:50,670 - DEBUG - [protocol.py:745] - > PONG b1 a0 e8 86 [binary, 4 bytes]
2025-02-07 15:30:50,674 - DEBUG - [protocol.py:599] - < PONG 81 92 8d d5 [binary, 4 bytes]
2025-02-07 15:30:50,677 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:31:10,667 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:31:10,670 - DEBUG - [protocol.py:745] - > PING c9 af 00 86 [binary, 4 bytes]
2025-02-07 15:31:10,678 - DEBUG - [protocol.py:599] - < PONG c9 af 00 86 [binary, 4 bytes]
2025-02-07 15:31:10,681 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:31:10,684 - DEBUG - [protocol.py:599] - < PING 54 c9 34 9b [binary, 4 bytes]
2025-02-07 15:31:10,686 - DEBUG - [protocol.py:745] - > PONG 54 c9 34 9b [binary, 4 bytes]
2025-02-07 15:31:30,685 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:31:30,687 - DEBUG - [protocol.py:745] - > PING 49 58 c7 cf [binary, 4 bytes]
2025-02-07 15:31:30,694 - DEBUG - [protocol.py:599] - < PING 39 52 bb 6b [binary, 4 bytes]
2025-02-07 15:31:30,695 - DEBUG - [protocol.py:745] - > PONG 39 52 bb 6b [binary, 4 bytes]
2025-02-07 15:31:30,699 - DEBUG - [protocol.py:599] - < PONG 49 58 c7 cf [binary, 4 bytes]
2025-02-07 15:31:30,703 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:31:34,238 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:31:34,239 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:31:34,239 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:31:34,240 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:31:34,273 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:31:34,274 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:31:34,275 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:31:34,277 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:31:34,277 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:31:34,278 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:31:34,532 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:31:34,533 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:31:34,533 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:31:34,534 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:31:34,534 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:31:34,535 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:31:34,827 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:31:34,828 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,061 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:35,062 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:31:35,062 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:31:35,063 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:31:35,063 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:31:35,063 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,284 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:35,284 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,553 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:35,553 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,777 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:35,777 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,999 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:36,000 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:31:36,000 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:31:36,001 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:31:36,214 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:31:36,214 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:31:36,215 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:31:36,216 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:31:36.215274",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:31:36,216 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:31:36,217 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:31:36,217 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:31:36,217 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:31:36,248 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:31:36,249 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:31:36,250 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:31:36,250 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:31:36,252 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:31:36,252 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:31:36,253 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:31:36.250707",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:31:36,277 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:31:36,277 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:31:50,695 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:31:50,695 - DEBUG - [protocol.py:745] - > PING b8 87 d7 60 [binary, 4 bytes]
2025-02-07 15:31:50,701 - DEBUG - [protocol.py:599] - < PING c2 05 c8 fb [binary, 4 bytes]
2025-02-07 15:31:50,702 - DEBUG - [protocol.py:745] - > PONG c2 05 c8 fb [binary, 4 bytes]
2025-02-07 15:31:50,704 - DEBUG - [protocol.py:599] - < PONG b8 87 d7 60 [binary, 4 bytes]
2025-02-07 15:31:50,705 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:32:10,707 - DEBUG - [protocol.py:599] - < PING 76 b6 e6 36 [binary, 4 bytes]
2025-02-07 15:32:10,709 - DEBUG - [protocol.py:745] - > PONG 76 b6 e6 36 [binary, 4 bytes]
2025-02-07 15:32:10,711 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:32:10,714 - DEBUG - [protocol.py:745] - > PING a3 87 f2 cb [binary, 4 bytes]
2025-02-07 15:32:10,720 - DEBUG - [protocol.py:599] - < PONG a3 87 f2 cb [binary, 4 bytes]
2025-02-07 15:32:10,723 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:32:30,719 - DEBUG - [protocol.py:599] - < PING 13 a4 54 34 [binary, 4 bytes]
2025-02-07 15:32:30,720 - DEBUG - [protocol.py:745] - > PONG 13 a4 54 34 [binary, 4 bytes]
2025-02-07 15:32:30,721 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:32:30,721 - DEBUG - [protocol.py:745] - > PING be dc ca 58 [binary, 4 bytes]
2025-02-07 15:32:30,727 - DEBUG - [protocol.py:599] - < PONG be dc ca 58 [binary, 4 bytes]
2025-02-07 15:32:30,728 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:32:50,727 - DEBUG - [protocol.py:599] - < PING ec f3 d5 32 [binary, 4 bytes]
2025-02-07 15:32:50,728 - DEBUG - [protocol.py:745] - > PONG ec f3 d5 32 [binary, 4 bytes]
2025-02-07 15:32:50,729 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:32:50,729 - DEBUG - [protocol.py:745] - > PING 4b a1 59 7f [binary, 4 bytes]
2025-02-07 15:32:50,735 - DEBUG - [protocol.py:599] - < PONG 4b a1 59 7f [binary, 4 bytes]
2025-02-07 15:32:50,736 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:33:10,726 - DEBUG - [protocol.py:599] - < PING d7 1c ad 0d [binary, 4 bytes]
2025-02-07 15:33:10,726 - DEBUG - [protocol.py:745] - > PONG d7 1c ad 0d [binary, 4 bytes]
2025-02-07 15:33:10,740 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:33:10,743 - DEBUG - [protocol.py:745] - > PING 72 16 a3 6f [binary, 4 bytes]
2025-02-07 15:33:10,749 - DEBUG - [protocol.py:599] - < PONG 72 16 a3 6f [binary, 4 bytes]
2025-02-07 15:33:10,751 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:33:30,748 - DEBUG - [protocol.py:599] - < PING 74 1a b6 2b [binary, 4 bytes]
2025-02-07 15:33:30,750 - DEBUG - [protocol.py:745] - > PONG 74 1a b6 2b [binary, 4 bytes]
2025-02-07 15:33:30,778 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:33:30,779 - DEBUG - [protocol.py:745] - > PING df 72 42 7c [binary, 4 bytes]
2025-02-07 15:33:30,786 - DEBUG - [protocol.py:599] - < PONG df 72 42 7c [binary, 4 bytes]
2025-02-07 15:33:30,788 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:33:50,751 - DEBUG - [protocol.py:599] - < PING d3 47 08 45 [binary, 4 bytes]
2025-02-07 15:33:50,751 - DEBUG - [protocol.py:745] - > PONG d3 47 08 45 [binary, 4 bytes]
2025-02-07 15:33:50,785 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:33:50,785 - DEBUG - [protocol.py:745] - > PING 94 72 41 3b [binary, 4 bytes]
2025-02-07 15:33:50,789 - DEBUG - [protocol.py:599] - < PONG 94 72 41 3b [binary, 4 bytes]
2025-02-07 15:33:50,789 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:34:10,764 - DEBUG - [protocol.py:599] - < PING f0 3d 14 47 [binary, 4 bytes]
2025-02-07 15:34:10,764 - DEBUG - [protocol.py:745] - > PONG f0 3d 14 47 [binary, 4 bytes]
2025-02-07 15:34:10,797 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:34:10,800 - DEBUG - [protocol.py:745] - > PING 8d de 37 bd [binary, 4 bytes]
2025-02-07 15:34:10,808 - DEBUG - [protocol.py:599] - < PONG 8d de 37 bd [binary, 4 bytes]
2025-02-07 15:34:10,810 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:34:30,778 - DEBUG - [protocol.py:599] - < PING 21 ba 4b ad [binary, 4 bytes]
2025-02-07 15:34:30,779 - DEBUG - [protocol.py:745] - > PONG 21 ba 4b ad [binary, 4 bytes]
2025-02-07 15:34:30,803 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:34:30,803 - DEBUG - [protocol.py:745] - > PING 97 d3 16 47 [binary, 4 bytes]
2025-02-07 15:34:30,810 - DEBUG - [protocol.py:599] - < PONG 97 d3 16 47 [binary, 4 bytes]
2025-02-07 15:34:30,810 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:34:50,784 - DEBUG - [protocol.py:599] - < PING '~\x00ɭ' [text, 4 bytes]
2025-02-07 15:34:50,784 - DEBUG - [protocol.py:745] - > PONG '~\x00ɭ' [text, 4 bytes]
2025-02-07 15:34:50,816 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:34:50,819 - DEBUG - [protocol.py:745] - > PING "K|'$" [text, 4 bytes]
2025-02-07 15:34:50,826 - DEBUG - [protocol.py:599] - < PONG "K|'$" [text, 4 bytes]
2025-02-07 15:34:50,826 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:35:10,796 - DEBUG - [protocol.py:599] - < PING d6 78 a3 92 [binary, 4 bytes]
2025-02-07 15:35:10,798 - DEBUG - [protocol.py:745] - > PONG d6 78 a3 92 [binary, 4 bytes]
2025-02-07 15:35:10,843 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:35:10,845 - DEBUG - [protocol.py:745] - > PING 1a 95 c6 57 [binary, 4 bytes]
2025-02-07 15:35:10,850 - DEBUG - [protocol.py:599] - < PONG 1a 95 c6 57 [binary, 4 bytes]
2025-02-07 15:35:10,851 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:35:30,788 - DEBUG - [protocol.py:599] - < PING 05 93 d9 61 [binary, 4 bytes]
2025-02-07 15:35:30,804 - DEBUG - [protocol.py:745] - > PONG 05 93 d9 61 [binary, 4 bytes]
2025-02-07 15:35:30,848 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:35:30,851 - DEBUG - [protocol.py:745] - > PING 4f 5d c2 7e [binary, 4 bytes]
2025-02-07 15:35:30,859 - DEBUG - [protocol.py:599] - < PONG 4f 5d c2 7e [binary, 4 bytes]
2025-02-07 15:35:30,861 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:35:50,814 - DEBUG - [protocol.py:599] - < PING 4a fc c5 28 [binary, 4 bytes]
2025-02-07 15:35:50,814 - DEBUG - [protocol.py:745] - > PONG 4a fc c5 28 [binary, 4 bytes]
2025-02-07 15:35:50,886 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:35:50,888 - DEBUG - [protocol.py:745] - > PING b6 19 d4 c6 [binary, 4 bytes]
2025-02-07 15:35:50,889 - DEBUG - [protocol.py:599] - < PONG b6 19 d4 c6 [binary, 4 bytes]
2025-02-07 15:35:50,894 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:36:09,821 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 15:36:09,830 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 15:36:09,832 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 15:36:09,832 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 15:36:09,832 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 15:36:09,838 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 15:36:09,840 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 15:36:09,845 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 15:36:37,478 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:36:37,488 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:36:37,488 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:36:37,489 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:36:37,533 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:36:37,533 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:36:37,534 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:36:37,534 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:36:37,535 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:36:37,535 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:36:37,887 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:36:37,887 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:36:37,888 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:36:37,888 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:36:37,889 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:36:37,889 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:36:38,098 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:36:38,099 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:38,317 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:38,318 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:36:38,318 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:36:38,319 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:36:38,319 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:36:38,320 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:38,599 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:38,600 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:38,845 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:38,845 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:39,074 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:39,075 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:39,286 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:39,287 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:36:39,288 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:36:39,288 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:36:39,562 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:36:39,563 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:36:39,563 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:36:39,564 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:36:39.563417",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:36:39,564 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:36:39,565 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:36:39,565 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:36:39,566 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:36:39,600 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:36:39,600 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:36:39,601 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:36:39,601 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:36:39,602 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:36:39,602 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:36:39,602 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:36:39.601514",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:36:39,638 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:36:39,639 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:37:03,611 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 15:37:03,611 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 15:37:03,611 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 15:37:03,614 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:37:03,649 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 15:37:03,651 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 15:37:03,651 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 15:37:03,651 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 15:37:03,651 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 15:37:03,651 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: xmqUC3UzjctuZX/8nut2Sg==
2025-02-07 15:37:03,653 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 15:37:03,653 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 15:37:03,653 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 15:37:03,717 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 15:37:03,717 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: 27c412rjaKBWSFvW7sgNlCjRdHM=
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 20:37:02 GMT
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 15:37:03,720 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 15:37:03,720 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 15:37:04,937 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:37:04,937 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:37:04,942 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:37:04,942 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:37:04,985 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:37:04,985 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:37:04,985 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:37:04,985 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:37:04,985 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:37:04,985 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:37:05,184 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:37:05,184 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:37:05,184 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 15:37:05,184 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 15:37:05,223 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 15:37:05,226 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 15:37:05,229 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:37:05,229 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:37:05,232 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:37:05,233 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:37:05,403 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:37:05,403 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:05,585 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:05,585 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:05,585 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:37:05,585 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:37:05,585 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:37:05,591 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:05,742 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:05,742 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:05,742 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:05,891 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:05,891 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:05,891 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:06,081 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:06,084 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:06,084 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:06,233 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:06,233 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:06,233 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 15:37:06,233 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:37:06,233 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:37:06,391 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:37:06,391 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:37:06,391 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:37:06,391 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:37:06,394 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:37:06,394 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:37:06,394 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:37:06,394 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:37:06,422 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T20:37:06.422400",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 15:37:06,472 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:37:06,475 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:37:23,714 - DEBUG - [protocol.py:599] - < PING f1 d2 8a 9e [binary, 4 bytes]
2025-02-07 15:37:23,714 - DEBUG - [protocol.py:745] - > PONG f1 d2 8a 9e [binary, 4 bytes]
2025-02-07 15:37:23,714 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:37:23,714 - DEBUG - [protocol.py:745] - > PING '3[\x06a' [text, 4 bytes]
2025-02-07 15:37:23,721 - DEBUG - [protocol.py:599] - < PONG '3[\x06a' [text, 4 bytes]
2025-02-07 15:37:23,721 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:37:43,723 - DEBUG - [protocol.py:599] - < PING ',VPj' [text, 4 bytes]
2025-02-07 15:37:43,724 - DEBUG - [protocol.py:745] - > PONG ',VPj' [text, 4 bytes]
2025-02-07 15:37:43,728 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:37:43,730 - DEBUG - [protocol.py:745] - > PING "R'\\x" [text, 4 bytes]
2025-02-07 15:37:43,738 - DEBUG - [protocol.py:599] - < PONG "R'\\x" [text, 4 bytes]
2025-02-07 15:37:43,741 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:38:03,722 - DEBUG - [protocol.py:599] - < PING 13 62 9c b6 [binary, 4 bytes]
2025-02-07 15:38:03,722 - DEBUG - [protocol.py:745] - > PONG 13 62 9c b6 [binary, 4 bytes]
2025-02-07 15:38:03,722 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:38:03,722 - DEBUG - [protocol.py:745] - > PING ac bc 9c 04 [binary, 4 bytes]
2025-02-07 15:38:03,738 - DEBUG - [protocol.py:599] - < PONG ac bc 9c 04 [binary, 4 bytes]
2025-02-07 15:38:03,738 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:38:23,718 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:38:23,718 - DEBUG - [protocol.py:745] - > PING 61 16 44 f5 [binary, 4 bytes]
2025-02-07 15:38:23,718 - DEBUG - [protocol.py:599] - < PONG 61 16 44 f5 [binary, 4 bytes]
2025-02-07 15:38:23,718 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:38:23,734 - DEBUG - [protocol.py:599] - < PING 30 01 e8 76 [binary, 4 bytes]
2025-02-07 15:38:23,734 - DEBUG - [protocol.py:745] - > PONG 30 01 e8 76 [binary, 4 bytes]
2025-02-07 15:38:43,734 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:38:43,736 - DEBUG - [protocol.py:745] - > PING e4 43 cb 52 [binary, 4 bytes]
2025-02-07 15:38:43,742 - DEBUG - [protocol.py:599] - < PONG e4 43 cb 52 [binary, 4 bytes]
2025-02-07 15:38:43,744 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:38:43,750 - DEBUG - [protocol.py:599] - < PING 88 ac 31 50 [binary, 4 bytes]
2025-02-07 15:38:43,754 - DEBUG - [protocol.py:745] - > PONG 88 ac 31 50 [binary, 4 bytes]
2025-02-07 15:39:03,745 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:39:03,746 - DEBUG - [protocol.py:745] - > PING a2 87 b5 f3 [binary, 4 bytes]
2025-02-07 15:39:03,754 - DEBUG - [protocol.py:599] - < PONG a2 87 b5 f3 [binary, 4 bytes]
2025-02-07 15:39:03,754 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:39:03,766 - DEBUG - [protocol.py:599] - < PING 49 4b f4 3f [binary, 4 bytes]
2025-02-07 15:39:03,767 - DEBUG - [protocol.py:745] - > PONG 49 4b f4 3f [binary, 4 bytes]
2025-02-07 15:39:23,761 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:39:23,765 - DEBUG - [protocol.py:745] - > PING ba 44 86 14 [binary, 4 bytes]
2025-02-07 15:39:23,767 - DEBUG - [protocol.py:599] - < PING 78 60 fc 9b [binary, 4 bytes]
2025-02-07 15:39:23,767 - DEBUG - [protocol.py:745] - > PONG 78 60 fc 9b [binary, 4 bytes]
2025-02-07 15:39:23,776 - DEBUG - [protocol.py:599] - < PONG ba 44 86 14 [binary, 4 bytes]
2025-02-07 15:39:23,780 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:39:43,769 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:39:43,769 - DEBUG - [protocol.py:745] - > PING eb ae f1 db [binary, 4 bytes]
2025-02-07 15:39:43,769 - DEBUG - [protocol.py:599] - < PONG eb ae f1 db [binary, 4 bytes]
2025-02-07 15:39:43,785 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:39:43,785 - DEBUG - [protocol.py:599] - < PING 61 87 17 14 [binary, 4 bytes]
2025-02-07 15:39:43,788 - DEBUG - [protocol.py:745] - > PONG 61 87 17 14 [binary, 4 bytes]
2025-02-07 15:40:03,781 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:40:03,781 - DEBUG - [protocol.py:745] - > PING f9 f5 a3 3d [binary, 4 bytes]
2025-02-07 15:40:03,796 - DEBUG - [protocol.py:599] - < PONG f9 f5 a3 3d [binary, 4 bytes]
2025-02-07 15:40:03,798 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:40:03,798 - DEBUG - [protocol.py:599] - < PING fd 2d 54 8c [binary, 4 bytes]
2025-02-07 15:40:03,798 - DEBUG - [protocol.py:745] - > PONG fd 2d 54 8c [binary, 4 bytes]
2025-02-07 15:40:23,795 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:40:23,796 - DEBUG - [protocol.py:745] - > PING 9f 42 86 06 [binary, 4 bytes]
2025-02-07 15:40:23,805 - DEBUG - [protocol.py:599] - < PONG 9f 42 86 06 [binary, 4 bytes]
2025-02-07 15:40:23,808 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:40:23,822 - DEBUG - [protocol.py:599] - < PING 08 57 42 ee [binary, 4 bytes]
2025-02-07 15:40:23,823 - DEBUG - [protocol.py:745] - > PONG 08 57 42 ee [binary, 4 bytes]
2025-02-07 15:40:43,800 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:40:43,802 - DEBUG - [protocol.py:745] - > PING 37 8e fa 50 [binary, 4 bytes]
2025-02-07 15:40:43,809 - DEBUG - [protocol.py:599] - < PONG 37 8e fa 50 [binary, 4 bytes]
2025-02-07 15:40:43,810 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:40:43,832 - DEBUG - [protocol.py:599] - < PING 67 9f 63 d8 [binary, 4 bytes]
2025-02-07 15:40:43,833 - DEBUG - [protocol.py:745] - > PONG 67 9f 63 d8 [binary, 4 bytes]
2025-02-07 15:41:03,804 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:41:03,806 - DEBUG - [protocol.py:745] - > PING 1e 66 43 a5 [binary, 4 bytes]
2025-02-07 15:41:03,816 - DEBUG - [protocol.py:599] - < PONG 1e 66 43 a5 [binary, 4 bytes]
2025-02-07 15:41:03,818 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:41:03,840 - DEBUG - [protocol.py:599] - < PING 0c 7f d3 29 [binary, 4 bytes]
2025-02-07 15:41:03,842 - DEBUG - [protocol.py:745] - > PONG 0c 7f d3 29 [binary, 4 bytes]
2025-02-07 15:41:23,821 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:41:23,823 - DEBUG - [protocol.py:745] - > PING 06 48 aa 10 [binary, 4 bytes]
2025-02-07 15:41:23,830 - DEBUG - [protocol.py:599] - < PONG 06 48 aa 10 [binary, 4 bytes]
2025-02-07 15:41:23,832 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:41:23,852 - DEBUG - [protocol.py:599] - < PING 9b ad d6 2f [binary, 4 bytes]
2025-02-07 15:41:23,855 - DEBUG - [protocol.py:745] - > PONG 9b ad d6 2f [binary, 4 bytes]
2025-02-07 15:41:43,836 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:41:43,837 - DEBUG - [protocol.py:745] - > PING e5 89 fa 24 [binary, 4 bytes]
2025-02-07 15:41:43,846 - DEBUG - [protocol.py:599] - < PONG e5 89 fa 24 [binary, 4 bytes]
2025-02-07 15:41:43,847 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:41:43,867 - DEBUG - [protocol.py:599] - < PING a2 c9 50 b7 [binary, 4 bytes]
2025-02-07 15:41:43,867 - DEBUG - [protocol.py:745] - > PONG a2 c9 50 b7 [binary, 4 bytes]
2025-02-07 15:42:03,846 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:42:03,855 - DEBUG - [protocol.py:745] - > PING d7 cb 92 fb [binary, 4 bytes]
2025-02-07 15:42:03,880 - DEBUG - [protocol.py:599] - < PONG d7 cb 92 fb [binary, 4 bytes]
2025-02-07 15:42:03,890 - DEBUG - [protocol.py:599] - < PING 87 cd 9f b9 [binary, 4 bytes]
2025-02-07 15:42:03,892 - DEBUG - [protocol.py:745] - > PONG 87 cd 9f b9 [binary, 4 bytes]
2025-02-07 15:42:03,893 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:42:07,577 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:42:07,577 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:42:07,578 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:42:07,578 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:42:07,609 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:42:07,609 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:42:07,610 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:42:07,610 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:42:07,611 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:42:07,611 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:42:08,453 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:42:08,455 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:42:08,455 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:42:08,456 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:42:08,456 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:42:08,457 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:42:08,783 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:42:08,785 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,004 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,005 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,005 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:42:09,005 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:42:09,006 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:42:09,006 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,194 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,195 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,195 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,453 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,454 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,454 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,678 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,678 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,679 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,905 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,907 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,907 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 15:42:09,908 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:42:09,909 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:42:10,170 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:42:10,171 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:42:10,171 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:42:10,172 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:42:10,173 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:42:10,173 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:42:10,174 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:42:10,174 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:42:10,207 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:42:10,207 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:42:10,208 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:42:10,208 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:42:10,209 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:42:10,209 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 15:42:10,209 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T20:42:10.208482",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 15:42:10,244 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:42:10,245 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:42:23,859 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:42:23,860 - DEBUG - [protocol.py:745] - > PING f9 33 66 3f [binary, 4 bytes]
2025-02-07 15:42:23,868 - DEBUG - [protocol.py:599] - < PONG f9 33 66 3f [binary, 4 bytes]
2025-02-07 15:42:23,875 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:42:23,907 - DEBUG - [protocol.py:599] - < PING aa f8 7b fe [binary, 4 bytes]
2025-02-07 15:42:23,909 - DEBUG - [protocol.py:745] - > PONG aa f8 7b fe [binary, 4 bytes]
2025-02-07 15:42:43,852 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:42:43,860 - DEBUG - [protocol.py:745] - > PING 4e cd 7d c4 [binary, 4 bytes]
2025-02-07 15:42:43,872 - DEBUG - [protocol.py:599] - < PONG 4e cd 7d c4 [binary, 4 bytes]
2025-02-07 15:42:43,874 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:42:43,916 - DEBUG - [protocol.py:599] - < PING f0 4b 0d 75 [binary, 4 bytes]
2025-02-07 15:42:43,918 - DEBUG - [protocol.py:745] - > PONG f0 4b 0d 75 [binary, 4 bytes]
2025-02-07 15:43:03,861 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:43:03,863 - DEBUG - [protocol.py:745] - > PING 09 38 8e 71 [binary, 4 bytes]
2025-02-07 15:43:03,872 - DEBUG - [protocol.py:599] - < PONG 09 38 8e 71 [binary, 4 bytes]
2025-02-07 15:43:03,873 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:43:03,927 - DEBUG - [protocol.py:599] - < PING 07 ee de 0b [binary, 4 bytes]
2025-02-07 15:43:03,928 - DEBUG - [protocol.py:745] - > PONG 07 ee de 0b [binary, 4 bytes]
2025-02-07 15:43:23,875 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:43:23,876 - DEBUG - [protocol.py:745] - > PING f3 ee c2 07 [binary, 4 bytes]
2025-02-07 15:43:23,882 - DEBUG - [protocol.py:599] - < PONG f3 ee c2 07 [binary, 4 bytes]
2025-02-07 15:43:23,883 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:43:23,934 - DEBUG - [protocol.py:599] - < PING 1f 7a 11 db [binary, 4 bytes]
2025-02-07 15:43:23,934 - DEBUG - [protocol.py:745] - > PONG 1f 7a 11 db [binary, 4 bytes]
2025-02-07 15:43:43,892 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:43:43,894 - DEBUG - [protocol.py:745] - > PING '\x04GS?' [text, 4 bytes]
2025-02-07 15:43:43,900 - DEBUG - [protocol.py:599] - < PONG '\x04GS?' [text, 4 bytes]
2025-02-07 15:43:43,902 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:43:43,940 - DEBUG - [protocol.py:599] - < PING d5 02 fc fc [binary, 4 bytes]
2025-02-07 15:43:43,941 - DEBUG - [protocol.py:745] - > PONG d5 02 fc fc [binary, 4 bytes]
2025-02-07 15:44:03,887 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:44:03,887 - DEBUG - [protocol.py:745] - > PING 10 60 9e 50 [binary, 4 bytes]
2025-02-07 15:44:03,891 - DEBUG - [protocol.py:599] - < PONG 10 60 9e 50 [binary, 4 bytes]
2025-02-07 15:44:03,891 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:44:03,947 - DEBUG - [protocol.py:599] - < PING b4 9b d7 64 [binary, 4 bytes]
2025-02-07 15:44:03,947 - DEBUG - [protocol.py:745] - > PONG b4 9b d7 64 [binary, 4 bytes]
2025-02-07 15:44:23,889 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:44:23,891 - DEBUG - [protocol.py:745] - > PING 56 63 80 b6 [binary, 4 bytes]
2025-02-07 15:44:23,899 - DEBUG - [protocol.py:599] - < PONG 56 63 80 b6 [binary, 4 bytes]
2025-02-07 15:44:23,901 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:44:23,955 - DEBUG - [protocol.py:599] - < PING ae 54 a2 9c [binary, 4 bytes]
2025-02-07 15:44:23,957 - DEBUG - [protocol.py:745] - > PONG ae 54 a2 9c [binary, 4 bytes]
2025-02-07 15:44:43,895 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:44:43,896 - DEBUG - [protocol.py:745] - > PING ad af 5d 0d [binary, 4 bytes]
2025-02-07 15:44:43,905 - DEBUG - [protocol.py:599] - < PONG ad af 5d 0d [binary, 4 bytes]
2025-02-07 15:44:43,905 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:44:43,962 - DEBUG - [protocol.py:599] - < PING 05 68 72 ce [binary, 4 bytes]
2025-02-07 15:44:43,963 - DEBUG - [protocol.py:745] - > PONG 05 68 72 ce [binary, 4 bytes]
2025-02-07 15:45:03,907 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:45:03,907 - DEBUG - [protocol.py:745] - > PING 66 53 e6 71 [binary, 4 bytes]
2025-02-07 15:45:03,907 - DEBUG - [protocol.py:599] - < PONG 66 53 e6 71 [binary, 4 bytes]
2025-02-07 15:45:03,907 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:45:03,972 - DEBUG - [protocol.py:599] - < PING cf 7b e1 82 [binary, 4 bytes]
2025-02-07 15:45:03,972 - DEBUG - [protocol.py:745] - > PONG cf 7b e1 82 [binary, 4 bytes]
2025-02-07 15:45:23,910 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:45:23,911 - DEBUG - [protocol.py:745] - > PING 59 21 cc c5 [binary, 4 bytes]
2025-02-07 15:45:23,911 - DEBUG - [protocol.py:599] - < PONG 59 21 cc c5 [binary, 4 bytes]
2025-02-07 15:45:23,911 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:45:23,974 - DEBUG - [protocol.py:599] - < PING 24 a0 a8 d4 [binary, 4 bytes]
2025-02-07 15:45:23,974 - DEBUG - [protocol.py:745] - > PONG 24 a0 a8 d4 [binary, 4 bytes]
2025-02-07 15:45:43,935 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:45:43,935 - DEBUG - [protocol.py:745] - > PING 0f b4 5a d2 [binary, 4 bytes]
2025-02-07 15:45:43,935 - DEBUG - [protocol.py:599] - < PONG 0f b4 5a d2 [binary, 4 bytes]
2025-02-07 15:45:43,935 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:45:43,983 - DEBUG - [protocol.py:599] - < PING 14 e1 29 2b [binary, 4 bytes]
2025-02-07 15:45:43,983 - DEBUG - [protocol.py:745] - > PONG 14 e1 29 2b [binary, 4 bytes]
2025-02-07 15:46:03,947 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:46:03,948 - DEBUG - [protocol.py:745] - > PING ee 4a b6 1c [binary, 4 bytes]
2025-02-07 15:46:03,948 - DEBUG - [protocol.py:599] - < PONG ee 4a b6 1c [binary, 4 bytes]
2025-02-07 15:46:03,948 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:46:03,997 - DEBUG - [protocol.py:599] - < PING 9d 25 3e 26 [binary, 4 bytes]
2025-02-07 15:46:03,997 - DEBUG - [protocol.py:745] - > PONG 9d 25 3e 26 [binary, 4 bytes]
2025-02-07 15:46:23,957 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:46:23,960 - DEBUG - [protocol.py:745] - > PING 84 b6 44 9f [binary, 4 bytes]
2025-02-07 15:46:23,969 - DEBUG - [protocol.py:599] - < PONG 84 b6 44 9f [binary, 4 bytes]
2025-02-07 15:46:23,971 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:46:24,011 - DEBUG - [protocol.py:599] - < PING d8 95 2a e4 [binary, 4 bytes]
2025-02-07 15:46:24,013 - DEBUG - [protocol.py:745] - > PONG d8 95 2a e4 [binary, 4 bytes]
2025-02-07 15:46:43,998 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:46:44,000 - DEBUG - [protocol.py:745] - > PING 82 24 7d 28 [binary, 4 bytes]
2025-02-07 15:46:44,007 - DEBUG - [protocol.py:599] - < PONG 82 24 7d 28 [binary, 4 bytes]
2025-02-07 15:46:44,010 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:46:44,021 - DEBUG - [protocol.py:599] - < PING b9 75 f9 cd [binary, 4 bytes]
2025-02-07 15:46:44,022 - DEBUG - [protocol.py:745] - > PONG b9 75 f9 cd [binary, 4 bytes]
2025-02-07 15:47:03,999 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:47:04,000 - DEBUG - [protocol.py:745] - > PING '\x15\x03\x13@' [text, 4 bytes]
2025-02-07 15:47:04,011 - DEBUG - [protocol.py:599] - < PONG '\x15\x03\x13@' [text, 4 bytes]
2025-02-07 15:47:04,014 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:47:04,028 - DEBUG - [protocol.py:599] - < PING 0f e4 c9 0c [binary, 4 bytes]
2025-02-07 15:47:04,030 - DEBUG - [protocol.py:745] - > PONG 0f e4 c9 0c [binary, 4 bytes]
2025-02-07 15:47:11,372 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:47:11,373 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:47:11,373 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:47:11,373 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:47:11,401 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:47:11,402 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:47:11,402 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:47:11,403 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:47:11,404 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:47:11,404 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:47:11,654 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:47:11,655 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:47:11,655 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:47:11,655 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:47:11,656 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:47:11,656 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:47:11,876 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:47:11,877 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:12,095 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:12,095 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:12,096 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:47:12,096 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:47:12,097 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:47:12,097 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:12,370 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:12,371 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:12,371 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:12,591 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:12,592 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:12,592 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:12,801 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:12,802 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:12,802 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:13,056 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:13,057 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:13,058 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 15:47:13,058 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:47:13,059 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:47:13,271 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:47:13,271 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:47:13,272 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:47:13,272 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:47:13,273 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:47:13,273 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:47:13,273 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:47:13,274 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:47:13,302 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:47:13,303 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:47:13,303 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:47:13,304 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:47:13,304 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:47:13,305 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 15:47:13,306 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T20:47:13.304766",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 15:47:13,338 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:47:13,339 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:47:24,001 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:47:24,003 - DEBUG - [protocol.py:745] - > PING b4 12 72 14 [binary, 4 bytes]
2025-02-07 15:47:24,011 - DEBUG - [protocol.py:599] - < PONG b4 12 72 14 [binary, 4 bytes]
2025-02-07 15:47:24,013 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:47:24,037 - DEBUG - [protocol.py:599] - < PING a8 ef 50 85 [binary, 4 bytes]
2025-02-07 15:47:24,039 - DEBUG - [protocol.py:745] - > PONG a8 ef 50 85 [binary, 4 bytes]
2025-02-07 15:47:34,695 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 15:47:34,695 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 15:47:34,697 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 15:47:34,697 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 15:47:34,697 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 15:47:34,697 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 15:47:34,697 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 15:47:34,697 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 15:52:16,491 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-07 15:52:16,491 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:52:16,491 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:52:16,491 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:52:18,577 - ERROR - [printer_monitor_service.py:102] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 85, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-07 15:57:19,938 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:57:19,941 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:57:19,941 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:57:19,942 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:57:19,989 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:57:19,989 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:57:19,990 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:57:19,991 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:57:19,991 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:57:19,992 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:57:20,231 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:57:20,232 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:57:20,232 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:57:20,233 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:57:20,233 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:57:20,234 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:57:20,463 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:57:20,464 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:20,778 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:20,778 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:20,778 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:57:20,779 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:57:20,779 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:57:20,779 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:21,005 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:21,006 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:21,006 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:21,226 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:21,227 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:21,227 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:21,506 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:21,507 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:21,507 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:21,719 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:21,719 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:21,720 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 15:57:21,720 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:57:21,720 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:57:21,940 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:57:21,941 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:57:21,941 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:57:21,942 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:57:21,943 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:57:21,943 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:57:21,943 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:57:21,945 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:57:21,978 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:57:21,979 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:57:21,979 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:57:21,980 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:57:21,981 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:57:21,981 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 15:57:21,982 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T20:57:21.980181",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 15:57:22,018 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:57:22,019 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:02:23,170 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:02:23,172 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:02:23,174 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:02:23,174 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:02:23,212 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:02:23,212 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:02:23,212 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:02:23,212 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:02:23,212 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:02:23,212 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:02:23,456 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:02:23,759 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 16:02:23,759 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:23,989 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:23,989 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:23,989 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 16:02:23,989 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:02:23,996 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:02:23,996 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:24,224 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:24,224 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:24,224 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:24,504 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:24,504 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:24,504 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:24,742 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:24,744 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:24,744 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:24,948 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:24,948 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:24,964 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 16:02:24,964 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:02:24,964 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:02:25,171 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:02:25,171 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:02:25,171 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:02:25,171 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:02:25,171 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:02:25,171 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:02:25,171 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:02:25,171 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:02:25,202 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:02:25,202 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:02:25,202 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:02:25,211 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:02:25,211 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:02:25,211 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:02:25,211 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:02:25.211822",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:02:25,253 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:02:25,253 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:07:26,397 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:07:26,401 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:07:26,402 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:07:26,404 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:07:26,456 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:07:26,458 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:07:26,459 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:07:26,461 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:07:26,463 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:07:26,464 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:07:26,778 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:07:26,779 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:07:26,780 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:07:26,780 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:07:26,780 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:07:26,781 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:07:27,025 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138874
2025-02-07 16:07:27,027 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:27,414 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:27,415 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:27,415 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138874, 'color_pages': 111083, 'bw_pages': None}
2025-02-07 16:07:27,416 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:07:27,416 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:07:27,417 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:27,682 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:27,682 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:27,683 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:27,899 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:27,899 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:27,901 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:28,117 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:28,118 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:28,118 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:28,326 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:28,327 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:28,327 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111083, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111083, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111083, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111083, 'max': 100, 'percentage': 100}}}
2025-02-07 16:07:28,328 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:07:28,328 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:07:28,591 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:07:28,592 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:07:28,592 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:07:28,593 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138874,
    "color_pages": 111083,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:07:28,593 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:07:28,594 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:07:28,594 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:07:28,594 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:07:28,627 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:07:28,627 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:07:28,628 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:07:28,629 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:07:28,629 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:07:28,630 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:07:28,630 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:07:28.629885",
  "printer_data": {
    "counters": {
      "total_pages": 138874,
      "color_pages": 111083,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:07:28,662 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:07:28,663 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:12:29,762 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:12:29,762 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:12:29,762 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:12:29,778 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:12:29,809 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:12:29,809 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:12:29,809 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:12:29,809 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:12:29,809 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:12:29,809 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:12:30,080 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:12:30,311 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138874
2025-02-07 16:12:30,311 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:30,592 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138874, 'color_pages': 111083, 'bw_pages': None}
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:30,811 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:30,811 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:30,811 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:31,019 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:31,019 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:31,019 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:31,239 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:31,239 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:31,239 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:31,514 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:31,514 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:31,514 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111083, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111083, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111083, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111083, 'max': 100, 'percentage': 100}}}
2025-02-07 16:12:31,514 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:12:31,514 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:12:31,725 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:12:31,725 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:12:31,725 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:12:31,725 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138874,
    "color_pages": 111083,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:12:31,725 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:12:31,725 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:12:31,725 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:12:31,725 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:12:31,748 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:12:31,762 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:12:31.748161",
  "printer_data": {
    "counters": {
      "total_pages": 138874,
      "color_pages": 111083,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:12:31,794 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:12:31,797 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:17:32,909 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:17:32,910 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:17:32,911 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:17:32,912 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:17:32,943 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:17:32,944 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:17:32,945 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:17:32,946 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:17:32,946 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:17:32,947 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:17:33,107 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:17:33,109 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:17:33,109 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:17:33,109 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:17:33,110 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:17:33,110 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:17:33,294 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138874
2025-02-07 16:17:33,295 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:33,466 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:33,467 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:33,467 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138874, 'color_pages': 111083, 'bw_pages': None}
2025-02-07 16:17:33,467 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:17:33,467 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:17:33,468 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:33,636 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:33,636 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:33,636 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:33,796 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:33,797 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:33,797 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:33,989 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:33,990 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:33,990 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:34,134 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:34,134 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:34,135 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111083, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111083, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111083, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111083, 'max': 100, 'percentage': 100}}}
2025-02-07 16:17:34,135 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:17:34,135 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:17:34,277 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:17:34,277 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:17:34,278 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:17:34,278 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138874,
    "color_pages": 111083,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:17:34,279 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:17:34,279 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:17:34,279 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:17:34,280 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:17:34,308 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:17:34,308 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:17:34,309 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:17:34,309 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:17:34,311 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:17:34,311 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:17:34,311 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:17:34.309959",
  "printer_data": {
    "counters": {
      "total_pages": 138874,
      "color_pages": 111083,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:17:34,338 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:17:34,338 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:22:35,432 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:22:35,432 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:22:35,432 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:22:35,432 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:22:35,460 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:22:35,461 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:22:35,461 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:22:35,462 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:22:35,463 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:22:35,463 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:22:35,693 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:22:35,693 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:22:35,693 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:22:35,693 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:22:35,695 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:22:35,696 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:22:35,864 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138876
2025-02-07 16:22:35,864 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,022 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,022 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,023 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138876, 'color_pages': 111085, 'bw_pages': None}
2025-02-07 16:22:36,023 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:22:36,024 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:22:36,024 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,222 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,222 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,223 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,394 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,394 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,396 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,673 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,673 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,673 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,825 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,826 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,826 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111085, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111085, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111085, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111085, 'max': 100, 'percentage': 100}}}
2025-02-07 16:22:36,826 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:22:36,826 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:22:37,021 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:22:37,022 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:22:37,022 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:22:37,022 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138876,
    "color_pages": 111085,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111085,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111085,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111085,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111085,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:22:37,024 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:22:37,024 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:22:37,024 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:22:37,024 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:22:37,053 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:22:37,053 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:22:37,054 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:22:37,055 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:22:37,055 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:22:37,057 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:22:37,057 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:22:37.055744",
  "printer_data": {
    "counters": {
      "total_pages": 138876,
      "color_pages": 111085,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111085,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111085,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111085,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111085,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:22:37,094 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:22:37,095 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:27:38,168 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:27:38,169 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:27:38,171 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:27:38,171 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:27:38,203 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:27:38,204 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:27:38,205 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:27:38,206 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:27:38,207 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:27:38,207 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:27:38,376 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:27:38,376 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:27:38,376 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:27:38,376 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:27:38,377 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:27:38,378 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:27:38,533 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:27:38,533 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:38,725 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:38,726 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:38,727 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:27:38,727 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:27:38,727 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:27:38,727 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:38,880 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:38,880 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:38,881 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:39,032 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:39,032 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:39,033 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:39,180 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:39,181 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:39,181 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:39,388 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:39,388 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:39,388 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:27:39,388 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:27:39,390 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:27:39,539 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:27:39,540 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:27:39,540 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:27:39,541 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:27:39,542 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:27:39,542 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:27:39,542 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:27:39,543 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:27:39,572 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:27:39,572 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:27:39,572 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:27:39,574 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:27:39,575 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:27:39,575 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:27:39,575 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:27:39.574069",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:27:39,607 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:27:39,607 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:32:40,679 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:32:40,680 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:32:40,680 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:32:40,680 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:32:40,711 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:32:40,711 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:32:40,712 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:32:40,713 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:32:40,713 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:32:40,713 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:32:40,920 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:32:40,921 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:32:40,921 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:32:40,922 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:32:40,922 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:32:40,922 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:32:41,163 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:32:41,164 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:41,347 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:41,347 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:41,348 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:32:41,348 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:32:41,349 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:32:41,349 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:41,507 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:41,507 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:41,507 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:41,716 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:41,717 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:41,717 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:41,975 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:41,975 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:41,975 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:42,163 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:42,164 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:42,164 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:32:42,164 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:32:42,166 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:32:42,327 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:32:42,327 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:32:42,328 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:32:42,328 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:32:42,329 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:32:42,329 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:32:42,329 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:32:42,330 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:32:42,368 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:32:42,369 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:32:42,370 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:32:42,372 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:32:42,372 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:32:42,374 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:32:42,376 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:32:42.371690",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:32:42,406 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:32:42,407 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:37:43,517 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:37:43,518 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:37:43,519 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:37:43,520 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:37:43,551 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:37:43,552 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:37:43,553 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:37:43,555 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:37:43,555 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:37:43,556 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:37:43,784 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:37:43,784 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:37:43,784 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:37:43,785 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:37:43,785 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:37:43,785 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:37:44,076 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:37:44,080 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:44,356 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:44,357 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:44,357 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:37:44,357 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:37:44,357 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:37:44,358 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:44,519 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:44,520 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:44,520 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:44,717 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:44,718 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:44,718 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:44,871 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:44,871 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:44,871 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:45,024 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:45,024 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:45,025 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:37:45,025 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:37:45,025 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:37:45,234 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:37:45,235 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:37:45,235 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:37:45,236 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:37:45,236 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:37:45,237 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:37:45,237 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:37:45,237 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:37:45,268 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:37:45,268 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:37:45,268 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:37:45,269 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:37:45,270 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:37:45,270 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:37:45,270 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:37:45.269209",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:37:45,295 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:37:45,295 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:42:46,390 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:42:46,391 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:42:46,392 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:42:46,392 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:42:46,423 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:42:46,425 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:42:46,426 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:42:46,427 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:42:46,428 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:42:46,428 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:42:46,588 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:42:46,588 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:42:46,588 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:42:46,588 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:42:46,590 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:42:46,590 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:42:46,744 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:42:46,744 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:46,893 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:46,894 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:46,894 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:42:46,895 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:42:46,895 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:42:46,895 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:47,105 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:47,106 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:47,106 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:47,258 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:47,259 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:47,259 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:47,409 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:47,410 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:47,410 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:47,599 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:47,599 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:47,600 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:42:47,600 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:42:47,601 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:42:47,751 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:42:47,752 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:42:47,752 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:42:47,752 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:42:47,753 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:42:47,753 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:42:47,753 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:42:47,753 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:42:47,786 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:42:47,786 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:42:47,787 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:42:47,787 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:42:47,788 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:42:47,788 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:42:47,788 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:42:47.787151",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:42:47,832 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:42:47,833 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:47:48,920 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:47:48,922 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:47:48,922 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:47:48,923 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:47:48,958 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:47:48,959 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:47:48,960 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:47:48,962 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:47:48,963 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:47:48,965 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:47:49,138 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:47:49,138 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:47:49,138 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:47:49,139 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:47:49,139 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:47:49,139 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:47:49,298 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:47:49,298 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:49,498 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:49,500 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:49,500 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:47:49,500 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:47:49,500 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:47:49,500 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:49,663 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:49,664 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:49,664 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:49,897 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:49,898 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:49,898 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:50,152 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:50,152 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:50,152 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:50,319 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:50,320 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:50,321 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:47:50,321 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:47:50,321 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:47:50,504 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:47:50,505 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:47:50,505 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:47:50,506 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:47:50,507 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:47:50,508 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:47:50,508 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:47:50,508 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:47:50,541 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:47:50,542 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:47:50,542 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:47:50,543 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:47:50,543 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:47:50,543 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:47:50,544 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:47:50.543676",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:47:50,573 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:47:50,574 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:52:51,669 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:52:51,671 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:52:51,672 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:52:51,673 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:52:51,706 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:52:51,707 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:52:51,707 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:52:51,709 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:52:51,710 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:52:51,710 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:52:51,871 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:52:51,871 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:52:51,872 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:52:51,872 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:52:51,872 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:52:51,873 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:52:52,072 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 16:52:52,072 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,229 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,229 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,230 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 16:52:52,231 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:52:52,231 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:52:52,231 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,386 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,386 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,386 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,573 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,574 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,574 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,733 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,734 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,734 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,883 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,884 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,884 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 16:52:52,885 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:52:52,885 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:52:53,031 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:52:53,032 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:52:53,032 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:52:53,032 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:52:53,033 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:52:53,033 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:52:53,033 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:52:53,033 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:52:53,067 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:52:53,068 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:52:53,069 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:52:53,071 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:52:53,072 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:52:53,074 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:52:53,075 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:52:53.071814",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:52:53,106 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:52:53,107 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:57:54,187 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:57:54,189 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:57:54,189 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:57:54,189 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:57:54,223 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:57:54,224 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:57:54,224 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:57:54,225 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:57:54,225 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:57:54,226 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:57:54,427 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:57:54,427 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:57:54,428 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:57:54,428 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:57:54,428 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:57:54,428 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:57:54,582 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 16:57:54,582 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:54,729 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:54,730 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:54,730 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 16:57:54,731 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:57:54,731 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:57:54,731 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:54,918 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:54,919 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:54,919 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:55,071 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:55,071 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:55,071 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:55,222 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:55,222 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:55,223 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:55,371 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:55,373 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:55,373 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 16:57:55,373 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:57:55,374 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:57:55,563 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:57:55,564 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:57:55,564 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:57:55,564 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:57:55,564 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:57:55,564 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:57:55,566 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:57:55,566 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:57:55,601 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:57:55,602 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:57:55,603 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:57:55,605 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:57:55,607 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:57:55,608 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:57:55,608 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:57:55.605799",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:57:55,635 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:57:55,635 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 17:02:56,711 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:02:56,712 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:02:56,713 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:02:56,713 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:02:56,747 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:02:56,748 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:02:56,749 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:02:56,750 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 17:02:56,751 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 17:02:56,751 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 17:02:56,922 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 17:02:56,922 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 17:02:56,923 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 17:02:56,923 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 17:02:56,923 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:02:56,924 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 17:02:57,085 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 17:02:57,085 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:57,277 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:57,278 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:57,278 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 17:02:57,278 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 17:02:57,280 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:02:57,280 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:57,456 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:57,457 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:57,457 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:57,642 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:57,643 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:57,643 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:57,807 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:57,808 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:57,809 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:58,022 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:58,023 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:58,023 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 17:02:58,023 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 17:02:58,023 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 17:02:58,198 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 17:02:58,199 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 17:02:58,200 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 17:02:58,200 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 17:02:58,201 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 17:02:58,201 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:02:58,202 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:02:58,202 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:02:58,235 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:02:58,235 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:02:58,236 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:02:58,237 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 17:02:58,239 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:02:58,239 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 17:02:58,240 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T22:02:58.237316",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 17:02:58,289 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 17:02:58,290 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 17:07:59,371 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:07:59,372 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:07:59,373 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:07:59,373 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:07:59,405 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:07:59,406 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:07:59,406 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:07:59,407 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 17:07:59,407 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 17:07:59,408 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 17:07:59,567 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 17:07:59,567 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 17:07:59,568 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 17:07:59,568 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 17:07:59,568 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:07:59,569 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 17:07:59,761 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 17:07:59,761 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:07:59,913 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:07:59,914 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:07:59,914 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 17:07:59,915 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 17:07:59,916 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:07:59,916 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:08:00,068 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:08:00,068 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:08:00,068 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:08:00,214 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:08:00,214 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:08:00,215 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:08:00,411 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:08:00,411 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:08:00,412 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:08:00,565 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:08:00,566 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:08:00,566 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 17:08:00,567 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 17:08:00,567 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 17:08:00,713 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 17:08:00,714 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 17:08:00,715 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 17:08:00,715 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 17:08:00,716 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 17:08:00,716 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:08:00,716 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:08:00,716 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:08:00,742 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:08:00,742 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:08:00,742 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:08:00,743 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 17:08:00,743 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:08:00,743 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 17:08:00,744 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T22:08:00.743647",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 17:08:00,772 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 17:08:00,773 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 17:13:01,864 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:13:01,866 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:13:01,867 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:13:01,867 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:13:01,962 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:13:01,978 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:13:01,980 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:13:01,983 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 17:13:01,983 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 17:13:01,986 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 17:13:02,239 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 17:13:02,239 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 17:13:02,239 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 17:13:02,241 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 17:13:02,241 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:13:02,241 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 17:13:02,443 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 17:13:02,443 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:02,619 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:02,619 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:02,620 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 17:13:02,620 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 17:13:02,620 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:13:02,620 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:02,780 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:02,794 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:02,794 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:03,003 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:03,003 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:03,004 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:03,178 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:03,178 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:03,178 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:03,330 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:03,330 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:03,330 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 17:13:03,330 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 17:13:03,330 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 17:13:03,529 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 17:13:03,532 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 17:13:03,532 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 17:13:03,532 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 17:13:03,532 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 17:13:03,532 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:13:03,532 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:13:03,532 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:13:03,587 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:13:03,588 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:13:03,589 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:13:03,590 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 17:13:03,590 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:13:03,591 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 17:13:03,592 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T22:13:03.590334",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 17:13:03,665 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 17:13:03,666 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 17:18:04,871 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:18:04,872 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:18:04,872 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:18:04,872 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:18:04,889 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:18:04,890 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:23:06,018 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:23:06,020 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:23:06,021 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:23:06,022 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:23:06,041 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:23:06,042 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:28:07,180 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:28:07,187 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:28:07,187 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:28:07,187 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:28:07,222 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:28:07,222 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:33:08,344 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:33:08,345 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:33:08,346 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:33:08,346 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:33:08,365 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:33:08,366 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
