2025-02-07 13:51:48,382 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 13:51:48,411 - DEBUG - [printer_monitor_service.py:43] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 13:51:48,422 - DEBUG - [printer_monitor_service.py:46] -   SNMP Community: public
2025-02-07 13:51:48,422 - DEBUG - [printer_monitor_service.py:47] -   SNMP Port: 161
2025-02-07 13:51:48,422 - DEBUG - [printer_monitor_service.py:48] -   SNMP Timeout: 2s
2025-02-07 13:51:48,422 - DEBUG - [printer_monitor_service.py:49] -   SNMP Retries: 1
2025-02-07 13:51:48,463 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 13:51:48,467 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 13:51:48,469 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 13:51:48,470 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 13:51:48,472 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 13:51:48,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: SqQIeGWwwRbXyBwfAj9LVg==
2025-02-07 13:51:48,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 13:51:48,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 13:51:48,473 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 13:51:48,501 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 13:51:48,503 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 13:51:48,503 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 13:51:48,503 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: Y8n37JH31M6z1MRH1uAIbLh6q28=
2025-02-07 13:51:48,503 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 13:51:48,506 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 18:51:47 GMT
2025-02-07 13:51:48,506 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 13:51:48,506 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 13:51:51,319 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 13:52:08,573 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:52:08,573 - DEBUG - [protocol.py:745] - > PING 67 31 88 85 [binary, 4 bytes]
2025-02-07 13:52:08,582 - DEBUG - [protocol.py:599] - < PONG 67 31 88 85 [binary, 4 bytes]
2025-02-07 13:52:08,582 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:52:28,579 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:52:28,579 - DEBUG - [protocol.py:745] - > PING 7f a4 92 37 [binary, 4 bytes]
2025-02-07 13:52:28,579 - DEBUG - [protocol.py:599] - < PING e3 56 8d 9b [binary, 4 bytes]
2025-02-07 13:52:28,584 - DEBUG - [protocol.py:745] - > PONG e3 56 8d 9b [binary, 4 bytes]
2025-02-07 13:52:28,584 - DEBUG - [protocol.py:599] - < PONG 7f a4 92 37 [binary, 4 bytes]
2025-02-07 13:52:28,584 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:52:48,579 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:52:48,579 - DEBUG - [protocol.py:745] - > PING df 28 49 c3 [binary, 4 bytes]
2025-02-07 13:52:48,585 - DEBUG - [protocol.py:599] - < PONG df 28 49 c3 [binary, 4 bytes]
2025-02-07 13:52:48,586 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:52:48,594 - DEBUG - [protocol.py:599] - < PING '\x7ft\x15b' [text, 4 bytes]
2025-02-07 13:52:48,595 - DEBUG - [protocol.py:745] - > PONG '\x7ft\x15b' [text, 4 bytes]
2025-02-07 13:53:08,589 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:53:08,591 - DEBUG - [protocol.py:745] - > PING '0M"T' [text, 4 bytes]
2025-02-07 13:53:08,600 - DEBUG - [protocol.py:599] - < PONG '0M"T' [text, 4 bytes]
2025-02-07 13:53:08,601 - DEBUG - [protocol.py:599] - < PING 0b d6 ff a7 [binary, 4 bytes]
2025-02-07 13:53:08,604 - DEBUG - [protocol.py:745] - > PONG 0b d6 ff a7 [binary, 4 bytes]
2025-02-07 13:53:08,610 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:53:28,605 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:53:28,610 - DEBUG - [protocol.py:745] - > PING 72 a1 bc 9b [binary, 4 bytes]
2025-02-07 13:53:28,616 - DEBUG - [protocol.py:599] - < PING 92 dd d2 80 [binary, 4 bytes]
2025-02-07 13:53:28,616 - DEBUG - [protocol.py:745] - > PONG 92 dd d2 80 [binary, 4 bytes]
2025-02-07 13:53:28,621 - DEBUG - [protocol.py:599] - < PONG 72 a1 bc 9b [binary, 4 bytes]
2025-02-07 13:53:28,622 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:53:48,610 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:53:48,613 - DEBUG - [protocol.py:745] - > PING e0 58 7d 2b [binary, 4 bytes]
2025-02-07 13:53:48,619 - DEBUG - [protocol.py:599] - < PONG e0 58 7d 2b [binary, 4 bytes]
2025-02-07 13:53:48,625 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:54:08,628 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:54:08,630 - DEBUG - [protocol.py:745] - > PING cf 15 9b d9 [binary, 4 bytes]
2025-02-07 13:54:08,638 - DEBUG - [protocol.py:599] - < PONG cf 15 9b d9 [binary, 4 bytes]
2025-02-07 13:54:08,639 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:54:08,658 - DEBUG - [protocol.py:599] - < PING dc ca 60 a4 [binary, 4 bytes]
2025-02-07 13:54:08,661 - DEBUG - [protocol.py:745] - > PONG dc ca 60 a4 [binary, 4 bytes]
2025-02-07 13:54:28,644 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:54:28,645 - DEBUG - [protocol.py:745] - > PING d8 ee 07 f1 [binary, 4 bytes]
2025-02-07 13:54:28,653 - DEBUG - [protocol.py:599] - < PONG d8 ee 07 f1 [binary, 4 bytes]
2025-02-07 13:54:28,653 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:54:28,666 - DEBUG - [protocol.py:599] - < PING b6 27 67 65 [binary, 4 bytes]
2025-02-07 13:54:28,666 - DEBUG - [protocol.py:745] - > PONG b6 27 67 65 [binary, 4 bytes]
2025-02-07 13:54:48,650 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:54:48,652 - DEBUG - [protocol.py:745] - > PING 5e 5d 61 b6 [binary, 4 bytes]
2025-02-07 13:54:48,661 - DEBUG - [protocol.py:599] - < PONG 5e 5d 61 b6 [binary, 4 bytes]
2025-02-07 13:54:48,663 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:54:48,675 - DEBUG - [protocol.py:599] - < PING de ea ec 49 [binary, 4 bytes]
2025-02-07 13:54:48,676 - DEBUG - [protocol.py:745] - > PONG de ea ec 49 [binary, 4 bytes]
2025-02-07 13:55:08,650 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:55:08,651 - DEBUG - [protocol.py:745] - > PING d5 ba a6 de [binary, 4 bytes]
2025-02-07 13:55:08,657 - DEBUG - [protocol.py:599] - < PONG d5 ba a6 de [binary, 4 bytes]
2025-02-07 13:55:08,658 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:55:08,683 - DEBUG - [protocol.py:599] - < PING 2f 34 6a ed [binary, 4 bytes]
2025-02-07 13:55:08,683 - DEBUG - [protocol.py:745] - > PONG 2f 34 6a ed [binary, 4 bytes]
2025-02-07 13:55:23,987 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 13:55:23,987 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 13:55:23,992 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 13:55:23,994 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 13:55:23,994 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 13:55:23,994 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 13:55:23,996 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 13:55:33,431 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 13:55:33,431 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 13:55:33,431 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 13:55:33,443 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 13:55:33,444 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 13:55:33,444 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 13:55:33,473 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 13:55:33,473 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: irr6r1WL+kuLFkRFi+NgZw==
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 13:55:33,473 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 13:55:33,503 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 13:55:33,504 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 13:55:33,504 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 13:55:33,505 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: ZhzeohlcV+7Uzy3r9rHNczdwapw=
2025-02-07 13:55:33,505 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 13:55:33,505 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 18:55:32 GMT
2025-02-07 13:55:33,506 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 13:55:33,506 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 13:55:33,506 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 13:55:34,584 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 13:55:34,585 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 13:55:34,585 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 13:55:34,585 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 13:55:34,610 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 13:55:34,610 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 13:55:34,610 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 13:55:34,610 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 13:55:34,610 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 13:55:34,610 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 13:55:34,768 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 13:55:34,768 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 13:55:34,768 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 13:55:34,768 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 13:55:34,804 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 13:55:34,805 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 13:55:34,805 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 13:55:34,807 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 13:55:34,808 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 13:55:34,809 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 13:55:34,984 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 13:55:34,984 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,169 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,169 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 13:55:35,169 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 13:55:35,169 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 13:55:35,181 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 13:55:35,181 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,319 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,319 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,470 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,470 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,683 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,683 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 13:55:35,848 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 13:55:35,848 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 13:55:35,849 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 13:55:35,849 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 13:55:36,012 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 13:55:36,012 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 13:55:36,013 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 13:55:36,013 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T18:55:36.013107",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 13:55:36,014 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 13:55:36,014 - DEBUG - [printer_monitor_service.py:418] - Datos procesados para enviar: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T18:55:36.013107",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 13:55:36,014 - DEBUG - [printer_monitor_service.py:446] - Enviando datos a ws://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 13:55:36,015 - DEBUG - [printer_monitor_service.py:447] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 13:55:36,015 - DEBUG - [printer_monitor_service.py:448] - Params: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5'}
2025-02-07 13:55:36,024 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 13:55:36,035 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 13:55:36,035 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 13:55:36,036 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 13:55:53,503 - DEBUG - [protocol.py:599] - < PING bd 69 7a 40 [binary, 4 bytes]
2025-02-07 13:55:53,507 - DEBUG - [protocol.py:745] - > PONG bd 69 7a 40 [binary, 4 bytes]
2025-02-07 13:55:53,507 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:55:53,507 - DEBUG - [protocol.py:745] - > PING 9a 47 0c cf [binary, 4 bytes]
2025-02-07 13:55:53,514 - DEBUG - [protocol.py:599] - < PONG 9a 47 0c cf [binary, 4 bytes]
2025-02-07 13:55:53,514 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:56:13,513 - DEBUG - [protocol.py:599] - < PING fa 91 3a 1c [binary, 4 bytes]
2025-02-07 13:56:13,514 - DEBUG - [protocol.py:745] - > PONG fa 91 3a 1c [binary, 4 bytes]
2025-02-07 13:56:13,515 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:56:13,515 - DEBUG - [protocol.py:745] - > PING 0c dc 75 2c [binary, 4 bytes]
2025-02-07 13:56:13,520 - DEBUG - [protocol.py:599] - < PONG 0c dc 75 2c [binary, 4 bytes]
2025-02-07 13:56:13,521 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:56:33,509 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:56:33,512 - DEBUG - [protocol.py:745] - > PING 0f 71 25 ff [binary, 4 bytes]
2025-02-07 13:56:33,522 - DEBUG - [protocol.py:599] - < PONG 0f 71 25 ff [binary, 4 bytes]
2025-02-07 13:56:33,523 - DEBUG - [protocol.py:599] - < PING 83 7f 8b a9 [binary, 4 bytes]
2025-02-07 13:56:33,528 - DEBUG - [protocol.py:745] - > PONG 83 7f 8b a9 [binary, 4 bytes]
2025-02-07 13:56:33,532 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:56:53,528 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:56:53,531 - DEBUG - [protocol.py:745] - > PING 37 76 e7 e0 [binary, 4 bytes]
2025-02-07 13:56:53,536 - DEBUG - [protocol.py:599] - < PING b5 da 26 a9 [binary, 4 bytes]
2025-02-07 13:56:53,538 - DEBUG - [protocol.py:745] - > PONG b5 da 26 a9 [binary, 4 bytes]
2025-02-07 13:56:53,541 - DEBUG - [protocol.py:599] - < PONG 37 76 e7 e0 [binary, 4 bytes]
2025-02-07 13:56:53,545 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:57:13,535 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:57:13,536 - DEBUG - [protocol.py:745] - > PING f1 90 9e c3 [binary, 4 bytes]
2025-02-07 13:57:13,544 - DEBUG - [protocol.py:599] - < PONG f1 90 9e c3 [binary, 4 bytes]
2025-02-07 13:57:13,550 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:57:13,550 - DEBUG - [protocol.py:599] - < PING 61 97 2f ed [binary, 4 bytes]
2025-02-07 13:57:13,551 - DEBUG - [protocol.py:745] - > PONG 61 97 2f ed [binary, 4 bytes]
2025-02-07 13:57:33,548 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:57:33,549 - DEBUG - [protocol.py:745] - > PING 68 e2 84 3f [binary, 4 bytes]
2025-02-07 13:57:33,556 - DEBUG - [protocol.py:599] - < PING df b6 47 e4 [binary, 4 bytes]
2025-02-07 13:57:33,557 - DEBUG - [protocol.py:745] - > PONG df b6 47 e4 [binary, 4 bytes]
2025-02-07 13:57:33,559 - DEBUG - [protocol.py:599] - < PONG 68 e2 84 3f [binary, 4 bytes]
2025-02-07 13:57:33,566 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:57:53,551 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:57:53,553 - DEBUG - [protocol.py:745] - > PING 0f 2d 0c 95 [binary, 4 bytes]
2025-02-07 13:57:53,555 - DEBUG - [protocol.py:599] - < PONG 0f 2d 0c 95 [binary, 4 bytes]
2025-02-07 13:57:53,559 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:57:53,568 - DEBUG - [protocol.py:599] - < PING a2 e6 af b5 [binary, 4 bytes]
2025-02-07 13:57:53,568 - DEBUG - [protocol.py:745] - > PONG a2 e6 af b5 [binary, 4 bytes]
2025-02-07 13:58:13,555 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:58:13,555 - DEBUG - [protocol.py:745] - > PING 9e 1c e9 6a [binary, 4 bytes]
2025-02-07 13:58:13,562 - DEBUG - [protocol.py:599] - < PONG 9e 1c e9 6a [binary, 4 bytes]
2025-02-07 13:58:13,562 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:58:13,574 - DEBUG - [protocol.py:599] - < PING fc cc 83 af [binary, 4 bytes]
2025-02-07 13:58:13,576 - DEBUG - [protocol.py:745] - > PONG fc cc 83 af [binary, 4 bytes]
2025-02-07 13:58:33,563 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:58:33,565 - DEBUG - [protocol.py:745] - > PING c4 15 83 e9 [binary, 4 bytes]
2025-02-07 13:58:33,572 - DEBUG - [protocol.py:599] - < PONG c4 15 83 e9 [binary, 4 bytes]
2025-02-07 13:58:33,576 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:58:33,583 - DEBUG - [protocol.py:599] - < PING e5 9b 9d ff [binary, 4 bytes]
2025-02-07 13:58:33,583 - DEBUG - [protocol.py:745] - > PONG e5 9b 9d ff [binary, 4 bytes]
2025-02-07 13:58:53,573 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:58:53,576 - DEBUG - [protocol.py:745] - > PING 52 ba c9 bf [binary, 4 bytes]
2025-02-07 13:58:53,584 - DEBUG - [protocol.py:599] - < PONG 52 ba c9 bf [binary, 4 bytes]
2025-02-07 13:58:53,586 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:58:53,608 - DEBUG - [protocol.py:599] - < PING 5a 61 8e df [binary, 4 bytes]
2025-02-07 13:58:53,609 - DEBUG - [protocol.py:745] - > PONG 5a 61 8e df [binary, 4 bytes]
2025-02-07 13:59:13,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:59:13,594 - DEBUG - [protocol.py:745] - > PING 35 b5 b9 68 [binary, 4 bytes]
2025-02-07 13:59:13,602 - DEBUG - [protocol.py:599] - < PONG 35 b5 b9 68 [binary, 4 bytes]
2025-02-07 13:59:13,604 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:59:13,619 - DEBUG - [protocol.py:599] - < PING 77 2d 29 e3 [binary, 4 bytes]
2025-02-07 13:59:13,622 - DEBUG - [protocol.py:745] - > PONG 77 2d 29 e3 [binary, 4 bytes]
2025-02-07 13:59:33,610 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:59:33,611 - DEBUG - [protocol.py:745] - > PING 17 d8 38 26 [binary, 4 bytes]
2025-02-07 13:59:33,619 - DEBUG - [protocol.py:599] - < PONG 17 d8 38 26 [binary, 4 bytes]
2025-02-07 13:59:33,621 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:59:33,636 - DEBUG - [protocol.py:599] - < PING e9 09 de a3 [binary, 4 bytes]
2025-02-07 13:59:33,638 - DEBUG - [protocol.py:745] - > PONG e9 09 de a3 [binary, 4 bytes]
2025-02-07 13:59:53,618 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 13:59:53,618 - DEBUG - [protocol.py:745] - > PING 5e e7 47 78 [binary, 4 bytes]
2025-02-07 13:59:53,626 - DEBUG - [protocol.py:599] - < PONG 5e e7 47 78 [binary, 4 bytes]
2025-02-07 13:59:53,627 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 13:59:53,646 - DEBUG - [protocol.py:599] - < PING 'Ւv\x05' [text, 4 bytes]
2025-02-07 13:59:53,647 - DEBUG - [protocol.py:745] - > PONG 'Ւv\x05' [text, 4 bytes]
2025-02-07 14:00:13,647 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:00:13,648 - DEBUG - [protocol.py:745] - > PING 7f 43 1d 91 [binary, 4 bytes]
2025-02-07 14:00:13,650 - DEBUG - [protocol.py:599] - < PING 6b 89 b0 90 [binary, 4 bytes]
2025-02-07 14:00:13,650 - DEBUG - [protocol.py:745] - > PONG 6b 89 b0 90 [binary, 4 bytes]
2025-02-07 14:00:13,650 - DEBUG - [protocol.py:599] - < PONG 7f 43 1d 91 [binary, 4 bytes]
2025-02-07 14:00:13,650 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:00:33,660 - DEBUG - [protocol.py:599] - < PING 6a 2f ed 54 [binary, 4 bytes]
2025-02-07 14:00:33,660 - DEBUG - [protocol.py:745] - > PONG 6a 2f ed 54 [binary, 4 bytes]
2025-02-07 14:00:33,660 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:00:33,660 - DEBUG - [protocol.py:745] - > PING c8 c1 a8 ce [binary, 4 bytes]
2025-02-07 14:00:33,671 - DEBUG - [protocol.py:599] - < PONG c8 c1 a8 ce [binary, 4 bytes]
2025-02-07 14:00:33,671 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:00:37,190 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:00:37,191 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:00:37,191 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:00:37,191 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:00:37,224 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:00:37,224 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:00:37,229 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:00:37,229 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:00:37,229 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:00:37,229 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:00:37,458 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:00:37,458 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:00:37,761 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:00:37,761 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:37,995 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:37,995 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:00:37,995 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:00:37,995 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:00:38,010 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:00:38,010 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:38,225 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:38,225 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:38,523 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:38,523 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:38,745 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:38,745 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:00:38,966 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:00:38,966 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:00:38,966 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:00:38,966 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:00:39,184 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:00:39,185 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:00:39,185 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:00:39,186 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:00:39.185225",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:00:39,186 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:00:39,187 - DEBUG - [printer_monitor_service.py:418] - Datos procesados para enviar: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:00:39.185225",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:00:39,188 - DEBUG - [printer_monitor_service.py:446] - Enviando datos a ws://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:00:39,189 - DEBUG - [printer_monitor_service.py:447] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:00:39,189 - DEBUG - [printer_monitor_service.py:448] - Params: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5'}
2025-02-07 14:00:39,283 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 14:00:39,283 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 14:00:39,283 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 14:00:39,283 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:00:53,671 - DEBUG - [protocol.py:599] - < PING e9 72 c7 94 [binary, 4 bytes]
2025-02-07 14:00:53,672 - DEBUG - [protocol.py:745] - > PONG e9 72 c7 94 [binary, 4 bytes]
2025-02-07 14:00:53,674 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:00:53,675 - DEBUG - [protocol.py:745] - > PING f2 51 09 d2 [binary, 4 bytes]
2025-02-07 14:00:53,682 - DEBUG - [protocol.py:599] - < PONG f2 51 09 d2 [binary, 4 bytes]
2025-02-07 14:00:53,686 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:01:13,673 - DEBUG - [protocol.py:599] - < PING f1 8e f9 c6 [binary, 4 bytes]
2025-02-07 14:01:13,673 - DEBUG - [protocol.py:745] - > PONG f1 8e f9 c6 [binary, 4 bytes]
2025-02-07 14:01:13,673 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:01:13,673 - DEBUG - [protocol.py:745] - > PING dc 60 20 1b [binary, 4 bytes]
2025-02-07 14:01:13,689 - DEBUG - [protocol.py:599] - < PONG dc 60 20 1b [binary, 4 bytes]
2025-02-07 14:01:13,692 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:01:33,673 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:01:33,677 - DEBUG - [protocol.py:745] - > PING 8a d8 8c 98 [binary, 4 bytes]
2025-02-07 14:01:33,683 - DEBUG - [protocol.py:599] - < PONG 8a d8 8c 98 [binary, 4 bytes]
2025-02-07 14:01:33,688 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:01:33,690 - DEBUG - [protocol.py:599] - < PING 27 86 c6 76 [binary, 4 bytes]
2025-02-07 14:01:33,691 - DEBUG - [protocol.py:745] - > PONG 27 86 c6 76 [binary, 4 bytes]
2025-02-07 14:01:53,693 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:01:53,695 - DEBUG - [protocol.py:745] - > PING 29 a6 f7 41 [binary, 4 bytes]
2025-02-07 14:01:53,695 - DEBUG - [protocol.py:599] - < PING 't\x18e\x10' [text, 4 bytes]
2025-02-07 14:01:53,695 - DEBUG - [protocol.py:745] - > PONG 't\x18e\x10' [text, 4 bytes]
2025-02-07 14:01:53,701 - DEBUG - [protocol.py:599] - < PONG 29 a6 f7 41 [binary, 4 bytes]
2025-02-07 14:01:53,707 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:02:13,707 - DEBUG - [protocol.py:599] - < PING 21 18 82 66 [binary, 4 bytes]
2025-02-07 14:02:13,707 - DEBUG - [protocol.py:745] - > PONG 21 18 82 66 [binary, 4 bytes]
2025-02-07 14:02:13,707 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:02:13,707 - DEBUG - [protocol.py:745] - > PING 80 2a 9e 59 [binary, 4 bytes]
2025-02-07 14:02:13,722 - DEBUG - [protocol.py:599] - < PONG 80 2a 9e 59 [binary, 4 bytes]
2025-02-07 14:02:13,723 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:02:33,710 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:02:33,711 - DEBUG - [protocol.py:745] - > PING 11 ff 42 0d [binary, 4 bytes]
2025-02-07 14:02:33,717 - DEBUG - [protocol.py:599] - < PONG 11 ff 42 0d [binary, 4 bytes]
2025-02-07 14:02:33,717 - DEBUG - [protocol.py:599] - < PING df de 54 bb [binary, 4 bytes]
2025-02-07 14:02:33,717 - DEBUG - [protocol.py:745] - > PONG df de 54 bb [binary, 4 bytes]
2025-02-07 14:02:33,720 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:02:53,718 - DEBUG - [protocol.py:599] - < PING '@O\x14[' [text, 4 bytes]
2025-02-07 14:02:53,718 - DEBUG - [protocol.py:745] - > PONG '@O\x14[' [text, 4 bytes]
2025-02-07 14:02:53,718 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:02:53,718 - DEBUG - [protocol.py:745] - > PING 70 92 c7 a6 [binary, 4 bytes]
2025-02-07 14:02:53,736 - DEBUG - [protocol.py:599] - < PONG 70 92 c7 a6 [binary, 4 bytes]
2025-02-07 14:02:53,736 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:03:13,724 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:03:13,725 - DEBUG - [protocol.py:745] - > PING 8c af c7 fb [binary, 4 bytes]
2025-02-07 14:03:13,733 - DEBUG - [protocol.py:599] - < PONG 8c af c7 fb [binary, 4 bytes]
2025-02-07 14:03:13,734 - DEBUG - [protocol.py:599] - < PING 'zm\x10x' [text, 4 bytes]
2025-02-07 14:03:13,734 - DEBUG - [protocol.py:745] - > PONG 'zm\x10x' [text, 4 bytes]
2025-02-07 14:03:13,736 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:03:33,737 - DEBUG - [protocol.py:599] - < PING 4b 60 0c 95 [binary, 4 bytes]
2025-02-07 14:03:33,737 - DEBUG - [protocol.py:745] - > PONG 4b 60 0c 95 [binary, 4 bytes]
2025-02-07 14:03:33,737 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:03:33,737 - DEBUG - [protocol.py:745] - > PING 35 58 a1 56 [binary, 4 bytes]
2025-02-07 14:03:33,747 - DEBUG - [protocol.py:599] - < PONG 35 58 a1 56 [binary, 4 bytes]
2025-02-07 14:03:33,748 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:03:53,737 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:03:53,739 - DEBUG - [protocol.py:745] - > PING cd 1b 11 a3 [binary, 4 bytes]
2025-02-07 14:03:53,746 - DEBUG - [protocol.py:599] - < PONG cd 1b 11 a3 [binary, 4 bytes]
2025-02-07 14:03:53,748 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:03:53,757 - DEBUG - [protocol.py:599] - < PING db 93 42 d8 [binary, 4 bytes]
2025-02-07 14:03:53,760 - DEBUG - [protocol.py:745] - > PONG db 93 42 d8 [binary, 4 bytes]
2025-02-07 14:04:13,756 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:04:13,758 - DEBUG - [protocol.py:745] - > PING 69 05 9b 66 [binary, 4 bytes]
2025-02-07 14:04:13,766 - DEBUG - [protocol.py:599] - < PONG 69 05 9b 66 [binary, 4 bytes]
2025-02-07 14:04:13,766 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:04:13,773 - DEBUG - [protocol.py:599] - < PING 23 2d 11 dc [binary, 4 bytes]
2025-02-07 14:04:13,773 - DEBUG - [protocol.py:745] - > PONG 23 2d 11 dc [binary, 4 bytes]
2025-02-07 14:04:33,773 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:04:33,773 - DEBUG - [protocol.py:745] - > PING bf ec 8f 2d [binary, 4 bytes]
2025-02-07 14:04:33,773 - DEBUG - [protocol.py:599] - < PONG bf ec 8f 2d [binary, 4 bytes]
2025-02-07 14:04:33,773 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:04:33,773 - DEBUG - [protocol.py:599] - < PING 83 4c fa 81 [binary, 4 bytes]
2025-02-07 14:04:33,790 - DEBUG - [protocol.py:745] - > PONG 83 4c fa 81 [binary, 4 bytes]
2025-02-07 14:04:53,790 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:04:53,790 - DEBUG - [protocol.py:745] - > PING 9d 4e 7a 7f [binary, 4 bytes]
2025-02-07 14:04:53,794 - DEBUG - [protocol.py:599] - < PONG 9d 4e 7a 7f [binary, 4 bytes]
2025-02-07 14:04:53,794 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:04:53,794 - DEBUG - [protocol.py:599] - < PING 22 c0 d7 e2 [binary, 4 bytes]
2025-02-07 14:04:53,801 - DEBUG - [protocol.py:745] - > PONG 22 c0 d7 e2 [binary, 4 bytes]
2025-02-07 14:05:13,790 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:05:13,792 - DEBUG - [protocol.py:745] - > PING c6 a0 bd 67 [binary, 4 bytes]
2025-02-07 14:05:13,802 - DEBUG - [protocol.py:599] - < PONG c6 a0 bd 67 [binary, 4 bytes]
2025-02-07 14:05:13,804 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:05:13,808 - DEBUG - [protocol.py:599] - < PING 'vF\x04%' [text, 4 bytes]
2025-02-07 14:05:13,809 - DEBUG - [protocol.py:745] - > PONG 'vF\x04%' [text, 4 bytes]
2025-02-07 14:05:33,810 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:05:33,810 - DEBUG - [protocol.py:745] - > PING 40 d4 19 e0 [binary, 4 bytes]
2025-02-07 14:05:33,817 - DEBUG - [protocol.py:599] - < PONG 40 d4 19 e0 [binary, 4 bytes]
2025-02-07 14:05:33,817 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:05:33,821 - DEBUG - [protocol.py:599] - < PING bc f4 82 f2 [binary, 4 bytes]
2025-02-07 14:05:33,821 - DEBUG - [protocol.py:745] - > PONG bc f4 82 f2 [binary, 4 bytes]
2025-02-07 14:05:40,374 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:05:40,375 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:05:40,376 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:05:40,376 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:05:40,409 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:05:40,409 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:05:40,410 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:05:40,411 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:05:40,411 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:05:40,412 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:05:40,715 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:05:40,715 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:05:40,716 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:05:40,716 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:05:40,716 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:05:40,717 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:05:40,956 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:05:40,957 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:41,187 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:41,187 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:05:41,187 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:05:41,188 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:05:41,189 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:05:41,189 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:41,489 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:41,490 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:41,717 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:41,717 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:41,949 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:41,950 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:05:42,207 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:05:42,208 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:05:42,208 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:05:42,210 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:05:42,427 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:05:42,428 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:05:42,428 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:05:42,429 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:05:42.428708",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:05:42,431 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:05:42,432 - DEBUG - [printer_monitor_service.py:418] - Datos procesados para enviar: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:05:42.428708",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:05:42,433 - DEBUG - [printer_monitor_service.py:446] - Enviando datos a ws://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:05:42,434 - DEBUG - [printer_monitor_service.py:447] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:05:42,435 - DEBUG - [printer_monitor_service.py:448] - Params: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5'}
2025-02-07 14:05:42,454 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 14:05:42,455 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 14:05:42,455 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 14:05:42,455 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:05:53,801 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:05:53,805 - DEBUG - [protocol.py:745] - > PING 8a 8d 6a 38 [binary, 4 bytes]
2025-02-07 14:05:53,813 - DEBUG - [protocol.py:599] - < PONG 8a 8d 6a 38 [binary, 4 bytes]
2025-02-07 14:05:53,820 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:05:53,827 - DEBUG - [protocol.py:599] - < PING 4c da 08 b7 [binary, 4 bytes]
2025-02-07 14:05:53,828 - DEBUG - [protocol.py:745] - > PONG 4c da 08 b7 [binary, 4 bytes]
2025-02-07 14:06:13,830 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:06:13,831 - DEBUG - [protocol.py:745] - > PING ec 02 29 f7 [binary, 4 bytes]
2025-02-07 14:06:13,836 - DEBUG - [protocol.py:599] - < PING 81 5a 2a 00 [binary, 4 bytes]
2025-02-07 14:06:13,837 - DEBUG - [protocol.py:745] - > PONG 81 5a 2a 00 [binary, 4 bytes]
2025-02-07 14:06:13,838 - DEBUG - [protocol.py:599] - < PONG ec 02 29 f7 [binary, 4 bytes]
2025-02-07 14:06:13,840 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:06:33,835 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:06:33,838 - DEBUG - [protocol.py:745] - > PING 30 3f 71 a6 [binary, 4 bytes]
2025-02-07 14:06:33,845 - DEBUG - [protocol.py:599] - < PING 'ge@\x05' [text, 4 bytes]
2025-02-07 14:06:33,846 - DEBUG - [protocol.py:745] - > PONG 'ge@\x05' [text, 4 bytes]
2025-02-07 14:06:33,850 - DEBUG - [protocol.py:599] - < PONG 30 3f 71 a6 [binary, 4 bytes]
2025-02-07 14:06:33,869 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:06:53,847 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:06:53,849 - DEBUG - [protocol.py:745] - > PING 7b 91 88 7d [binary, 4 bytes]
2025-02-07 14:06:53,857 - DEBUG - [protocol.py:599] - < PING 38 9c df a8 [binary, 4 bytes]
2025-02-07 14:06:53,859 - DEBUG - [protocol.py:745] - > PONG 38 9c df a8 [binary, 4 bytes]
2025-02-07 14:06:53,863 - DEBUG - [protocol.py:599] - < PONG 7b 91 88 7d [binary, 4 bytes]
2025-02-07 14:06:53,865 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:07:13,867 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:07:13,867 - DEBUG - [protocol.py:745] - > PING ec 24 ac 22 [binary, 4 bytes]
2025-02-07 14:07:13,867 - DEBUG - [protocol.py:599] - < PING 8b 04 1e 6c [binary, 4 bytes]
2025-02-07 14:07:13,873 - DEBUG - [protocol.py:745] - > PONG 8b 04 1e 6c [binary, 4 bytes]
2025-02-07 14:07:13,873 - DEBUG - [protocol.py:599] - < PONG ec 24 ac 22 [binary, 4 bytes]
2025-02-07 14:07:13,873 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:07:33,877 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:07:33,878 - DEBUG - [protocol.py:745] - > PING 65 91 04 85 [binary, 4 bytes]
2025-02-07 14:07:33,880 - DEBUG - [protocol.py:599] - < PING e7 7f 08 4f [binary, 4 bytes]
2025-02-07 14:07:33,880 - DEBUG - [protocol.py:745] - > PONG e7 7f 08 4f [binary, 4 bytes]
2025-02-07 14:07:33,880 - DEBUG - [protocol.py:599] - < PONG 65 91 04 85 [binary, 4 bytes]
2025-02-07 14:07:33,880 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:07:53,866 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:07:53,866 - DEBUG - [protocol.py:745] - > PING d3 23 3d 97 [binary, 4 bytes]
2025-02-07 14:07:53,866 - DEBUG - [protocol.py:599] - < PONG d3 23 3d 97 [binary, 4 bytes]
2025-02-07 14:07:53,866 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:07:53,887 - DEBUG - [protocol.py:599] - < PING '\n\x17Oz' [text, 4 bytes]
2025-02-07 14:07:53,889 - DEBUG - [protocol.py:745] - > PONG '\n\x17Oz' [text, 4 bytes]
2025-02-07 14:08:13,885 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:08:13,890 - DEBUG - [protocol.py:745] - > PING 8f 49 68 74 [binary, 4 bytes]
2025-02-07 14:08:13,896 - DEBUG - [protocol.py:599] - < PING 00 e2 c6 69 [binary, 4 bytes]
2025-02-07 14:08:13,898 - DEBUG - [protocol.py:745] - > PONG 00 e2 c6 69 [binary, 4 bytes]
2025-02-07 14:08:13,899 - DEBUG - [protocol.py:599] - < PONG 8f 49 68 74 [binary, 4 bytes]
2025-02-07 14:08:13,902 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:08:33,905 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:08:33,905 - DEBUG - [protocol.py:745] - > PING 16 61 e1 4c [binary, 4 bytes]
2025-02-07 14:08:33,905 - DEBUG - [protocol.py:599] - < PING 55 e0 18 d5 [binary, 4 bytes]
2025-02-07 14:08:33,905 - DEBUG - [protocol.py:745] - > PONG 55 e0 18 d5 [binary, 4 bytes]
2025-02-07 14:08:33,913 - DEBUG - [protocol.py:599] - < PONG 16 61 e1 4c [binary, 4 bytes]
2025-02-07 14:08:33,915 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:08:53,910 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:08:53,911 - DEBUG - [protocol.py:745] - > PING 25 d4 79 89 [binary, 4 bytes]
2025-02-07 14:08:53,917 - DEBUG - [protocol.py:599] - < PING 0a 7f f8 31 [binary, 4 bytes]
2025-02-07 14:08:53,919 - DEBUG - [protocol.py:745] - > PONG 0a 7f f8 31 [binary, 4 bytes]
2025-02-07 14:08:53,921 - DEBUG - [protocol.py:599] - < PONG 25 d4 79 89 [binary, 4 bytes]
2025-02-07 14:08:53,922 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:09:13,925 - DEBUG - [protocol.py:599] - < PING 20 25 b2 0f [binary, 4 bytes]
2025-02-07 14:09:13,926 - DEBUG - [protocol.py:745] - > PONG 20 25 b2 0f [binary, 4 bytes]
2025-02-07 14:09:13,926 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:09:13,927 - DEBUG - [protocol.py:745] - > PING 13 32 4e a3 [binary, 4 bytes]
2025-02-07 14:09:13,933 - DEBUG - [protocol.py:599] - < PONG 13 32 4e a3 [binary, 4 bytes]
2025-02-07 14:09:13,933 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:09:33,935 - DEBUG - [protocol.py:599] - < PING 65 9f 26 ad [binary, 4 bytes]
2025-02-07 14:09:33,937 - DEBUG - [protocol.py:745] - > PONG 65 9f 26 ad [binary, 4 bytes]
2025-02-07 14:09:33,939 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:09:33,940 - DEBUG - [protocol.py:745] - > PING f3 6d 86 a6 [binary, 4 bytes]
2025-02-07 14:09:33,947 - DEBUG - [protocol.py:599] - < PONG f3 6d 86 a6 [binary, 4 bytes]
2025-02-07 14:09:33,949 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:09:53,938 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:09:53,940 - DEBUG - [protocol.py:745] - > PING 76 b5 c4 4f [binary, 4 bytes]
2025-02-07 14:09:53,943 - DEBUG - [protocol.py:599] - < PING bc 19 1c 6d [binary, 4 bytes]
2025-02-07 14:09:53,946 - DEBUG - [protocol.py:745] - > PONG bc 19 1c 6d [binary, 4 bytes]
2025-02-07 14:09:53,949 - DEBUG - [protocol.py:599] - < PONG 76 b5 c4 4f [binary, 4 bytes]
2025-02-07 14:09:53,951 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:10:13,950 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:10:13,952 - DEBUG - [protocol.py:745] - > PING 54 ef c9 cb [binary, 4 bytes]
2025-02-07 14:10:13,955 - DEBUG - [protocol.py:599] - < PING 2d f6 7a f9 [binary, 4 bytes]
2025-02-07 14:10:13,957 - DEBUG - [protocol.py:745] - > PONG 2d f6 7a f9 [binary, 4 bytes]
2025-02-07 14:10:13,960 - DEBUG - [protocol.py:599] - < PONG 54 ef c9 cb [binary, 4 bytes]
2025-02-07 14:10:13,963 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:10:33,955 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:10:33,956 - DEBUG - [protocol.py:745] - > PING 0f c5 52 3a [binary, 4 bytes]
2025-02-07 14:10:33,964 - DEBUG - [protocol.py:599] - < PONG 0f c5 52 3a [binary, 4 bytes]
2025-02-07 14:10:33,965 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:10:33,967 - DEBUG - [protocol.py:599] - < PING 32 d1 ba ce [binary, 4 bytes]
2025-02-07 14:10:33,968 - DEBUG - [protocol.py:745] - > PONG 32 d1 ba ce [binary, 4 bytes]
2025-02-07 14:10:43,613 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:10:43,615 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:10:43,615 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:10:43,616 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:10:43,651 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:10:43,652 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:10:43,655 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:10:43,655 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:10:43,655 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:10:43,655 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:10:43,827 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:10:43,827 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:10:43,982 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:10:43,984 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,156 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,156 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:10:44,156 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:10:44,156 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:10:44,169 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:10:44,169 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,326 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,327 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,490 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,490 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,688 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,688 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:10:44,862 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:10:44,862 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:10:44,862 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:10:44,862 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:10:45,025 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:10:45,025 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:10:45,025 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:10:45,028 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:10:45.025677",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:10:45,028 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:10:45,029 - DEBUG - [printer_monitor_service.py:418] - Datos procesados para enviar: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:10:45.025677",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:10:45,029 - DEBUG - [printer_monitor_service.py:446] - Enviando datos a ws://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:10:45,029 - DEBUG - [printer_monitor_service.py:447] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:10:45,029 - DEBUG - [printer_monitor_service.py:448] - Params: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5'}
2025-02-07 14:10:45,054 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 14:10:45,055 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 14:10:45,056 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 14:10:45,058 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:10:53,975 - DEBUG - [protocol.py:599] - < PING 52 b7 ca c2 [binary, 4 bytes]
2025-02-07 14:10:53,976 - DEBUG - [protocol.py:745] - > PONG 52 b7 ca c2 [binary, 4 bytes]
2025-02-07 14:10:53,977 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:10:53,978 - DEBUG - [protocol.py:745] - > PING ff af fa 9e [binary, 4 bytes]
2025-02-07 14:10:53,985 - DEBUG - [protocol.py:599] - < PONG ff af fa 9e [binary, 4 bytes]
2025-02-07 14:10:53,987 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:11:13,981 - DEBUG - [protocol.py:599] - < PING 15 a3 3e 1f [binary, 4 bytes]
2025-02-07 14:11:13,981 - DEBUG - [protocol.py:745] - > PONG 15 a3 3e 1f [binary, 4 bytes]
2025-02-07 14:11:13,998 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:11:13,998 - DEBUG - [protocol.py:745] - > PING b7 ea 2d 20 [binary, 4 bytes]
2025-02-07 14:11:14,004 - DEBUG - [protocol.py:599] - < PONG b7 ea 2d 20 [binary, 4 bytes]
2025-02-07 14:11:14,004 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:11:21,025 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:11:21,026 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:11:21,031 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:11:21,031 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:11:21,033 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:11:21,033 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:11:21,033 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:11:26,399 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:11:26,400 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:11:26,400 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:11:26,402 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:11:26,433 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:11:26,433 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: gANiWwPstKN+XF+XiWU81w==
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:11:26,433 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:11:26,455 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:11:26,455 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:11:26,455 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:11:26,456 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: kKT3HpqjZ64sETGZZuEY9iM98K4=
2025-02-07 14:11:26,456 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:11:26,456 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:11:25 GMT
2025-02-07 14:11:26,456 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:11:26,457 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:11:26,457 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:11:27,534 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:11:27,535 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:11:27,535 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:11:27,535 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:11:27,562 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:11:27,562 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:11:27,562 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:11:27,563 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:11:27,563 - INFO - [printer_monitor_service.py:472] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:11:27,564 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:11:27,732 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:11:27,732 - INFO - [printer_monitor_service.py:481] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:11:27,732 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:11:27,732 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:11:27,765 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:11:27,766 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:11:27,769 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:11:27,771 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:11:27,771 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:11:27,774 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:11:27,965 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:11:27,966 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,145 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:11:28,145 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,311 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,311 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,463 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,463 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,645 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,645 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:11:28,799 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:11:28,799 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:11:28,799 - INFO - [printer_monitor_service.py:502] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:11:28,802 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:11:28,951 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:11:28,951 - INFO - [printer_monitor_service.py:533] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:11:28,951 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:11:28,953 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:11:28.951712",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:11:28,953 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:11:28,953 - DEBUG - [printer_monitor_service.py:438] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:11:28,953 - DEBUG - [printer_monitor_service.py:439] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:11:28,953 - DEBUG - [printer_monitor_service.py:440] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:11:28.953412",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:11:28,973 - ERROR - [printer_monitor_service.py:449] - Error actualizando datos para 192.168.18.79
2025-02-07 14:11:28,973 - ERROR - [printer_monitor_service.py:450] - Status: 422
2025-02-07 14:11:28,973 - ERROR - [printer_monitor_service.py:451] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null},{"type":"missing","loc":["query","agent_id"],"msg":"Field required","input":null}]}
2025-02-07 14:11:28,974 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:11:46,458 - DEBUG - [protocol.py:599] - < PING 4b 05 86 d2 [binary, 4 bytes]
2025-02-07 14:11:46,460 - DEBUG - [protocol.py:745] - > PONG 4b 05 86 d2 [binary, 4 bytes]
2025-02-07 14:11:46,462 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:11:46,464 - DEBUG - [protocol.py:745] - > PING b6 8f 54 8b [binary, 4 bytes]
2025-02-07 14:11:46,473 - DEBUG - [protocol.py:599] - < PONG b6 8f 54 8b [binary, 4 bytes]
2025-02-07 14:11:46,475 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:12:06,472 - DEBUG - [protocol.py:599] - < PING 45 0e c6 e3 [binary, 4 bytes]
2025-02-07 14:12:06,474 - DEBUG - [protocol.py:745] - > PONG 45 0e c6 e3 [binary, 4 bytes]
2025-02-07 14:12:06,476 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:12:06,478 - DEBUG - [protocol.py:745] - > PING aa e1 89 69 [binary, 4 bytes]
2025-02-07 14:12:06,483 - DEBUG - [protocol.py:599] - < PONG aa e1 89 69 [binary, 4 bytes]
2025-02-07 14:12:06,486 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:12:26,482 - DEBUG - [protocol.py:599] - < PING e9 49 06 11 [binary, 4 bytes]
2025-02-07 14:12:26,482 - DEBUG - [protocol.py:745] - > PONG e9 49 06 11 [binary, 4 bytes]
2025-02-07 14:12:26,483 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:12:26,483 - DEBUG - [protocol.py:745] - > PING 67 ba 00 c1 [binary, 4 bytes]
2025-02-07 14:12:26,489 - DEBUG - [protocol.py:599] - < PONG 67 ba 00 c1 [binary, 4 bytes]
2025-02-07 14:12:26,490 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:12:46,478 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:12:46,481 - DEBUG - [protocol.py:745] - > PING bc 03 3e fd [binary, 4 bytes]
2025-02-07 14:12:46,488 - DEBUG - [protocol.py:599] - < PING 8f 42 fd 20 [binary, 4 bytes]
2025-02-07 14:12:46,489 - DEBUG - [protocol.py:745] - > PONG 8f 42 fd 20 [binary, 4 bytes]
2025-02-07 14:12:46,490 - DEBUG - [protocol.py:599] - < PONG bc 03 3e fd [binary, 4 bytes]
2025-02-07 14:12:46,491 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:13:06,477 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:13:06,481 - DEBUG - [protocol.py:745] - > PING 16 ca a0 ca [binary, 4 bytes]
2025-02-07 14:13:06,488 - DEBUG - [protocol.py:599] - < PONG 16 ca a0 ca [binary, 4 bytes]
2025-02-07 14:13:06,491 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:13:06,494 - DEBUG - [protocol.py:599] - < PING 'S?~l' [text, 4 bytes]
2025-02-07 14:13:06,496 - DEBUG - [protocol.py:745] - > PONG 'S?~l' [text, 4 bytes]
2025-02-07 14:13:15,637 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:13:15,637 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:13:15,641 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:13:15,643 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:13:15,643 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:13:15,643 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:13:15,644 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:13:19,773 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:13:19,773 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:13:19,773 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:13:19,784 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:13:19,784 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:13:19,812 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:13:19,812 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 9i9VBC3U+e+b6/+pYNyHEg==
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:13:19,812 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:13:19,844 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:13:19,844 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:13:19,845 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:13:19,845 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: BWXPUFcE1t1yzWRASOwPbm82zlM=
2025-02-07 14:13:19,845 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:13:19,846 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:13:18 GMT
2025-02-07 14:13:19,846 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:13:19,846 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:13:19,847 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:13:20,939 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:13:20,939 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:13:20,944 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:13:20,944 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:13:20,967 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:13:20,967 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:13:20,967 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:13:20,967 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:13:20,974 - INFO - [printer_monitor_service.py:485] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:13:20,974 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:13:21,126 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:13:21,126 - INFO - [printer_monitor_service.py:494] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:13:21,126 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:13:21,126 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:13:21,162 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:13:21,163 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:13:21,163 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:13:21,165 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:13:21,165 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:13:21,167 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:13:21,327 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:13:21,327 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:21,508 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:13:21,508 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:21,657 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:21,657 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:21,812 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:21,812 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:21,992 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:21,992 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:13:22,204 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:13:22,204 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:13:22,205 - INFO - [printer_monitor_service.py:515] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:13:22,205 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:13:22,385 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:13:22,385 - INFO - [printer_monitor_service.py:546] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:13:22,386 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:13:22,386 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:13:22.386564",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:13:22,387 - INFO - [printer_monitor_service.py:412] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:13:22,387 - DEBUG - [printer_monitor_service.py:445] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:13:22,387 - DEBUG - [printer_monitor_service.py:446] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:13:22,388 - DEBUG - [printer_monitor_service.py:447] - Parámetros: {'agent_id': 'agt_277c92e42b554050bb83241f2f730ec5', 'self': 'true'}
2025-02-07 14:13:22,388 - DEBUG - [printer_monitor_service.py:448] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:13:22.387559",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:13:22,408 - ERROR - [printer_monitor_service.py:462] - Error actualizando datos para 192.168.18.79
2025-02-07 14:13:22,409 - ERROR - [printer_monitor_service.py:463] - Status: 422
2025-02-07 14:13:22,409 - ERROR - [printer_monitor_service.py:464] - Respuesta: {"detail":[{"type":"int_parsing","loc":["query","agent_id"],"msg":"Input should be a valid integer, unable to parse string as an integer","input":"agt_277c92e42b554050bb83241f2f730ec5"}]}
2025-02-07 14:13:22,411 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:13:39,845 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:13:39,847 - DEBUG - [protocol.py:745] - > PING c1 2c e9 24 [binary, 4 bytes]
2025-02-07 14:13:39,852 - DEBUG - [protocol.py:599] - < PING e9 c8 2c 6e [binary, 4 bytes]
2025-02-07 14:13:39,855 - DEBUG - [protocol.py:745] - > PONG e9 c8 2c 6e [binary, 4 bytes]
2025-02-07 14:13:39,858 - DEBUG - [protocol.py:599] - < PONG c1 2c e9 24 [binary, 4 bytes]
2025-02-07 14:13:39,861 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:13:59,865 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:13:59,867 - DEBUG - [protocol.py:745] - > PING 78 8f 8d f1 [binary, 4 bytes]
2025-02-07 14:13:59,869 - DEBUG - [protocol.py:599] - < PING 70 58 88 09 [binary, 4 bytes]
2025-02-07 14:13:59,871 - DEBUG - [protocol.py:745] - > PONG 70 58 88 09 [binary, 4 bytes]
2025-02-07 14:13:59,875 - DEBUG - [protocol.py:599] - < PONG 78 8f 8d f1 [binary, 4 bytes]
2025-02-07 14:13:59,877 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:14:19,880 - DEBUG - [protocol.py:599] - < PING 'Z\u0590N' [text, 4 bytes]
2025-02-07 14:14:19,880 - DEBUG - [protocol.py:745] - > PONG 'Z\u0590N' [text, 4 bytes]
2025-02-07 14:14:19,881 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:14:19,881 - DEBUG - [protocol.py:745] - > PING a6 05 1e 40 [binary, 4 bytes]
2025-02-07 14:14:19,887 - DEBUG - [protocol.py:599] - < PONG a6 05 1e 40 [binary, 4 bytes]
2025-02-07 14:14:19,887 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:14:39,887 - DEBUG - [protocol.py:599] - < PING c5 b3 80 16 [binary, 4 bytes]
2025-02-07 14:14:39,888 - DEBUG - [protocol.py:745] - > PONG c5 b3 80 16 [binary, 4 bytes]
2025-02-07 14:14:39,891 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:14:39,892 - DEBUG - [protocol.py:745] - > PING 7a 82 f3 7b [binary, 4 bytes]
2025-02-07 14:14:39,898 - DEBUG - [protocol.py:599] - < PONG 7a 82 f3 7b [binary, 4 bytes]
2025-02-07 14:14:39,900 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:14:59,894 - DEBUG - [protocol.py:599] - < PING 7c b0 c0 5a [binary, 4 bytes]
2025-02-07 14:14:59,895 - DEBUG - [protocol.py:745] - > PONG 7c b0 c0 5a [binary, 4 bytes]
2025-02-07 14:14:59,895 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:14:59,897 - DEBUG - [protocol.py:745] - > PING 7a 95 ab 18 [binary, 4 bytes]
2025-02-07 14:14:59,903 - DEBUG - [protocol.py:599] - < PONG 7a 95 ab 18 [binary, 4 bytes]
2025-02-07 14:14:59,904 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:15:12,521 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:15:12,525 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:15:12,533 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:15:12,534 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:15:12,536 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:15:12,537 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:15:12,539 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:15:17,632 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:15:17,632 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:15:17,632 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:15:17,632 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:15:17,671 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:15:17,676 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:15:17,677 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:15:17,677 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:15:17,679 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:15:17,679 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 7/jX6VecZxV/AQc7Kn6gvA==
2025-02-07 14:15:17,680 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:15:17,680 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:15:17,680 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:15:17,707 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:15:17,708 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:15:17,709 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:15:17,709 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: WdQZGgcwmvtr0o+ocxTSLuofhRM=
2025-02-07 14:15:17,709 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:15:17,710 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:15:16 GMT
2025-02-07 14:15:17,710 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:15:17,711 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:15:17,711 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:15:18,791 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:15:18,791 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:15:18,791 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:15:18,791 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:15:18,823 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:15:18,824 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:15:18,825 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:15:18,826 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:15:18,826 - INFO - [printer_monitor_service.py:498] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:15:18,826 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:15:18,996 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:15:18,997 - INFO - [printer_monitor_service.py:507] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:15:18,997 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:15:18,997 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:15:19,021 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:15:19,021 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:15:19,023 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:15:19,023 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:15:19,023 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:15:19,023 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:15:19,179 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:15:19,179 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:19,353 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:19,353 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:15:19,355 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:15:19,355 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:15:19,355 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:15:19,357 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:19,502 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:19,502 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:19,652 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:19,652 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:19,836 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:19,836 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:15:20,001 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:15:20,001 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:15:20,003 - INFO - [printer_monitor_service.py:528] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:15:20,003 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:15:20,157 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:15:20,158 - INFO - [printer_monitor_service.py:559] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:15:20,158 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:15:20,158 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:15:20.158529",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:15:20,158 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:15:20,160 - DEBUG - [printer_monitor_service.py:459] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:15:20,160 - DEBUG - [printer_monitor_service.py:460] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:15:20,160 - DEBUG - [printer_monitor_service.py:461] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:15:20,161 - DEBUG - [printer_monitor_service.py:462] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:15:20.160134",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:15:20,191 - ERROR - [printer_monitor_service.py:476] - Error actualizando datos para 192.168.18.79
2025-02-07 14:15:20,191 - ERROR - [printer_monitor_service.py:477] - Status: 500
2025-02-07 14:15:20,191 - ERROR - [printer_monitor_service.py:478] - Respuesta: Internal Server Error
2025-02-07 14:15:20,191 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:15:37,697 - DEBUG - [protocol.py:599] - < PING a1 14 ba bc [binary, 4 bytes]
2025-02-07 14:15:37,697 - DEBUG - [protocol.py:745] - > PONG a1 14 ba bc [binary, 4 bytes]
2025-02-07 14:15:37,728 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:15:37,731 - DEBUG - [protocol.py:745] - > PING 45 0b a2 02 [binary, 4 bytes]
2025-02-07 14:15:37,732 - DEBUG - [protocol.py:599] - < PONG 45 0b a2 02 [binary, 4 bytes]
2025-02-07 14:15:37,732 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:15:57,713 - DEBUG - [protocol.py:599] - < PING 6e 54 cb de [binary, 4 bytes]
2025-02-07 14:15:57,714 - DEBUG - [protocol.py:745] - > PONG 6e 54 cb de [binary, 4 bytes]
2025-02-07 14:15:57,714 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:15:57,716 - DEBUG - [protocol.py:745] - > PING 'AЊl' [text, 4 bytes]
2025-02-07 14:15:57,718 - DEBUG - [protocol.py:599] - < PONG 'AЊl' [text, 4 bytes]
2025-02-07 14:15:57,719 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:16:17,718 - DEBUG - [protocol.py:599] - < PING 'e\x03\x02\x17' [text, 4 bytes]
2025-02-07 14:16:17,718 - DEBUG - [protocol.py:745] - > PONG 'e\x03\x02\x17' [text, 4 bytes]
2025-02-07 14:16:17,719 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:16:17,719 - DEBUG - [protocol.py:745] - > PING 'F\x1f"9' [text, 4 bytes]
2025-02-07 14:16:17,725 - DEBUG - [protocol.py:599] - < PONG 'F\x1f"9' [text, 4 bytes]
2025-02-07 14:16:17,726 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:16:37,724 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:16:37,726 - DEBUG - [protocol.py:745] - > PING 39 5e e3 62 [binary, 4 bytes]
2025-02-07 14:16:37,729 - DEBUG - [protocol.py:599] - < PING b5 0f d0 e5 [binary, 4 bytes]
2025-02-07 14:16:37,732 - DEBUG - [protocol.py:745] - > PONG b5 0f d0 e5 [binary, 4 bytes]
2025-02-07 14:16:37,737 - DEBUG - [protocol.py:599] - < PONG 39 5e e3 62 [binary, 4 bytes]
2025-02-07 14:16:37,740 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:16:57,731 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:16:57,732 - DEBUG - [protocol.py:745] - > PING 31 e2 ec c1 [binary, 4 bytes]
2025-02-07 14:16:57,738 - DEBUG - [protocol.py:599] - < PONG 31 e2 ec c1 [binary, 4 bytes]
2025-02-07 14:16:57,738 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:16:57,738 - DEBUG - [protocol.py:599] - < PING d1 37 8d 3a [binary, 4 bytes]
2025-02-07 14:16:57,738 - DEBUG - [protocol.py:745] - > PONG d1 37 8d 3a [binary, 4 bytes]
2025-02-07 14:17:17,734 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:17:17,735 - DEBUG - [protocol.py:745] - > PING 95 75 46 0f [binary, 4 bytes]
2025-02-07 14:17:17,739 - DEBUG - [protocol.py:599] - < PONG 95 75 46 0f [binary, 4 bytes]
2025-02-07 14:17:17,743 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:17:17,745 - DEBUG - [protocol.py:599] - < PING 9c ea 28 aa [binary, 4 bytes]
2025-02-07 14:17:17,745 - DEBUG - [protocol.py:745] - > PONG 9c ea 28 aa [binary, 4 bytes]
2025-02-07 14:17:37,736 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:17:37,738 - DEBUG - [protocol.py:745] - > PING 24 02 bf ef [binary, 4 bytes]
2025-02-07 14:17:37,744 - DEBUG - [protocol.py:599] - < PONG 24 02 bf ef [binary, 4 bytes]
2025-02-07 14:17:37,744 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:17:37,744 - DEBUG - [protocol.py:599] - < PING 72 9c 61 d6 [binary, 4 bytes]
2025-02-07 14:17:37,744 - DEBUG - [protocol.py:745] - > PONG 72 9c 61 d6 [binary, 4 bytes]
2025-02-07 14:17:42,808 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:17:42,811 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:17:42,819 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:17:42,823 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:17:42,826 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:17:42,826 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:17:42,828 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:18:15,088 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:18:15,089 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:18:15,089 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:18:15,090 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:18:15,091 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:18:15,126 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:18:15,126 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:18:15,127 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:18:15,127 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:18:15,127 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:18:15,127 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: ewD7cDfLOZMfNDdSvFFCHA==
2025-02-07 14:18:15,128 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:18:15,128 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:18:15,128 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:18:15,153 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:18:15,154 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:18:15,154 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:18:15,154 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: lfO83YktQuk36OYt/rlclhmR/sQ=
2025-02-07 14:18:15,155 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:18:15,155 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:18:14 GMT
2025-02-07 14:18:15,155 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:18:15,156 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:18:15,157 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:18:16,231 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:18:16,231 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:18:16,231 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:18:16,231 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:18:16,259 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:18:16,259 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:18:16,259 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:18:16,259 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:18:16,259 - INFO - [printer_monitor_service.py:501] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:18:16,259 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:18:16,453 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:18:16,455 - INFO - [printer_monitor_service.py:510] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:18:16,455 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:18:16,455 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:18:16,481 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:18:16,481 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:18:16,481 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:18:16,482 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:18:16,482 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:18:16,482 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:18:16,642 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:18:16,642 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:16,807 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:18:16,807 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:16,956 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:16,956 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:17,105 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:17,105 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:17,286 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:17,286 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:18:17,453 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:18:17,453 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:18:17,453 - INFO - [printer_monitor_service.py:531] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:18:17,453 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:18:17,589 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:18:17,589 - INFO - [printer_monitor_service.py:562] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:18:17,589 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:18:17,589 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:18:17.589687",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:18:17,589 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:18:17,605 - DEBUG - [printer_monitor_service.py:462] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:18:17,605 - DEBUG - [printer_monitor_service.py:463] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:18:17,605 - DEBUG - [printer_monitor_service.py:464] - Parámetros: {'agent_id': '1'}
2025-02-07 14:18:17,605 - DEBUG - [printer_monitor_service.py:465] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:18:17.589687",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null,
  "name": "Unknown Printer",
  "model": "Unknown",
  "client_id": null
}
2025-02-07 14:18:17,624 - ERROR - [printer_monitor_service.py:479] - Error actualizando datos para 192.168.18.79
2025-02-07 14:18:17,624 - ERROR - [printer_monitor_service.py:480] - Status: 422
2025-02-07 14:18:17,625 - ERROR - [printer_monitor_service.py:481] - Respuesta: {"detail":[{"type":"missing","loc":["query","self"],"msg":"Field required","input":null}]}
2025-02-07 14:18:17,625 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:18:35,155 - DEBUG - [protocol.py:599] - < PING 1e 3e 72 91 [binary, 4 bytes]
2025-02-07 14:18:35,157 - DEBUG - [protocol.py:745] - > PONG 1e 3e 72 91 [binary, 4 bytes]
2025-02-07 14:18:35,160 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:18:35,162 - DEBUG - [protocol.py:745] - > PING 6c 07 af 85 [binary, 4 bytes]
2025-02-07 14:18:35,171 - DEBUG - [protocol.py:599] - < PONG 6c 07 af 85 [binary, 4 bytes]
2025-02-07 14:18:35,173 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:18:55,165 - DEBUG - [protocol.py:599] - < PING f9 e3 20 6d [binary, 4 bytes]
2025-02-07 14:18:55,167 - DEBUG - [protocol.py:745] - > PONG f9 e3 20 6d [binary, 4 bytes]
2025-02-07 14:18:55,170 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:18:55,171 - DEBUG - [protocol.py:745] - > PING 29 ec 60 99 [binary, 4 bytes]
2025-02-07 14:18:55,180 - DEBUG - [protocol.py:599] - < PONG 29 ec 60 99 [binary, 4 bytes]
2025-02-07 14:18:55,182 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:19:15,174 - DEBUG - [protocol.py:599] - < PING 30 a5 32 49 [binary, 4 bytes]
2025-02-07 14:19:15,175 - DEBUG - [protocol.py:745] - > PONG 30 a5 32 49 [binary, 4 bytes]
2025-02-07 14:19:15,176 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:19:15,177 - DEBUG - [protocol.py:745] - > PING 57 e1 f3 ef [binary, 4 bytes]
2025-02-07 14:19:15,181 - DEBUG - [protocol.py:599] - < PONG 57 e1 f3 ef [binary, 4 bytes]
2025-02-07 14:19:15,183 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:19:35,181 - DEBUG - [protocol.py:599] - < PING 7c 6d 55 f4 [binary, 4 bytes]
2025-02-07 14:19:35,183 - DEBUG - [protocol.py:745] - > PONG 7c 6d 55 f4 [binary, 4 bytes]
2025-02-07 14:19:35,185 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:19:35,186 - DEBUG - [protocol.py:745] - > PING '\x7f\x0cϦ' [text, 4 bytes]
2025-02-07 14:19:35,194 - DEBUG - [protocol.py:599] - < PONG '\x7f\x0cϦ' [text, 4 bytes]
2025-02-07 14:19:35,196 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:19:55,190 - DEBUG - [protocol.py:599] - < PING 5e b1 6c cc [binary, 4 bytes]
2025-02-07 14:19:55,191 - DEBUG - [protocol.py:745] - > PONG 5e b1 6c cc [binary, 4 bytes]
2025-02-07 14:19:55,195 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:19:55,196 - DEBUG - [protocol.py:745] - > PING 61 5e 6a a4 [binary, 4 bytes]
2025-02-07 14:19:55,201 - DEBUG - [protocol.py:599] - < PONG 61 5e 6a a4 [binary, 4 bytes]
2025-02-07 14:19:55,204 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:20:10,558 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:20:10,558 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:20:10,563 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:20:10,563 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:20:10,563 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:20:10,563 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:20:10,565 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:20:14,835 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:20:14,835 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:20:14,846 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:20:14,846 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:20:14,882 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:20:14,882 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:20:14,882 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:20:14,884 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:20:14,884 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:20:14,885 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 4Lki/kp5c0Fgu6/W9XX8Rw==
2025-02-07 14:20:14,885 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:20:14,885 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:20:14,886 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:20:14,914 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:20:14,914 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:20:14,914 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:20:14,916 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: gQ2ZJNX1zaXTyf5R0IdUPVhwgTc=
2025-02-07 14:20:14,916 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:20:14,916 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:20:13 GMT
2025-02-07 14:20:14,918 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:20:14,919 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:20:14,920 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:20:16,044 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:20:16,045 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:20:16,045 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:20:16,046 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:20:16,088 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:20:16,091 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:20:16,092 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:20:16,094 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:20:16,096 - INFO - [printer_monitor_service.py:510] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:20:16,096 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:20:16,292 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:20:16,293 - INFO - [printer_monitor_service.py:519] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:20:16,293 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:20:16,293 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:20:16,340 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:20:16,340 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:20:16,340 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:20:16,342 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:20:16,342 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:20:16,342 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:20:16,501 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:20:16,501 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:16,684 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:20:16,684 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:16,840 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:16,840 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:16,988 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:16,990 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:17,172 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:17,172 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:20:17,319 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:20:17,319 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:20:17,319 - INFO - [printer_monitor_service.py:540] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:20:17,319 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:20:17,470 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:20:17,470 - INFO - [printer_monitor_service.py:571] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:20:17,470 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:20:17,473 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:20:17.470744",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:20:17,473 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:20:17,473 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:20:17,473 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:20:17,473 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:20:17,504 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:20:17,504 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:20:17,504 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:20:17,511 - DEBUG - [printer_monitor_service.py:471] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:20:17,511 - DEBUG - [printer_monitor_service.py:472] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:20:17,511 - DEBUG - [printer_monitor_service.py:473] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:20:17,511 - DEBUG - [printer_monitor_service.py:474] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:20:17.511695",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null,
  "name": "RRHH",
  "model": "MPC 307",
  "client_id": 4
}
2025-02-07 14:20:17,537 - ERROR - [printer_monitor_service.py:488] - Error actualizando datos para 192.168.18.79
2025-02-07 14:20:17,537 - ERROR - [printer_monitor_service.py:489] - Status: 500
2025-02-07 14:20:17,537 - ERROR - [printer_monitor_service.py:490] - Respuesta: Internal Server Error
2025-02-07 14:20:17,537 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:20:34,914 - DEBUG - [protocol.py:599] - < PING 51 79 78 be [binary, 4 bytes]
2025-02-07 14:20:34,916 - DEBUG - [protocol.py:745] - > PONG 51 79 78 be [binary, 4 bytes]
2025-02-07 14:20:34,919 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:20:34,920 - DEBUG - [protocol.py:745] - > PING d5 97 bd 1d [binary, 4 bytes]
2025-02-07 14:20:34,927 - DEBUG - [protocol.py:599] - < PONG d5 97 bd 1d [binary, 4 bytes]
2025-02-07 14:20:34,929 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:20:54,919 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:20:54,920 - DEBUG - [protocol.py:745] - > PING ea 94 d4 15 [binary, 4 bytes]
2025-02-07 14:20:54,923 - DEBUG - [protocol.py:599] - < PING 2c 78 96 25 [binary, 4 bytes]
2025-02-07 14:20:54,923 - DEBUG - [protocol.py:745] - > PONG 2c 78 96 25 [binary, 4 bytes]
2025-02-07 14:20:54,925 - DEBUG - [protocol.py:599] - < PONG ea 94 d4 15 [binary, 4 bytes]
2025-02-07 14:20:54,926 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:21:14,919 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:21:14,919 - DEBUG - [protocol.py:745] - > PING 33 32 75 a4 [binary, 4 bytes]
2025-02-07 14:21:14,926 - DEBUG - [protocol.py:599] - < PONG 33 32 75 a4 [binary, 4 bytes]
2025-02-07 14:21:14,926 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:21:14,932 - DEBUG - [protocol.py:599] - < PING cc 7a f2 9d [binary, 4 bytes]
2025-02-07 14:21:14,933 - DEBUG - [protocol.py:745] - > PONG cc 7a f2 9d [binary, 4 bytes]
2025-02-07 14:21:34,934 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:21:34,936 - DEBUG - [protocol.py:745] - > PING c3 5d f7 a7 [binary, 4 bytes]
2025-02-07 14:21:34,939 - DEBUG - [protocol.py:599] - < PING 'ɕ.j' [text, 4 bytes]
2025-02-07 14:21:34,940 - DEBUG - [protocol.py:745] - > PONG 'ɕ.j' [text, 4 bytes]
2025-02-07 14:21:34,943 - DEBUG - [protocol.py:599] - < PONG c3 5d f7 a7 [binary, 4 bytes]
2025-02-07 14:21:34,946 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:21:54,942 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:21:54,944 - DEBUG - [protocol.py:745] - > PING 2f f2 7a f8 [binary, 4 bytes]
2025-02-07 14:21:54,947 - DEBUG - [protocol.py:599] - < PING 86 19 6e ff [binary, 4 bytes]
2025-02-07 14:21:54,948 - DEBUG - [protocol.py:745] - > PONG 86 19 6e ff [binary, 4 bytes]
2025-02-07 14:21:54,951 - DEBUG - [protocol.py:599] - < PONG 2f f2 7a f8 [binary, 4 bytes]
2025-02-07 14:21:54,953 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:22:14,955 - DEBUG - [protocol.py:599] - < PING 91 41 47 35 [binary, 4 bytes]
2025-02-07 14:22:14,955 - DEBUG - [protocol.py:745] - > PONG 91 41 47 35 [binary, 4 bytes]
2025-02-07 14:22:14,956 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:22:14,957 - DEBUG - [protocol.py:745] - > PING f8 d9 b8 8e [binary, 4 bytes]
2025-02-07 14:22:14,962 - DEBUG - [protocol.py:599] - < PONG f8 d9 b8 8e [binary, 4 bytes]
2025-02-07 14:22:14,963 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:22:34,962 - DEBUG - [protocol.py:599] - < PING 72 1e 08 d8 [binary, 4 bytes]
2025-02-07 14:22:34,964 - DEBUG - [protocol.py:745] - > PONG 72 1e 08 d8 [binary, 4 bytes]
2025-02-07 14:22:34,966 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:22:34,968 - DEBUG - [protocol.py:745] - > PING ef 1a 3e f2 [binary, 4 bytes]
2025-02-07 14:22:34,975 - DEBUG - [protocol.py:599] - < PONG ef 1a 3e f2 [binary, 4 bytes]
2025-02-07 14:22:34,979 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:22:54,966 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:22:54,968 - DEBUG - [protocol.py:745] - > PING f6 00 ea e1 [binary, 4 bytes]
2025-02-07 14:22:54,973 - DEBUG - [protocol.py:599] - < PING 3f a3 e0 6d [binary, 4 bytes]
2025-02-07 14:22:54,974 - DEBUG - [protocol.py:745] - > PONG 3f a3 e0 6d [binary, 4 bytes]
2025-02-07 14:22:54,977 - DEBUG - [protocol.py:599] - < PONG f6 00 ea e1 [binary, 4 bytes]
2025-02-07 14:22:54,979 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:23:14,971 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:23:14,973 - DEBUG - [protocol.py:745] - > PING bb 99 c1 d5 [binary, 4 bytes]
2025-02-07 14:23:14,978 - DEBUG - [protocol.py:599] - < PONG bb 99 c1 d5 [binary, 4 bytes]
2025-02-07 14:23:14,979 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:23:14,984 - DEBUG - [protocol.py:599] - < PING 39 45 c0 26 [binary, 4 bytes]
2025-02-07 14:23:14,985 - DEBUG - [protocol.py:745] - > PONG 39 45 c0 26 [binary, 4 bytes]
2025-02-07 14:23:34,992 - DEBUG - [protocol.py:599] - < PING c1 b7 c0 1c [binary, 4 bytes]
2025-02-07 14:23:34,993 - DEBUG - [protocol.py:745] - > PONG c1 b7 c0 1c [binary, 4 bytes]
2025-02-07 14:23:34,995 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:23:34,996 - DEBUG - [protocol.py:745] - > PING c5 c7 c6 33 [binary, 4 bytes]
2025-02-07 14:23:35,001 - DEBUG - [protocol.py:599] - < PONG c5 c7 c6 33 [binary, 4 bytes]
2025-02-07 14:23:35,003 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:23:54,998 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:23:55,000 - DEBUG - [protocol.py:745] - > PING fe c7 f6 a0 [binary, 4 bytes]
2025-02-07 14:23:55,002 - DEBUG - [protocol.py:599] - < PING a9 96 46 6a [binary, 4 bytes]
2025-02-07 14:23:55,003 - DEBUG - [protocol.py:745] - > PONG a9 96 46 6a [binary, 4 bytes]
2025-02-07 14:23:55,012 - DEBUG - [protocol.py:599] - < PONG fe c7 f6 a0 [binary, 4 bytes]
2025-02-07 14:23:55,015 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:24:15,010 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:24:15,013 - DEBUG - [protocol.py:745] - > PING fb 58 0a f0 [binary, 4 bytes]
2025-02-07 14:24:15,017 - DEBUG - [protocol.py:599] - < PING 28 0b f1 5d [binary, 4 bytes]
2025-02-07 14:24:15,018 - DEBUG - [protocol.py:745] - > PONG 28 0b f1 5d [binary, 4 bytes]
2025-02-07 14:24:15,021 - DEBUG - [protocol.py:599] - < PONG fb 58 0a f0 [binary, 4 bytes]
2025-02-07 14:24:15,023 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:24:35,023 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:24:35,037 - DEBUG - [protocol.py:745] - > PING d9 2a 11 78 [binary, 4 bytes]
2025-02-07 14:24:35,038 - DEBUG - [protocol.py:599] - < PING 3a a3 ac cd [binary, 4 bytes]
2025-02-07 14:24:35,039 - DEBUG - [protocol.py:745] - > PONG 3a a3 ac cd [binary, 4 bytes]
2025-02-07 14:24:35,100 - DEBUG - [protocol.py:599] - < PONG d9 2a 11 78 [binary, 4 bytes]
2025-02-07 14:24:35,100 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:24:55,051 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:24:55,053 - DEBUG - [protocol.py:745] - > PING f8 8f a8 22 [binary, 4 bytes]
2025-02-07 14:24:55,061 - DEBUG - [protocol.py:599] - < PONG f8 8f a8 22 [binary, 4 bytes]
2025-02-07 14:24:55,063 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:24:55,101 - DEBUG - [protocol.py:599] - < PING 8e 25 ae 17 [binary, 4 bytes]
2025-02-07 14:24:55,103 - DEBUG - [protocol.py:745] - > PONG 8e 25 ae 17 [binary, 4 bytes]
2025-02-07 14:25:15,061 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:25:15,063 - DEBUG - [protocol.py:745] - > PING 80 0f fc 5b [binary, 4 bytes]
2025-02-07 14:25:15,069 - DEBUG - [protocol.py:599] - < PONG 80 0f fc 5b [binary, 4 bytes]
2025-02-07 14:25:15,070 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:25:15,110 - DEBUG - [protocol.py:599] - < PING f6 6a 68 69 [binary, 4 bytes]
2025-02-07 14:25:15,112 - DEBUG - [protocol.py:745] - > PONG f6 6a 68 69 [binary, 4 bytes]
2025-02-07 14:25:18,669 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:25:18,671 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:25:18,672 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:25:18,673 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:25:18,766 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:25:18,767 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:25:18,768 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:25:18,769 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:25:18,770 - INFO - [printer_monitor_service.py:510] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:25:18,770 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:25:18,998 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:25:18,998 - INFO - [printer_monitor_service.py:519] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:25:18,999 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:25:18,999 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:25:19,000 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:25:19,000 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:25:19,279 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:25:19,280 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:19,504 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:19,505 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:25:19,505 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:25:19,506 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:25:19,506 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:25:19,507 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:19,727 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:19,727 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:20,001 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:20,002 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:20,288 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:20,289 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:25:20,497 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:25:20,498 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:25:20,498 - INFO - [printer_monitor_service.py:540] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:25:20,498 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:25:20,706 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:25:20,706 - INFO - [printer_monitor_service.py:571] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:25:20,706 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:25:20,707 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:25:20.706681",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:25:20,708 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:25:20,708 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:25:20,708 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:25:20,709 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:25:20,740 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:25:20,742 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:25:20,742 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:25:20,745 - DEBUG - [printer_monitor_service.py:471] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:25:20,746 - DEBUG - [printer_monitor_service.py:472] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:25:20,748 - DEBUG - [printer_monitor_service.py:473] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:25:20,749 - DEBUG - [printer_monitor_service.py:474] - Datos: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:25:20.744967",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null,
  "name": "RRHH",
  "model": "MPC 307",
  "client_id": 4
}
2025-02-07 14:25:20,775 - ERROR - [printer_monitor_service.py:488] - Error actualizando datos para 192.168.18.79
2025-02-07 14:25:20,776 - ERROR - [printer_monitor_service.py:489] - Status: 500
2025-02-07 14:25:20,776 - ERROR - [printer_monitor_service.py:490] - Respuesta: Internal Server Error
2025-02-07 14:25:20,778 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:25:35,068 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:25:35,070 - DEBUG - [protocol.py:745] - > PING 22 90 8f bf [binary, 4 bytes]
2025-02-07 14:25:35,076 - DEBUG - [protocol.py:599] - < PONG 22 90 8f bf [binary, 4 bytes]
2025-02-07 14:25:35,078 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:25:35,120 - DEBUG - [protocol.py:599] - < PING 9b 99 b5 cf [binary, 4 bytes]
2025-02-07 14:25:35,122 - DEBUG - [protocol.py:745] - > PONG 9b 99 b5 cf [binary, 4 bytes]
2025-02-07 14:25:55,087 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:25:55,088 - DEBUG - [protocol.py:745] - > PING d7 3b b5 4b [binary, 4 bytes]
2025-02-07 14:25:55,095 - DEBUG - [protocol.py:599] - < PONG d7 3b b5 4b [binary, 4 bytes]
2025-02-07 14:25:55,097 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:25:55,126 - DEBUG - [protocol.py:599] - < PING 0c f2 d0 35 [binary, 4 bytes]
2025-02-07 14:25:55,128 - DEBUG - [protocol.py:745] - > PONG 0c f2 d0 35 [binary, 4 bytes]
2025-02-07 14:26:15,095 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:26:15,097 - DEBUG - [protocol.py:745] - > PING 7c 35 d9 df [binary, 4 bytes]
2025-02-07 14:26:15,104 - DEBUG - [protocol.py:599] - < PONG 7c 35 d9 df [binary, 4 bytes]
2025-02-07 14:26:15,107 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:26:15,136 - DEBUG - [protocol.py:599] - < PING 81 a2 a2 f7 [binary, 4 bytes]
2025-02-07 14:26:15,138 - DEBUG - [protocol.py:745] - > PONG 81 a2 a2 f7 [binary, 4 bytes]
2025-02-07 14:26:35,116 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:26:35,118 - DEBUG - [protocol.py:745] - > PING 89 68 39 86 [binary, 4 bytes]
2025-02-07 14:26:35,126 - DEBUG - [protocol.py:599] - < PONG 89 68 39 86 [binary, 4 bytes]
2025-02-07 14:26:35,128 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:26:35,145 - DEBUG - [protocol.py:599] - < PING 'o~ka' [text, 4 bytes]
2025-02-07 14:26:35,147 - DEBUG - [protocol.py:745] - > PONG 'o~ka' [text, 4 bytes]
2025-02-07 14:26:55,149 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:26:55,150 - DEBUG - [protocol.py:745] - > PING f4 4b c6 ae [binary, 4 bytes]
2025-02-07 14:26:55,156 - DEBUG - [protocol.py:599] - < PING 36 04 3b 97 [binary, 4 bytes]
2025-02-07 14:26:55,157 - DEBUG - [protocol.py:745] - > PONG 36 04 3b 97 [binary, 4 bytes]
2025-02-07 14:26:55,158 - DEBUG - [protocol.py:599] - < PONG f4 4b c6 ae [binary, 4 bytes]
2025-02-07 14:26:55,159 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:27:15,163 - DEBUG - [protocol.py:599] - < PING 9d 18 cf 0a [binary, 4 bytes]
2025-02-07 14:27:15,163 - DEBUG - [protocol.py:745] - > PONG 9d 18 cf 0a [binary, 4 bytes]
2025-02-07 14:27:15,164 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:27:15,164 - DEBUG - [protocol.py:745] - > PING c6 5d 11 ee [binary, 4 bytes]
2025-02-07 14:27:15,169 - DEBUG - [protocol.py:599] - < PONG c6 5d 11 ee [binary, 4 bytes]
2025-02-07 14:27:15,170 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:27:35,168 - DEBUG - [protocol.py:599] - < PING 09 b4 5c 2d [binary, 4 bytes]
2025-02-07 14:27:35,169 - DEBUG - [protocol.py:745] - > PONG 09 b4 5c 2d [binary, 4 bytes]
2025-02-07 14:27:35,170 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:27:35,171 - DEBUG - [protocol.py:745] - > PING d8 63 88 fc [binary, 4 bytes]
2025-02-07 14:27:35,175 - DEBUG - [protocol.py:599] - < PONG d8 63 88 fc [binary, 4 bytes]
2025-02-07 14:27:35,176 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:27:55,170 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:27:55,172 - DEBUG - [protocol.py:745] - > PING cb 72 db d3 [binary, 4 bytes]
2025-02-07 14:27:55,174 - DEBUG - [protocol.py:599] - < PING '9\x7fl>' [text, 4 bytes]
2025-02-07 14:27:55,176 - DEBUG - [protocol.py:745] - > PONG '9\x7fl>' [text, 4 bytes]
2025-02-07 14:27:55,180 - DEBUG - [protocol.py:599] - < PONG cb 72 db d3 [binary, 4 bytes]
2025-02-07 14:27:55,182 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:28:15,173 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:28:15,175 - DEBUG - [protocol.py:745] - > PING 'RD#\x10' [text, 4 bytes]
2025-02-07 14:28:15,180 - DEBUG - [protocol.py:599] - < PONG 'RD#\x10' [text, 4 bytes]
2025-02-07 14:28:15,182 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:28:15,184 - DEBUG - [protocol.py:599] - < PING a9 f4 9e 05 [binary, 4 bytes]
2025-02-07 14:28:15,186 - DEBUG - [protocol.py:745] - > PONG a9 f4 9e 05 [binary, 4 bytes]
2025-02-07 14:28:35,187 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:28:35,189 - DEBUG - [protocol.py:745] - > PING 7b e7 a0 f1 [binary, 4 bytes]
2025-02-07 14:28:35,196 - DEBUG - [protocol.py:599] - < PING b5 ca 05 c6 [binary, 4 bytes]
2025-02-07 14:28:35,197 - DEBUG - [protocol.py:745] - > PONG b5 ca 05 c6 [binary, 4 bytes]
2025-02-07 14:28:35,199 - DEBUG - [protocol.py:599] - < PONG 7b e7 a0 f1 [binary, 4 bytes]
2025-02-07 14:28:35,202 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:28:55,199 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:28:55,201 - DEBUG - [protocol.py:745] - > PING 55 25 66 a7 [binary, 4 bytes]
2025-02-07 14:28:55,204 - DEBUG - [protocol.py:599] - < PING 35 5e 63 b2 [binary, 4 bytes]
2025-02-07 14:28:55,208 - DEBUG - [protocol.py:745] - > PONG 35 5e 63 b2 [binary, 4 bytes]
2025-02-07 14:28:55,211 - DEBUG - [protocol.py:599] - < PONG 55 25 66 a7 [binary, 4 bytes]
2025-02-07 14:28:55,213 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:29:15,213 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:29:15,215 - DEBUG - [protocol.py:745] - > PING ab 35 11 15 [binary, 4 bytes]
2025-02-07 14:29:15,217 - DEBUG - [protocol.py:599] - < PING 82 55 74 23 [binary, 4 bytes]
2025-02-07 14:29:15,219 - DEBUG - [protocol.py:745] - > PONG 82 55 74 23 [binary, 4 bytes]
2025-02-07 14:29:15,222 - DEBUG - [protocol.py:599] - < PONG ab 35 11 15 [binary, 4 bytes]
2025-02-07 14:29:15,224 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:29:35,219 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:29:35,221 - DEBUG - [protocol.py:745] - > PING f7 45 9d 30 [binary, 4 bytes]
2025-02-07 14:29:35,226 - DEBUG - [protocol.py:599] - < PING db 05 95 0f [binary, 4 bytes]
2025-02-07 14:29:35,231 - DEBUG - [protocol.py:745] - > PONG db 05 95 0f [binary, 4 bytes]
2025-02-07 14:29:35,233 - DEBUG - [protocol.py:599] - < PONG f7 45 9d 30 [binary, 4 bytes]
2025-02-07 14:29:35,235 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:29:55,230 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:29:55,231 - DEBUG - [protocol.py:745] - > PING fb 7a 5c 58 [binary, 4 bytes]
2025-02-07 14:29:55,239 - DEBUG - [protocol.py:599] - < PONG fb 7a 5c 58 [binary, 4 bytes]
2025-02-07 14:29:55,240 - DEBUG - [protocol.py:599] - < PING 3a 9d 42 08 [binary, 4 bytes]
2025-02-07 14:29:55,240 - DEBUG - [protocol.py:745] - > PONG 3a 9d 42 08 [binary, 4 bytes]
2025-02-07 14:29:55,241 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:30:00,765 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:30:00,767 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:30:00,773 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:30:00,775 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:30:00,777 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:30:00,779 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:30:00,781 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:30:05,305 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:30:05,305 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:30:05,321 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:30:05,321 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:30:05,345 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:30:05,345 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: QJk+ofxWcAxT71Q7ErUMWA==
2025-02-07 14:30:05,345 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:30:05,360 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:30:05,360 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:30:05,429 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:30:05,429 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:30:05,429 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:30:05,429 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: ZV6/Da84T66zn3QvJGRs+krLezQ=
2025-02-07 14:30:05,434 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:30:05,434 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:30:04 GMT
2025-02-07 14:30:05,434 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:30:05,435 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:30:05,435 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:30:06,547 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:30:06,550 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:30:06,550 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:30:06,550 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:30:06,620 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:30:06,620 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:30:06,620 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:30:06,620 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:30:06,620 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:30:06,622 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:30:06,793 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:30:06,793 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:30:06,794 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:30:06,794 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:30:06,834 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:30:06,834 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:30:06,834 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:30:06,837 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:30:06,837 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:30:06,838 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:30:06,997 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:30:06,997 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,175 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:30:07,175 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,342 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,343 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,512 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,512 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,708 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,710 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:30:07,886 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:30:07,886 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:30:07,886 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:30:07,886 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:30:08,049 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:30:08,050 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:30:08,050 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:30:08,051 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:30:08.050440",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:30:08,051 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:30:08,051 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:30:08,052 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:30:08,052 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:30:08,096 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:30:08,096 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:30:08.096695",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:30:08,116 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:30:08,116 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:30:08,126 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:30:08,126 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:30:25,419 - DEBUG - [protocol.py:599] - < PING e9 a3 6a 37 [binary, 4 bytes]
2025-02-07 14:30:25,419 - DEBUG - [protocol.py:745] - > PONG e9 a3 6a 37 [binary, 4 bytes]
2025-02-07 14:30:25,419 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:30:25,419 - DEBUG - [protocol.py:745] - > PING bb 99 20 c5 [binary, 4 bytes]
2025-02-07 14:30:25,436 - DEBUG - [protocol.py:599] - < PONG bb 99 20 c5 [binary, 4 bytes]
2025-02-07 14:30:25,436 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:30:45,429 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:30:45,431 - DEBUG - [protocol.py:745] - > PING e5 72 94 c1 [binary, 4 bytes]
2025-02-07 14:30:45,434 - DEBUG - [protocol.py:599] - < PONG e5 72 94 c1 [binary, 4 bytes]
2025-02-07 14:30:45,434 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:30:45,434 - DEBUG - [protocol.py:599] - < PING 16 36 3e 95 [binary, 4 bytes]
2025-02-07 14:30:45,446 - DEBUG - [protocol.py:745] - > PONG 16 36 3e 95 [binary, 4 bytes]
2025-02-07 14:31:05,440 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:31:05,441 - DEBUG - [protocol.py:745] - > PING 11 9f 88 a6 [binary, 4 bytes]
2025-02-07 14:31:05,446 - DEBUG - [protocol.py:599] - < PONG 11 9f 88 a6 [binary, 4 bytes]
2025-02-07 14:31:05,446 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:31:05,455 - DEBUG - [protocol.py:599] - < PING 9b db c3 ca [binary, 4 bytes]
2025-02-07 14:31:05,457 - DEBUG - [protocol.py:745] - > PONG 9b db c3 ca [binary, 4 bytes]
2025-02-07 14:31:25,433 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:31:25,435 - DEBUG - [protocol.py:745] - > PING 09 c2 2b b9 [binary, 4 bytes]
2025-02-07 14:31:25,444 - DEBUG - [protocol.py:599] - < PONG 09 c2 2b b9 [binary, 4 bytes]
2025-02-07 14:31:25,447 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:31:25,466 - DEBUG - [protocol.py:599] - < PING a0 38 f2 38 [binary, 4 bytes]
2025-02-07 14:31:25,469 - DEBUG - [protocol.py:745] - > PONG a0 38 f2 38 [binary, 4 bytes]
2025-02-07 14:31:45,453 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:31:45,454 - DEBUG - [protocol.py:745] - > PING 1d d2 15 ba [binary, 4 bytes]
2025-02-07 14:31:45,460 - DEBUG - [protocol.py:599] - < PONG 1d d2 15 ba [binary, 4 bytes]
2025-02-07 14:31:45,460 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:31:45,477 - DEBUG - [protocol.py:599] - < PING 1a 70 09 fe [binary, 4 bytes]
2025-02-07 14:31:45,478 - DEBUG - [protocol.py:745] - > PONG 1a 70 09 fe [binary, 4 bytes]
2025-02-07 14:32:05,457 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:32:05,457 - DEBUG - [protocol.py:745] - > PING 1d 05 12 e8 [binary, 4 bytes]
2025-02-07 14:32:05,464 - DEBUG - [protocol.py:599] - < PONG 1d 05 12 e8 [binary, 4 bytes]
2025-02-07 14:32:05,465 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:32:05,487 - DEBUG - [protocol.py:599] - < PING db cb af 68 [binary, 4 bytes]
2025-02-07 14:32:05,488 - DEBUG - [protocol.py:745] - > PONG db cb af 68 [binary, 4 bytes]
2025-02-07 14:32:25,468 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:32:25,470 - DEBUG - [protocol.py:745] - > PING 93 ee 95 ee [binary, 4 bytes]
2025-02-07 14:32:25,479 - DEBUG - [protocol.py:599] - < PONG 93 ee 95 ee [binary, 4 bytes]
2025-02-07 14:32:25,481 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:32:25,494 - DEBUG - [protocol.py:599] - < PING '`ؽ ' [text, 4 bytes]
2025-02-07 14:32:25,495 - DEBUG - [protocol.py:745] - > PONG '`ؽ ' [text, 4 bytes]
2025-02-07 14:32:45,479 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:32:45,483 - DEBUG - [protocol.py:745] - > PING 8f d0 be c5 [binary, 4 bytes]
2025-02-07 14:32:45,489 - DEBUG - [protocol.py:599] - < PONG 8f d0 be c5 [binary, 4 bytes]
2025-02-07 14:32:45,490 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:32:45,503 - DEBUG - [protocol.py:599] - < PING 28 61 7c ee [binary, 4 bytes]
2025-02-07 14:32:45,505 - DEBUG - [protocol.py:745] - > PONG 28 61 7c ee [binary, 4 bytes]
2025-02-07 14:33:05,489 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:33:05,490 - DEBUG - [protocol.py:745] - > PING 54 ce d1 8a [binary, 4 bytes]
2025-02-07 14:33:05,497 - DEBUG - [protocol.py:599] - < PONG 54 ce d1 8a [binary, 4 bytes]
2025-02-07 14:33:05,498 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:33:05,511 - DEBUG - [protocol.py:599] - < PING f8 ab 50 b4 [binary, 4 bytes]
2025-02-07 14:33:05,511 - DEBUG - [protocol.py:745] - > PONG f8 ab 50 b4 [binary, 4 bytes]
2025-02-07 14:33:25,504 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:33:25,506 - DEBUG - [protocol.py:745] - > PING c9 24 e1 8c [binary, 4 bytes]
2025-02-07 14:33:25,511 - DEBUG - [protocol.py:599] - < PONG c9 24 e1 8c [binary, 4 bytes]
2025-02-07 14:33:25,513 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:33:25,516 - DEBUG - [protocol.py:599] - < PING a5 4f 14 ce [binary, 4 bytes]
2025-02-07 14:33:25,518 - DEBUG - [protocol.py:745] - > PONG a5 4f 14 ce [binary, 4 bytes]
2025-02-07 14:33:45,508 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:33:45,508 - DEBUG - [protocol.py:745] - > PING 30 ce fe 65 [binary, 4 bytes]
2025-02-07 14:33:45,518 - DEBUG - [protocol.py:599] - < PONG 30 ce fe 65 [binary, 4 bytes]
2025-02-07 14:33:45,518 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:33:45,523 - DEBUG - [protocol.py:599] - < PING 'QRbw' [text, 4 bytes]
2025-02-07 14:33:45,525 - DEBUG - [protocol.py:745] - > PONG 'QRbw' [text, 4 bytes]
2025-02-07 14:34:05,524 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:34:05,527 - DEBUG - [protocol.py:745] - > PING '\n?sq' [text, 4 bytes]
2025-02-07 14:34:05,535 - DEBUG - [protocol.py:599] - < PONG '\n?sq' [text, 4 bytes]
2025-02-07 14:34:05,537 - DEBUG - [protocol.py:599] - < PING c5 b5 81 3d [binary, 4 bytes]
2025-02-07 14:34:05,538 - DEBUG - [protocol.py:745] - > PONG c5 b5 81 3d [binary, 4 bytes]
2025-02-07 14:34:05,541 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:34:25,535 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:34:25,538 - DEBUG - [protocol.py:745] - > PING ed e2 59 d4 [binary, 4 bytes]
2025-02-07 14:34:25,538 - DEBUG - [protocol.py:599] - < PONG ed e2 59 d4 [binary, 4 bytes]
2025-02-07 14:34:25,538 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:34:25,538 - DEBUG - [protocol.py:599] - < PING 4c 7c fc 10 [binary, 4 bytes]
2025-02-07 14:34:25,551 - DEBUG - [protocol.py:745] - > PONG 4c 7c fc 10 [binary, 4 bytes]
2025-02-07 14:34:45,541 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:34:45,543 - DEBUG - [protocol.py:745] - > PING 96 00 16 56 [binary, 4 bytes]
2025-02-07 14:34:45,551 - DEBUG - [protocol.py:599] - < PONG 96 00 16 56 [binary, 4 bytes]
2025-02-07 14:34:45,553 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:34:45,560 - DEBUG - [protocol.py:599] - < PING 1e 3b 1d ad [binary, 4 bytes]
2025-02-07 14:34:45,562 - DEBUG - [protocol.py:745] - > PONG 1e 3b 1d ad [binary, 4 bytes]
2025-02-07 14:35:05,557 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:35:05,557 - DEBUG - [protocol.py:745] - > PING fa fc dd 3e [binary, 4 bytes]
2025-02-07 14:35:05,560 - DEBUG - [protocol.py:599] - < PONG fa fc dd 3e [binary, 4 bytes]
2025-02-07 14:35:05,560 - DEBUG - [protocol.py:599] - < PING a8 a3 b0 29 [binary, 4 bytes]
2025-02-07 14:35:05,573 - DEBUG - [protocol.py:745] - > PONG a8 a3 b0 29 [binary, 4 bytes]
2025-02-07 14:35:05,575 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:35:09,268 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:35:09,268 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:35:09,280 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:35:09,282 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:35:09,334 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:35:09,334 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:35:09,338 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:35:09,338 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:35:09,342 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:35:09,342 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:35:09,693 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:35:09,693 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:35:09,693 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:35:09,693 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:35:09,696 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:35:09,696 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:35:09,993 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:35:09,993 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:10,188 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:35:10,188 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:10,410 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:10,410 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:10,664 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:10,664 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:10,887 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:10,887 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:35:11,094 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:35:11,094 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:35:11,094 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:35:11,094 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:35:11,301 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:35:11,301 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:35:11,301 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:35:11,301 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:35:11.301341",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:35:11,301 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:35:11,301 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:35:11,301 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:35:11,301 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:35:11,381 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:35:11,381 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:35:11.381550",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:35:11,414 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:35:11,414 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:35:11,414 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:35:11,414 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:35:25,563 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:35:25,563 - DEBUG - [protocol.py:745] - > PING 6c 5c a5 2d [binary, 4 bytes]
2025-02-07 14:35:25,567 - DEBUG - [protocol.py:599] - < PONG 6c 5c a5 2d [binary, 4 bytes]
2025-02-07 14:35:25,567 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:35:25,581 - DEBUG - [protocol.py:599] - < PING '\x02魷' [text, 4 bytes]
2025-02-07 14:35:25,585 - DEBUG - [protocol.py:745] - > PONG '\x02魷' [text, 4 bytes]
2025-02-07 14:35:45,567 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:35:45,568 - DEBUG - [protocol.py:745] - > PING '獟f' [text, 4 bytes]
2025-02-07 14:35:45,574 - DEBUG - [protocol.py:599] - < PONG '獟f' [text, 4 bytes]
2025-02-07 14:35:45,576 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:35:45,592 - DEBUG - [protocol.py:599] - < PING c1 6a 7d 93 [binary, 4 bytes]
2025-02-07 14:35:45,593 - DEBUG - [protocol.py:745] - > PONG c1 6a 7d 93 [binary, 4 bytes]
2025-02-07 14:36:05,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:36:05,595 - DEBUG - [protocol.py:745] - > PING b0 a6 d0 64 [binary, 4 bytes]
2025-02-07 14:36:05,601 - DEBUG - [protocol.py:599] - < PING 07 4b b9 5d [binary, 4 bytes]
2025-02-07 14:36:05,603 - DEBUG - [protocol.py:745] - > PONG 07 4b b9 5d [binary, 4 bytes]
2025-02-07 14:36:05,605 - DEBUG - [protocol.py:599] - < PONG b0 a6 d0 64 [binary, 4 bytes]
2025-02-07 14:36:05,607 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:36:25,606 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:36:25,606 - DEBUG - [protocol.py:745] - > PING d5 ea 36 2f [binary, 4 bytes]
2025-02-07 14:36:25,609 - DEBUG - [protocol.py:599] - < PING 'K౨' [text, 4 bytes]
2025-02-07 14:36:25,613 - DEBUG - [protocol.py:745] - > PONG 'K౨' [text, 4 bytes]
2025-02-07 14:36:25,615 - DEBUG - [protocol.py:599] - < PONG d5 ea 36 2f [binary, 4 bytes]
2025-02-07 14:36:25,616 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:36:45,605 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:36:45,606 - DEBUG - [protocol.py:745] - > PING 5c d3 ec 84 [binary, 4 bytes]
2025-02-07 14:36:45,612 - DEBUG - [protocol.py:599] - < PONG 5c d3 ec 84 [binary, 4 bytes]
2025-02-07 14:36:45,613 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:36:45,621 - DEBUG - [protocol.py:599] - < PING 36 21 70 f7 [binary, 4 bytes]
2025-02-07 14:36:45,622 - DEBUG - [protocol.py:745] - > PONG 36 21 70 f7 [binary, 4 bytes]
2025-02-07 14:37:05,612 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:37:05,614 - DEBUG - [protocol.py:745] - > PING 9e e0 cc 61 [binary, 4 bytes]
2025-02-07 14:37:05,622 - DEBUG - [protocol.py:599] - < PONG 9e e0 cc 61 [binary, 4 bytes]
2025-02-07 14:37:05,624 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:37:05,629 - DEBUG - [protocol.py:599] - < PING 9a ef 88 cb [binary, 4 bytes]
2025-02-07 14:37:05,631 - DEBUG - [protocol.py:745] - > PONG 9a ef 88 cb [binary, 4 bytes]
2025-02-07 14:37:25,622 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:37:25,625 - DEBUG - [protocol.py:745] - > PING aa 44 74 d8 [binary, 4 bytes]
2025-02-07 14:37:25,632 - DEBUG - [protocol.py:599] - < PONG aa 44 74 d8 [binary, 4 bytes]
2025-02-07 14:37:25,634 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:37:25,638 - DEBUG - [protocol.py:599] - < PING df a1 86 6b [binary, 4 bytes]
2025-02-07 14:37:25,640 - DEBUG - [protocol.py:745] - > PONG df a1 86 6b [binary, 4 bytes]
2025-02-07 14:37:45,636 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:37:45,637 - DEBUG - [protocol.py:745] - > PING 6c b7 c6 da [binary, 4 bytes]
2025-02-07 14:37:45,644 - DEBUG - [protocol.py:599] - < PONG 6c b7 c6 da [binary, 4 bytes]
2025-02-07 14:37:45,645 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:37:45,646 - DEBUG - [protocol.py:599] - < PING bf 9c 16 b9 [binary, 4 bytes]
2025-02-07 14:37:45,647 - DEBUG - [protocol.py:745] - > PONG bf 9c 16 b9 [binary, 4 bytes]
2025-02-07 14:38:05,648 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:38:05,650 - DEBUG - [protocol.py:745] - > PING fc d0 59 e8 [binary, 4 bytes]
2025-02-07 14:38:05,655 - DEBUG - [protocol.py:599] - < PING b7 16 bd 27 [binary, 4 bytes]
2025-02-07 14:38:05,656 - DEBUG - [protocol.py:745] - > PONG b7 16 bd 27 [binary, 4 bytes]
2025-02-07 14:38:05,660 - DEBUG - [protocol.py:599] - < PONG fc d0 59 e8 [binary, 4 bytes]
2025-02-07 14:38:05,661 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:38:25,651 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:38:25,652 - DEBUG - [protocol.py:745] - > PING b3 ab 93 33 [binary, 4 bytes]
2025-02-07 14:38:25,659 - DEBUG - [protocol.py:599] - < PONG b3 ab 93 33 [binary, 4 bytes]
2025-02-07 14:38:25,660 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:38:25,664 - DEBUG - [protocol.py:599] - < PING d6 81 f6 79 [binary, 4 bytes]
2025-02-07 14:38:25,664 - DEBUG - [protocol.py:745] - > PONG d6 81 f6 79 [binary, 4 bytes]
2025-02-07 14:38:45,651 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:38:45,653 - DEBUG - [protocol.py:745] - > PING 0a 63 ef e5 [binary, 4 bytes]
2025-02-07 14:38:45,661 - DEBUG - [protocol.py:599] - < PONG 0a 63 ef e5 [binary, 4 bytes]
2025-02-07 14:38:45,663 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:38:45,672 - DEBUG - [protocol.py:599] - < PING 25 53 71 f9 [binary, 4 bytes]
2025-02-07 14:38:45,673 - DEBUG - [protocol.py:745] - > PONG 25 53 71 f9 [binary, 4 bytes]
2025-02-07 14:39:05,672 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:39:05,673 - DEBUG - [protocol.py:745] - > PING 6d 20 91 84 [binary, 4 bytes]
2025-02-07 14:39:05,678 - DEBUG - [protocol.py:599] - < PING b6 00 7f 71 [binary, 4 bytes]
2025-02-07 14:39:05,679 - DEBUG - [protocol.py:745] - > PONG b6 00 7f 71 [binary, 4 bytes]
2025-02-07 14:39:05,680 - DEBUG - [protocol.py:599] - < PONG 6d 20 91 84 [binary, 4 bytes]
2025-02-07 14:39:05,681 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:39:25,667 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:39:25,668 - DEBUG - [protocol.py:745] - > PING de bc ef df [binary, 4 bytes]
2025-02-07 14:39:25,674 - DEBUG - [protocol.py:599] - < PONG de bc ef df [binary, 4 bytes]
2025-02-07 14:39:25,675 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:39:25,687 - DEBUG - [protocol.py:599] - < PING 33 32 7c de [binary, 4 bytes]
2025-02-07 14:39:25,687 - DEBUG - [protocol.py:745] - > PONG 33 32 7c de [binary, 4 bytes]
2025-02-07 14:39:45,681 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:39:45,684 - DEBUG - [protocol.py:745] - > PING 8b 29 3c bc [binary, 4 bytes]
2025-02-07 14:39:45,699 - DEBUG - [protocol.py:599] - < PONG 8b 29 3c bc [binary, 4 bytes]
2025-02-07 14:39:45,700 - DEBUG - [protocol.py:599] - < PING 1a 92 3d f1 [binary, 4 bytes]
2025-02-07 14:39:45,702 - DEBUG - [protocol.py:745] - > PONG 1a 92 3d f1 [binary, 4 bytes]
2025-02-07 14:39:45,704 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:40:05,692 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:40:05,695 - DEBUG - [protocol.py:745] - > PING 22 11 9a 39 [binary, 4 bytes]
2025-02-07 14:40:05,702 - DEBUG - [protocol.py:599] - < PONG 22 11 9a 39 [binary, 4 bytes]
2025-02-07 14:40:05,703 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:40:05,710 - DEBUG - [protocol.py:599] - < PING 07 28 fc 7e [binary, 4 bytes]
2025-02-07 14:40:05,711 - DEBUG - [protocol.py:745] - > PONG 07 28 fc 7e [binary, 4 bytes]
2025-02-07 14:40:12,534 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:40:12,535 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:40:12,536 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:40:12,537 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:40:12,574 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:40:12,574 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:40:12,575 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:40:12,576 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:40:12,576 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:40:12,577 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:40:12,874 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:40:12,875 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:40:12,875 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 14:40:12,875 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:40:12,876 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:40:12,876 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:40:13,105 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:40:13,106 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:13,328 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:13,329 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:40:13,329 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:40:13,330 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:40:13,330 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:40:13,331 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:13,608 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:13,608 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:13,830 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:13,830 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:14,054 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:14,054 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:40:14,312 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:40:14,313 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:40:14,313 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:40:14,314 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:40:14,531 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:40:14,531 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:40:14,532 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:40:14,532 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:40:14.532763",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:40:14,533 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:40:14,533 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:40:14,534 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:40:14,534 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:40:14,569 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:40:14,570 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:40:14,570 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:40:14,571 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:40:14,572 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:40:14,572 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:40:14,572 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:40:14.571186",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:40:14,605 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:40:14,605 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:40:14,605 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:40:14,606 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:40:25,708 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:40:25,709 - DEBUG - [protocol.py:745] - > PING e9 e4 af 23 [binary, 4 bytes]
2025-02-07 14:40:25,716 - DEBUG - [protocol.py:599] - < PONG e9 e4 af 23 [binary, 4 bytes]
2025-02-07 14:40:25,717 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:40:25,719 - DEBUG - [protocol.py:599] - < PING 8a 45 b9 12 [binary, 4 bytes]
2025-02-07 14:40:25,719 - DEBUG - [protocol.py:745] - > PONG 8a 45 b9 12 [binary, 4 bytes]
2025-02-07 14:40:45,726 - DEBUG - [protocol.py:599] - < PING 90 61 a3 a6 [binary, 4 bytes]
2025-02-07 14:40:45,727 - DEBUG - [protocol.py:745] - > PONG 90 61 a3 a6 [binary, 4 bytes]
2025-02-07 14:40:45,730 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:40:45,731 - DEBUG - [protocol.py:745] - > PING 66 f2 b1 3b [binary, 4 bytes]
2025-02-07 14:40:45,737 - DEBUG - [protocol.py:599] - < PONG 66 f2 b1 3b [binary, 4 bytes]
2025-02-07 14:40:45,739 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:41:05,728 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:41:05,729 - DEBUG - [protocol.py:745] - > PING 7f 4b a7 7d [binary, 4 bytes]
2025-02-07 14:41:05,735 - DEBUG - [protocol.py:599] - < PONG 7f 4b a7 7d [binary, 4 bytes]
2025-02-07 14:41:05,735 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:41:05,735 - DEBUG - [protocol.py:599] - < PING eb 2b fb 57 [binary, 4 bytes]
2025-02-07 14:41:05,735 - DEBUG - [protocol.py:745] - > PONG eb 2b fb 57 [binary, 4 bytes]
2025-02-07 14:41:25,743 - DEBUG - [protocol.py:599] - < PING 93 5e fd 7d [binary, 4 bytes]
2025-02-07 14:41:25,745 - DEBUG - [protocol.py:745] - > PONG 93 5e fd 7d [binary, 4 bytes]
2025-02-07 14:41:25,747 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:41:25,748 - DEBUG - [protocol.py:745] - > PING ce a2 7a d4 [binary, 4 bytes]
2025-02-07 14:41:25,756 - DEBUG - [protocol.py:599] - < PONG ce a2 7a d4 [binary, 4 bytes]
2025-02-07 14:41:25,758 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:41:45,751 - DEBUG - [protocol.py:599] - < PING 2d 96 0c 17 [binary, 4 bytes]
2025-02-07 14:41:45,752 - DEBUG - [protocol.py:745] - > PONG 2d 96 0c 17 [binary, 4 bytes]
2025-02-07 14:41:45,753 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:41:45,753 - DEBUG - [protocol.py:745] - > PING 73 c1 f7 9d [binary, 4 bytes]
2025-02-07 14:41:45,757 - DEBUG - [protocol.py:599] - < PONG 73 c1 f7 9d [binary, 4 bytes]
2025-02-07 14:41:45,759 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:42:05,760 - DEBUG - [protocol.py:599] - < PING d9 59 61 91 [binary, 4 bytes]
2025-02-07 14:42:05,761 - DEBUG - [protocol.py:745] - > PONG d9 59 61 91 [binary, 4 bytes]
2025-02-07 14:42:05,763 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:42:05,765 - DEBUG - [protocol.py:745] - > PING 31 82 60 56 [binary, 4 bytes]
2025-02-07 14:42:05,772 - DEBUG - [protocol.py:599] - < PONG 31 82 60 56 [binary, 4 bytes]
2025-02-07 14:42:05,774 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:42:25,770 - DEBUG - [protocol.py:599] - < PING b2 d2 27 15 [binary, 4 bytes]
2025-02-07 14:42:25,772 - DEBUG - [protocol.py:745] - > PONG b2 d2 27 15 [binary, 4 bytes]
2025-02-07 14:42:25,774 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:42:25,776 - DEBUG - [protocol.py:745] - > PING f1 0f 8a a0 [binary, 4 bytes]
2025-02-07 14:42:25,784 - DEBUG - [protocol.py:599] - < PONG f1 0f 8a a0 [binary, 4 bytes]
2025-02-07 14:42:25,786 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:42:45,775 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:42:45,776 - DEBUG - [protocol.py:745] - > PING 61 da bf cf [binary, 4 bytes]
2025-02-07 14:42:45,781 - DEBUG - [protocol.py:599] - < PING 81 1a 1f 00 [binary, 4 bytes]
2025-02-07 14:42:45,783 - DEBUG - [protocol.py:745] - > PONG 81 1a 1f 00 [binary, 4 bytes]
2025-02-07 14:42:45,786 - DEBUG - [protocol.py:599] - < PONG 61 da bf cf [binary, 4 bytes]
2025-02-07 14:42:45,788 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:43:05,778 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:43:05,779 - DEBUG - [protocol.py:745] - > PING '#G˦' [text, 4 bytes]
2025-02-07 14:43:05,786 - DEBUG - [protocol.py:599] - < PONG '#G˦' [text, 4 bytes]
2025-02-07 14:43:05,787 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:43:05,792 - DEBUG - [protocol.py:599] - < PING ce 6b 1f 87 [binary, 4 bytes]
2025-02-07 14:43:05,793 - DEBUG - [protocol.py:745] - > PONG ce 6b 1f 87 [binary, 4 bytes]
2025-02-07 14:43:25,785 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:43:25,785 - DEBUG - [protocol.py:745] - > PING da d7 ba 08 [binary, 4 bytes]
2025-02-07 14:43:25,785 - DEBUG - [protocol.py:599] - < PONG da d7 ba 08 [binary, 4 bytes]
2025-02-07 14:43:25,785 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:43:25,801 - DEBUG - [protocol.py:599] - < PING 35 91 6d 26 [binary, 4 bytes]
2025-02-07 14:43:25,802 - DEBUG - [protocol.py:745] - > PONG 35 91 6d 26 [binary, 4 bytes]
2025-02-07 14:43:40,101 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:43:40,101 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:43:40,110 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:43:40,110 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:43:40,113 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:43:40,114 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:43:40,114 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:43:47,784 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:43:47,784 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:43:47,784 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:43:47,784 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:43:47,816 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:43:47,816 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:43:47,827 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:43:47,827 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:43:47,827 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:43:47,828 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: w3sasLisE9PppB4yrz/XLg==
2025-02-07 14:43:47,828 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:43:47,828 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:43:47,829 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:43:47,848 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:43:47,848 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:43:47,848 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:43:47,848 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: SLpuefphZ/hbuk1p3wCGmOphdjE=
2025-02-07 14:43:47,848 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:43:47,849 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:43:46 GMT
2025-02-07 14:43:47,849 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:43:47,849 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:43:47,850 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:43:48,925 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:43:48,925 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:43:48,925 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:43:48,925 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:43:48,961 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:43:48,961 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:43:48,962 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:43:48,962 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:43:48,964 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:43:48,964 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:43:49,137 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:43:49,143 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:43:49,147 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:43:49,147 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:43:49,173 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:43:49,173 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:43:49,173 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:43:49,175 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:43:49,175 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:43:49,177 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:43:49,447 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:43:49,447 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:49,658 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:49,658 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:43:49,658 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:43:49,658 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:43:49,658 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:43:49,660 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:49,919 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:49,919 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:50,094 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:50,094 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:50,317 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:50,317 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:43:50,476 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:43:50,476 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:43:50,476 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:43:50,476 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:43:50,611 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:43:50,611 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:43:50,611 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:43:50,611 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:43:50.611152",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:43:50,622 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:43:50,622 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:43:50,622 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:43:50,624 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:43:50,648 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:43:50,648 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:43:50.648455",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:43:50,679 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:43:50,680 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:43:50,680 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:43:50,681 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:44:07,846 - DEBUG - [protocol.py:599] - < PING e8 68 af 06 [binary, 4 bytes]
2025-02-07 14:44:07,848 - DEBUG - [protocol.py:745] - > PONG e8 68 af 06 [binary, 4 bytes]
2025-02-07 14:44:07,849 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:44:07,849 - DEBUG - [protocol.py:745] - > PING 10 29 eb 1f [binary, 4 bytes]
2025-02-07 14:44:07,855 - DEBUG - [protocol.py:599] - < PONG 10 29 eb 1f [binary, 4 bytes]
2025-02-07 14:44:07,857 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:44:27,852 - DEBUG - [protocol.py:599] - < PING bf b3 ee af [binary, 4 bytes]
2025-02-07 14:44:27,852 - DEBUG - [protocol.py:745] - > PONG bf b3 ee af [binary, 4 bytes]
2025-02-07 14:44:27,852 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:44:27,852 - DEBUG - [protocol.py:745] - > PING ac 4b 19 b7 [binary, 4 bytes]
2025-02-07 14:44:27,852 - DEBUG - [protocol.py:599] - < PONG ac 4b 19 b7 [binary, 4 bytes]
2025-02-07 14:44:27,852 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:44:47,857 - DEBUG - [protocol.py:599] - < PING '(*9\x06' [text, 4 bytes]
2025-02-07 14:44:47,860 - DEBUG - [protocol.py:745] - > PONG '(*9\x06' [text, 4 bytes]
2025-02-07 14:44:47,890 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:44:47,892 - DEBUG - [protocol.py:745] - > PING f9 e8 71 de [binary, 4 bytes]
2025-02-07 14:44:47,892 - DEBUG - [protocol.py:599] - < PONG f9 e8 71 de [binary, 4 bytes]
2025-02-07 14:44:47,901 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:44:49,921 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:44:49,921 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:44:49,921 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 14:44:49,921 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:44:49,933 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:44:49,936 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:44:49,942 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:45:18,684 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:45:18,685 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:45:18,687 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:45:18,688 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:45:18,688 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:45:18,688 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:45:18,688 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:45:18,721 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:45:18,722 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:45:18,722 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:45:18,723 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:45:18,723 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:45:18,723 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: i38PpzLI1PilS7mL9jr6eg==
2025-02-07 14:45:18,724 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:45:18,724 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:45:18,724 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:45:18,905 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:45:18,905 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:45:18,906 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:45:18,906 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: pS6ishYSTQvyMiQ0sEK4aAID8Ao=
2025-02-07 14:45:18,907 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:45:18,908 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:45:17 GMT
2025-02-07 14:45:18,909 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:45:18,910 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:45:18,910 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:45:20,077 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:45:20,078 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:45:20,078 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:45:20,078 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:45:20,108 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:45:20,108 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:45:20,109 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:45:20,110 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:45:20,111 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:45:20,111 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:45:20,299 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:45:20,299 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:45:20,299 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:45:20,300 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:45:20,331 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:45:20,332 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:45:20,332 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:45:20,333 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:45:20,334 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:45:20,334 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:45:20,506 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:45:20,507 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:20,704 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:20,704 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:45:20,704 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:45:20,705 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:45:20,705 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:45:20,706 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:20,865 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:20,866 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:21,028 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:21,029 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:21,229 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:21,229 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:45:21,392 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:45:21,392 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:45:21,392 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:45:21,393 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:45:21,548 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:45:21,549 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:45:21,549 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:45:21,549 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:45:21.549589",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:45:21,551 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:45:21,551 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:45:21,551 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:45:21,552 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:45:21,579 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:45:21,580 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:45:21,580 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:45:21,581 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:45:21,582 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:45:21,582 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:45:21,582 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:45:21.581576",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:45:21,607 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:45:21,607 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:45:21,608 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:45:21,608 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:45:38,885 - DEBUG - [protocol.py:599] - < PING 2e 70 c2 29 [binary, 4 bytes]
2025-02-07 14:45:38,887 - DEBUG - [protocol.py:745] - > PONG 2e 70 c2 29 [binary, 4 bytes]
2025-02-07 14:45:38,932 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:45:38,933 - DEBUG - [protocol.py:745] - > PING fb 57 99 f6 [binary, 4 bytes]
2025-02-07 14:45:38,939 - DEBUG - [protocol.py:599] - < PONG fb 57 99 f6 [binary, 4 bytes]
2025-02-07 14:45:38,940 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:45:58,897 - DEBUG - [protocol.py:599] - < PING 78 53 f0 ae [binary, 4 bytes]
2025-02-07 14:45:58,899 - DEBUG - [protocol.py:745] - > PONG 78 53 f0 ae [binary, 4 bytes]
2025-02-07 14:45:58,938 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:45:58,944 - DEBUG - [protocol.py:745] - > PING 51 4d b7 fa [binary, 4 bytes]
2025-02-07 14:45:58,952 - DEBUG - [protocol.py:599] - < PONG 51 4d b7 fa [binary, 4 bytes]
2025-02-07 14:45:58,954 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:46:18,904 - DEBUG - [protocol.py:599] - < PING '9\x07w\x13' [text, 4 bytes]
2025-02-07 14:46:18,905 - DEBUG - [protocol.py:745] - > PONG '9\x07w\x13' [text, 4 bytes]
2025-02-07 14:46:18,961 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:46:18,961 - DEBUG - [protocol.py:745] - > PING 8a 7e 55 c8 [binary, 4 bytes]
2025-02-07 14:46:18,964 - DEBUG - [protocol.py:599] - < PONG 8a 7e 55 c8 [binary, 4 bytes]
2025-02-07 14:46:18,965 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:46:38,911 - DEBUG - [protocol.py:599] - < PING 9e 7c b8 37 [binary, 4 bytes]
2025-02-07 14:46:38,914 - DEBUG - [protocol.py:745] - > PONG 9e 7c b8 37 [binary, 4 bytes]
2025-02-07 14:46:38,975 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:46:38,976 - DEBUG - [protocol.py:745] - > PING c3 f8 90 85 [binary, 4 bytes]
2025-02-07 14:46:38,984 - DEBUG - [protocol.py:599] - < PONG c3 f8 90 85 [binary, 4 bytes]
2025-02-07 14:46:38,985 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:46:58,915 - DEBUG - [protocol.py:599] - < PING a6 e8 d7 a1 [binary, 4 bytes]
2025-02-07 14:46:58,915 - DEBUG - [protocol.py:745] - > PONG a6 e8 d7 a1 [binary, 4 bytes]
2025-02-07 14:46:58,981 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:46:58,985 - DEBUG - [protocol.py:745] - > PING 54 2d e4 cf [binary, 4 bytes]
2025-02-07 14:46:58,987 - DEBUG - [protocol.py:599] - < PONG 54 2d e4 cf [binary, 4 bytes]
2025-02-07 14:46:58,987 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:47:18,931 - DEBUG - [protocol.py:599] - < PING 90 5f a6 0f [binary, 4 bytes]
2025-02-07 14:47:18,933 - DEBUG - [protocol.py:745] - > PONG 90 5f a6 0f [binary, 4 bytes]
2025-02-07 14:47:19,014 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:47:19,017 - DEBUG - [protocol.py:745] - > PING d5 87 04 86 [binary, 4 bytes]
2025-02-07 14:47:19,026 - DEBUG - [protocol.py:599] - < PONG d5 87 04 86 [binary, 4 bytes]
2025-02-07 14:47:19,034 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:47:38,941 - DEBUG - [protocol.py:599] - < PING e5 bf 5f 00 [binary, 4 bytes]
2025-02-07 14:47:38,943 - DEBUG - [protocol.py:745] - > PONG e5 bf 5f 00 [binary, 4 bytes]
2025-02-07 14:47:39,027 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:47:39,029 - DEBUG - [protocol.py:745] - > PING c7 cd 1e 28 [binary, 4 bytes]
2025-02-07 14:47:39,035 - DEBUG - [protocol.py:599] - < PONG c7 cd 1e 28 [binary, 4 bytes]
2025-02-07 14:47:39,037 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:47:58,950 - DEBUG - [protocol.py:599] - < PING d4 3e 69 70 [binary, 4 bytes]
2025-02-07 14:47:58,951 - DEBUG - [protocol.py:745] - > PONG d4 3e 69 70 [binary, 4 bytes]
2025-02-07 14:47:59,045 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:47:59,046 - DEBUG - [protocol.py:745] - > PING b4 67 88 a7 [binary, 4 bytes]
2025-02-07 14:47:59,053 - DEBUG - [protocol.py:599] - < PONG b4 67 88 a7 [binary, 4 bytes]
2025-02-07 14:47:59,055 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:48:18,959 - DEBUG - [protocol.py:599] - < PING 50 e9 9b 2e [binary, 4 bytes]
2025-02-07 14:48:18,959 - DEBUG - [protocol.py:745] - > PONG 50 e9 9b 2e [binary, 4 bytes]
2025-02-07 14:48:19,039 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:48:19,044 - DEBUG - [protocol.py:745] - > PING 'L{A\x03' [text, 4 bytes]
2025-02-07 14:48:19,044 - DEBUG - [protocol.py:599] - < PONG 'L{A\x03' [text, 4 bytes]
2025-02-07 14:48:19,044 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:48:38,969 - DEBUG - [protocol.py:599] - < PING d3 9a d3 70 [binary, 4 bytes]
2025-02-07 14:48:38,969 - DEBUG - [protocol.py:745] - > PONG d3 9a d3 70 [binary, 4 bytes]
2025-02-07 14:48:39,026 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:48:39,028 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:48:39,028 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:48:39,028 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 14:48:55,299 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:48:55,301 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:48:55,301 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:48:55,303 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:48:55,335 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:48:55,338 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:48:55,339 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:48:55,341 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:48:55,341 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:48:55,342 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 6rqNU191LO2/TKPPnXU3nA==
2025-02-07 14:48:55,343 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:48:55,344 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:48:55,345 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:48:55,495 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:48:55,497 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:48:55,498 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:48:55,499 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: rzWqA3+hrZIFq0+GngEsa5hXg7w=
2025-02-07 14:48:55,500 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:48:55,503 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:48:53 GMT
2025-02-07 14:48:55,504 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:48:55,506 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:48:55,507 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:48:56,638 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:48:56,640 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:48:56,642 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:48:56,643 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:48:56,731 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:48:56,731 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:48:56,732 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:48:56,733 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:48:56,733 - INFO - [printer_monitor_service.py:515] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:48:56,733 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:48:56,967 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:48:56,967 - INFO - [printer_monitor_service.py:524] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:48:56,967 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:48:56,967 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:48:56,999 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:48:56,999 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:48:57,000 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:48:57,000 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:48:57,001 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:48:57,001 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:48:57,174 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:48:57,175 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:57,361 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:57,361 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:48:57,362 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:48:57,363 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:48:57,363 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:48:57,364 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:57,515 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:57,516 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:57,664 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:57,664 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:57,851 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:57,851 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:48:58,005 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:48:58,005 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:48:58,005 - INFO - [printer_monitor_service.py:545] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:48:58,005 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:48:58,160 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:48:58,160 - INFO - [printer_monitor_service.py:576] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:48:58,161 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:48:58,161 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:48:58.161383",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:48:58,162 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:48:58,162 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:48:58,162 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:48:58,162 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:48:58,198 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:48:58,200 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:48:58,200 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:48:58,201 - DEBUG - [printer_monitor_service.py:476] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:48:58,201 - DEBUG - [printer_monitor_service.py:477] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:48:58,202 - DEBUG - [printer_monitor_service.py:478] - Parámetros: {'agent_id': '1', 'self': 'true'}
2025-02-07 14:48:58,202 - DEBUG - [printer_monitor_service.py:479] - Datos: {
  "ip_address": "192.168.18.79",
  "last_check": "2025-02-07T19:48:58.201296",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:48:58,232 - ERROR - [printer_monitor_service.py:493] - Error actualizando datos para 192.168.18.79
2025-02-07 14:48:58,233 - ERROR - [printer_monitor_service.py:494] - Status: 500
2025-02-07 14:48:58,233 - ERROR - [printer_monitor_service.py:495] - Respuesta: Internal Server Error
2025-02-07 14:48:58,234 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:49:15,495 - DEBUG - [protocol.py:599] - < PING c5 c4 cd bf [binary, 4 bytes]
2025-02-07 14:49:15,497 - DEBUG - [protocol.py:745] - > PONG c5 c4 cd bf [binary, 4 bytes]
2025-02-07 14:49:15,520 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:49:15,521 - DEBUG - [protocol.py:745] - > PING f6 74 17 c9 [binary, 4 bytes]
2025-02-07 14:49:15,529 - DEBUG - [protocol.py:599] - < PONG f6 74 17 c9 [binary, 4 bytes]
2025-02-07 14:49:15,530 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:49:35,507 - DEBUG - [protocol.py:599] - < PING 18 c7 f2 ad [binary, 4 bytes]
2025-02-07 14:49:35,509 - DEBUG - [protocol.py:745] - > PONG 18 c7 f2 ad [binary, 4 bytes]
2025-02-07 14:49:35,511 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:49:35,513 - DEBUG - [protocol.py:745] - > PING 74 c2 6d f4 [binary, 4 bytes]
2025-02-07 14:49:35,524 - DEBUG - [protocol.py:599] - < PONG 74 c2 6d f4 [binary, 4 bytes]
2025-02-07 14:49:35,525 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:49:55,515 - DEBUG - [protocol.py:599] - < PING 13 b4 bb c3 [binary, 4 bytes]
2025-02-07 14:49:55,516 - DEBUG - [protocol.py:745] - > PONG 13 b4 bb c3 [binary, 4 bytes]
2025-02-07 14:49:55,517 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:49:55,517 - DEBUG - [protocol.py:745] - > PING 30 02 29 a2 [binary, 4 bytes]
2025-02-07 14:49:55,524 - DEBUG - [protocol.py:599] - < PONG 30 02 29 a2 [binary, 4 bytes]
2025-02-07 14:49:55,524 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:50:15,524 - DEBUG - [protocol.py:599] - < PING e3 2f 70 c2 [binary, 4 bytes]
2025-02-07 14:50:15,525 - DEBUG - [protocol.py:745] - > PONG e3 2f 70 c2 [binary, 4 bytes]
2025-02-07 14:50:15,526 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:50:15,526 - DEBUG - [protocol.py:745] - > PING 30 f6 2d ba [binary, 4 bytes]
2025-02-07 14:50:15,532 - DEBUG - [protocol.py:599] - < PONG 30 f6 2d ba [binary, 4 bytes]
2025-02-07 14:50:15,533 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:50:35,532 - DEBUG - [protocol.py:599] - < PING 52 50 e1 eb [binary, 4 bytes]
2025-02-07 14:50:35,534 - DEBUG - [protocol.py:745] - > PONG 52 50 e1 eb [binary, 4 bytes]
2025-02-07 14:50:35,536 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:50:35,538 - DEBUG - [protocol.py:745] - > PING 04 44 88 26 [binary, 4 bytes]
2025-02-07 14:50:35,547 - DEBUG - [protocol.py:599] - < PONG 04 44 88 26 [binary, 4 bytes]
2025-02-07 14:50:35,549 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:50:55,541 - DEBUG - [protocol.py:599] - < PING b6 73 12 2f [binary, 4 bytes]
2025-02-07 14:50:55,543 - DEBUG - [protocol.py:745] - > PONG b6 73 12 2f [binary, 4 bytes]
2025-02-07 14:50:55,545 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:50:55,546 - DEBUG - [protocol.py:745] - > PING 64 04 7a 85 [binary, 4 bytes]
2025-02-07 14:50:55,554 - DEBUG - [protocol.py:599] - < PONG 64 04 7a 85 [binary, 4 bytes]
2025-02-07 14:50:55,558 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:51:15,553 - DEBUG - [protocol.py:599] - < PING 5d 9e 5b cd [binary, 4 bytes]
2025-02-07 14:51:15,554 - DEBUG - [protocol.py:745] - > PONG 5d 9e 5b cd [binary, 4 bytes]
2025-02-07 14:51:15,556 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:51:15,557 - DEBUG - [protocol.py:745] - > PING 3b 3a 8b c1 [binary, 4 bytes]
2025-02-07 14:51:15,565 - DEBUG - [protocol.py:599] - < PONG 3b 3a 8b c1 [binary, 4 bytes]
2025-02-07 14:51:15,566 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:51:35,558 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:51:35,562 - DEBUG - [protocol.py:745] - > PING b2 41 8b fa [binary, 4 bytes]
2025-02-07 14:51:35,564 - DEBUG - [protocol.py:599] - < PING cd fe d7 5a [binary, 4 bytes]
2025-02-07 14:51:35,567 - DEBUG - [protocol.py:745] - > PONG cd fe d7 5a [binary, 4 bytes]
2025-02-07 14:51:35,572 - DEBUG - [protocol.py:599] - < PONG b2 41 8b fa [binary, 4 bytes]
2025-02-07 14:51:35,574 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:51:55,572 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:51:55,572 - DEBUG - [protocol.py:745] - > PING 36 5e c2 15 [binary, 4 bytes]
2025-02-07 14:51:55,572 - DEBUG - [protocol.py:599] - < PING 51 b3 57 a1 [binary, 4 bytes]
2025-02-07 14:51:55,577 - DEBUG - [protocol.py:745] - > PONG 51 b3 57 a1 [binary, 4 bytes]
2025-02-07 14:51:55,582 - DEBUG - [protocol.py:599] - < PONG 36 5e c2 15 [binary, 4 bytes]
2025-02-07 14:51:55,586 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:52:06,281 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:52:06,282 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:52:06,284 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:52:06,285 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:52:06,286 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:52:06,287 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:52:06,287 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:52:06,289 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 14:52:56,299 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:52:56,301 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:52:56,301 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:52:56,301 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:52:56,301 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:52:56,302 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:52:56,303 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:52:56,334 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:52:56,335 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:52:56,336 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:52:56,336 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:52:56,336 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:52:56,337 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: L/J+f9wyO9XZ7J9fBoxWCw==
2025-02-07 14:52:56,337 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:52:56,337 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:52:56,337 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:52:56,528 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:52:56,530 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:52:56,530 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:52:56,531 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: OL9S9X3SkFf456dPt2AKfDYWzJk=
2025-02-07 14:52:56,531 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:52:56,532 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:52:54 GMT
2025-02-07 14:52:56,533 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:52:56,534 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:52:56,534 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:52:57,685 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:52:57,687 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:52:57,687 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:52:57,689 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:52:57,725 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:52:57,726 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:52:57,727 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:52:57,728 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:52:57,729 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:52:57,729 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:52:57,903 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:52:57,903 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:52:57,904 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:52:57,904 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:52:57,940 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:52:57,941 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:52:57,942 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:52:57,944 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:52:57,945 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:52:57,947 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:52:58,132 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:52:58,132 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,313 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,313 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:52:58,313 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:52:58,314 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:52:58,314 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:52:58,314 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,468 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,469 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,621 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,622 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,807 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,808 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:52:58,958 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:52:58,958 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:52:58,959 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:52:58,959 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:52:59,112 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:52:59,113 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:52:59,113 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:52:59,114 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:52:59.113256",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:52:59,114 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:52:59,114 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:52:59,115 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:52:59,115 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:52:59,147 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:52:59,147 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:52:59,147 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:52:59,148 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:52:59,148 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:52:59,150 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 14:52:59,150 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T19:52:59.148936",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:52:59,171 - ERROR - [printer_monitor_service.py:492] - Error actualizando datos para 192.168.18.79
2025-02-07 14:52:59,171 - ERROR - [printer_monitor_service.py:493] - Status: 500
2025-02-07 14:52:59,171 - ERROR - [printer_monitor_service.py:494] - Respuesta: {"detail":"PrinterMonitorService.update_printer_data() got an unexpected keyword argument 'agent_id'"}
2025-02-07 14:52:59,172 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:53:09,533 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:53:09,535 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:53:09,536 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:53:09,537 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:53:09,538 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:53:09,539 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:53:09,541 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:53:09,542 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 14:56:06,868 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 14:56:06,868 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 14:56:06,868 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 14:56:06,871 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 14:56:06,871 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 14:56:06,871 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 14:56:06,905 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 14:56:06,907 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 14:56:06,909 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 14:56:06,909 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 14:56:06,910 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 14:56:06,910 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: O8g57aOwf8A5fPbVk5sIVA==
2025-02-07 14:56:06,911 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 14:56:06,911 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 14:56:06,912 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 14:56:07,076 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: qZuNsbgJgV9q4BGzPZ4upgYkktw=
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 19:56:06 GMT
2025-02-07 14:56:07,078 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 14:56:07,078 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 14:56:07,080 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 14:56:08,271 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 14:56:08,276 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:56:08,276 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:56:08,278 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:56:08,328 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:56:08,328 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:56:08,328 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:56:08,329 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 14:56:08,329 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 14:56:08,330 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 14:56:08,506 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 14:56:08,506 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 14:56:08,506 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 14:56:08,507 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 14:56:08,540 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 14:56:08,540 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 14:56:08,540 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:56:08,547 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 14:56:08,547 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:56:08,547 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 14:56:08,703 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 14:56:08,703 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:08,900 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:08,900 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 14:56:08,900 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 14:56:08,903 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 14:56:08,903 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 14:56:08,903 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:09,052 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:09,052 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:09,202 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:09,202 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:09,403 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:09,403 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 14:56:09,561 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 14:56:09,561 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 14:56:09,561 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 14:56:09,562 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 14:56:09,708 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 14:56:09,708 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 14:56:09,708 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 14:56:09,708 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T19:56:09.708566",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 14:56:09,717 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 14:56:09,717 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 14:56:09,717 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 14:56:09,717 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:56:09,744 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"offline","client_id":4}]...
2025-02-07 14:56:09,751 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 14:56:09,752 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-07 14:56:09,753 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 14:56:09,753 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 14:56:09,754 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 14:56:09,754 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T19:56:09.753973",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 14:56:09,790 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 14:56:09,790 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 14:56:27,067 - DEBUG - [protocol.py:599] - < PING 04 45 60 99 [binary, 4 bytes]
2025-02-07 14:56:27,081 - DEBUG - [protocol.py:745] - > PONG 04 45 60 99 [binary, 4 bytes]
2025-02-07 14:56:27,081 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:56:27,084 - DEBUG - [protocol.py:745] - > PING 48 a9 ad f6 [binary, 4 bytes]
2025-02-07 14:56:27,089 - DEBUG - [protocol.py:599] - < PONG 48 a9 ad f6 [binary, 4 bytes]
2025-02-07 14:56:27,096 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:56:47,081 - DEBUG - [protocol.py:599] - < PING 1d b1 c3 c2 [binary, 4 bytes]
2025-02-07 14:56:47,081 - DEBUG - [protocol.py:745] - > PONG 1d b1 c3 c2 [binary, 4 bytes]
2025-02-07 14:56:47,097 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:56:47,097 - DEBUG - [protocol.py:745] - > PING a3 6c d7 e4 [binary, 4 bytes]
2025-02-07 14:56:47,097 - DEBUG - [protocol.py:599] - < PONG a3 6c d7 e4 [binary, 4 bytes]
2025-02-07 14:56:47,097 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:57:07,103 - DEBUG - [protocol.py:599] - < PING 45 0b 80 dd [binary, 4 bytes]
2025-02-07 14:57:07,103 - DEBUG - [protocol.py:745] - > PONG 45 0b 80 dd [binary, 4 bytes]
2025-02-07 14:57:07,103 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:57:07,103 - DEBUG - [protocol.py:745] - > PING 5f 76 48 94 [binary, 4 bytes]
2025-02-07 14:57:07,113 - DEBUG - [protocol.py:599] - < PONG 5f 76 48 94 [binary, 4 bytes]
2025-02-07 14:57:07,113 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:57:27,111 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:57:27,113 - DEBUG - [protocol.py:745] - > PING 7e 3e bb 95 [binary, 4 bytes]
2025-02-07 14:57:27,116 - DEBUG - [protocol.py:599] - < PING 8b 3d aa c0 [binary, 4 bytes]
2025-02-07 14:57:27,117 - DEBUG - [protocol.py:745] - > PONG 8b 3d aa c0 [binary, 4 bytes]
2025-02-07 14:57:27,121 - DEBUG - [protocol.py:599] - < PONG 7e 3e bb 95 [binary, 4 bytes]
2025-02-07 14:57:27,123 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:57:47,121 - DEBUG - [protocol.py:599] - < PING 29 47 a7 2b [binary, 4 bytes]
2025-02-07 14:57:47,121 - DEBUG - [protocol.py:745] - > PONG 29 47 a7 2b [binary, 4 bytes]
2025-02-07 14:57:47,129 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:57:47,129 - DEBUG - [protocol.py:745] - > PING bc b7 a0 ad [binary, 4 bytes]
2025-02-07 14:57:47,137 - DEBUG - [protocol.py:599] - < PONG bc b7 a0 ad [binary, 4 bytes]
2025-02-07 14:57:47,139 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:58:07,134 - DEBUG - [protocol.py:599] - < PING 66 fb 4c be [binary, 4 bytes]
2025-02-07 14:58:07,138 - DEBUG - [protocol.py:745] - > PONG 66 fb 4c be [binary, 4 bytes]
2025-02-07 14:58:07,138 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 14:58:07,142 - DEBUG - [protocol.py:745] - > PING 7c fe fb 4a [binary, 4 bytes]
2025-02-07 14:58:07,148 - DEBUG - [protocol.py:599] - < PONG 7c fe fb 4a [binary, 4 bytes]
2025-02-07 14:58:07,151 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 14:58:21,369 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:58:21,371 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 14:58:21,371 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 14:58:21,373 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 14:58:21,373 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 14:58:21,373 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 14:58:21,373 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 14:58:21,375 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 15:00:11,639 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 15:00:11,639 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 15:00:11,639 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 15:00:11,653 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 15:00:11,653 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 15:00:11,653 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 15:00:11,653 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:00:21,682 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: timed out during handshake
2025-02-07 15:00:31,686 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:00:33,756 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:00:43,758 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:00:45,820 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:00:55,829 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:00:57,873 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:07,890 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:09,942 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:19,945 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:22,015 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:32,023 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:34,082 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:44,088 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:46,157 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:01:56,170 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:01:58,222 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:08,225 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:10,286 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:20,290 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:22,367 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:32,381 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:34,438 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:44,453 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:46,534 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:02:56,549 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:02:58,606 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:08,617 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:10,662 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:20,666 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:22,729 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:32,737 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:34,809 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:44,824 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:46,888 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:03:56,904 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:03:58,971 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:08,981 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:11,034 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:21,041 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:23,089 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:33,092 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:35,151 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:45,155 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:47,221 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:04:57,236 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:04:59,299 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:09,314 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:11,394 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:21,417 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:23,477 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:33,479 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:35,561 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:45,567 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:47,640 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:05:57,654 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:05:59,720 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:09,737 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:06:11,793 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:21,797 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:06:23,858 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:33,870 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:06:35,947 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:45,958 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:06:48,017 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:06:58,027 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:00,097 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:10,107 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:12,196 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:22,208 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:24,282 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:34,293 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:36,362 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:46,371 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:07:48,443 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:07:58,455 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:00,502 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:10,514 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:12,587 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:22,594 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:24,666 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:34,668 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:36,737 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:46,746 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:08:48,826 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:08:58,829 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:00,900 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:10,908 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:12,971 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:22,977 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:25,054 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:35,057 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:37,115 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:47,124 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:09:49,191 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:09:59,202 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:01,261 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:11,272 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:13,330 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:23,331 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:25,391 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:35,401 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:37,475 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:47,479 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:10:49,537 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:10:59,542 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:01,603 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:11,609 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:13,687 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:23,692 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:25,776 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:35,796 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:37,862 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:47,875 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:11:49,933 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:11:59,937 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:02,008 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:12:12,017 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:14,105 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:12:24,108 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:26,164 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:12:36,170 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:38,244 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:12:48,252 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:12:50,318 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:00,327 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:02,391 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:12,399 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:14,463 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:24,477 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:26,521 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:36,529 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:38,614 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:13:48,624 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:13:50,676 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:00,683 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:02,745 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:12,751 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:14,815 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:24,827 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:26,891 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:36,906 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:38,950 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:14:48,964 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:14:51,015 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:01,024 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:03,110 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:13,123 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:15,180 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:25,182 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:27,238 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:37,250 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:39,310 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:15:49,313 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:15:51,381 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:01,384 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:03,454 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:13,461 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:15,535 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:25,542 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:27,588 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:37,597 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:39,652 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:16:49,661 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:16:51,708 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:01,717 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:03,776 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:13,788 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:15,847 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:25,857 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:27,904 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:37,916 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:39,954 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:17:49,962 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:17:52,009 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:02,017 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:04,106 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:14,112 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:16,183 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:26,191 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:28,265 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:38,275 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:40,339 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:18:50,354 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:18:52,431 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:02,438 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:04,483 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:14,491 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:16,566 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:26,577 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:28,637 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:38,649 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:40,731 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:19:50,736 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:19:52,800 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:02,807 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:04,881 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:14,884 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:16,957 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:26,965 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:29,027 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:39,041 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:41,105 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:20:51,107 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:20:53,171 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:03,174 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:05,223 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:15,234 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:17,312 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:27,329 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:29,401 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:39,411 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:41,476 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:21:51,487 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:21:53,544 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:03,559 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:05,631 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:15,641 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:17,705 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:27,719 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:29,776 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:39,782 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:41,841 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:22:51,854 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:22:53,928 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:03,929 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:05,999 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:16,007 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:18,055 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:28,066 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:30,127 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:40,139 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:42,199 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: [WinError 1225] El equipo remoto rechazó la conexión de red
2025-02-07 15:23:52,213 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:23:52,218 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 15:23:52,223 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 15:23:52,226 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 15:23:52,226 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 15:23:52,229 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 15:23:52,230 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: wlGOlR013GVEEntaZdlnHg==
2025-02-07 15:23:52,232 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 15:23:52,234 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 15:23:52,238 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 15:23:52,418 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 15:23:52,426 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 15:23:52,428 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 15:23:52,429 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: 1XME3Q8037uUQo2Lr4vFSxV3t28=
2025-02-07 15:23:52,430 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 15:23:52,431 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 20:23:51 GMT
2025-02-07 15:23:52,431 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 15:23:52,433 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 15:23:52,434 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 15:23:53,578 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:23:53,580 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:23:53,580 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:23:53,582 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:23:53,620 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:23:53,622 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:23:53,623 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:23:53,625 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:23:53,626 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:23:53,627 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:23:53,805 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:23:53,806 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:23:53,806 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 15:23:53,807 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 15:23:53,837 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 15:23:53,839 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 15:23:53,840 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:23:53,841 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:23:53,841 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:23:53,842 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:23:54,009 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:23:54,009 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,206 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,206 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:23:54,207 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:23:54,207 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:23:54,207 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:23:54,208 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,366 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,367 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,532 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,532 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,727 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,728 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:23:54,883 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:23:54,883 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:23:54,883 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:23:54,885 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:23:55,039 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:23:55,040 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:23:55,041 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:23:55,041 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:23:55.041373",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:23:55,042 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:23:55,042 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:23:55,042 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:23:55,043 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:23:55,070 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:23:55,072 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:23:55,072 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:23:55,073 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:23:55,074 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:23:55,074 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:23:55,074 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:23:55.073444",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:23:55,104 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:23:55,105 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:24:12,417 - DEBUG - [protocol.py:599] - < PING 2b 47 6b d6 [binary, 4 bytes]
2025-02-07 15:24:12,418 - DEBUG - [protocol.py:745] - > PONG 2b 47 6b d6 [binary, 4 bytes]
2025-02-07 15:24:12,420 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:24:12,421 - DEBUG - [protocol.py:745] - > PING dd 4e 8f e5 [binary, 4 bytes]
2025-02-07 15:24:12,426 - DEBUG - [protocol.py:599] - < PONG dd 4e 8f e5 [binary, 4 bytes]
2025-02-07 15:24:12,427 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:24:18,696 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 15:24:18,699 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 15:24:18,705 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 15:24:18,707 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 15:24:18,707 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 15:24:18,709 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 15:24:18,710 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 15:24:25,556 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 15:24:25,558 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 15:24:25,558 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 15:24:25,558 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:24:25,594 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 15:24:25,596 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: /AIMAaCtYaIPu0DC0+BcwA==
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 15:24:25,596 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 15:24:25,620 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 15:24:25,620 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 15:24:25,620 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 15:24:25,622 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: wjLoCqBMYgJn6yiMp+RvBbHa7wo=
2025-02-07 15:24:25,622 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 15:24:25,623 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 20:24:24 GMT
2025-02-07 15:24:25,623 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 15:24:25,623 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 15:24:25,625 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 15:24:26,716 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:24:26,716 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:24:26,716 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:24:26,719 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:24:26,746 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:24:26,746 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:24:26,751 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:24:26,751 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:24:26,751 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:24:26,751 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:24:28,582 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:24:28,585 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:24:28,586 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 15:24:28,588 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 15:24:28,611 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 15:24:28,615 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 15:24:28,615 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:24:28,617 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:24:28,617 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:24:28,618 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:24:28,777 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:24:28,777 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:28,966 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:28,966 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:24:28,966 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:24:28,969 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:24:28,969 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:24:28,969 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:29,127 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:29,127 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:29,279 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:29,279 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:29,476 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:29,476 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:24:29,627 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:24:29,627 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:24:29,627 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:24:29,627 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:24:29,777 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:24:29,781 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:24:29,781 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:24:29,781 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:24:29.781829",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:24:29,781 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:24:29,781 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:24:29,781 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:24:29,781 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:24:29,816 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:24:29,816 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:24:29.816692",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:24:29,856 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:24:29,857 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:24:45,623 - DEBUG - [protocol.py:599] - < PING b3 5e 1a 49 [binary, 4 bytes]
2025-02-07 15:24:45,623 - DEBUG - [protocol.py:745] - > PONG b3 5e 1a 49 [binary, 4 bytes]
2025-02-07 15:24:45,623 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:24:45,628 - DEBUG - [protocol.py:745] - > PING 11 d0 c3 91 [binary, 4 bytes]
2025-02-07 15:24:45,636 - DEBUG - [protocol.py:599] - < PONG 11 d0 c3 91 [binary, 4 bytes]
2025-02-07 15:24:45,636 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:25:05,629 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:25:05,629 - DEBUG - [protocol.py:745] - > PING 07 18 48 dd [binary, 4 bytes]
2025-02-07 15:25:05,629 - DEBUG - [protocol.py:599] - < PING f5 d6 b9 90 [binary, 4 bytes]
2025-02-07 15:25:05,629 - DEBUG - [protocol.py:745] - > PONG f5 d6 b9 90 [binary, 4 bytes]
2025-02-07 15:25:05,641 - DEBUG - [protocol.py:599] - < PONG 07 18 48 dd [binary, 4 bytes]
2025-02-07 15:25:05,642 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:25:25,635 - DEBUG - [protocol.py:599] - < PING 22 95 8a 3c [binary, 4 bytes]
2025-02-07 15:25:25,635 - DEBUG - [protocol.py:745] - > PONG 22 95 8a 3c [binary, 4 bytes]
2025-02-07 15:25:25,651 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:25:25,651 - DEBUG - [protocol.py:745] - > PING 1f c3 10 4c [binary, 4 bytes]
2025-02-07 15:25:25,658 - DEBUG - [protocol.py:599] - < PONG 1f c3 10 4c [binary, 4 bytes]
2025-02-07 15:25:25,659 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:25:45,657 - DEBUG - [protocol.py:599] - < PING 91 e7 8a 90 [binary, 4 bytes]
2025-02-07 15:25:45,657 - DEBUG - [protocol.py:745] - > PONG 91 e7 8a 90 [binary, 4 bytes]
2025-02-07 15:25:45,679 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:25:45,681 - DEBUG - [protocol.py:745] - > PING c9 de 20 da [binary, 4 bytes]
2025-02-07 15:25:45,692 - DEBUG - [protocol.py:599] - < PONG c9 de 20 da [binary, 4 bytes]
2025-02-07 15:25:45,695 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:26:05,669 - DEBUG - [protocol.py:599] - < PING 7d 45 ec 53 [binary, 4 bytes]
2025-02-07 15:26:05,671 - DEBUG - [protocol.py:745] - > PONG 7d 45 ec 53 [binary, 4 bytes]
2025-02-07 15:26:05,673 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:26:05,674 - DEBUG - [protocol.py:745] - > PING 1c 0e af 3d [binary, 4 bytes]
2025-02-07 15:26:05,680 - DEBUG - [protocol.py:599] - < PONG 1c 0e af 3d [binary, 4 bytes]
2025-02-07 15:26:05,683 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:26:25,678 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:26:25,680 - DEBUG - [protocol.py:745] - > PING b3 9c 03 a8 [binary, 4 bytes]
2025-02-07 15:26:25,682 - DEBUG - [protocol.py:599] - < PING 2c dd a3 bf [binary, 4 bytes]
2025-02-07 15:26:25,684 - DEBUG - [protocol.py:745] - > PONG 2c dd a3 bf [binary, 4 bytes]
2025-02-07 15:26:25,687 - DEBUG - [protocol.py:599] - < PONG b3 9c 03 a8 [binary, 4 bytes]
2025-02-07 15:26:25,689 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:26:25,743 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-07 15:26:25,744 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 15:26:25,752 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-07 15:26:25,753 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 15:26:25,754 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 15:26:25,754 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 15:26:25,755 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 15:26:30,472 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 15:26:30,475 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 15:26:30,475 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 15:26:30,476 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 15:26:30,477 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:26:30,507 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 15:26:30,507 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: ECSX/Fqh97Ag/yb+L6tV7A==
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 15:26:30,507 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 15:26:30,536 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: l/huP7yeBc+Ufp551ZpEf/MHbgY=
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 15:26:30,536 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 20:26:29 GMT
2025-02-07 15:26:30,538 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 15:26:30,538 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 15:26:30,538 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 15:26:31,621 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:26:31,621 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:26:31,622 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:26:31,623 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:26:31,644 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:26:31,644 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:26:31,652 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:26:31,653 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:26:31,653 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:26:31,654 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:26:31,832 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:26:31,833 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:26:31,833 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 15:26:31,833 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 15:26:31,854 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 15:26:31,855 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 15:26:31,855 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:26:31,855 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:26:31,856 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:26:31,856 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:26:32,023 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:26:32,024 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,261 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,261 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:26:32,261 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:26:32,261 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:26:32,263 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:26:32,263 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,424 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,425 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,586 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,586 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,783 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,784 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:26:32,942 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:26:32,942 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:26:32,942 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:26:32,943 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:26:33,086 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:26:33,086 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:26:33,086 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:26:33,086 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:26:33.086764",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:26:33,100 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:26:33,100 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:26:33,101 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:26:33,101 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:26:33,125 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:26:33,125 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:26:33.125214",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:26:33,154 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:26:33,154 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:26:50,539 - DEBUG - [protocol.py:599] - < PING 21 00 cd f7 [binary, 4 bytes]
2025-02-07 15:26:50,540 - DEBUG - [protocol.py:745] - > PONG 21 00 cd f7 [binary, 4 bytes]
2025-02-07 15:26:50,544 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:26:50,544 - DEBUG - [protocol.py:745] - > PING 03 5a 01 e2 [binary, 4 bytes]
2025-02-07 15:26:50,556 - DEBUG - [protocol.py:599] - < PONG 03 5a 01 e2 [binary, 4 bytes]
2025-02-07 15:26:50,558 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:27:10,546 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:27:10,548 - DEBUG - [protocol.py:745] - > PING 4a a0 cb 1d [binary, 4 bytes]
2025-02-07 15:27:10,549 - DEBUG - [protocol.py:599] - < PING a6 0a 51 ab [binary, 4 bytes]
2025-02-07 15:27:10,550 - DEBUG - [protocol.py:745] - > PONG a6 0a 51 ab [binary, 4 bytes]
2025-02-07 15:27:10,552 - DEBUG - [protocol.py:599] - < PONG 4a a0 cb 1d [binary, 4 bytes]
2025-02-07 15:27:10,554 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:27:30,542 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:27:30,542 - DEBUG - [protocol.py:745] - > PING a8 36 fb 99 [binary, 4 bytes]
2025-02-07 15:27:30,542 - DEBUG - [protocol.py:599] - < PONG a8 36 fb 99 [binary, 4 bytes]
2025-02-07 15:27:30,542 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:27:30,558 - DEBUG - [protocol.py:599] - < PING f8 07 08 8c [binary, 4 bytes]
2025-02-07 15:27:30,558 - DEBUG - [protocol.py:745] - > PONG f8 07 08 8c [binary, 4 bytes]
2025-02-07 15:27:50,559 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:27:50,559 - DEBUG - [protocol.py:745] - > PING 49 9f 16 98 [binary, 4 bytes]
2025-02-07 15:27:50,559 - DEBUG - [protocol.py:599] - < PING 3a e0 24 1b [binary, 4 bytes]
2025-02-07 15:27:50,559 - DEBUG - [protocol.py:745] - > PONG 3a e0 24 1b [binary, 4 bytes]
2025-02-07 15:27:50,573 - DEBUG - [protocol.py:599] - < PONG 49 9f 16 98 [binary, 4 bytes]
2025-02-07 15:27:50,575 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:28:10,572 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:28:10,572 - DEBUG - [protocol.py:745] - > PING 03 ea 15 3a [binary, 4 bytes]
2025-02-07 15:28:10,572 - DEBUG - [protocol.py:599] - < PING 11 8c 25 36 [binary, 4 bytes]
2025-02-07 15:28:10,572 - DEBUG - [protocol.py:745] - > PONG 11 8c 25 36 [binary, 4 bytes]
2025-02-07 15:28:10,572 - DEBUG - [protocol.py:599] - < PONG 03 ea 15 3a [binary, 4 bytes]
2025-02-07 15:28:10,572 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:28:30,584 - DEBUG - [protocol.py:599] - < PING f7 fb c2 01 [binary, 4 bytes]
2025-02-07 15:28:30,584 - DEBUG - [protocol.py:745] - > PONG f7 fb c2 01 [binary, 4 bytes]
2025-02-07 15:28:30,584 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:28:30,584 - DEBUG - [protocol.py:745] - > PING 'zȼ]' [text, 4 bytes]
2025-02-07 15:28:30,584 - DEBUG - [protocol.py:599] - < PONG 'zȼ]' [text, 4 bytes]
2025-02-07 15:28:30,584 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:28:50,594 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:28:50,596 - DEBUG - [protocol.py:745] - > PING 9b 2b f4 e6 [binary, 4 bytes]
2025-02-07 15:28:50,598 - DEBUG - [protocol.py:599] - < PING '`݄V' [text, 4 bytes]
2025-02-07 15:28:50,600 - DEBUG - [protocol.py:745] - > PONG '`݄V' [text, 4 bytes]
2025-02-07 15:28:50,604 - DEBUG - [protocol.py:599] - < PONG 9b 2b f4 e6 [binary, 4 bytes]
2025-02-07 15:28:50,606 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:29:10,598 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:29:10,600 - DEBUG - [protocol.py:745] - > PING 88 94 c5 9b [binary, 4 bytes]
2025-02-07 15:29:10,608 - DEBUG - [protocol.py:599] - < PING 91 25 09 3f [binary, 4 bytes]
2025-02-07 15:29:10,609 - DEBUG - [protocol.py:745] - > PONG 91 25 09 3f [binary, 4 bytes]
2025-02-07 15:29:10,612 - DEBUG - [protocol.py:599] - < PONG 88 94 c5 9b [binary, 4 bytes]
2025-02-07 15:29:10,616 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:29:30,606 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:29:30,607 - DEBUG - [protocol.py:745] - > PING 2a 1d 87 2f [binary, 4 bytes]
2025-02-07 15:29:30,615 - DEBUG - [protocol.py:599] - < PING b8 18 3e 79 [binary, 4 bytes]
2025-02-07 15:29:30,616 - DEBUG - [protocol.py:745] - > PONG b8 18 3e 79 [binary, 4 bytes]
2025-02-07 15:29:30,618 - DEBUG - [protocol.py:599] - < PONG 2a 1d 87 2f [binary, 4 bytes]
2025-02-07 15:29:30,619 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:29:50,612 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:29:50,615 - DEBUG - [protocol.py:745] - > PING 01 a2 b8 f7 [binary, 4 bytes]
2025-02-07 15:29:50,623 - DEBUG - [protocol.py:599] - < PONG 01 a2 b8 f7 [binary, 4 bytes]
2025-02-07 15:29:50,625 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:29:50,627 - DEBUG - [protocol.py:599] - < PING b3 38 e2 e7 [binary, 4 bytes]
2025-02-07 15:29:50,631 - DEBUG - [protocol.py:745] - > PONG b3 38 e2 e7 [binary, 4 bytes]
2025-02-07 15:30:10,632 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:30:10,634 - DEBUG - [protocol.py:745] - > PING e8 f7 6f c7 [binary, 4 bytes]
2025-02-07 15:30:10,642 - DEBUG - [protocol.py:599] - < PING 80 7f 13 be [binary, 4 bytes]
2025-02-07 15:30:10,644 - DEBUG - [protocol.py:745] - > PONG 80 7f 13 be [binary, 4 bytes]
2025-02-07 15:30:10,649 - DEBUG - [protocol.py:599] - < PONG e8 f7 6f c7 [binary, 4 bytes]
2025-02-07 15:30:10,651 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:30:30,654 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:30:30,656 - DEBUG - [protocol.py:745] - > PING 9e 30 63 ad [binary, 4 bytes]
2025-02-07 15:30:30,658 - DEBUG - [protocol.py:599] - < PING 85 f9 81 f0 [binary, 4 bytes]
2025-02-07 15:30:30,660 - DEBUG - [protocol.py:745] - > PONG 85 f9 81 f0 [binary, 4 bytes]
2025-02-07 15:30:30,665 - DEBUG - [protocol.py:599] - < PONG 9e 30 63 ad [binary, 4 bytes]
2025-02-07 15:30:30,667 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:30:50,658 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:30:50,660 - DEBUG - [protocol.py:745] - > PING 81 92 8d d5 [binary, 4 bytes]
2025-02-07 15:30:50,668 - DEBUG - [protocol.py:599] - < PING b1 a0 e8 86 [binary, 4 bytes]
2025-02-07 15:30:50,670 - DEBUG - [protocol.py:745] - > PONG b1 a0 e8 86 [binary, 4 bytes]
2025-02-07 15:30:50,674 - DEBUG - [protocol.py:599] - < PONG 81 92 8d d5 [binary, 4 bytes]
2025-02-07 15:30:50,677 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:31:10,667 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:31:10,670 - DEBUG - [protocol.py:745] - > PING c9 af 00 86 [binary, 4 bytes]
2025-02-07 15:31:10,678 - DEBUG - [protocol.py:599] - < PONG c9 af 00 86 [binary, 4 bytes]
2025-02-07 15:31:10,681 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:31:10,684 - DEBUG - [protocol.py:599] - < PING 54 c9 34 9b [binary, 4 bytes]
2025-02-07 15:31:10,686 - DEBUG - [protocol.py:745] - > PONG 54 c9 34 9b [binary, 4 bytes]
2025-02-07 15:31:30,685 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:31:30,687 - DEBUG - [protocol.py:745] - > PING 49 58 c7 cf [binary, 4 bytes]
2025-02-07 15:31:30,694 - DEBUG - [protocol.py:599] - < PING 39 52 bb 6b [binary, 4 bytes]
2025-02-07 15:31:30,695 - DEBUG - [protocol.py:745] - > PONG 39 52 bb 6b [binary, 4 bytes]
2025-02-07 15:31:30,699 - DEBUG - [protocol.py:599] - < PONG 49 58 c7 cf [binary, 4 bytes]
2025-02-07 15:31:30,703 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:31:34,238 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:31:34,239 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:31:34,239 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:31:34,240 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:31:34,273 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:31:34,274 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:31:34,275 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:31:34,277 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:31:34,277 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:31:34,278 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:31:34,532 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:31:34,533 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:31:34,533 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:31:34,534 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:31:34,534 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:31:34,535 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:31:34,827 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:31:34,828 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,061 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:35,062 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:31:35,062 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:31:35,063 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:31:35,063 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:31:35,063 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,284 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:35,284 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,553 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:35,553 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,777 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:35,777 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:31:35,999 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:31:36,000 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:31:36,000 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:31:36,001 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:31:36,214 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:31:36,214 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:31:36,215 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:31:36,216 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:31:36.215274",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:31:36,216 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:31:36,217 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:31:36,217 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:31:36,217 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:31:36,248 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:31:36,249 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:31:36,250 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:31:36,250 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:31:36,252 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:31:36,252 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:31:36,253 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:31:36.250707",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:31:36,277 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:31:36,277 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:31:50,695 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:31:50,695 - DEBUG - [protocol.py:745] - > PING b8 87 d7 60 [binary, 4 bytes]
2025-02-07 15:31:50,701 - DEBUG - [protocol.py:599] - < PING c2 05 c8 fb [binary, 4 bytes]
2025-02-07 15:31:50,702 - DEBUG - [protocol.py:745] - > PONG c2 05 c8 fb [binary, 4 bytes]
2025-02-07 15:31:50,704 - DEBUG - [protocol.py:599] - < PONG b8 87 d7 60 [binary, 4 bytes]
2025-02-07 15:31:50,705 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:32:10,707 - DEBUG - [protocol.py:599] - < PING 76 b6 e6 36 [binary, 4 bytes]
2025-02-07 15:32:10,709 - DEBUG - [protocol.py:745] - > PONG 76 b6 e6 36 [binary, 4 bytes]
2025-02-07 15:32:10,711 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:32:10,714 - DEBUG - [protocol.py:745] - > PING a3 87 f2 cb [binary, 4 bytes]
2025-02-07 15:32:10,720 - DEBUG - [protocol.py:599] - < PONG a3 87 f2 cb [binary, 4 bytes]
2025-02-07 15:32:10,723 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:32:30,719 - DEBUG - [protocol.py:599] - < PING 13 a4 54 34 [binary, 4 bytes]
2025-02-07 15:32:30,720 - DEBUG - [protocol.py:745] - > PONG 13 a4 54 34 [binary, 4 bytes]
2025-02-07 15:32:30,721 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:32:30,721 - DEBUG - [protocol.py:745] - > PING be dc ca 58 [binary, 4 bytes]
2025-02-07 15:32:30,727 - DEBUG - [protocol.py:599] - < PONG be dc ca 58 [binary, 4 bytes]
2025-02-07 15:32:30,728 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:32:50,727 - DEBUG - [protocol.py:599] - < PING ec f3 d5 32 [binary, 4 bytes]
2025-02-07 15:32:50,728 - DEBUG - [protocol.py:745] - > PONG ec f3 d5 32 [binary, 4 bytes]
2025-02-07 15:32:50,729 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:32:50,729 - DEBUG - [protocol.py:745] - > PING 4b a1 59 7f [binary, 4 bytes]
2025-02-07 15:32:50,735 - DEBUG - [protocol.py:599] - < PONG 4b a1 59 7f [binary, 4 bytes]
2025-02-07 15:32:50,736 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:33:10,726 - DEBUG - [protocol.py:599] - < PING d7 1c ad 0d [binary, 4 bytes]
2025-02-07 15:33:10,726 - DEBUG - [protocol.py:745] - > PONG d7 1c ad 0d [binary, 4 bytes]
2025-02-07 15:33:10,740 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:33:10,743 - DEBUG - [protocol.py:745] - > PING 72 16 a3 6f [binary, 4 bytes]
2025-02-07 15:33:10,749 - DEBUG - [protocol.py:599] - < PONG 72 16 a3 6f [binary, 4 bytes]
2025-02-07 15:33:10,751 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:33:30,748 - DEBUG - [protocol.py:599] - < PING 74 1a b6 2b [binary, 4 bytes]
2025-02-07 15:33:30,750 - DEBUG - [protocol.py:745] - > PONG 74 1a b6 2b [binary, 4 bytes]
2025-02-07 15:33:30,778 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:33:30,779 - DEBUG - [protocol.py:745] - > PING df 72 42 7c [binary, 4 bytes]
2025-02-07 15:33:30,786 - DEBUG - [protocol.py:599] - < PONG df 72 42 7c [binary, 4 bytes]
2025-02-07 15:33:30,788 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:33:50,751 - DEBUG - [protocol.py:599] - < PING d3 47 08 45 [binary, 4 bytes]
2025-02-07 15:33:50,751 - DEBUG - [protocol.py:745] - > PONG d3 47 08 45 [binary, 4 bytes]
2025-02-07 15:33:50,785 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:33:50,785 - DEBUG - [protocol.py:745] - > PING 94 72 41 3b [binary, 4 bytes]
2025-02-07 15:33:50,789 - DEBUG - [protocol.py:599] - < PONG 94 72 41 3b [binary, 4 bytes]
2025-02-07 15:33:50,789 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:34:10,764 - DEBUG - [protocol.py:599] - < PING f0 3d 14 47 [binary, 4 bytes]
2025-02-07 15:34:10,764 - DEBUG - [protocol.py:745] - > PONG f0 3d 14 47 [binary, 4 bytes]
2025-02-07 15:34:10,797 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:34:10,800 - DEBUG - [protocol.py:745] - > PING 8d de 37 bd [binary, 4 bytes]
2025-02-07 15:34:10,808 - DEBUG - [protocol.py:599] - < PONG 8d de 37 bd [binary, 4 bytes]
2025-02-07 15:34:10,810 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:34:30,778 - DEBUG - [protocol.py:599] - < PING 21 ba 4b ad [binary, 4 bytes]
2025-02-07 15:34:30,779 - DEBUG - [protocol.py:745] - > PONG 21 ba 4b ad [binary, 4 bytes]
2025-02-07 15:34:30,803 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:34:30,803 - DEBUG - [protocol.py:745] - > PING 97 d3 16 47 [binary, 4 bytes]
2025-02-07 15:34:30,810 - DEBUG - [protocol.py:599] - < PONG 97 d3 16 47 [binary, 4 bytes]
2025-02-07 15:34:30,810 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:34:50,784 - DEBUG - [protocol.py:599] - < PING '~\x00ɭ' [text, 4 bytes]
2025-02-07 15:34:50,784 - DEBUG - [protocol.py:745] - > PONG '~\x00ɭ' [text, 4 bytes]
2025-02-07 15:34:50,816 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:34:50,819 - DEBUG - [protocol.py:745] - > PING "K|'$" [text, 4 bytes]
2025-02-07 15:34:50,826 - DEBUG - [protocol.py:599] - < PONG "K|'$" [text, 4 bytes]
2025-02-07 15:34:50,826 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:35:10,796 - DEBUG - [protocol.py:599] - < PING d6 78 a3 92 [binary, 4 bytes]
2025-02-07 15:35:10,798 - DEBUG - [protocol.py:745] - > PONG d6 78 a3 92 [binary, 4 bytes]
2025-02-07 15:35:10,843 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:35:10,845 - DEBUG - [protocol.py:745] - > PING 1a 95 c6 57 [binary, 4 bytes]
2025-02-07 15:35:10,850 - DEBUG - [protocol.py:599] - < PONG 1a 95 c6 57 [binary, 4 bytes]
2025-02-07 15:35:10,851 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:35:30,788 - DEBUG - [protocol.py:599] - < PING 05 93 d9 61 [binary, 4 bytes]
2025-02-07 15:35:30,804 - DEBUG - [protocol.py:745] - > PONG 05 93 d9 61 [binary, 4 bytes]
2025-02-07 15:35:30,848 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:35:30,851 - DEBUG - [protocol.py:745] - > PING 4f 5d c2 7e [binary, 4 bytes]
2025-02-07 15:35:30,859 - DEBUG - [protocol.py:599] - < PONG 4f 5d c2 7e [binary, 4 bytes]
2025-02-07 15:35:30,861 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:35:50,814 - DEBUG - [protocol.py:599] - < PING 4a fc c5 28 [binary, 4 bytes]
2025-02-07 15:35:50,814 - DEBUG - [protocol.py:745] - > PONG 4a fc c5 28 [binary, 4 bytes]
2025-02-07 15:35:50,886 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:35:50,888 - DEBUG - [protocol.py:745] - > PING b6 19 d4 c6 [binary, 4 bytes]
2025-02-07 15:35:50,889 - DEBUG - [protocol.py:599] - < PONG b6 19 d4 c6 [binary, 4 bytes]
2025-02-07 15:35:50,894 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:36:09,821 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 15:36:09,830 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 15:36:09,832 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 15:36:09,832 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 15:36:09,832 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 15:36:09,838 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 15:36:09,840 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 15:36:09,845 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 15:36:37,478 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:36:37,488 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:36:37,488 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:36:37,489 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:36:37,533 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:36:37,533 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:36:37,534 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:36:37,534 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:36:37,535 - INFO - [printer_monitor_service.py:514] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:36:37,535 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:36:37,887 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:36:37,887 - INFO - [printer_monitor_service.py:523] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:36:37,888 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:36:37,888 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:36:37,889 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:36:37,889 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:36:38,098 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:36:38,099 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:38,317 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:38,318 - WARNING - [printer_monitor_service.py:309] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:36:38,318 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:36:38,319 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:36:38,319 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:36:38,320 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:38,599 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:38,600 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:38,845 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:38,845 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:39,074 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:39,075 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:36:39,286 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:36:39,287 - DEBUG - [printer_monitor_service.py:289] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100}, 'cyan': {'level': 111081, 'max': 100}, 'magenta': {'level': 111081, 'max': 100}, 'yellow': {'level': 111081, 'max': 100}}}
2025-02-07 15:36:39,288 - INFO - [printer_monitor_service.py:544] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:36:39,288 - DEBUG - [printer_monitor_service.py:312] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:36:39,562 - DEBUG - [printer_monitor_service.py:337] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:36:39,563 - INFO - [printer_monitor_service.py:575] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:36:39,563 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:36:39,564 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": "192.168.18.79",
  "brand": "Ricoh",
  "last_check": "2025-02-07T20:36:39.563417",
  "status": "idle",
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:36:39,564 - INFO - [printer_monitor_service.py:423] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:36:39,565 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:36:39,565 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:36:39,566 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:36:39,600 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:36:39,600 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:36:39,601 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:36:39,601 - DEBUG - [printer_monitor_service.py:475] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:36:39,602 - DEBUG - [printer_monitor_service.py:476] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:36:39,602 - DEBUG - [printer_monitor_service.py:477] - Parámetros: {'agent_id': '1'}
2025-02-07 15:36:39,602 - DEBUG - [printer_monitor_service.py:478] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": "idle",
  "last_check": "2025-02-07T20:36:39.601514",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100
        }
      }
    },
    "status": "idle"
  }
}
2025-02-07 15:36:39,638 - INFO - [printer_monitor_service.py:489] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:36:39,639 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:37:03,611 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-07 15:37:03,611 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-07 15:37:03,611 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-07 15:37:03,614 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-07 15:37:03,614 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-07 15:37:03,649 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-07 15:37:03,651 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-07 15:37:03,651 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-07 15:37:03,651 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-07 15:37:03,651 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-07 15:37:03,651 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: xmqUC3UzjctuZX/8nut2Sg==
2025-02-07 15:37:03,653 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-07 15:37:03,653 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-07 15:37:03,653 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-07 15:37:03,717 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-07 15:37:03,717 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: 27c412rjaKBWSFvW7sgNlCjRdHM=
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < date: Fri, 07 Feb 2025 20:37:02 GMT
2025-02-07 15:37:03,718 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-07 15:37:03,720 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-07 15:37:03,720 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-07 15:37:04,937 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:37:04,937 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:37:04,942 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:37:04,942 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:37:04,985 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:37:04,985 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:37:04,985 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:37:04,985 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:37:04,985 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:37:04,985 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:37:05,184 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:37:05,184 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:37:05,184 - INFO - [printer_monitor_service.py:184] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-07 15:37:05,184 - DEBUG - [printer_monitor_service.py:191] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-07 15:37:05,223 - DEBUG - [printer_monitor_service.py:196] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-07 15:37:05,226 - INFO - [printer_monitor_service.py:201] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-07 15:37:05,229 - DEBUG - [printer_monitor_service.py:202] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:37:05,229 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:37:05,232 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:37:05,233 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:37:05,403 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:37:05,403 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:05,585 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:05,585 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:05,585 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:37:05,585 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:37:05,585 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:37:05,591 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:05,742 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:05,742 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:05,742 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:05,891 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:05,891 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:05,891 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:06,081 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:06,084 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:06,084 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:37:06,233 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:37:06,233 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:37:06,233 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 15:37:06,233 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:37:06,233 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:37:06,391 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:37:06,391 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:37:06,391 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:37:06,391 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:37:06,394 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:37:06,394 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:37:06,394 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:37:06,394 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"idle","client_id":4}]...
2025-02-07 15:37:06,422 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "idle",
    "client_id": 4
  }
]
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 15:37:06,422 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T20:37:06.422400",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 15:37:06,472 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:37:06,475 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:37:23,714 - DEBUG - [protocol.py:599] - < PING f1 d2 8a 9e [binary, 4 bytes]
2025-02-07 15:37:23,714 - DEBUG - [protocol.py:745] - > PONG f1 d2 8a 9e [binary, 4 bytes]
2025-02-07 15:37:23,714 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:37:23,714 - DEBUG - [protocol.py:745] - > PING '3[\x06a' [text, 4 bytes]
2025-02-07 15:37:23,721 - DEBUG - [protocol.py:599] - < PONG '3[\x06a' [text, 4 bytes]
2025-02-07 15:37:23,721 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:37:43,723 - DEBUG - [protocol.py:599] - < PING ',VPj' [text, 4 bytes]
2025-02-07 15:37:43,724 - DEBUG - [protocol.py:745] - > PONG ',VPj' [text, 4 bytes]
2025-02-07 15:37:43,728 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:37:43,730 - DEBUG - [protocol.py:745] - > PING "R'\\x" [text, 4 bytes]
2025-02-07 15:37:43,738 - DEBUG - [protocol.py:599] - < PONG "R'\\x" [text, 4 bytes]
2025-02-07 15:37:43,741 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:38:03,722 - DEBUG - [protocol.py:599] - < PING 13 62 9c b6 [binary, 4 bytes]
2025-02-07 15:38:03,722 - DEBUG - [protocol.py:745] - > PONG 13 62 9c b6 [binary, 4 bytes]
2025-02-07 15:38:03,722 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:38:03,722 - DEBUG - [protocol.py:745] - > PING ac bc 9c 04 [binary, 4 bytes]
2025-02-07 15:38:03,738 - DEBUG - [protocol.py:599] - < PONG ac bc 9c 04 [binary, 4 bytes]
2025-02-07 15:38:03,738 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:38:23,718 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:38:23,718 - DEBUG - [protocol.py:745] - > PING 61 16 44 f5 [binary, 4 bytes]
2025-02-07 15:38:23,718 - DEBUG - [protocol.py:599] - < PONG 61 16 44 f5 [binary, 4 bytes]
2025-02-07 15:38:23,718 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:38:23,734 - DEBUG - [protocol.py:599] - < PING 30 01 e8 76 [binary, 4 bytes]
2025-02-07 15:38:23,734 - DEBUG - [protocol.py:745] - > PONG 30 01 e8 76 [binary, 4 bytes]
2025-02-07 15:38:43,734 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:38:43,736 - DEBUG - [protocol.py:745] - > PING e4 43 cb 52 [binary, 4 bytes]
2025-02-07 15:38:43,742 - DEBUG - [protocol.py:599] - < PONG e4 43 cb 52 [binary, 4 bytes]
2025-02-07 15:38:43,744 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:38:43,750 - DEBUG - [protocol.py:599] - < PING 88 ac 31 50 [binary, 4 bytes]
2025-02-07 15:38:43,754 - DEBUG - [protocol.py:745] - > PONG 88 ac 31 50 [binary, 4 bytes]
2025-02-07 15:39:03,745 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:39:03,746 - DEBUG - [protocol.py:745] - > PING a2 87 b5 f3 [binary, 4 bytes]
2025-02-07 15:39:03,754 - DEBUG - [protocol.py:599] - < PONG a2 87 b5 f3 [binary, 4 bytes]
2025-02-07 15:39:03,754 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:39:03,766 - DEBUG - [protocol.py:599] - < PING 49 4b f4 3f [binary, 4 bytes]
2025-02-07 15:39:03,767 - DEBUG - [protocol.py:745] - > PONG 49 4b f4 3f [binary, 4 bytes]
2025-02-07 15:39:23,761 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:39:23,765 - DEBUG - [protocol.py:745] - > PING ba 44 86 14 [binary, 4 bytes]
2025-02-07 15:39:23,767 - DEBUG - [protocol.py:599] - < PING 78 60 fc 9b [binary, 4 bytes]
2025-02-07 15:39:23,767 - DEBUG - [protocol.py:745] - > PONG 78 60 fc 9b [binary, 4 bytes]
2025-02-07 15:39:23,776 - DEBUG - [protocol.py:599] - < PONG ba 44 86 14 [binary, 4 bytes]
2025-02-07 15:39:23,780 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:39:43,769 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:39:43,769 - DEBUG - [protocol.py:745] - > PING eb ae f1 db [binary, 4 bytes]
2025-02-07 15:39:43,769 - DEBUG - [protocol.py:599] - < PONG eb ae f1 db [binary, 4 bytes]
2025-02-07 15:39:43,785 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:39:43,785 - DEBUG - [protocol.py:599] - < PING 61 87 17 14 [binary, 4 bytes]
2025-02-07 15:39:43,788 - DEBUG - [protocol.py:745] - > PONG 61 87 17 14 [binary, 4 bytes]
2025-02-07 15:40:03,781 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:40:03,781 - DEBUG - [protocol.py:745] - > PING f9 f5 a3 3d [binary, 4 bytes]
2025-02-07 15:40:03,796 - DEBUG - [protocol.py:599] - < PONG f9 f5 a3 3d [binary, 4 bytes]
2025-02-07 15:40:03,798 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:40:03,798 - DEBUG - [protocol.py:599] - < PING fd 2d 54 8c [binary, 4 bytes]
2025-02-07 15:40:03,798 - DEBUG - [protocol.py:745] - > PONG fd 2d 54 8c [binary, 4 bytes]
2025-02-07 15:40:23,795 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:40:23,796 - DEBUG - [protocol.py:745] - > PING 9f 42 86 06 [binary, 4 bytes]
2025-02-07 15:40:23,805 - DEBUG - [protocol.py:599] - < PONG 9f 42 86 06 [binary, 4 bytes]
2025-02-07 15:40:23,808 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:40:23,822 - DEBUG - [protocol.py:599] - < PING 08 57 42 ee [binary, 4 bytes]
2025-02-07 15:40:23,823 - DEBUG - [protocol.py:745] - > PONG 08 57 42 ee [binary, 4 bytes]
2025-02-07 15:40:43,800 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:40:43,802 - DEBUG - [protocol.py:745] - > PING 37 8e fa 50 [binary, 4 bytes]
2025-02-07 15:40:43,809 - DEBUG - [protocol.py:599] - < PONG 37 8e fa 50 [binary, 4 bytes]
2025-02-07 15:40:43,810 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:40:43,832 - DEBUG - [protocol.py:599] - < PING 67 9f 63 d8 [binary, 4 bytes]
2025-02-07 15:40:43,833 - DEBUG - [protocol.py:745] - > PONG 67 9f 63 d8 [binary, 4 bytes]
2025-02-07 15:41:03,804 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:41:03,806 - DEBUG - [protocol.py:745] - > PING 1e 66 43 a5 [binary, 4 bytes]
2025-02-07 15:41:03,816 - DEBUG - [protocol.py:599] - < PONG 1e 66 43 a5 [binary, 4 bytes]
2025-02-07 15:41:03,818 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:41:03,840 - DEBUG - [protocol.py:599] - < PING 0c 7f d3 29 [binary, 4 bytes]
2025-02-07 15:41:03,842 - DEBUG - [protocol.py:745] - > PONG 0c 7f d3 29 [binary, 4 bytes]
2025-02-07 15:41:23,821 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:41:23,823 - DEBUG - [protocol.py:745] - > PING 06 48 aa 10 [binary, 4 bytes]
2025-02-07 15:41:23,830 - DEBUG - [protocol.py:599] - < PONG 06 48 aa 10 [binary, 4 bytes]
2025-02-07 15:41:23,832 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:41:23,852 - DEBUG - [protocol.py:599] - < PING 9b ad d6 2f [binary, 4 bytes]
2025-02-07 15:41:23,855 - DEBUG - [protocol.py:745] - > PONG 9b ad d6 2f [binary, 4 bytes]
2025-02-07 15:41:43,836 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:41:43,837 - DEBUG - [protocol.py:745] - > PING e5 89 fa 24 [binary, 4 bytes]
2025-02-07 15:41:43,846 - DEBUG - [protocol.py:599] - < PONG e5 89 fa 24 [binary, 4 bytes]
2025-02-07 15:41:43,847 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:41:43,867 - DEBUG - [protocol.py:599] - < PING a2 c9 50 b7 [binary, 4 bytes]
2025-02-07 15:41:43,867 - DEBUG - [protocol.py:745] - > PONG a2 c9 50 b7 [binary, 4 bytes]
2025-02-07 15:42:03,846 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:42:03,855 - DEBUG - [protocol.py:745] - > PING d7 cb 92 fb [binary, 4 bytes]
2025-02-07 15:42:03,880 - DEBUG - [protocol.py:599] - < PONG d7 cb 92 fb [binary, 4 bytes]
2025-02-07 15:42:03,890 - DEBUG - [protocol.py:599] - < PING 87 cd 9f b9 [binary, 4 bytes]
2025-02-07 15:42:03,892 - DEBUG - [protocol.py:745] - > PONG 87 cd 9f b9 [binary, 4 bytes]
2025-02-07 15:42:03,893 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:42:07,577 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:42:07,577 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:42:07,578 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:42:07,578 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:42:07,609 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:42:07,609 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:42:07,610 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:42:07,610 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:42:07,611 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:42:07,611 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:42:08,453 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:42:08,455 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:42:08,455 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:42:08,456 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:42:08,456 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:42:08,457 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:42:08,783 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:42:08,785 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,004 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,005 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,005 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:42:09,005 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:42:09,006 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:42:09,006 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,194 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,195 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,195 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,453 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,454 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,454 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,678 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,678 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,679 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:42:09,905 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:42:09,907 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:42:09,907 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 15:42:09,908 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:42:09,909 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:42:10,170 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:42:10,171 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:42:10,171 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:42:10,172 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:42:10,173 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:42:10,173 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:42:10,174 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:42:10,174 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:42:10,207 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:42:10,207 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:42:10,208 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:42:10,208 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:42:10,209 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:42:10,209 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 15:42:10,209 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T20:42:10.208482",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 15:42:10,244 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:42:10,245 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:42:23,859 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:42:23,860 - DEBUG - [protocol.py:745] - > PING f9 33 66 3f [binary, 4 bytes]
2025-02-07 15:42:23,868 - DEBUG - [protocol.py:599] - < PONG f9 33 66 3f [binary, 4 bytes]
2025-02-07 15:42:23,875 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:42:23,907 - DEBUG - [protocol.py:599] - < PING aa f8 7b fe [binary, 4 bytes]
2025-02-07 15:42:23,909 - DEBUG - [protocol.py:745] - > PONG aa f8 7b fe [binary, 4 bytes]
2025-02-07 15:42:43,852 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:42:43,860 - DEBUG - [protocol.py:745] - > PING 4e cd 7d c4 [binary, 4 bytes]
2025-02-07 15:42:43,872 - DEBUG - [protocol.py:599] - < PONG 4e cd 7d c4 [binary, 4 bytes]
2025-02-07 15:42:43,874 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:42:43,916 - DEBUG - [protocol.py:599] - < PING f0 4b 0d 75 [binary, 4 bytes]
2025-02-07 15:42:43,918 - DEBUG - [protocol.py:745] - > PONG f0 4b 0d 75 [binary, 4 bytes]
2025-02-07 15:43:03,861 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:43:03,863 - DEBUG - [protocol.py:745] - > PING 09 38 8e 71 [binary, 4 bytes]
2025-02-07 15:43:03,872 - DEBUG - [protocol.py:599] - < PONG 09 38 8e 71 [binary, 4 bytes]
2025-02-07 15:43:03,873 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:43:03,927 - DEBUG - [protocol.py:599] - < PING 07 ee de 0b [binary, 4 bytes]
2025-02-07 15:43:03,928 - DEBUG - [protocol.py:745] - > PONG 07 ee de 0b [binary, 4 bytes]
2025-02-07 15:43:23,875 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:43:23,876 - DEBUG - [protocol.py:745] - > PING f3 ee c2 07 [binary, 4 bytes]
2025-02-07 15:43:23,882 - DEBUG - [protocol.py:599] - < PONG f3 ee c2 07 [binary, 4 bytes]
2025-02-07 15:43:23,883 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:43:23,934 - DEBUG - [protocol.py:599] - < PING 1f 7a 11 db [binary, 4 bytes]
2025-02-07 15:43:23,934 - DEBUG - [protocol.py:745] - > PONG 1f 7a 11 db [binary, 4 bytes]
2025-02-07 15:43:43,892 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:43:43,894 - DEBUG - [protocol.py:745] - > PING '\x04GS?' [text, 4 bytes]
2025-02-07 15:43:43,900 - DEBUG - [protocol.py:599] - < PONG '\x04GS?' [text, 4 bytes]
2025-02-07 15:43:43,902 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:43:43,940 - DEBUG - [protocol.py:599] - < PING d5 02 fc fc [binary, 4 bytes]
2025-02-07 15:43:43,941 - DEBUG - [protocol.py:745] - > PONG d5 02 fc fc [binary, 4 bytes]
2025-02-07 15:44:03,887 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:44:03,887 - DEBUG - [protocol.py:745] - > PING 10 60 9e 50 [binary, 4 bytes]
2025-02-07 15:44:03,891 - DEBUG - [protocol.py:599] - < PONG 10 60 9e 50 [binary, 4 bytes]
2025-02-07 15:44:03,891 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:44:03,947 - DEBUG - [protocol.py:599] - < PING b4 9b d7 64 [binary, 4 bytes]
2025-02-07 15:44:03,947 - DEBUG - [protocol.py:745] - > PONG b4 9b d7 64 [binary, 4 bytes]
2025-02-07 15:44:23,889 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:44:23,891 - DEBUG - [protocol.py:745] - > PING 56 63 80 b6 [binary, 4 bytes]
2025-02-07 15:44:23,899 - DEBUG - [protocol.py:599] - < PONG 56 63 80 b6 [binary, 4 bytes]
2025-02-07 15:44:23,901 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:44:23,955 - DEBUG - [protocol.py:599] - < PING ae 54 a2 9c [binary, 4 bytes]
2025-02-07 15:44:23,957 - DEBUG - [protocol.py:745] - > PONG ae 54 a2 9c [binary, 4 bytes]
2025-02-07 15:44:43,895 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:44:43,896 - DEBUG - [protocol.py:745] - > PING ad af 5d 0d [binary, 4 bytes]
2025-02-07 15:44:43,905 - DEBUG - [protocol.py:599] - < PONG ad af 5d 0d [binary, 4 bytes]
2025-02-07 15:44:43,905 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:44:43,962 - DEBUG - [protocol.py:599] - < PING 05 68 72 ce [binary, 4 bytes]
2025-02-07 15:44:43,963 - DEBUG - [protocol.py:745] - > PONG 05 68 72 ce [binary, 4 bytes]
2025-02-07 15:45:03,907 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:45:03,907 - DEBUG - [protocol.py:745] - > PING 66 53 e6 71 [binary, 4 bytes]
2025-02-07 15:45:03,907 - DEBUG - [protocol.py:599] - < PONG 66 53 e6 71 [binary, 4 bytes]
2025-02-07 15:45:03,907 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:45:03,972 - DEBUG - [protocol.py:599] - < PING cf 7b e1 82 [binary, 4 bytes]
2025-02-07 15:45:03,972 - DEBUG - [protocol.py:745] - > PONG cf 7b e1 82 [binary, 4 bytes]
2025-02-07 15:45:23,910 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:45:23,911 - DEBUG - [protocol.py:745] - > PING 59 21 cc c5 [binary, 4 bytes]
2025-02-07 15:45:23,911 - DEBUG - [protocol.py:599] - < PONG 59 21 cc c5 [binary, 4 bytes]
2025-02-07 15:45:23,911 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:45:23,974 - DEBUG - [protocol.py:599] - < PING 24 a0 a8 d4 [binary, 4 bytes]
2025-02-07 15:45:23,974 - DEBUG - [protocol.py:745] - > PONG 24 a0 a8 d4 [binary, 4 bytes]
2025-02-07 15:45:43,935 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:45:43,935 - DEBUG - [protocol.py:745] - > PING 0f b4 5a d2 [binary, 4 bytes]
2025-02-07 15:45:43,935 - DEBUG - [protocol.py:599] - < PONG 0f b4 5a d2 [binary, 4 bytes]
2025-02-07 15:45:43,935 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:45:43,983 - DEBUG - [protocol.py:599] - < PING 14 e1 29 2b [binary, 4 bytes]
2025-02-07 15:45:43,983 - DEBUG - [protocol.py:745] - > PONG 14 e1 29 2b [binary, 4 bytes]
2025-02-07 15:46:03,947 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:46:03,948 - DEBUG - [protocol.py:745] - > PING ee 4a b6 1c [binary, 4 bytes]
2025-02-07 15:46:03,948 - DEBUG - [protocol.py:599] - < PONG ee 4a b6 1c [binary, 4 bytes]
2025-02-07 15:46:03,948 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:46:03,997 - DEBUG - [protocol.py:599] - < PING 9d 25 3e 26 [binary, 4 bytes]
2025-02-07 15:46:03,997 - DEBUG - [protocol.py:745] - > PONG 9d 25 3e 26 [binary, 4 bytes]
2025-02-07 15:46:23,957 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:46:23,960 - DEBUG - [protocol.py:745] - > PING 84 b6 44 9f [binary, 4 bytes]
2025-02-07 15:46:23,969 - DEBUG - [protocol.py:599] - < PONG 84 b6 44 9f [binary, 4 bytes]
2025-02-07 15:46:23,971 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:46:24,011 - DEBUG - [protocol.py:599] - < PING d8 95 2a e4 [binary, 4 bytes]
2025-02-07 15:46:24,013 - DEBUG - [protocol.py:745] - > PONG d8 95 2a e4 [binary, 4 bytes]
2025-02-07 15:46:43,998 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:46:44,000 - DEBUG - [protocol.py:745] - > PING 82 24 7d 28 [binary, 4 bytes]
2025-02-07 15:46:44,007 - DEBUG - [protocol.py:599] - < PONG 82 24 7d 28 [binary, 4 bytes]
2025-02-07 15:46:44,010 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:46:44,021 - DEBUG - [protocol.py:599] - < PING b9 75 f9 cd [binary, 4 bytes]
2025-02-07 15:46:44,022 - DEBUG - [protocol.py:745] - > PONG b9 75 f9 cd [binary, 4 bytes]
2025-02-07 15:47:03,999 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:47:04,000 - DEBUG - [protocol.py:745] - > PING '\x15\x03\x13@' [text, 4 bytes]
2025-02-07 15:47:04,011 - DEBUG - [protocol.py:599] - < PONG '\x15\x03\x13@' [text, 4 bytes]
2025-02-07 15:47:04,014 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:47:04,028 - DEBUG - [protocol.py:599] - < PING 0f e4 c9 0c [binary, 4 bytes]
2025-02-07 15:47:04,030 - DEBUG - [protocol.py:745] - > PONG 0f e4 c9 0c [binary, 4 bytes]
2025-02-07 15:47:11,372 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:47:11,373 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:47:11,373 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:47:11,373 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:47:11,401 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:47:11,402 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:47:11,402 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:47:11,403 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:47:11,404 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:47:11,404 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:47:11,654 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:47:11,655 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:47:11,655 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:47:11,655 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:47:11,656 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:47:11,656 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:47:11,876 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:47:11,877 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:12,095 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:12,095 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:12,096 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:47:12,096 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:47:12,097 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:47:12,097 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:12,370 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:12,371 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:12,371 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:12,591 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:12,592 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:12,592 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:12,801 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:12,802 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:12,802 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:47:13,056 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:47:13,057 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:47:13,058 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 15:47:13,058 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:47:13,059 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:47:13,271 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:47:13,271 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:47:13,272 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:47:13,272 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:47:13,273 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:47:13,273 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:47:13,273 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:47:13,274 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:47:13,302 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:47:13,303 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:47:13,303 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:47:13,304 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:47:13,304 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:47:13,305 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 15:47:13,306 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T20:47:13.304766",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 15:47:13,338 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:47:13,339 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 15:47:24,001 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-07 15:47:24,003 - DEBUG - [protocol.py:745] - > PING b4 12 72 14 [binary, 4 bytes]
2025-02-07 15:47:24,011 - DEBUG - [protocol.py:599] - < PONG b4 12 72 14 [binary, 4 bytes]
2025-02-07 15:47:24,013 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-07 15:47:24,037 - DEBUG - [protocol.py:599] - < PING a8 ef 50 85 [binary, 4 bytes]
2025-02-07 15:47:24,039 - DEBUG - [protocol.py:745] - > PONG a8 ef 50 85 [binary, 4 bytes]
2025-02-07 15:47:34,695 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-07 15:47:34,695 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-07 15:47:34,697 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-07 15:47:34,697 - DEBUG - [protocol.py:649] - < EOF
2025-02-07 15:47:34,697 - DEBUG - [protocol.py:757] - > EOF
2025-02-07 15:47:34,697 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-07 15:47:34,697 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-07 15:47:34,697 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-07 15:52:16,491 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-07 15:52:16,491 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:52:16,491 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:52:16,491 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:52:18,577 - ERROR - [printer_monitor_service.py:102] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 85, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-07 15:57:19,938 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 15:57:19,941 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:57:19,941 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:57:19,942 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:57:19,989 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:57:19,989 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:57:19,990 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:57:19,991 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 15:57:19,991 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 15:57:19,992 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 15:57:20,231 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 15:57:20,232 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 15:57:20,232 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 15:57:20,233 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 15:57:20,233 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:57:20,234 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 15:57:20,463 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 15:57:20,464 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:20,778 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:20,778 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:20,778 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 15:57:20,779 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 15:57:20,779 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 15:57:20,779 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:21,005 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:21,006 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:21,006 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:21,226 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:21,227 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:21,227 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:21,506 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:21,507 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:21,507 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 15:57:21,719 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 15:57:21,719 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 15:57:21,720 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 15:57:21,720 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 15:57:21,720 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 15:57:21,940 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 15:57:21,941 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 15:57:21,941 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 15:57:21,942 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 15:57:21,943 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 15:57:21,943 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 15:57:21,943 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 15:57:21,945 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:57:21,978 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 15:57:21,979 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 15:57:21,979 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 15:57:21,980 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 15:57:21,981 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 15:57:21,981 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 15:57:21,982 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T20:57:21.980181",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 15:57:22,018 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 15:57:22,019 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:02:23,170 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:02:23,172 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:02:23,174 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:02:23,174 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:02:23,212 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:02:23,212 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:02:23,212 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:02:23,212 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:02:23,212 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:02:23,212 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:02:23,456 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:02:23,456 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:02:23,759 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138872
2025-02-07 16:02:23,759 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:23,989 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:23,989 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:23,989 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138872, 'color_pages': 111081, 'bw_pages': None}
2025-02-07 16:02:23,989 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:02:23,996 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:02:23,996 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:24,224 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:24,224 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:24,224 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:24,504 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:24,504 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:24,504 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:24,742 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:24,744 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:24,744 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:02:24,948 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111081
2025-02-07 16:02:24,948 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:02:24,964 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111081, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111081, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111081, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111081, 'max': 100, 'percentage': 100}}}
2025-02-07 16:02:24,964 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:02:24,964 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:02:25,171 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:02:25,171 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:02:25,171 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:02:25,171 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138872,
    "color_pages": 111081,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111081,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:02:25,171 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:02:25,171 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:02:25,171 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:02:25,171 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:02:25,202 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:02:25,202 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:02:25,202 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:02:25,211 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:02:25,211 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:02:25,211 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:02:25,211 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:02:25.211822",
  "printer_data": {
    "counters": {
      "total_pages": 138872,
      "color_pages": 111081,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111081,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:02:25,253 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:02:25,253 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:07:26,397 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:07:26,401 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:07:26,402 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:07:26,404 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:07:26,456 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:07:26,458 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:07:26,459 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:07:26,461 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:07:26,463 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:07:26,464 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:07:26,778 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:07:26,779 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:07:26,780 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:07:26,780 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:07:26,780 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:07:26,781 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:07:27,025 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138874
2025-02-07 16:07:27,027 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:27,414 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:27,415 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:27,415 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138874, 'color_pages': 111083, 'bw_pages': None}
2025-02-07 16:07:27,416 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:07:27,416 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:07:27,417 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:27,682 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:27,682 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:27,683 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:27,899 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:27,899 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:27,901 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:28,117 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:28,118 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:28,118 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:07:28,326 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:07:28,327 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:07:28,327 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111083, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111083, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111083, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111083, 'max': 100, 'percentage': 100}}}
2025-02-07 16:07:28,328 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:07:28,328 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:07:28,591 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:07:28,592 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:07:28,592 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:07:28,593 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138874,
    "color_pages": 111083,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:07:28,593 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:07:28,594 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:07:28,594 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:07:28,594 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:07:28,627 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:07:28,627 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:07:28,628 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:07:28,629 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:07:28,629 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:07:28,630 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:07:28,630 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:07:28.629885",
  "printer_data": {
    "counters": {
      "total_pages": 138874,
      "color_pages": 111083,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:07:28,662 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:07:28,663 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:12:29,762 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:12:29,762 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:12:29,762 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:12:29,778 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:12:29,809 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:12:29,809 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:12:29,809 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:12:29,809 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:12:29,809 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:12:29,809 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:12:30,080 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:12:30,080 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:12:30,311 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138874
2025-02-07 16:12:30,311 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:30,592 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138874, 'color_pages': 111083, 'bw_pages': None}
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:12:30,592 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:30,811 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:30,811 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:30,811 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:31,019 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:31,019 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:31,019 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:31,239 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:31,239 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:31,239 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:12:31,514 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:12:31,514 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:12:31,514 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111083, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111083, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111083, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111083, 'max': 100, 'percentage': 100}}}
2025-02-07 16:12:31,514 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:12:31,514 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:12:31,725 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:12:31,725 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:12:31,725 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:12:31,725 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138874,
    "color_pages": 111083,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:12:31,725 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:12:31,725 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:12:31,725 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:12:31,725 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:12:31,748 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:12:31,748 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:12:31,762 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:12:31.748161",
  "printer_data": {
    "counters": {
      "total_pages": 138874,
      "color_pages": 111083,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:12:31,794 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:12:31,797 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:17:32,909 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:17:32,910 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:17:32,911 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:17:32,912 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:17:32,943 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:17:32,944 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:17:32,945 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:17:32,946 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:17:32,946 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:17:32,947 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:17:33,107 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:17:33,109 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:17:33,109 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:17:33,109 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:17:33,110 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:17:33,110 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:17:33,294 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138874
2025-02-07 16:17:33,295 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:33,466 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:33,467 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:33,467 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138874, 'color_pages': 111083, 'bw_pages': None}
2025-02-07 16:17:33,467 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:17:33,467 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:17:33,468 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:33,636 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:33,636 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:33,636 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:33,796 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:33,797 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:33,797 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:33,989 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:33,990 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:33,990 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:17:34,134 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111083
2025-02-07 16:17:34,134 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:17:34,135 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111083, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111083, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111083, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111083, 'max': 100, 'percentage': 100}}}
2025-02-07 16:17:34,135 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:17:34,135 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:17:34,277 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:17:34,277 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:17:34,278 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:17:34,278 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138874,
    "color_pages": 111083,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111083,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:17:34,279 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:17:34,279 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:17:34,279 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:17:34,280 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:17:34,308 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:17:34,308 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:17:34,309 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:17:34,309 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:17:34,311 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:17:34,311 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:17:34,311 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:17:34.309959",
  "printer_data": {
    "counters": {
      "total_pages": 138874,
      "color_pages": 111083,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111083,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:17:34,338 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:17:34,338 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:22:35,432 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:22:35,432 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:22:35,432 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:22:35,432 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:22:35,460 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:22:35,461 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:22:35,461 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:22:35,462 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:22:35,463 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:22:35,463 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:22:35,693 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:22:35,693 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:22:35,693 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:22:35,693 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:22:35,695 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:22:35,696 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:22:35,864 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138876
2025-02-07 16:22:35,864 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,022 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,022 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,023 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138876, 'color_pages': 111085, 'bw_pages': None}
2025-02-07 16:22:36,023 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:22:36,024 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:22:36,024 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,222 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,222 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,223 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,394 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,394 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,396 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,673 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,673 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,673 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:22:36,825 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111085
2025-02-07 16:22:36,826 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:22:36,826 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111085, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111085, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111085, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111085, 'max': 100, 'percentage': 100}}}
2025-02-07 16:22:36,826 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:22:36,826 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:22:37,021 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:22:37,022 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:22:37,022 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:22:37,022 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138876,
    "color_pages": 111085,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111085,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111085,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111085,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111085,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:22:37,024 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:22:37,024 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:22:37,024 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:22:37,024 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:22:37,053 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:22:37,053 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:22:37,054 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:22:37,055 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:22:37,055 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:22:37,057 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:22:37,057 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:22:37.055744",
  "printer_data": {
    "counters": {
      "total_pages": 138876,
      "color_pages": 111085,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111085,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111085,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111085,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111085,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:22:37,094 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:22:37,095 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:27:38,168 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:27:38,169 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:27:38,171 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:27:38,171 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:27:38,203 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:27:38,204 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:27:38,205 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:27:38,206 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:27:38,207 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:27:38,207 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:27:38,376 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:27:38,376 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:27:38,376 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:27:38,376 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:27:38,377 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:27:38,378 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:27:38,533 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:27:38,533 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:38,725 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:38,726 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:38,727 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:27:38,727 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:27:38,727 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:27:38,727 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:38,880 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:38,880 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:38,881 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:39,032 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:39,032 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:39,033 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:39,180 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:39,181 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:39,181 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:27:39,388 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:27:39,388 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:27:39,388 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:27:39,388 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:27:39,390 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:27:39,539 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:27:39,540 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:27:39,540 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:27:39,541 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:27:39,542 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:27:39,542 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:27:39,542 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:27:39,543 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:27:39,572 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:27:39,572 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:27:39,572 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:27:39,574 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:27:39,575 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:27:39,575 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:27:39,575 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:27:39.574069",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:27:39,607 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:27:39,607 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:32:40,679 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:32:40,680 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:32:40,680 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:32:40,680 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:32:40,711 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:32:40,711 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:32:40,712 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:32:40,713 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:32:40,713 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:32:40,713 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:32:40,920 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:32:40,921 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:32:40,921 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:32:40,922 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:32:40,922 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:32:40,922 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:32:41,163 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:32:41,164 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:41,347 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:41,347 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:41,348 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:32:41,348 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:32:41,349 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:32:41,349 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:41,507 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:41,507 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:41,507 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:41,716 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:41,717 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:41,717 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:41,975 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:41,975 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:41,975 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:32:42,163 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:32:42,164 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:32:42,164 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:32:42,164 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:32:42,166 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:32:42,327 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:32:42,327 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:32:42,328 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:32:42,328 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:32:42,329 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:32:42,329 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:32:42,329 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:32:42,330 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:32:42,368 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:32:42,369 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:32:42,370 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:32:42,372 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:32:42,372 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:32:42,374 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:32:42,376 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:32:42.371690",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:32:42,406 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:32:42,407 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:37:43,517 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:37:43,518 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:37:43,519 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:37:43,520 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:37:43,551 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:37:43,552 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:37:43,553 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:37:43,555 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:37:43,555 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:37:43,556 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:37:43,784 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:37:43,784 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:37:43,784 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:37:43,785 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:37:43,785 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:37:43,785 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:37:44,076 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:37:44,080 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:44,356 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:44,357 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:44,357 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:37:44,357 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:37:44,357 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:37:44,358 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:44,519 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:44,520 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:44,520 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:44,717 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:44,718 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:44,718 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:44,871 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:44,871 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:44,871 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:37:45,024 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:37:45,024 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:37:45,025 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:37:45,025 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:37:45,025 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:37:45,234 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:37:45,235 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:37:45,235 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:37:45,236 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:37:45,236 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:37:45,237 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:37:45,237 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:37:45,237 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:37:45,268 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:37:45,268 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:37:45,268 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:37:45,269 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:37:45,270 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:37:45,270 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:37:45,270 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:37:45.269209",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:37:45,295 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:37:45,295 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:42:46,390 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:42:46,391 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:42:46,392 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:42:46,392 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:42:46,423 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:42:46,425 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:42:46,426 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:42:46,427 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:42:46,428 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:42:46,428 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:42:46,588 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:42:46,588 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:42:46,588 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:42:46,588 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:42:46,590 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:42:46,590 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:42:46,744 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:42:46,744 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:46,893 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:46,894 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:46,894 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:42:46,895 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:42:46,895 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:42:46,895 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:47,105 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:47,106 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:47,106 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:47,258 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:47,259 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:47,259 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:47,409 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:47,410 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:47,410 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:42:47,599 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:42:47,599 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:42:47,600 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:42:47,600 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:42:47,601 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:42:47,751 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:42:47,752 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:42:47,752 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:42:47,752 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:42:47,753 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:42:47,753 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:42:47,753 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:42:47,753 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:42:47,786 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:42:47,786 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:42:47,787 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:42:47,787 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:42:47,788 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:42:47,788 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:42:47,788 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:42:47.787151",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:42:47,832 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:42:47,833 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:47:48,920 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:47:48,922 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:47:48,922 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:47:48,923 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:47:48,958 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:47:48,959 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:47:48,960 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:47:48,962 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:47:48,963 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:47:48,965 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:47:49,138 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:47:49,138 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:47:49,138 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:47:49,139 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:47:49,139 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:47:49,139 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:47:49,298 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138879
2025-02-07 16:47:49,298 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:49,498 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:49,500 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:49,500 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138879, 'color_pages': 111088, 'bw_pages': None}
2025-02-07 16:47:49,500 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:47:49,500 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:47:49,500 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:49,663 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:49,664 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:49,664 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:49,897 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:49,898 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:49,898 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:50,152 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:50,152 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:50,152 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:47:50,319 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111088
2025-02-07 16:47:50,320 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:47:50,321 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111088, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111088, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111088, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111088, 'max': 100, 'percentage': 100}}}
2025-02-07 16:47:50,321 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:47:50,321 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:47:50,504 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:47:50,505 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:47:50,505 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:47:50,506 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138879,
    "color_pages": 111088,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111088,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:47:50,507 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:47:50,508 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:47:50,508 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:47:50,508 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:47:50,541 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:47:50,542 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:47:50,542 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:47:50,543 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:47:50,543 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:47:50,543 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:47:50,544 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:47:50.543676",
  "printer_data": {
    "counters": {
      "total_pages": 138879,
      "color_pages": 111088,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111088,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:47:50,573 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:47:50,574 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:52:51,669 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:52:51,671 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:52:51,672 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:52:51,673 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:52:51,706 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:52:51,707 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:52:51,707 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:52:51,709 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:52:51,710 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:52:51,710 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:52:51,871 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:52:51,871 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:52:51,872 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:52:51,872 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:52:51,872 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:52:51,873 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:52:52,072 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 16:52:52,072 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,229 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,229 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,230 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 16:52:52,231 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:52:52,231 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:52:52,231 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,386 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,386 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,386 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,573 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,574 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,574 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,733 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,734 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,734 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:52:52,883 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:52:52,884 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:52:52,884 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 16:52:52,885 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:52:52,885 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:52:53,031 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:52:53,032 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:52:53,032 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:52:53,032 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:52:53,033 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:52:53,033 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:52:53,033 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:52:53,033 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:52:53,067 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:52:53,068 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:52:53,069 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:52:53,071 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:52:53,072 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:52:53,074 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:52:53,075 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:52:53.071814",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:52:53,106 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:52:53,107 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 16:57:54,187 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 16:57:54,189 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:57:54,189 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:57:54,189 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:57:54,223 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:57:54,224 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:57:54,224 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:57:54,225 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 16:57:54,225 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 16:57:54,226 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 16:57:54,427 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 16:57:54,427 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 16:57:54,428 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 16:57:54,428 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 16:57:54,428 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:57:54,428 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 16:57:54,582 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 16:57:54,582 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:54,729 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:54,730 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:54,730 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 16:57:54,731 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 16:57:54,731 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 16:57:54,731 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:54,918 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:54,919 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:54,919 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:55,071 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:55,071 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:55,071 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:55,222 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:55,222 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:55,223 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 16:57:55,371 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 16:57:55,373 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 16:57:55,373 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 16:57:55,373 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 16:57:55,374 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 16:57:55,563 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 16:57:55,564 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 16:57:55,564 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 16:57:55,564 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 16:57:55,564 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 16:57:55,564 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 16:57:55,566 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 16:57:55,566 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:57:55,601 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 16:57:55,602 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 16:57:55,603 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 16:57:55,605 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 16:57:55,607 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 16:57:55,608 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 16:57:55,608 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T21:57:55.605799",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 16:57:55,635 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 16:57:55,635 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 17:02:56,711 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:02:56,712 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:02:56,713 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:02:56,713 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:02:56,747 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:02:56,748 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:02:56,749 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:02:56,750 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 17:02:56,751 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 17:02:56,751 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 17:02:56,922 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 17:02:56,922 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 17:02:56,923 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 17:02:56,923 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 17:02:56,923 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:02:56,924 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 17:02:57,085 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 17:02:57,085 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:57,277 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:57,278 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:57,278 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 17:02:57,278 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 17:02:57,280 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:02:57,280 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:57,456 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:57,457 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:57,457 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:57,642 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:57,643 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:57,643 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:57,807 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:57,808 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:57,809 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:02:58,022 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:02:58,023 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:02:58,023 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 17:02:58,023 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 17:02:58,023 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 17:02:58,198 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 17:02:58,199 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 17:02:58,200 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 17:02:58,200 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 17:02:58,201 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 17:02:58,201 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:02:58,202 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:02:58,202 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:02:58,235 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:02:58,235 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:02:58,236 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:02:58,237 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 17:02:58,239 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:02:58,239 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 17:02:58,240 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T22:02:58.237316",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 17:02:58,289 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 17:02:58,290 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 17:07:59,371 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:07:59,372 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:07:59,373 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:07:59,373 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:07:59,405 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:07:59,406 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:07:59,406 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:07:59,407 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 17:07:59,407 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 17:07:59,408 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 17:07:59,567 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 17:07:59,567 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 17:07:59,568 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 17:07:59,568 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 17:07:59,568 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:07:59,569 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 17:07:59,761 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 17:07:59,761 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:07:59,913 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:07:59,914 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:07:59,914 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 17:07:59,915 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 17:07:59,916 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:07:59,916 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:08:00,068 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:08:00,068 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:08:00,068 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:08:00,214 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:08:00,214 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:08:00,215 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:08:00,411 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:08:00,411 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:08:00,412 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:08:00,565 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:08:00,566 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:08:00,566 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 17:08:00,567 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 17:08:00,567 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 17:08:00,713 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 17:08:00,714 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 17:08:00,715 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 17:08:00,715 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 17:08:00,716 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 17:08:00,716 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:08:00,716 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:08:00,716 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:08:00,742 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:08:00,742 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:08:00,742 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:08:00,743 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 17:08:00,743 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:08:00,743 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 17:08:00,744 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T22:08:00.743647",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 17:08:00,772 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 17:08:00,773 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 17:13:01,864 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:13:01,866 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:13:01,867 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:13:01,867 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:13:01,962 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:13:01,978 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:13:01,980 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:13:01,983 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-07 17:13:01,983 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-07 17:13:01,986 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-07 17:13:02,239 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-07 17:13:02,239 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-07 17:13:02,239 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-07 17:13:02,241 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-07 17:13:02,241 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:13:02,241 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-07 17:13:02,443 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 138903
2025-02-07 17:13:02,443 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:02,619 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:02,619 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:02,620 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 138903, 'color_pages': 111112, 'bw_pages': None}
2025-02-07 17:13:02,620 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-07 17:13:02,620 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-07 17:13:02,620 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:02,780 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:02,794 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:02,794 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:03,003 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:03,003 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:03,004 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:03,178 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:03,178 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:03,178 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-07 17:13:03,330 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111112
2025-02-07 17:13:03,330 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-07 17:13:03,330 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111112, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111112, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111112, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111112, 'max': 100, 'percentage': 100}}}
2025-02-07 17:13:03,330 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-07 17:13:03,330 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-07 17:13:03,529 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-07 17:13:03,532 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-07 17:13:03,532 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-07 17:13:03,532 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 138903,
    "color_pages": 111112,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111112,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-07 17:13:03,532 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-07 17:13:03,532 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:13:03,532 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:13:03,532 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:13:03,587 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-07 17:13:03,588 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-07 17:13:03,589 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-07 17:13:03,590 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-07 17:13:03,590 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:13:03,591 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-07 17:13:03,592 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-07T22:13:03.590334",
  "printer_data": {
    "counters": {
      "total_pages": 138903,
      "color_pages": 111112,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111112,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-07 17:13:03,665 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-07 17:13:03,666 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-07 17:18:04,871 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:18:04,872 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:18:04,872 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:18:04,872 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:18:04,889 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:18:04,890 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:23:06,018 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:23:06,020 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:23:06,021 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:23:06,022 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:23:06,041 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:23:06,042 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:28:07,180 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:28:07,187 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:28:07,187 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:28:07,187 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:28:07,222 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:28:07,222 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:33:08,344 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:33:08,345 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:33:08,346 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:33:08,346 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:33:08,365 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:33:08,366 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:38:09,484 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:38:09,487 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:38:09,488 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:38:09,490 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:38:09,515 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:38:09,518 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:43:10,605 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:43:10,608 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:43:10,609 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:43:10,610 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:43:10,638 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:43:10,640 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:48:11,727 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:48:11,728 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:48:11,729 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:48:11,729 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:48:11,745 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:48:11,746 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-07 17:53:12,895 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-07 17:53:12,897 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-07 17:53:12,899 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-07 17:53:12,900 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-07 17:53:12,920 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-07 17:53:12,923 - ERROR - [printer_monitor_service.py:95] - ❌ Error 404: {"detail":"Not Found"}
2025-02-08 08:16:52,430 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 08:16:52,431 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:16:52,431 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:16:52,434 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-08 08:16:52,471 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"En linea","client_id":4}]...
2025-02-08 08:16:52,471 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:16:52,471 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "En linea",
    "client_id": 4
  }
]
2025-02-08 08:16:52,474 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 08:16:52,474 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 08:16:52,479 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 08:16:52,945 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 08:16:52,948 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 08:16:52,949 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 08:16:52,949 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 08:16:52,949 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:16:52,949 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 08:16:53,326 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 08:16:53,327 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:16:53,666 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:16:53,666 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:16:53,666 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 08:16:53,666 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 08:16:53,666 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:16:53,672 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:16:54,181 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:16:54,182 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:16:54,182 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:16:54,581 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:16:54,583 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:16:54,583 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:16:54,950 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:16:54,952 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:16:54,952 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:16:55,369 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:16:55,371 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:16:55,371 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 08:16:55,371 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 08:16:55,371 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 08:16:55,576 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 08:16:55,576 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 08:16:55,576 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 08:16:55,576 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 08:16:55,579 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-08 08:16:55,579 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:16:55,579 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:16:55,579 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-08 08:16:55,609 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":"En linea","client_id":4}]...
2025-02-08 08:16:55,611 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:16:55,611 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": "En linea",
    "client_id": 4
  }
]
2025-02-08 08:16:55,612 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 08:16:55,612 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-08 08:16:55,612 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-08 08:16:55,612 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T13:16:55.612383",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 08:16:55,646 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 08:16:55,646 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 08:21:56,764 - ERROR - [agent_service.py:425] - ❌ Error en la actualización: {'detail': 'Agent not found'}
2025-02-08 08:21:56,772 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:21:56,773 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:21:56,775 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-08 08:21:56,823 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:21:56,825 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:21:56,825 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:21:56,830 - INFO - [printer_monitor_service.py:120] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 08:21:56,830 - INFO - [printer_monitor_service.py:520] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 08:21:56,832 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 08:21:57,070 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 08:21:57,070 - INFO - [printer_monitor_service.py:529] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 08:21:57,070 - DEBUG - [printer_monitor_service.py:181] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 08:21:57,075 - DEBUG - [printer_monitor_service.py:223] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 08:21:57,075 - DEBUG - [printer_monitor_service.py:224] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:21:57,075 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 08:21:57,267 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 08:21:57,267 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:21:57,504 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:21:57,508 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:21:57,508 - DEBUG - [printer_monitor_service.py:239] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 08:21:57,508 - DEBUG - [printer_monitor_service.py:257] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 08:21:57,508 - DEBUG - [printer_monitor_service.py:258] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:21:57,508 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:21:57,708 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:21:57,708 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:21:57,708 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:21:57,898 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:21:57,898 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:21:57,901 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:21:58,125 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:21:58,125 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:21:58,125 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:21:58,300 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:21:58,303 - WARNING - [printer_monitor_service.py:316] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:21:58,303 - DEBUG - [printer_monitor_service.py:296] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 08:21:58,305 - INFO - [printer_monitor_service.py:550] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 08:21:58,305 - DEBUG - [printer_monitor_service.py:319] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 08:21:58,500 - DEBUG - [printer_monitor_service.py:344] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 08:21:58,500 - INFO - [printer_monitor_service.py:581] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 08:21:58,503 - INFO - [printer_monitor_service.py:154] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 08:21:58,503 - DEBUG - [printer_monitor_service.py:155] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 08:21:58,504 - INFO - [printer_monitor_service.py:429] - Preparando actualización de datos para 192.168.18.79
2025-02-08 08:21:58,504 - INFO - [printer_monitor_service.py:69] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:21:58,504 - DEBUG - [printer_monitor_service.py:81] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:21:58,504 - DEBUG - [printer_monitor_service.py:82] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-08 08:21:58,534 - DEBUG - [printer_monitor_service.py:87] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:21:58,534 - INFO - [printer_monitor_service.py:91] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:21:58,534 - DEBUG - [printer_monitor_service.py:92] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:21:58,534 - DEBUG - [printer_monitor_service.py:481] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 08:21:58,541 - DEBUG - [printer_monitor_service.py:482] - Headers: {'Authorization': 'Bearer agt_277c92e42b554050bb83241f2f730ec5', 'Content-Type': 'application/json'}
2025-02-08 08:21:58,541 - DEBUG - [printer_monitor_service.py:483] - Parámetros: {'agent_id': '1'}
2025-02-08 08:21:58,542 - DEBUG - [printer_monitor_service.py:484] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T13:21:58.534466",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 08:21:58,583 - INFO - [printer_monitor_service.py:495] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 08:21:58,585 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 08:22:18,814 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 08:22:18,814 - INFO - [printer_monitor_service.py:51] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 08:22:18,818 - DEBUG - [printer_monitor_service.py:52] - Verificando configuración inicial:
2025-02-08 08:22:18,818 - DEBUG - [printer_monitor_service.py:53] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 08:22:18,818 - DEBUG - [printer_monitor_service.py:54] -   CLIENT_TOKEN presente: Sí
2025-02-08 08:22:18,818 - DEBUG - [printer_monitor_service.py:55] -   AGENT_TOKEN presente: Sí
2025-02-08 08:22:18,818 - DEBUG - [printer_monitor_service.py:56] -   SNMP Community: public
2025-02-08 08:22:18,818 - DEBUG - [printer_monitor_service.py:57] -   SNMP Port: 161
2025-02-08 08:22:18,818 - DEBUG - [printer_monitor_service.py:58] -   SNMP Timeout: 2s
2025-02-08 08:22:18,818 - DEBUG - [printer_monitor_service.py:59] -   SNMP Retries: 1
2025-02-08 08:22:18,818 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5
2025-02-08 08:22:18,859 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 08:22:18,861 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_277c92e42b554050bb83241f2f730ec5 HTTP/1.1
2025-02-08 08:22:18,862 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 08:22:18,862 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 08:22:18,862 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 08:22:18,862 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: t6MrtAGq5SsF9mMVS1C3iQ==
2025-02-08 08:22:18,862 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 08:22:18,865 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 08:22:18,865 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 08:22:18,907 - DEBUG - [client.py:333] - < HTTP/1.1 403 Forbidden
2025-02-08 08:22:18,910 - DEBUG - [client.py:335] - < Date: Sat, 08 Feb 2025 13:22:17 GMT
2025-02-08 08:22:18,912 - DEBUG - [client.py:335] - < Content-Length: 0
2025-02-08 08:22:18,913 - DEBUG - [client.py:335] - < Content-Type: text/plain
2025-02-08 08:22:18,913 - DEBUG - [client.py:335] - < Connection: close
2025-02-08 08:22:18,913 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 08:22:18,913 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 08:22:18,915 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 08:22:18,917 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 08:22:18,917 - ERROR - [agent_service.py:144] - 🚨 Error en la conexión WebSocket: server rejected WebSocket connection: HTTP 403
2025-02-08 08:22:54,837 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 08:23:15,834 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 08:24:30,756 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 08:28:19,534 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 08:29:55,439 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 08:29:55,439 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 08:29:55,450 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 08:29:55,450 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 08:29:55,450 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 08:29:55,450 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: No
2025-02-08 08:29:55,450 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 08:29:55,450 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 08:29:55,450 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 08:29:55,450 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 08:29:56,540 - DEBUG - [agent_service.py:80] - 🔄 Enviando datos de registro: {
    "client_token": "cli_a5380ce9961f463eb1df00ef1ec9c393",
    "hostname": "Isidro",
    "username": "Isidro",
    "ip_address": "192.168.18.26",
    "device_type": "Windows",
    "system_info": {
        "Sistema": {
            "Nombre del SO": "Windows",
            "Versi\u00f3n del SO": "10.0.26100",
            "Arquitectura": "64bit",
            "Nombre del dispositivo": "Isidro",
            "Nombre del usuario": "Isidro",
            "Procesador": "Intel64 Family 6 Model 142 Stepping 12, GenuineIntel"
        },
        "CPU": {
            "Modelo": "Intel64 Family 6 Model 142 Stepping 12, GenuineIntel",
            "N\u00facleos f\u00edsicos": 2,
            "N\u00facleos l\u00f3gicos": 4,
            "Frecuencia (MHz)": 2592.0,
            "Uso actual (%)": 23.7
        },
        "Memoria": {
            "Total RAM (GB)": 11.83,
            "Disponible RAM (GB)": 2.69,
            "Uso de RAM (%)": 77.2
        },
        "Discos": [
            {
                "Dispositivo": "C:\\",
                "Punto de montaje": "C:\\",
                "Tipo de sistema de archivos": "NTFS",
                "Total (GB)": 231.84,
                "Usado (GB)": 168.44,
                "Disponible (GB)": 63.4,
                "Porcentaje de uso (%)": 72.7
            },
            {
                "Dispositivo": "D:\\",
                "Punto de montaje": "D:\\",
                "Tipo de sistema de archivos": "NTFS",
                "Total (GB)": 931.51,
                "Usado (GB)": 59.82,
                "Disponible (GB)": 871.69,
                "Porcentaje de uso (%)": 6.4
            }
        ],
        "Red": {
            "Wi-Fi": [
                {
                    "Tipo": "MAC",
                    "Direcci\u00f3n": "00-E9-3A-66-16-4F"
                },
                {
                    "Tipo": "IPv4",
                    "Direcci\u00f3n": "169.254.226.212",
                    "M\u00e1scara de red": "255.255.0.0",
                    "Broadcast": null
                },
                {
                    "Tipo": "IPv6",
                    "Direcci\u00f3n": "fe80::3f4b:1eaa:2cc5:e844",
                    "M\u00e1scara de red": null
                }
            ],
            "Conexi\u00f3n de \u00e1rea local* 1": [
                {
                    "Tipo": "MAC",
                    "Direcci\u00f3n": "02-E9-3A-66-16-4F"
                },
                {
                    "Tipo": "IPv4",
                    "Direcci\u00f3n": "169.254.138.12",
                    "M\u00e1scara de red": "255.255.0.0",
                    "Broadcast": null
                },
                {
                    "Tipo": "IPv6",
                    "Direcci\u00f3n": "fe80::8376:a87d:4560:d0af",
                    "M\u00e1scara de red": null
                }
            ],
            "Conexi\u00f3n de \u00e1rea local* 2": [
                {
                    "Tipo": "MAC",
                    "Direcci\u00f3n": "82-E9-3A-66-16-4F"
                },
                {
                    "Tipo": "IPv4",
                    "Direcci\u00f3n": "169.254.91.129",
                    "M\u00e1scara de red": "255.255.0.0",
                    "Broadcast": null
                },
                {
                    "Tipo": "IPv6",
                    "Direcci\u00f3n": "fe80::79d6:7705:344b:9722",
                    "M\u00e1scara de red": null
                }
            ],
            "Ethernet": [
                {
                    "Tipo": "MAC",
                    "Direcci\u00f3n": "14-CB-19-0C-E3-7E"
                },
                {
                    "Tipo": "IPv4",
                    "Direcci\u00f3n": "192.168.18.26",
                    "M\u00e1scara de red": "255.255.255.0",
                    "Broadcast": null
                },
                {
                    "Tipo": "IPv6",
                    "Direcci\u00f3n": "fe80::450:191f:4bc9:e23c",
                    "M\u00e1scara de red": null
                }
            ],
            "Conexi\u00f3n de red Bluetooth": [
                {
                    "Tipo": "MAC",
                    "Direcci\u00f3n": "00-E9-3A-66-16-4E"
                },
                {
                    "Tipo": "IPv4",
                    "Direcci\u00f3n": "169.254.213.153",
                    "M\u00e1scara de red": "255.255.0.0",
                    "Broadcast": null
                },
                {
                    "Tipo": "IPv6",
                    "Direcci\u00f3n": "fe80::9793:9d98:46ab:c2fc",
                    "M\u00e1scara de red": null
                }
            ],
            "Loopback Pseudo-Interface 1": [
                {
                    "Tipo": "IPv4",
                    "Direcci\u00f3n": "127.0.0.1",
                    "M\u00e1scara de red": "255.0.0.0",
                    "Broadcast": null
                },
                {
                    "Tipo": "IPv6",
                    "Direcci\u00f3n": "::1",
                    "M\u00e1scara de red": null
                }
            ]
        },
        "Bater\u00eda": {
            "Porcentaje": 73,
            "Enchufado": true
        },
        "Tarjetas Gr\u00e1ficas": "No se encontraron GPUs.",
        "Espacio en Disco": {
            "Total (GB)": 231.84,
            "Usado (GB)": 168.44,
            "Libre (GB)": 63.4
        }
    }
}
2025-02-08 08:29:56,604 - DEBUG - [agent_service.py:86] - Respuesta del servidor: 200 - {"cpu_info":{"Modelo":"Intel64 Family 6 Model 142 Stepping 12, GenuineIntel","Núcleos físicos":2,"Núcleos lógicos":4,"Frecuencia (MHz)":2592.0,"Uso actual (%)":23.7},"disk_usage":{"Total (GB)":231.84,"Usado (GB)":168.44,"Libre (GB)":63.4},"updated_at":"2025-02-08T13:29:55.660364","status":"online","token":"agt_32499ebe03d94fee8d8e5dd9446f46a6","memory_info":{"Total RAM (GB)":11.83,"Disponible RAM (GB)":2.69,"Uso de RAM (%)":77.2},"created_at":"2025-02-08T13:29:55.660354","is_active":true,"hostname":"Isidro","disk_info":[{"Dispositivo":"C:\\","Punto de montaje":"C:\\","Tipo de sistema de archivos":"NTFS","Total (GB)":231.84,"Usado (GB)":168.44,"Disponible (GB)":63.4,"Porcentaje de uso (%)":72.7},{"Dispositivo":"D:\\","Punto de montaje":"D:\\","Tipo de sistema de archivos":"NTFS","Total (GB)":931.51,"Usado (GB)":59.82,"Disponible (GB)":871.69,"Porcentaje de uso (%)":6.4}],"id":1,"username":"Isidro","ip_address":"192.168.18.26","network_info":{"Wi-Fi":[{"Tipo":"MAC","Dirección":"00-E9-3A-66-16-4F"},{"Tipo":"IPv4","Dirección":"169.254.226.212","Máscara de red":"255.255.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::3f4b:1eaa:2cc5:e844","Máscara de red":null}],"Conexión de área local* 1":[{"Tipo":"MAC","Dirección":"02-E9-3A-66-16-4F"},{"Tipo":"IPv4","Dirección":"169.254.138.12","Máscara de red":"255.255.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::8376:a87d:4560:d0af","Máscara de red":null}],"Conexión de área local* 2":[{"Tipo":"MAC","Dirección":"82-E9-3A-66-16-4F"},{"Tipo":"IPv4","Dirección":"169.254.91.129","Máscara de red":"255.255.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::79d6:7705:344b:9722","Máscara de red":null}],"Ethernet":[{"Tipo":"MAC","Dirección":"14-CB-19-0C-E3-7E"},{"Tipo":"IPv4","Dirección":"192.168.18.26","Máscara de red":"255.255.255.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::450:191f:4bc9:e23c","Máscara de red":null}],"Conexión de red Bluetooth":[{"Tipo":"MAC","Dirección":"00-E9-3A-66-16-4E"},{"Tipo":"IPv4","Dirección":"169.254.213.153","Máscara de red":"255.255.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::9793:9d98:46ab:c2fc","Máscara de red":null}],"Loopback Pseudo-Interface 1":[{"Tipo":"IPv4","Dirección":"127.0.0.1","Máscara de red":"255.0.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"::1","Máscara de red":null}]},"device_type":"Windows","gpu_info":"No se encontraron GPUs.","battery_info":{"Porcentaje":73,"Enchufado":true},"client_id":4,"system_info":{"Sistema":{"Nombre del SO":"Windows","Versión del SO":"10.0.26100","Arquitectura":"64bit","Nombre del dispositivo":"Isidro","Nombre del usuario":"Isidro","Procesador":"Intel64 Family 6 Model 142 Stepping 12, GenuineIntel"},"CPU":{"Modelo":"Intel64 Family 6 Model 142 Stepping 12, GenuineIntel","Núcleos físicos":2,"Núcleos lógicos":4,"Frecuencia (MHz)":2592.0,"Uso actual (%)":23.7},"Memoria":{"Total RAM (GB)":11.83,"Disponible RAM (GB)":2.69,"Uso de RAM (%)":77.2},"Discos":[{"Dispositivo":"C:\\","Punto de montaje":"C:\\","Tipo de sistema de archivos":"NTFS","Total (GB)":231.84,"Usado (GB)":168.44,"Disponible (GB)":63.4,"Porcentaje de uso (%)":72.7},{"Dispositivo":"D:\\","Punto de montaje":"D:\\","Tipo de sistema de archivos":"NTFS","Total (GB)":931.51,"Usado (GB)":59.82,"Disponible (GB)":871.69,"Porcentaje de uso (%)":6.4}],"Red":{"Wi-Fi":[{"Tipo":"MAC","Dirección":"00-E9-3A-66-16-4F"},{"Tipo":"IPv4","Dirección":"169.254.226.212","Máscara de red":"255.255.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::3f4b:1eaa:2cc5:e844","Máscara de red":null}],"Conexión de área local* 1":[{"Tipo":"MAC","Dirección":"02-E9-3A-66-16-4F"},{"Tipo":"IPv4","Dirección":"169.254.138.12","Máscara de red":"255.255.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::8376:a87d:4560:d0af","Máscara de red":null}],"Conexión de área local* 2":[{"Tipo":"MAC","Dirección":"82-E9-3A-66-16-4F"},{"Tipo":"IPv4","Dirección":"169.254.91.129","Máscara de red":"255.255.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::79d6:7705:344b:9722","Máscara de red":null}],"Ethernet":[{"Tipo":"MAC","Dirección":"14-CB-19-0C-E3-7E"},{"Tipo":"IPv4","Dirección":"192.168.18.26","Máscara de red":"255.255.255.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::450:191f:4bc9:e23c","Máscara de red":null}],"Conexión de red Bluetooth":[{"Tipo":"MAC","Dirección":"00-E9-3A-66-16-4E"},{"Tipo":"IPv4","Dirección":"169.254.213.153","Máscara de red":"255.255.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"fe80::9793:9d98:46ab:c2fc","Máscara de red":null}],"Loopback Pseudo-Interface 1":[{"Tipo":"IPv4","Dirección":"127.0.0.1","Máscara de red":"255.0.0.0","Broadcast":null},{"Tipo":"IPv6","Dirección":"::1","Máscara de red":null}]},"Batería":{"Porcentaje":73,"Enchufado":true},"Tarjetas Gráficas":"No se encontraron GPUs.","Espacio en Disco":{"Total (GB)":231.84,"Usado (GB)":168.44,"Libre (GB)":63.4}}}
2025-02-08 08:29:56,608 - INFO - [agent_service.py:116] - Saving agent token: agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 08:29:56,610 - INFO - [agent_service.py:101] - ✅ Registro exitoso, conectando...
2025-02-08 08:29:56,611 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 08:29:56,659 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 08:29:56,659 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 08:29:56,667 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 08:29:56,667 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 08:29:56,667 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 08:29:56,667 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 7trO0WR0qw/1RslbpTlEoA==
2025-02-08 08:29:56,667 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 08:29:56,667 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 08:29:56,667 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 08:29:56,678 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 08:29:56,678 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 08:29:56,678 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 08:29:56,678 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: Wo5qvYxtYdsKSfP1felR3mVBstY=
2025-02-08 08:29:56,678 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 08:29:56,678 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 13:29:55 GMT
2025-02-08 08:29:56,678 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 08:29:56,678 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 08:29:56,678 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 08:29:57,762 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 08:29:57,762 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:29:57,762 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:29:57,762 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:29:57,794 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:29:57,794 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:29:57,794 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:29:57,797 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 08:29:57,797 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 08:29:57,797 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 08:29:58,017 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 08:29:58,017 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 08:29:58,017 - INFO - [printer_monitor_service.py:182] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 08:29:58,017 - DEBUG - [printer_monitor_service.py:189] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 08:29:58,050 - DEBUG - [printer_monitor_service.py:194] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 08:29:58,053 - INFO - [printer_monitor_service.py:199] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 08:29:58,053 - DEBUG - [printer_monitor_service.py:200] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:29:58,053 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 08:29:58,053 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:29:58,055 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 08:29:58,220 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 08:29:58,220 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:29:58,400 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:29:58,404 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:29:58,404 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 08:29:58,404 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 08:29:58,404 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:29:58,404 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:29:58,559 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:29:58,559 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:29:58,559 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:29:58,796 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:29:58,796 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:29:58,796 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:29:59,007 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:29:59,007 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:29:59,007 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:29:59,166 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:29:59,166 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:29:59,166 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 08:29:59,166 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 08:29:59,170 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 08:29:59,324 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 08:29:59,324 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 08:29:59,324 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 08:29:59,324 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 08:29:59,324 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 08:29:59,324 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:29:59,327 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:29:59,327 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:29:59,358 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:29:59,358 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:29:59,358 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:29:59,362 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 08:29:59,362 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:29:59,362 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 08:29:59,362 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T13:29:59.362320",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 08:29:59,392 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 08:29:59,392 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 08:30:16,683 - DEBUG - [protocol.py:599] - < PING 41 0a cb 53 [binary, 4 bytes]
2025-02-08 08:30:16,686 - DEBUG - [protocol.py:745] - > PONG 41 0a cb 53 [binary, 4 bytes]
2025-02-08 08:30:16,689 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:30:16,690 - DEBUG - [protocol.py:745] - > PING 37 9e 52 c5 [binary, 4 bytes]
2025-02-08 08:30:16,700 - DEBUG - [protocol.py:599] - < PONG 37 9e 52 c5 [binary, 4 bytes]
2025-02-08 08:30:16,701 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:30:36,688 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:30:36,690 - DEBUG - [protocol.py:745] - > PING 0e 7d b1 88 [binary, 4 bytes]
2025-02-08 08:30:36,695 - DEBUG - [protocol.py:599] - < PING 69 d2 22 e7 [binary, 4 bytes]
2025-02-08 08:30:36,698 - DEBUG - [protocol.py:745] - > PONG 69 d2 22 e7 [binary, 4 bytes]
2025-02-08 08:30:36,702 - DEBUG - [protocol.py:599] - < PONG 0e 7d b1 88 [binary, 4 bytes]
2025-02-08 08:30:36,705 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:30:56,703 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:30:56,704 - DEBUG - [protocol.py:745] - > PING 1f 9d c6 fe [binary, 4 bytes]
2025-02-08 08:30:56,707 - DEBUG - [protocol.py:599] - < PING d6 ca fb 02 [binary, 4 bytes]
2025-02-08 08:30:56,709 - DEBUG - [protocol.py:745] - > PONG d6 ca fb 02 [binary, 4 bytes]
2025-02-08 08:30:56,714 - DEBUG - [protocol.py:599] - < PONG 1f 9d c6 fe [binary, 4 bytes]
2025-02-08 08:30:56,716 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:31:16,704 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:31:16,706 - DEBUG - [protocol.py:745] - > PING 14 ab b4 53 [binary, 4 bytes]
2025-02-08 08:31:16,714 - DEBUG - [protocol.py:599] - < PONG 14 ab b4 53 [binary, 4 bytes]
2025-02-08 08:31:16,717 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:31:16,721 - DEBUG - [protocol.py:599] - < PING f2 eb 7d af [binary, 4 bytes]
2025-02-08 08:31:16,723 - DEBUG - [protocol.py:745] - > PONG f2 eb 7d af [binary, 4 bytes]
2025-02-08 08:31:36,700 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:31:36,702 - DEBUG - [protocol.py:745] - > PING a9 3a 87 15 [binary, 4 bytes]
2025-02-08 08:31:36,708 - DEBUG - [protocol.py:599] - < PONG a9 3a 87 15 [binary, 4 bytes]
2025-02-08 08:31:36,710 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:31:36,734 - DEBUG - [protocol.py:599] - < PING a5 b2 49 24 [binary, 4 bytes]
2025-02-08 08:31:36,743 - DEBUG - [protocol.py:745] - > PONG a5 b2 49 24 [binary, 4 bytes]
2025-02-08 08:31:56,702 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:31:56,702 - DEBUG - [protocol.py:745] - > PING f4 0e 4e a1 [binary, 4 bytes]
2025-02-08 08:31:56,710 - DEBUG - [protocol.py:599] - < PONG f4 0e 4e a1 [binary, 4 bytes]
2025-02-08 08:31:56,711 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:31:56,753 - DEBUG - [protocol.py:599] - < PING b7 d2 a0 e9 [binary, 4 bytes]
2025-02-08 08:31:56,754 - DEBUG - [protocol.py:745] - > PONG b7 d2 a0 e9 [binary, 4 bytes]
2025-02-08 08:32:16,705 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:32:16,708 - DEBUG - [protocol.py:745] - > PING c1 19 3a 47 [binary, 4 bytes]
2025-02-08 08:32:16,715 - DEBUG - [protocol.py:599] - < PONG c1 19 3a 47 [binary, 4 bytes]
2025-02-08 08:32:16,717 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:32:16,759 - DEBUG - [protocol.py:599] - < PING 'Ȋ=<' [text, 4 bytes]
2025-02-08 08:32:16,761 - DEBUG - [protocol.py:745] - > PONG 'Ȋ=<' [text, 4 bytes]
2025-02-08 08:32:36,730 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:32:36,732 - DEBUG - [protocol.py:745] - > PING 83 80 e0 ce [binary, 4 bytes]
2025-02-08 08:32:36,741 - DEBUG - [protocol.py:599] - < PONG 83 80 e0 ce [binary, 4 bytes]
2025-02-08 08:32:36,743 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:32:36,767 - DEBUG - [protocol.py:599] - < PING 83 fe fc 20 [binary, 4 bytes]
2025-02-08 08:32:36,768 - DEBUG - [protocol.py:745] - > PONG 83 fe fc 20 [binary, 4 bytes]
2025-02-08 08:32:56,727 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:32:56,731 - DEBUG - [protocol.py:745] - > PING a3 08 52 bb [binary, 4 bytes]
2025-02-08 08:32:56,735 - DEBUG - [protocol.py:599] - < PONG a3 08 52 bb [binary, 4 bytes]
2025-02-08 08:32:56,737 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:32:56,774 - DEBUG - [protocol.py:599] - < PING 8d b7 7e 6f [binary, 4 bytes]
2025-02-08 08:32:56,778 - DEBUG - [protocol.py:745] - > PONG 8d b7 7e 6f [binary, 4 bytes]
2025-02-08 08:33:16,753 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:33:16,755 - DEBUG - [protocol.py:745] - > PING f1 eb 68 d9 [binary, 4 bytes]
2025-02-08 08:33:16,764 - DEBUG - [protocol.py:599] - < PONG f1 eb 68 d9 [binary, 4 bytes]
2025-02-08 08:33:16,767 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:33:16,786 - DEBUG - [protocol.py:599] - < PING 'C\x05\x08\t' [text, 4 bytes]
2025-02-08 08:33:16,788 - DEBUG - [protocol.py:745] - > PONG 'C\x05\x08\t' [text, 4 bytes]
2025-02-08 08:33:36,788 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:33:36,790 - DEBUG - [protocol.py:745] - > PING '\tmٛ' [text, 4 bytes]
2025-02-08 08:33:36,798 - DEBUG - [protocol.py:599] - < PONG '\tmٛ' [text, 4 bytes]
2025-02-08 08:33:36,799 - DEBUG - [protocol.py:599] - < PING 3a be ac 88 [binary, 4 bytes]
2025-02-08 08:33:36,801 - DEBUG - [protocol.py:745] - > PONG 3a be ac 88 [binary, 4 bytes]
2025-02-08 08:33:36,804 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:33:56,797 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:33:56,798 - DEBUG - [protocol.py:745] - > PING e3 75 81 d2 [binary, 4 bytes]
2025-02-08 08:33:56,807 - DEBUG - [protocol.py:599] - < PONG e3 75 81 d2 [binary, 4 bytes]
2025-02-08 08:33:56,809 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:33:56,812 - DEBUG - [protocol.py:599] - < PING 85 f7 6a 9f [binary, 4 bytes]
2025-02-08 08:33:56,814 - DEBUG - [protocol.py:745] - > PONG 85 f7 6a 9f [binary, 4 bytes]
2025-02-08 08:34:16,788 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:34:16,790 - DEBUG - [protocol.py:745] - > PING f2 b0 1e 60 [binary, 4 bytes]
2025-02-08 08:34:16,796 - DEBUG - [protocol.py:599] - < PONG f2 b0 1e 60 [binary, 4 bytes]
2025-02-08 08:34:16,799 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:34:16,821 - DEBUG - [protocol.py:599] - < PING 2a 17 d0 37 [binary, 4 bytes]
2025-02-08 08:34:16,823 - DEBUG - [protocol.py:745] - > PONG 2a 17 d0 37 [binary, 4 bytes]
2025-02-08 08:34:36,821 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:34:36,823 - DEBUG - [protocol.py:745] - > PING 96 f6 b4 f8 [binary, 4 bytes]
2025-02-08 08:34:36,830 - DEBUG - [protocol.py:599] - < PONG 96 f6 b4 f8 [binary, 4 bytes]
2025-02-08 08:34:36,831 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:34:36,833 - DEBUG - [protocol.py:599] - < PING d2 fc 9e 12 [binary, 4 bytes]
2025-02-08 08:34:36,835 - DEBUG - [protocol.py:745] - > PONG d2 fc 9e 12 [binary, 4 bytes]
2025-02-08 08:34:56,839 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:34:56,840 - DEBUG - [protocol.py:745] - > PING 9a 8d 5d 81 [binary, 4 bytes]
2025-02-08 08:34:56,844 - DEBUG - [protocol.py:599] - < PING f5 aa b9 f5 [binary, 4 bytes]
2025-02-08 08:34:56,846 - DEBUG - [protocol.py:745] - > PONG f5 aa b9 f5 [binary, 4 bytes]
2025-02-08 08:34:56,849 - DEBUG - [protocol.py:599] - < PONG 9a 8d 5d 81 [binary, 4 bytes]
2025-02-08 08:34:56,851 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:35:00,498 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 08:35:00,500 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:35:00,503 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:35:00,504 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:35:00,548 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:35:00,549 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:35:00,549 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:35:00,550 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 08:35:00,551 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 08:35:00,551 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 08:35:00,783 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 08:35:00,783 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 08:35:00,784 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 08:35:00,784 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 08:35:00,785 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:35:00,785 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 08:35:01,076 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 08:35:01,077 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:35:01,299 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:35:01,299 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:35:01,299 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 08:35:01,299 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 08:35:01,300 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:35:01,300 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:35:01,523 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:35:01,523 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:35:01,524 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:35:01,802 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:35:01,803 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:35:01,803 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:35:02,027 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:35:02,028 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:35:02,029 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:35:02,268 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:35:02,268 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:35:02,269 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 08:35:02,269 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 08:35:02,270 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 08:35:02,470 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 08:35:02,471 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 08:35:02,471 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 08:35:02,471 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 08:35:02,473 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 08:35:02,473 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:35:02,473 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:35:02,474 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:35:02,516 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:35:02,517 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:35:02,517 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:35:02,518 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 08:35:02,520 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:35:02,521 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 08:35:02,522 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T13:35:02.518984",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 08:35:02,628 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 08:35:02,631 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 08:35:16,839 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:35:16,841 - DEBUG - [protocol.py:745] - > PING 31 31 36 e8 [binary, 4 bytes]
2025-02-08 08:35:16,849 - DEBUG - [protocol.py:599] - < PONG 31 31 36 e8 [binary, 4 bytes]
2025-02-08 08:35:16,852 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:35:16,857 - DEBUG - [protocol.py:599] - < PING 93 d5 24 e0 [binary, 4 bytes]
2025-02-08 08:35:16,860 - DEBUG - [protocol.py:745] - > PONG 93 d5 24 e0 [binary, 4 bytes]
2025-02-08 08:35:36,836 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:35:36,837 - DEBUG - [protocol.py:745] - > PING ec 13 ec 57 [binary, 4 bytes]
2025-02-08 08:35:36,843 - DEBUG - [protocol.py:599] - < PONG ec 13 ec 57 [binary, 4 bytes]
2025-02-08 08:35:36,845 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:35:36,872 - DEBUG - [protocol.py:599] - < PING 71 d0 84 89 [binary, 4 bytes]
2025-02-08 08:35:36,876 - DEBUG - [protocol.py:745] - > PONG 71 d0 84 89 [binary, 4 bytes]
2025-02-08 08:35:56,877 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:35:56,879 - DEBUG - [protocol.py:745] - > PING 9e dd 7d e8 [binary, 4 bytes]
2025-02-08 08:35:56,884 - DEBUG - [protocol.py:599] - < PING 9d 9e e9 d2 [binary, 4 bytes]
2025-02-08 08:35:56,886 - DEBUG - [protocol.py:745] - > PONG 9d 9e e9 d2 [binary, 4 bytes]
2025-02-08 08:35:56,888 - DEBUG - [protocol.py:599] - < PONG 9e dd 7d e8 [binary, 4 bytes]
2025-02-08 08:35:56,890 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:36:16,894 - DEBUG - [protocol.py:599] - < PING c3 5f cd 9e [binary, 4 bytes]
2025-02-08 08:36:16,896 - DEBUG - [protocol.py:745] - > PONG c3 5f cd 9e [binary, 4 bytes]
2025-02-08 08:36:16,899 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:36:16,900 - DEBUG - [protocol.py:745] - > PING a2 85 b5 e2 [binary, 4 bytes]
2025-02-08 08:36:16,909 - DEBUG - [protocol.py:599] - < PONG a2 85 b5 e2 [binary, 4 bytes]
2025-02-08 08:36:16,912 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:36:36,905 - DEBUG - [protocol.py:599] - < PING 01 19 25 97 [binary, 4 bytes]
2025-02-08 08:36:36,908 - DEBUG - [protocol.py:745] - > PONG 01 19 25 97 [binary, 4 bytes]
2025-02-08 08:36:36,910 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:36:36,912 - DEBUG - [protocol.py:745] - > PING 3c d9 f6 bf [binary, 4 bytes]
2025-02-08 08:36:36,920 - DEBUG - [protocol.py:599] - < PONG 3c d9 f6 bf [binary, 4 bytes]
2025-02-08 08:36:36,922 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:36:56,916 - DEBUG - [protocol.py:599] - < PING f1 dc 66 a5 [binary, 4 bytes]
2025-02-08 08:36:56,919 - DEBUG - [protocol.py:745] - > PONG f1 dc 66 a5 [binary, 4 bytes]
2025-02-08 08:36:56,921 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:36:56,922 - DEBUG - [protocol.py:745] - > PING 0b de b7 bf [binary, 4 bytes]
2025-02-08 08:36:56,930 - DEBUG - [protocol.py:599] - < PONG 0b de b7 bf [binary, 4 bytes]
2025-02-08 08:36:56,933 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:37:16,929 - DEBUG - [protocol.py:599] - < PING 95 a1 00 f0 [binary, 4 bytes]
2025-02-08 08:37:16,930 - DEBUG - [protocol.py:745] - > PONG 95 a1 00 f0 [binary, 4 bytes]
2025-02-08 08:37:16,933 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:37:16,934 - DEBUG - [protocol.py:745] - > PING 6d 6a c5 20 [binary, 4 bytes]
2025-02-08 08:37:16,942 - DEBUG - [protocol.py:599] - < PONG 6d 6a c5 20 [binary, 4 bytes]
2025-02-08 08:37:16,944 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:37:36,936 - DEBUG - [protocol.py:599] - < PING 23 42 ec 77 [binary, 4 bytes]
2025-02-08 08:37:36,938 - DEBUG - [protocol.py:745] - > PONG 23 42 ec 77 [binary, 4 bytes]
2025-02-08 08:37:36,941 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:37:36,943 - DEBUG - [protocol.py:745] - > PING c2 4e 49 39 [binary, 4 bytes]
2025-02-08 08:37:36,951 - DEBUG - [protocol.py:599] - < PONG c2 4e 49 39 [binary, 4 bytes]
2025-02-08 08:37:36,953 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:37:56,947 - DEBUG - [protocol.py:599] - < PING 71 ab ec 54 [binary, 4 bytes]
2025-02-08 08:37:56,949 - DEBUG - [protocol.py:745] - > PONG 71 ab ec 54 [binary, 4 bytes]
2025-02-08 08:37:56,951 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:37:56,952 - DEBUG - [protocol.py:745] - > PING 8f dd 80 18 [binary, 4 bytes]
2025-02-08 08:37:56,958 - DEBUG - [protocol.py:599] - < PONG 8f dd 80 18 [binary, 4 bytes]
2025-02-08 08:37:56,960 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:38:16,947 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:38:16,949 - DEBUG - [protocol.py:745] - > PING b6 a9 8d 4a [binary, 4 bytes]
2025-02-08 08:38:16,954 - DEBUG - [protocol.py:599] - < PONG b6 a9 8d 4a [binary, 4 bytes]
2025-02-08 08:38:16,957 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:38:16,959 - DEBUG - [protocol.py:599] - < PING 72 71 22 b4 [binary, 4 bytes]
2025-02-08 08:38:16,961 - DEBUG - [protocol.py:745] - > PONG 72 71 22 b4 [binary, 4 bytes]
2025-02-08 08:38:36,958 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:38:36,960 - DEBUG - [protocol.py:745] - > PING ab e0 5c 49 [binary, 4 bytes]
2025-02-08 08:38:36,968 - DEBUG - [protocol.py:599] - < PONG ab e0 5c 49 [binary, 4 bytes]
2025-02-08 08:38:36,970 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:38:36,974 - DEBUG - [protocol.py:599] - < PING 74 5d 11 fe [binary, 4 bytes]
2025-02-08 08:38:36,977 - DEBUG - [protocol.py:745] - > PONG 74 5d 11 fe [binary, 4 bytes]
2025-02-08 08:38:56,986 - DEBUG - [protocol.py:599] - < PING f6 59 e1 f8 [binary, 4 bytes]
2025-02-08 08:38:56,988 - DEBUG - [protocol.py:745] - > PONG f6 59 e1 f8 [binary, 4 bytes]
2025-02-08 08:38:56,990 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:38:56,992 - DEBUG - [protocol.py:745] - > PING 96 68 95 c9 [binary, 4 bytes]
2025-02-08 08:38:56,997 - DEBUG - [protocol.py:599] - < PONG 96 68 95 c9 [binary, 4 bytes]
2025-02-08 08:38:56,998 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:39:16,996 - DEBUG - [protocol.py:599] - < PING b9 94 a2 8e [binary, 4 bytes]
2025-02-08 08:39:16,998 - DEBUG - [protocol.py:745] - > PONG b9 94 a2 8e [binary, 4 bytes]
2025-02-08 08:39:17,000 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:39:17,002 - DEBUG - [protocol.py:745] - > PING b2 79 b1 c3 [binary, 4 bytes]
2025-02-08 08:39:17,009 - DEBUG - [protocol.py:599] - < PONG b2 79 b1 c3 [binary, 4 bytes]
2025-02-08 08:39:17,013 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:39:37,008 - DEBUG - [protocol.py:599] - < PING 81 10 53 c1 [binary, 4 bytes]
2025-02-08 08:39:37,010 - DEBUG - [protocol.py:745] - > PONG 81 10 53 c1 [binary, 4 bytes]
2025-02-08 08:39:37,012 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:39:37,014 - DEBUG - [protocol.py:745] - > PING 2b 8b c6 0c [binary, 4 bytes]
2025-02-08 08:39:37,025 - DEBUG - [protocol.py:599] - < PONG 2b 8b c6 0c [binary, 4 bytes]
2025-02-08 08:39:37,028 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:39:57,017 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:39:57,019 - DEBUG - [protocol.py:745] - > PING f8 aa 74 58 [binary, 4 bytes]
2025-02-08 08:39:57,021 - DEBUG - [protocol.py:599] - < PING 67 e7 6f cf [binary, 4 bytes]
2025-02-08 08:39:57,023 - DEBUG - [protocol.py:745] - > PONG 67 e7 6f cf [binary, 4 bytes]
2025-02-08 08:39:57,026 - DEBUG - [protocol.py:599] - < PONG f8 aa 74 58 [binary, 4 bytes]
2025-02-08 08:39:57,029 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:40:03,941 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 08:40:03,944 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:40:03,945 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:40:03,947 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:40:04,054 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:40:04,055 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:40:04,057 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:40:04,059 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 08:40:04,060 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 08:40:04,061 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 08:40:04,438 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 08:40:04,438 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 08:40:04,439 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 08:40:04,439 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 08:40:04,440 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:40:04,441 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 08:40:04,669 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 08:40:04,670 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:40:04,902 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:40:04,902 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:40:04,903 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 08:40:04,903 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 08:40:04,903 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:40:04,904 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:40:05,183 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:40:05,184 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:40:05,184 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:40:05,415 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:40:05,417 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:40:05,417 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:40:05,633 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:40:05,634 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:40:05,634 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:40:05,903 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:40:05,903 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:40:05,903 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 08:40:05,903 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 08:40:05,904 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 08:40:06,121 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 08:40:06,121 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 08:40:06,122 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 08:40:06,122 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 08:40:06,123 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 08:40:06,123 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:40:06,123 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:40:06,124 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:40:06,262 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:40:06,264 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:40:06,265 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:40:06,268 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 08:40:06,269 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:40:06,270 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 08:40:06,272 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T13:40:06.267221",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 08:40:06,398 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 08:40:06,401 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 08:40:17,030 - DEBUG - [protocol.py:599] - < PING a3 ac a0 56 [binary, 4 bytes]
2025-02-08 08:40:17,032 - DEBUG - [protocol.py:745] - > PONG a3 ac a0 56 [binary, 4 bytes]
2025-02-08 08:40:17,035 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:40:17,036 - DEBUG - [protocol.py:745] - > PING 51 e7 98 ed [binary, 4 bytes]
2025-02-08 08:40:17,043 - DEBUG - [protocol.py:599] - < PONG 51 e7 98 ed [binary, 4 bytes]
2025-02-08 08:40:17,045 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:40:37,041 - DEBUG - [protocol.py:599] - < PING 78 fb b5 ba [binary, 4 bytes]
2025-02-08 08:40:37,043 - DEBUG - [protocol.py:745] - > PONG 78 fb b5 ba [binary, 4 bytes]
2025-02-08 08:40:37,046 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:40:37,048 - DEBUG - [protocol.py:745] - > PING 1e 60 99 d2 [binary, 4 bytes]
2025-02-08 08:40:37,059 - DEBUG - [protocol.py:599] - < PONG 1e 60 99 d2 [binary, 4 bytes]
2025-02-08 08:40:37,063 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:40:57,051 - DEBUG - [protocol.py:599] - < PING e3 91 49 99 [binary, 4 bytes]
2025-02-08 08:40:57,053 - DEBUG - [protocol.py:745] - > PONG e3 91 49 99 [binary, 4 bytes]
2025-02-08 08:40:57,056 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:40:57,058 - DEBUG - [protocol.py:745] - > PING aa 54 19 f4 [binary, 4 bytes]
2025-02-08 08:40:57,067 - DEBUG - [protocol.py:599] - < PONG aa 54 19 f4 [binary, 4 bytes]
2025-02-08 08:40:57,070 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:41:17,061 - DEBUG - [protocol.py:599] - < PING 3b 6a 89 15 [binary, 4 bytes]
2025-02-08 08:41:17,063 - DEBUG - [protocol.py:745] - > PONG 3b 6a 89 15 [binary, 4 bytes]
2025-02-08 08:41:17,065 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:41:17,067 - DEBUG - [protocol.py:745] - > PING '\x11U&K' [text, 4 bytes]
2025-02-08 08:41:17,073 - DEBUG - [protocol.py:599] - < PONG '\x11U&K' [text, 4 bytes]
2025-02-08 08:41:17,075 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:41:37,069 - DEBUG - [protocol.py:599] - < PING b9 be 07 8d [binary, 4 bytes]
2025-02-08 08:41:37,071 - DEBUG - [protocol.py:745] - > PONG b9 be 07 8d [binary, 4 bytes]
2025-02-08 08:41:37,074 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:41:37,076 - DEBUG - [protocol.py:745] - > PING 58 ed 34 0e [binary, 4 bytes]
2025-02-08 08:41:37,082 - DEBUG - [protocol.py:599] - < PONG 58 ed 34 0e [binary, 4 bytes]
2025-02-08 08:41:37,084 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:41:57,079 - DEBUG - [protocol.py:599] - < PING b6 ab 77 32 [binary, 4 bytes]
2025-02-08 08:41:57,081 - DEBUG - [protocol.py:745] - > PONG b6 ab 77 32 [binary, 4 bytes]
2025-02-08 08:41:57,083 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:41:57,084 - DEBUG - [protocol.py:745] - > PING 52 1e 4c 84 [binary, 4 bytes]
2025-02-08 08:41:57,091 - DEBUG - [protocol.py:599] - < PONG 52 1e 4c 84 [binary, 4 bytes]
2025-02-08 08:41:57,093 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:42:17,089 - DEBUG - [protocol.py:599] - < PING 53 1a e9 f3 [binary, 4 bytes]
2025-02-08 08:42:17,091 - DEBUG - [protocol.py:745] - > PONG 53 1a e9 f3 [binary, 4 bytes]
2025-02-08 08:42:17,093 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:42:17,095 - DEBUG - [protocol.py:745] - > PING c2 e2 f6 51 [binary, 4 bytes]
2025-02-08 08:42:17,104 - DEBUG - [protocol.py:599] - < PONG c2 e2 f6 51 [binary, 4 bytes]
2025-02-08 08:42:17,106 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:42:37,098 - DEBUG - [protocol.py:599] - < PING a2 75 31 20 [binary, 4 bytes]
2025-02-08 08:42:37,100 - DEBUG - [protocol.py:745] - > PONG a2 75 31 20 [binary, 4 bytes]
2025-02-08 08:42:37,102 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:42:37,103 - DEBUG - [protocol.py:745] - > PING 76 d1 cc 2f [binary, 4 bytes]
2025-02-08 08:42:37,108 - DEBUG - [protocol.py:599] - < PONG 76 d1 cc 2f [binary, 4 bytes]
2025-02-08 08:42:37,110 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:42:57,109 - DEBUG - [protocol.py:599] - < PING 3f 61 85 e5 [binary, 4 bytes]
2025-02-08 08:42:57,111 - DEBUG - [protocol.py:745] - > PONG 3f 61 85 e5 [binary, 4 bytes]
2025-02-08 08:42:57,114 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:42:57,115 - DEBUG - [protocol.py:745] - > PING 95 2f 50 c7 [binary, 4 bytes]
2025-02-08 08:42:57,123 - DEBUG - [protocol.py:599] - < PONG 95 2f 50 c7 [binary, 4 bytes]
2025-02-08 08:42:57,126 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:43:17,120 - DEBUG - [protocol.py:599] - < PING 11 fe 95 8f [binary, 4 bytes]
2025-02-08 08:43:17,122 - DEBUG - [protocol.py:745] - > PONG 11 fe 95 8f [binary, 4 bytes]
2025-02-08 08:43:17,125 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:43:17,126 - DEBUG - [protocol.py:745] - > PING 87 ef d7 fb [binary, 4 bytes]
2025-02-08 08:43:17,133 - DEBUG - [protocol.py:599] - < PONG 87 ef d7 fb [binary, 4 bytes]
2025-02-08 08:43:17,137 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:43:37,131 - DEBUG - [protocol.py:599] - < PING 6b a5 ee f9 [binary, 4 bytes]
2025-02-08 08:43:37,134 - DEBUG - [protocol.py:745] - > PONG 6b a5 ee f9 [binary, 4 bytes]
2025-02-08 08:43:37,136 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:43:37,139 - DEBUG - [protocol.py:745] - > PING 10 7b 84 8d [binary, 4 bytes]
2025-02-08 08:43:37,148 - DEBUG - [protocol.py:599] - < PONG 10 7b 84 8d [binary, 4 bytes]
2025-02-08 08:43:37,150 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:43:57,141 - DEBUG - [protocol.py:599] - < PING 97 a2 48 69 [binary, 4 bytes]
2025-02-08 08:43:57,142 - DEBUG - [protocol.py:745] - > PONG 97 a2 48 69 [binary, 4 bytes]
2025-02-08 08:43:57,144 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:43:57,146 - DEBUG - [protocol.py:745] - > PING 77 60 9e 62 [binary, 4 bytes]
2025-02-08 08:43:57,153 - DEBUG - [protocol.py:599] - < PONG 77 60 9e 62 [binary, 4 bytes]
2025-02-08 08:43:57,156 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:44:17,151 - DEBUG - [protocol.py:599] - < PING c0 9f 22 0a [binary, 4 bytes]
2025-02-08 08:44:17,153 - DEBUG - [protocol.py:745] - > PONG c0 9f 22 0a [binary, 4 bytes]
2025-02-08 08:44:17,155 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:44:17,157 - DEBUG - [protocol.py:745] - > PING 0b f8 9a fc [binary, 4 bytes]
2025-02-08 08:44:17,162 - DEBUG - [protocol.py:599] - < PONG 0b f8 9a fc [binary, 4 bytes]
2025-02-08 08:44:17,165 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:44:37,152 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:44:37,154 - DEBUG - [protocol.py:745] - > PING 70 28 91 b9 [binary, 4 bytes]
2025-02-08 08:44:37,159 - DEBUG - [protocol.py:599] - < PING b1 58 b3 7e [binary, 4 bytes]
2025-02-08 08:44:37,161 - DEBUG - [protocol.py:745] - > PONG b1 58 b3 7e [binary, 4 bytes]
2025-02-08 08:44:37,166 - DEBUG - [protocol.py:599] - < PONG 70 28 91 b9 [binary, 4 bytes]
2025-02-08 08:44:37,173 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:44:57,151 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:44:57,153 - DEBUG - [protocol.py:745] - > PING 02 fe f8 49 [binary, 4 bytes]
2025-02-08 08:44:57,161 - DEBUG - [protocol.py:599] - < PONG 02 fe f8 49 [binary, 4 bytes]
2025-02-08 08:44:57,164 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:44:57,174 - DEBUG - [protocol.py:599] - < PING ff 2b 88 4b [binary, 4 bytes]
2025-02-08 08:44:57,176 - DEBUG - [protocol.py:745] - > PONG ff 2b 88 4b [binary, 4 bytes]
2025-02-08 08:45:07,525 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 08:45:07,528 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:45:07,529 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:45:07,531 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:45:07,587 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:45:07,587 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:45:07,588 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:45:07,589 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 08:45:07,590 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 08:45:07,590 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 08:45:07,823 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 08:45:07,823 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 08:45:07,824 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 08:45:07,824 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 08:45:07,824 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:45:07,825 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 08:45:08,058 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 08:45:08,058 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:45:08,357 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:45:08,358 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:45:08,358 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 08:45:08,359 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 08:45:08,359 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:45:08,360 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:45:08,576 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:45:08,577 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:45:08,577 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:45:08,793 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:45:08,794 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:45:08,794 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:45:09,085 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:45:09,086 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:45:09,086 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:45:09,304 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:45:09,305 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:45:09,305 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 08:45:09,305 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 08:45:09,306 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 08:45:09,527 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 08:45:09,529 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 08:45:09,529 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 08:45:09,529 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 08:45:09,530 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 08:45:09,530 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:45:09,530 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:45:09,531 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:45:09,565 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:45:09,566 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:45:09,567 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:45:09,568 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 08:45:09,569 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:45:09,569 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 08:45:09,569 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T13:45:09.568227",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 08:45:09,604 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 08:45:09,605 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 08:45:17,162 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:45:17,165 - DEBUG - [protocol.py:745] - > PING b5 ea 8d d1 [binary, 4 bytes]
2025-02-08 08:45:17,172 - DEBUG - [protocol.py:599] - < PONG b5 ea 8d d1 [binary, 4 bytes]
2025-02-08 08:45:17,175 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:45:17,189 - DEBUG - [protocol.py:599] - < PING 67 fb 98 e0 [binary, 4 bytes]
2025-02-08 08:45:17,192 - DEBUG - [protocol.py:745] - > PONG 67 fb 98 e0 [binary, 4 bytes]
2025-02-08 08:45:37,189 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:45:37,191 - DEBUG - [protocol.py:745] - > PING 74 28 21 e5 [binary, 4 bytes]
2025-02-08 08:45:37,199 - DEBUG - [protocol.py:599] - < PONG 74 28 21 e5 [binary, 4 bytes]
2025-02-08 08:45:37,202 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:45:37,206 - DEBUG - [protocol.py:599] - < PING a2 9d f4 30 [binary, 4 bytes]
2025-02-08 08:45:37,208 - DEBUG - [protocol.py:745] - > PONG a2 9d f4 30 [binary, 4 bytes]
2025-02-08 08:45:57,203 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:45:57,205 - DEBUG - [protocol.py:745] - > PING "'6LS" [text, 4 bytes]
2025-02-08 08:45:57,209 - DEBUG - [protocol.py:599] - < PONG "'6LS" [text, 4 bytes]
2025-02-08 08:45:57,211 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:45:57,216 - DEBUG - [protocol.py:599] - < PING 59 4f fe 68 [binary, 4 bytes]
2025-02-08 08:45:57,222 - DEBUG - [protocol.py:745] - > PONG 59 4f fe 68 [binary, 4 bytes]
2025-02-08 08:46:17,200 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:46:17,203 - DEBUG - [protocol.py:745] - > PING fd c4 4e ee [binary, 4 bytes]
2025-02-08 08:46:17,211 - DEBUG - [protocol.py:599] - < PONG fd c4 4e ee [binary, 4 bytes]
2025-02-08 08:46:17,214 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:46:17,234 - DEBUG - [protocol.py:599] - < PING ae 23 95 72 [binary, 4 bytes]
2025-02-08 08:46:17,237 - DEBUG - [protocol.py:745] - > PONG ae 23 95 72 [binary, 4 bytes]
2025-02-08 08:46:37,206 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:46:37,208 - DEBUG - [protocol.py:745] - > PING e5 21 77 c2 [binary, 4 bytes]
2025-02-08 08:46:37,217 - DEBUG - [protocol.py:599] - < PONG e5 21 77 c2 [binary, 4 bytes]
2025-02-08 08:46:37,219 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:46:37,249 - DEBUG - [protocol.py:599] - < PING 17 49 48 d8 [binary, 4 bytes]
2025-02-08 08:46:37,252 - DEBUG - [protocol.py:745] - > PONG 17 49 48 d8 [binary, 4 bytes]
2025-02-08 08:46:57,212 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:46:57,214 - DEBUG - [protocol.py:745] - > PING 9c 2a ee 1a [binary, 4 bytes]
2025-02-08 08:46:57,223 - DEBUG - [protocol.py:599] - < PONG 9c 2a ee 1a [binary, 4 bytes]
2025-02-08 08:46:57,226 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:46:57,261 - DEBUG - [protocol.py:599] - < PING bf 67 ed 9d [binary, 4 bytes]
2025-02-08 08:46:57,263 - DEBUG - [protocol.py:745] - > PONG bf 67 ed 9d [binary, 4 bytes]
2025-02-08 08:47:17,226 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:47:17,228 - DEBUG - [protocol.py:745] - > PING a4 e3 18 c0 [binary, 4 bytes]
2025-02-08 08:47:17,234 - DEBUG - [protocol.py:599] - < PONG a4 e3 18 c0 [binary, 4 bytes]
2025-02-08 08:47:17,236 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:47:17,269 - DEBUG - [protocol.py:599] - < PING 14 49 a7 eb [binary, 4 bytes]
2025-02-08 08:47:17,270 - DEBUG - [protocol.py:745] - > PONG 14 49 a7 eb [binary, 4 bytes]
2025-02-08 08:47:37,230 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:47:37,232 - DEBUG - [protocol.py:745] - > PING 5b 9b 8d b0 [binary, 4 bytes]
2025-02-08 08:47:37,239 - DEBUG - [protocol.py:599] - < PONG 5b 9b 8d b0 [binary, 4 bytes]
2025-02-08 08:47:37,241 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:47:37,277 - DEBUG - [protocol.py:599] - < PING fd cc d5 69 [binary, 4 bytes]
2025-02-08 08:47:37,280 - DEBUG - [protocol.py:745] - > PONG fd cc d5 69 [binary, 4 bytes]
2025-02-08 08:47:57,226 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:47:57,228 - DEBUG - [protocol.py:745] - > PING 98 43 95 b5 [binary, 4 bytes]
2025-02-08 08:47:57,236 - DEBUG - [protocol.py:599] - < PONG 98 43 95 b5 [binary, 4 bytes]
2025-02-08 08:47:57,239 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:47:57,288 - DEBUG - [protocol.py:599] - < PING 0c 80 fa 10 [binary, 4 bytes]
2025-02-08 08:47:57,289 - DEBUG - [protocol.py:745] - > PONG 0c 80 fa 10 [binary, 4 bytes]
2025-02-08 08:48:17,235 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:48:17,238 - DEBUG - [protocol.py:745] - > PING c7 16 9c 36 [binary, 4 bytes]
2025-02-08 08:48:17,246 - DEBUG - [protocol.py:599] - < PONG c7 16 9c 36 [binary, 4 bytes]
2025-02-08 08:48:17,249 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:48:17,295 - DEBUG - [protocol.py:599] - < PING c7 68 98 a3 [binary, 4 bytes]
2025-02-08 08:48:17,297 - DEBUG - [protocol.py:745] - > PONG c7 68 98 a3 [binary, 4 bytes]
2025-02-08 08:48:37,267 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:48:37,269 - DEBUG - [protocol.py:745] - > PING 8f 71 45 4e [binary, 4 bytes]
2025-02-08 08:48:37,275 - DEBUG - [protocol.py:599] - < PONG 8f 71 45 4e [binary, 4 bytes]
2025-02-08 08:48:37,279 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:48:37,306 - DEBUG - [protocol.py:599] - < PING 0c 5d f6 4a [binary, 4 bytes]
2025-02-08 08:48:37,308 - DEBUG - [protocol.py:745] - > PONG 0c 5d f6 4a [binary, 4 bytes]
2025-02-08 08:48:57,270 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:48:57,273 - DEBUG - [protocol.py:745] - > PING 40 fe c6 61 [binary, 4 bytes]
2025-02-08 08:48:57,281 - DEBUG - [protocol.py:599] - < PONG 40 fe c6 61 [binary, 4 bytes]
2025-02-08 08:48:57,283 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:48:57,317 - DEBUG - [protocol.py:599] - < PING 20 f4 69 23 [binary, 4 bytes]
2025-02-08 08:48:57,320 - DEBUG - [protocol.py:745] - > PONG 20 f4 69 23 [binary, 4 bytes]
2025-02-08 08:49:17,289 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:49:17,291 - DEBUG - [protocol.py:745] - > PING 4e cd 23 03 [binary, 4 bytes]
2025-02-08 08:49:17,298 - DEBUG - [protocol.py:599] - < PONG 4e cd 23 03 [binary, 4 bytes]
2025-02-08 08:49:17,300 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:49:17,328 - DEBUG - [protocol.py:599] - < PING 76 b3 4e 72 [binary, 4 bytes]
2025-02-08 08:49:17,329 - DEBUG - [protocol.py:745] - > PONG 76 b3 4e 72 [binary, 4 bytes]
2025-02-08 08:49:37,318 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:49:37,319 - DEBUG - [protocol.py:745] - > PING '\x11\x16J@' [text, 4 bytes]
2025-02-08 08:49:37,326 - DEBUG - [protocol.py:599] - < PONG '\x11\x16J@' [text, 4 bytes]
2025-02-08 08:49:37,329 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:49:37,337 - DEBUG - [protocol.py:599] - < PING 60 6a 32 a3 [binary, 4 bytes]
2025-02-08 08:49:37,339 - DEBUG - [protocol.py:745] - > PONG 60 6a 32 a3 [binary, 4 bytes]
2025-02-08 08:49:57,344 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:49:57,345 - DEBUG - [protocol.py:745] - > PING 06 e1 a2 d1 [binary, 4 bytes]
2025-02-08 08:49:57,348 - DEBUG - [protocol.py:599] - < PING ab 6f b4 97 [binary, 4 bytes]
2025-02-08 08:49:57,350 - DEBUG - [protocol.py:745] - > PONG ab 6f b4 97 [binary, 4 bytes]
2025-02-08 08:49:57,353 - DEBUG - [protocol.py:599] - < PONG 06 e1 a2 d1 [binary, 4 bytes]
2025-02-08 08:49:57,355 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:50:10,761 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 08:50:10,763 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:50:10,765 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:50:10,766 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:50:10,834 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:50:10,835 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:50:10,836 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:50:10,837 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 08:50:10,838 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 08:50:10,839 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 08:50:11,083 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 08:50:11,084 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 08:50:11,084 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 08:50:11,085 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 08:50:11,085 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:50:11,086 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 08:50:11,396 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 08:50:11,396 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:50:11,614 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:50:11,615 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:50:11,615 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 08:50:11,616 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 08:50:11,617 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:50:11,617 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:50:11,848 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:50:11,849 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:50:11,849 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:50:12,120 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:50:12,121 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:50:12,121 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:50:12,354 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:50:12,354 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:50:12,355 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:50:12,571 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:50:12,572 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:50:12,572 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 08:50:12,572 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 08:50:12,573 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 08:50:12,780 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 08:50:12,781 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 08:50:12,781 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 08:50:12,782 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 08:50:12,782 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 08:50:12,782 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:50:12,783 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:50:12,783 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:50:12,823 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:50:12,823 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:50:12,823 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:50:12,825 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 08:50:12,825 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:50:12,826 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 08:50:12,826 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T13:50:12.825710",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 08:50:12,906 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 08:50:12,907 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 08:50:17,352 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:50:17,354 - DEBUG - [protocol.py:745] - > PING 3d da db 5f [binary, 4 bytes]
2025-02-08 08:50:17,363 - DEBUG - [protocol.py:599] - < PING a1 fc d7 ce [binary, 4 bytes]
2025-02-08 08:50:17,365 - DEBUG - [protocol.py:745] - > PONG a1 fc d7 ce [binary, 4 bytes]
2025-02-08 08:50:17,367 - DEBUG - [protocol.py:599] - < PONG 3d da db 5f [binary, 4 bytes]
2025-02-08 08:50:17,370 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:50:37,368 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:50:37,371 - DEBUG - [protocol.py:745] - > PING '\x7fm\x1eV' [text, 4 bytes]
2025-02-08 08:50:37,374 - DEBUG - [protocol.py:599] - < PING e2 c3 72 31 [binary, 4 bytes]
2025-02-08 08:50:37,375 - DEBUG - [protocol.py:745] - > PONG e2 c3 72 31 [binary, 4 bytes]
2025-02-08 08:50:37,378 - DEBUG - [protocol.py:599] - < PONG '\x7fm\x1eV' [text, 4 bytes]
2025-02-08 08:50:37,381 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:50:57,383 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:50:57,385 - DEBUG - [protocol.py:745] - > PING e0 fd 99 1a [binary, 4 bytes]
2025-02-08 08:50:57,388 - DEBUG - [protocol.py:599] - < PING 77 f3 b6 3b [binary, 4 bytes]
2025-02-08 08:50:57,389 - DEBUG - [protocol.py:745] - > PONG 77 f3 b6 3b [binary, 4 bytes]
2025-02-08 08:50:57,393 - DEBUG - [protocol.py:599] - < PONG e0 fd 99 1a [binary, 4 bytes]
2025-02-08 08:50:57,396 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:51:17,395 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:51:17,398 - DEBUG - [protocol.py:745] - > PING 1d 14 89 6d [binary, 4 bytes]
2025-02-08 08:51:17,401 - DEBUG - [protocol.py:599] - < PING fa 5b 74 8d [binary, 4 bytes]
2025-02-08 08:51:17,402 - DEBUG - [protocol.py:745] - > PONG fa 5b 74 8d [binary, 4 bytes]
2025-02-08 08:51:17,407 - DEBUG - [protocol.py:599] - < PONG 1d 14 89 6d [binary, 4 bytes]
2025-02-08 08:51:17,409 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:51:37,410 - DEBUG - [protocol.py:599] - < PING 9e f5 ac 10 [binary, 4 bytes]
2025-02-08 08:51:37,412 - DEBUG - [protocol.py:745] - > PONG 9e f5 ac 10 [binary, 4 bytes]
2025-02-08 08:51:37,414 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:51:37,416 - DEBUG - [protocol.py:745] - > PING 5a 44 df 28 [binary, 4 bytes]
2025-02-08 08:51:37,425 - DEBUG - [protocol.py:599] - < PONG 5a 44 df 28 [binary, 4 bytes]
2025-02-08 08:51:37,428 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:51:57,419 - DEBUG - [protocol.py:599] - < PING 71 7f 32 8f [binary, 4 bytes]
2025-02-08 08:51:57,422 - DEBUG - [protocol.py:745] - > PONG 71 7f 32 8f [binary, 4 bytes]
2025-02-08 08:51:57,424 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:51:57,426 - DEBUG - [protocol.py:745] - > PING 72 d3 8f ae [binary, 4 bytes]
2025-02-08 08:51:57,435 - DEBUG - [protocol.py:599] - < PONG 72 d3 8f ae [binary, 4 bytes]
2025-02-08 08:51:57,439 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:52:17,427 - DEBUG - [protocol.py:599] - < PING '\x13[\x0b|' [text, 4 bytes]
2025-02-08 08:52:17,429 - DEBUG - [protocol.py:745] - > PONG '\x13[\x0b|' [text, 4 bytes]
2025-02-08 08:52:17,459 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:52:17,463 - DEBUG - [protocol.py:745] - > PING 43 8d 21 1d [binary, 4 bytes]
2025-02-08 08:52:17,471 - DEBUG - [protocol.py:599] - < PONG 43 8d 21 1d [binary, 4 bytes]
2025-02-08 08:52:17,472 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:52:37,435 - DEBUG - [protocol.py:599] - < PING a0 32 95 8d [binary, 4 bytes]
2025-02-08 08:52:37,438 - DEBUG - [protocol.py:745] - > PONG a0 32 95 8d [binary, 4 bytes]
2025-02-08 08:52:37,478 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:52:37,480 - DEBUG - [protocol.py:745] - > PING 8c 43 a5 23 [binary, 4 bytes]
2025-02-08 08:52:37,489 - DEBUG - [protocol.py:599] - < PONG 8c 43 a5 23 [binary, 4 bytes]
2025-02-08 08:52:37,492 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:52:57,447 - DEBUG - [protocol.py:599] - < PING 77 62 f8 e2 [binary, 4 bytes]
2025-02-08 08:52:57,449 - DEBUG - [protocol.py:745] - > PONG 77 62 f8 e2 [binary, 4 bytes]
2025-02-08 08:52:57,499 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:52:57,502 - DEBUG - [protocol.py:745] - > PING 87 1f 62 f8 [binary, 4 bytes]
2025-02-08 08:52:57,508 - DEBUG - [protocol.py:599] - < PONG 87 1f 62 f8 [binary, 4 bytes]
2025-02-08 08:52:57,509 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:53:17,459 - DEBUG - [protocol.py:599] - < PING a2 0f 4a a8 [binary, 4 bytes]
2025-02-08 08:53:17,461 - DEBUG - [protocol.py:745] - > PONG a2 0f 4a a8 [binary, 4 bytes]
2025-02-08 08:53:17,509 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:53:17,511 - DEBUG - [protocol.py:745] - > PING c5 16 95 35 [binary, 4 bytes]
2025-02-08 08:53:17,518 - DEBUG - [protocol.py:599] - < PONG c5 16 95 35 [binary, 4 bytes]
2025-02-08 08:53:17,520 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:53:37,470 - DEBUG - [protocol.py:599] - < PING '\x04KW^' [text, 4 bytes]
2025-02-08 08:53:37,472 - DEBUG - [protocol.py:745] - > PONG '\x04KW^' [text, 4 bytes]
2025-02-08 08:53:37,518 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:53:37,519 - DEBUG - [protocol.py:745] - > PING 18 e5 a2 d3 [binary, 4 bytes]
2025-02-08 08:53:37,529 - DEBUG - [protocol.py:599] - < PONG 18 e5 a2 d3 [binary, 4 bytes]
2025-02-08 08:53:37,531 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:53:57,480 - DEBUG - [protocol.py:599] - < PING 7e 64 39 82 [binary, 4 bytes]
2025-02-08 08:53:57,482 - DEBUG - [protocol.py:745] - > PONG 7e 64 39 82 [binary, 4 bytes]
2025-02-08 08:53:57,541 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:53:57,543 - DEBUG - [protocol.py:745] - > PING 59 a3 22 0d [binary, 4 bytes]
2025-02-08 08:53:57,551 - DEBUG - [protocol.py:599] - < PONG 59 a3 22 0d [binary, 4 bytes]
2025-02-08 08:53:57,553 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:54:17,491 - DEBUG - [protocol.py:599] - < PING 20 9a c4 6b [binary, 4 bytes]
2025-02-08 08:54:17,493 - DEBUG - [protocol.py:745] - > PONG 20 9a c4 6b [binary, 4 bytes]
2025-02-08 08:54:17,560 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:54:17,561 - DEBUG - [protocol.py:745] - > PING ')|!\x17' [text, 4 bytes]
2025-02-08 08:54:17,567 - DEBUG - [protocol.py:599] - < PONG ')|!\x17' [text, 4 bytes]
2025-02-08 08:54:17,570 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:54:37,502 - DEBUG - [protocol.py:599] - < PING a1 43 fc b4 [binary, 4 bytes]
2025-02-08 08:54:37,506 - DEBUG - [protocol.py:745] - > PONG a1 43 fc b4 [binary, 4 bytes]
2025-02-08 08:54:37,556 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:54:37,560 - DEBUG - [protocol.py:745] - > PING 91 70 12 77 [binary, 4 bytes]
2025-02-08 08:54:37,569 - DEBUG - [protocol.py:599] - < PONG 91 70 12 77 [binary, 4 bytes]
2025-02-08 08:54:37,573 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:54:57,514 - DEBUG - [protocol.py:599] - < PING 22 b7 4f 1b [binary, 4 bytes]
2025-02-08 08:54:57,516 - DEBUG - [protocol.py:745] - > PONG 22 b7 4f 1b [binary, 4 bytes]
2025-02-08 08:54:57,565 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:54:57,566 - DEBUG - [protocol.py:745] - > PING 4b 98 f8 ea [binary, 4 bytes]
2025-02-08 08:54:57,574 - DEBUG - [protocol.py:599] - < PONG 4b 98 f8 ea [binary, 4 bytes]
2025-02-08 08:54:57,576 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:55:14,042 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 08:55:14,046 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:55:14,048 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:55:14,049 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:55:14,099 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:55:14,100 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:55:14,100 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:55:14,102 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 08:55:14,102 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 08:55:14,103 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 08:55:14,403 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 08:55:14,403 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 08:55:14,404 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 08:55:14,404 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 08:55:14,404 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:55:14,405 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 08:55:14,644 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 08:55:14,645 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:55:14,881 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:55:14,883 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:55:14,884 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 08:55:14,885 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 08:55:14,887 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 08:55:14,888 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:55:15,193 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:55:15,194 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:55:15,194 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:55:15,408 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:55:15,408 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:55:15,409 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:55:15,636 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:55:15,636 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:55:15,637 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 08:55:15,850 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 08:55:15,851 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 08:55:15,852 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 08:55:15,852 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 08:55:15,852 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 08:55:16,129 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 08:55:16,129 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 08:55:16,130 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 08:55:16,131 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 08:55:16,132 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 08:55:16,132 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 08:55:16,132 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 08:55:16,132 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:55:16,170 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 08:55:16,170 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 08:55:16,171 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 08:55:16,172 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 08:55:16,173 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 08:55:16,173 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 08:55:16,174 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T13:55:16.172012",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 08:55:16,215 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 08:55:16,216 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 08:55:17,525 - DEBUG - [protocol.py:599] - < PING 70 b4 90 47 [binary, 4 bytes]
2025-02-08 08:55:17,527 - DEBUG - [protocol.py:745] - > PONG 70 b4 90 47 [binary, 4 bytes]
2025-02-08 08:55:17,579 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:55:17,582 - DEBUG - [protocol.py:745] - > PING 9b 85 ae d3 [binary, 4 bytes]
2025-02-08 08:55:17,590 - DEBUG - [protocol.py:599] - < PONG 9b 85 ae d3 [binary, 4 bytes]
2025-02-08 08:55:17,593 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:55:37,534 - DEBUG - [protocol.py:599] - < PING 2c 89 58 93 [binary, 4 bytes]
2025-02-08 08:55:37,537 - DEBUG - [protocol.py:745] - > PONG 2c 89 58 93 [binary, 4 bytes]
2025-02-08 08:55:37,594 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:55:37,599 - DEBUG - [protocol.py:745] - > PING 1b 31 69 de [binary, 4 bytes]
2025-02-08 08:55:37,605 - DEBUG - [protocol.py:599] - < PONG 1b 31 69 de [binary, 4 bytes]
2025-02-08 08:55:37,607 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:55:57,542 - DEBUG - [protocol.py:599] - < PING 16 c8 91 e4 [binary, 4 bytes]
2025-02-08 08:55:57,544 - DEBUG - [protocol.py:745] - > PONG 16 c8 91 e4 [binary, 4 bytes]
2025-02-08 08:55:57,614 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:55:57,615 - DEBUG - [protocol.py:745] - > PING 73 f6 bc 1d [binary, 4 bytes]
2025-02-08 08:55:57,622 - DEBUG - [protocol.py:599] - < PONG 73 f6 bc 1d [binary, 4 bytes]
2025-02-08 08:55:57,623 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:56:17,552 - DEBUG - [protocol.py:599] - < PING ad b9 7a 20 [binary, 4 bytes]
2025-02-08 08:56:17,554 - DEBUG - [protocol.py:745] - > PONG ad b9 7a 20 [binary, 4 bytes]
2025-02-08 08:56:17,619 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:56:17,622 - DEBUG - [protocol.py:745] - > PING 7b ea 6b 2a [binary, 4 bytes]
2025-02-08 08:56:17,629 - DEBUG - [protocol.py:599] - < PONG 7b ea 6b 2a [binary, 4 bytes]
2025-02-08 08:56:17,632 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:56:37,562 - DEBUG - [protocol.py:599] - < PING 8c 57 18 c2 [binary, 4 bytes]
2025-02-08 08:56:37,564 - DEBUG - [protocol.py:745] - > PONG 8c 57 18 c2 [binary, 4 bytes]
2025-02-08 08:56:37,628 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:56:37,629 - DEBUG - [protocol.py:745] - > PING 8f 13 26 11 [binary, 4 bytes]
2025-02-08 08:56:37,635 - DEBUG - [protocol.py:599] - < PONG 8f 13 26 11 [binary, 4 bytes]
2025-02-08 08:56:37,637 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:56:57,573 - DEBUG - [protocol.py:599] - < PING c1 84 4c 39 [binary, 4 bytes]
2025-02-08 08:56:57,575 - DEBUG - [protocol.py:745] - > PONG c1 84 4c 39 [binary, 4 bytes]
2025-02-08 08:56:57,649 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:56:57,650 - DEBUG - [protocol.py:745] - > PING 'l?\x7f8' [text, 4 bytes]
2025-02-08 08:56:57,659 - DEBUG - [protocol.py:599] - < PONG 'l?\x7f8' [text, 4 bytes]
2025-02-08 08:56:57,660 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:57:17,580 - DEBUG - [protocol.py:599] - < PING cf 3c 5f 5c [binary, 4 bytes]
2025-02-08 08:57:17,582 - DEBUG - [protocol.py:745] - > PONG cf 3c 5f 5c [binary, 4 bytes]
2025-02-08 08:57:17,654 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:57:17,656 - DEBUG - [protocol.py:745] - > PING d9 06 df 66 [binary, 4 bytes]
2025-02-08 08:57:17,663 - DEBUG - [protocol.py:599] - < PONG d9 06 df 66 [binary, 4 bytes]
2025-02-08 08:57:17,665 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:57:37,590 - DEBUG - [protocol.py:599] - < PING 85 c8 03 4e [binary, 4 bytes]
2025-02-08 08:57:37,592 - DEBUG - [protocol.py:745] - > PONG 85 c8 03 4e [binary, 4 bytes]
2025-02-08 08:57:37,660 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:57:37,663 - DEBUG - [protocol.py:745] - > PING 5a 3a 88 68 [binary, 4 bytes]
2025-02-08 08:57:37,672 - DEBUG - [protocol.py:599] - < PONG 5a 3a 88 68 [binary, 4 bytes]
2025-02-08 08:57:37,676 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:57:57,598 - DEBUG - [protocol.py:599] - < PING f6 f6 98 d9 [binary, 4 bytes]
2025-02-08 08:57:57,600 - DEBUG - [protocol.py:745] - > PONG f6 f6 98 d9 [binary, 4 bytes]
2025-02-08 08:57:57,670 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:57:57,672 - DEBUG - [protocol.py:745] - > PING e8 eb 10 b5 [binary, 4 bytes]
2025-02-08 08:57:57,680 - DEBUG - [protocol.py:599] - < PONG e8 eb 10 b5 [binary, 4 bytes]
2025-02-08 08:57:57,681 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:58:17,607 - DEBUG - [protocol.py:599] - < PING d7 f8 b2 01 [binary, 4 bytes]
2025-02-08 08:58:17,609 - DEBUG - [protocol.py:745] - > PONG d7 f8 b2 01 [binary, 4 bytes]
2025-02-08 08:58:17,679 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:58:17,682 - DEBUG - [protocol.py:745] - > PING 15 85 e1 62 [binary, 4 bytes]
2025-02-08 08:58:17,690 - DEBUG - [protocol.py:599] - < PONG 15 85 e1 62 [binary, 4 bytes]
2025-02-08 08:58:17,691 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:58:37,616 - DEBUG - [protocol.py:599] - < PING 3b 56 fe 69 [binary, 4 bytes]
2025-02-08 08:58:37,619 - DEBUG - [protocol.py:745] - > PONG 3b 56 fe 69 [binary, 4 bytes]
2025-02-08 08:58:37,694 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:58:37,698 - DEBUG - [protocol.py:745] - > PING c3 63 b3 24 [binary, 4 bytes]
2025-02-08 08:58:37,707 - DEBUG - [protocol.py:599] - < PONG c3 63 b3 24 [binary, 4 bytes]
2025-02-08 08:58:37,708 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:58:57,625 - DEBUG - [protocol.py:599] - < PING 3e a8 53 64 [binary, 4 bytes]
2025-02-08 08:58:57,627 - DEBUG - [protocol.py:745] - > PONG 3e a8 53 64 [binary, 4 bytes]
2025-02-08 08:58:57,707 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:58:57,709 - DEBUG - [protocol.py:745] - > PING 62 56 3f ac [binary, 4 bytes]
2025-02-08 08:58:57,718 - DEBUG - [protocol.py:599] - < PONG 62 56 3f ac [binary, 4 bytes]
2025-02-08 08:58:57,720 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:59:17,633 - DEBUG - [protocol.py:599] - < PING d8 e3 fc 21 [binary, 4 bytes]
2025-02-08 08:59:17,635 - DEBUG - [protocol.py:745] - > PONG d8 e3 fc 21 [binary, 4 bytes]
2025-02-08 08:59:17,720 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:59:17,721 - DEBUG - [protocol.py:745] - > PING 10 4b 9c be [binary, 4 bytes]
2025-02-08 08:59:17,728 - DEBUG - [protocol.py:599] - < PONG 10 4b 9c be [binary, 4 bytes]
2025-02-08 08:59:17,729 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:59:37,644 - DEBUG - [protocol.py:599] - < PING 3c 9c d6 af [binary, 4 bytes]
2025-02-08 08:59:37,646 - DEBUG - [protocol.py:745] - > PONG 3c 9c d6 af [binary, 4 bytes]
2025-02-08 08:59:37,720 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:59:37,721 - DEBUG - [protocol.py:745] - > PING 14 90 a1 19 [binary, 4 bytes]
2025-02-08 08:59:37,726 - DEBUG - [protocol.py:599] - < PONG 14 90 a1 19 [binary, 4 bytes]
2025-02-08 08:59:37,727 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 08:59:57,657 - DEBUG - [protocol.py:599] - < PING '|\ueea2' [text, 4 bytes]
2025-02-08 08:59:57,663 - DEBUG - [protocol.py:745] - > PONG '|\ueea2' [text, 4 bytes]
2025-02-08 08:59:57,719 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 08:59:57,722 - DEBUG - [protocol.py:745] - > PING b0 a7 1f 7b [binary, 4 bytes]
2025-02-08 08:59:57,730 - DEBUG - [protocol.py:599] - < PONG b0 a7 1f 7b [binary, 4 bytes]
2025-02-08 08:59:57,731 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:00:17,346 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:00:17,349 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:00:17,350 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:00:17,351 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:00:17,390 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:00:17,391 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:00:17,392 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:00:17,393 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:00:17,394 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:00:17,395 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:00:17,653 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:00:17,654 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:00:17,654 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:00:17,655 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:00:17,655 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:00:17,656 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:00:17,886 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:00:17,887 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:00:18,175 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:00:18,177 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:00:18,177 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:00:18,178 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:00:18,178 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:00:18,179 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:00:18,414 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:00:18,415 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:00:18,415 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:00:18,637 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:00:18,637 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:00:18,638 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:00:18,856 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:00:18,856 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:00:18,856 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:00:19,150 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:00:19,151 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:00:19,151 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:00:19,151 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:00:19,152 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:00:19,374 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:00:19,375 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:00:19,375 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:00:19,376 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:00:19,377 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:00:19,377 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:00:19,377 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:00:19,377 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:00:19,379 - DEBUG - [protocol.py:599] - < PING ca 82 24 a2 [binary, 4 bytes]
2025-02-08 09:00:19,379 - DEBUG - [protocol.py:745] - > PONG ca 82 24 a2 [binary, 4 bytes]
2025-02-08 09:00:19,380 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:00:19,380 - DEBUG - [protocol.py:745] - > PING 8f 13 71 36 [binary, 4 bytes]
2025-02-08 09:00:19,385 - DEBUG - [protocol.py:599] - < PONG 8f 13 71 36 [binary, 4 bytes]
2025-02-08 09:00:19,386 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:00:19,410 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:00:19,410 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:00:19,411 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:00:19,413 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:00:19,413 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:00:19,413 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:00:19,414 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:00:19.411970",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:00:19,458 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:00:19,459 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:00:39,385 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:00:39,387 - DEBUG - [protocol.py:745] - > PING b6 af 21 8a [binary, 4 bytes]
2025-02-08 09:00:39,390 - DEBUG - [protocol.py:599] - < PING 1c 44 e5 42 [binary, 4 bytes]
2025-02-08 09:00:39,392 - DEBUG - [protocol.py:745] - > PONG 1c 44 e5 42 [binary, 4 bytes]
2025-02-08 09:00:39,395 - DEBUG - [protocol.py:599] - < PONG b6 af 21 8a [binary, 4 bytes]
2025-02-08 09:00:39,398 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:00:59,388 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:00:59,390 - DEBUG - [protocol.py:745] - > PING 10 ea 73 e3 [binary, 4 bytes]
2025-02-08 09:00:59,397 - DEBUG - [protocol.py:599] - < PONG 10 ea 73 e3 [binary, 4 bytes]
2025-02-08 09:00:59,400 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:00:59,403 - DEBUG - [protocol.py:599] - < PING 84 36 e5 8c [binary, 4 bytes]
2025-02-08 09:00:59,407 - DEBUG - [protocol.py:745] - > PONG 84 36 e5 8c [binary, 4 bytes]
2025-02-08 09:01:19,397 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:01:19,399 - DEBUG - [protocol.py:745] - > PING 98 e5 e5 55 [binary, 4 bytes]
2025-02-08 09:01:19,409 - DEBUG - [protocol.py:599] - < PONG 98 e5 e5 55 [binary, 4 bytes]
2025-02-08 09:01:19,412 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:01:19,421 - DEBUG - [protocol.py:599] - < PING '\t\x10KI' [text, 4 bytes]
2025-02-08 09:01:19,423 - DEBUG - [protocol.py:745] - > PONG '\t\x10KI' [text, 4 bytes]
2025-02-08 09:01:39,403 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:01:39,405 - DEBUG - [protocol.py:745] - > PING 65 a2 bf a2 [binary, 4 bytes]
2025-02-08 09:01:39,413 - DEBUG - [protocol.py:599] - < PONG 65 a2 bf a2 [binary, 4 bytes]
2025-02-08 09:01:39,415 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:01:39,431 - DEBUG - [protocol.py:599] - < PING 82 16 78 91 [binary, 4 bytes]
2025-02-08 09:01:39,434 - DEBUG - [protocol.py:745] - > PONG 82 16 78 91 [binary, 4 bytes]
2025-02-08 09:01:59,413 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:01:59,415 - DEBUG - [protocol.py:745] - > PING bd d2 5f a8 [binary, 4 bytes]
2025-02-08 09:01:59,423 - DEBUG - [protocol.py:599] - < PONG bd d2 5f a8 [binary, 4 bytes]
2025-02-08 09:01:59,425 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:01:59,441 - DEBUG - [protocol.py:599] - < PING f8 98 37 66 [binary, 4 bytes]
2025-02-08 09:01:59,443 - DEBUG - [protocol.py:745] - > PONG f8 98 37 66 [binary, 4 bytes]
2025-02-08 09:02:19,417 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:02:19,419 - DEBUG - [protocol.py:745] - > PING ad 9c ad 31 [binary, 4 bytes]
2025-02-08 09:02:19,427 - DEBUG - [protocol.py:599] - < PONG ad 9c ad 31 [binary, 4 bytes]
2025-02-08 09:02:19,429 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:02:19,453 - DEBUG - [protocol.py:599] - < PING f9 76 c5 7f [binary, 4 bytes]
2025-02-08 09:02:19,458 - DEBUG - [protocol.py:745] - > PONG f9 76 c5 7f [binary, 4 bytes]
2025-02-08 09:02:39,426 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:02:39,428 - DEBUG - [protocol.py:745] - > PING ce 43 b7 42 [binary, 4 bytes]
2025-02-08 09:02:39,437 - DEBUG - [protocol.py:599] - < PONG ce 43 b7 42 [binary, 4 bytes]
2025-02-08 09:02:39,439 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:02:39,468 - DEBUG - [protocol.py:599] - < PING 6d ae f7 ff [binary, 4 bytes]
2025-02-08 09:02:39,469 - DEBUG - [protocol.py:745] - > PONG 6d ae f7 ff [binary, 4 bytes]
2025-02-08 09:02:59,453 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:02:59,455 - DEBUG - [protocol.py:745] - > PING 63 d3 a0 b4 [binary, 4 bytes]
2025-02-08 09:02:59,461 - DEBUG - [protocol.py:599] - < PONG 63 d3 a0 b4 [binary, 4 bytes]
2025-02-08 09:02:59,464 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:02:59,480 - DEBUG - [protocol.py:599] - < PING c0 23 82 88 [binary, 4 bytes]
2025-02-08 09:02:59,482 - DEBUG - [protocol.py:745] - > PONG c0 23 82 88 [binary, 4 bytes]
2025-02-08 09:03:19,467 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:03:19,470 - DEBUG - [protocol.py:745] - > PING b2 4d 4f a3 [binary, 4 bytes]
2025-02-08 09:03:19,476 - DEBUG - [protocol.py:599] - < PONG b2 4d 4f a3 [binary, 4 bytes]
2025-02-08 09:03:19,479 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:03:19,489 - DEBUG - [protocol.py:599] - < PING bb ec eb 98 [binary, 4 bytes]
2025-02-08 09:03:19,491 - DEBUG - [protocol.py:745] - > PONG bb ec eb 98 [binary, 4 bytes]
2025-02-08 09:03:39,476 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:03:39,479 - DEBUG - [protocol.py:745] - > PING af 79 2a 2b [binary, 4 bytes]
2025-02-08 09:03:39,487 - DEBUG - [protocol.py:599] - < PONG af 79 2a 2b [binary, 4 bytes]
2025-02-08 09:03:39,489 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:03:39,501 - DEBUG - [protocol.py:599] - < PING 6d 4b 7e 98 [binary, 4 bytes]
2025-02-08 09:03:39,503 - DEBUG - [protocol.py:745] - > PONG 6d 4b 7e 98 [binary, 4 bytes]
2025-02-08 09:03:59,487 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:03:59,489 - DEBUG - [protocol.py:745] - > PING 64 df c6 85 [binary, 4 bytes]
2025-02-08 09:03:59,497 - DEBUG - [protocol.py:599] - < PONG 64 df c6 85 [binary, 4 bytes]
2025-02-08 09:03:59,499 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:03:59,512 - DEBUG - [protocol.py:599] - < PING '/\x1b\x127' [text, 4 bytes]
2025-02-08 09:03:59,516 - DEBUG - [protocol.py:745] - > PONG '/\x1b\x127' [text, 4 bytes]
2025-02-08 09:04:19,494 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:04:19,497 - DEBUG - [protocol.py:745] - > PING 51 14 60 df [binary, 4 bytes]
2025-02-08 09:04:19,505 - DEBUG - [protocol.py:599] - < PONG 51 14 60 df [binary, 4 bytes]
2025-02-08 09:04:19,508 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:04:19,528 - DEBUG - [protocol.py:599] - < PING 38 0d 93 0c [binary, 4 bytes]
2025-02-08 09:04:19,530 - DEBUG - [protocol.py:745] - > PONG 38 0d 93 0c [binary, 4 bytes]
2025-02-08 09:04:39,512 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:04:39,514 - DEBUG - [protocol.py:745] - > PING b9 66 07 db [binary, 4 bytes]
2025-02-08 09:04:39,522 - DEBUG - [protocol.py:599] - < PONG b9 66 07 db [binary, 4 bytes]
2025-02-08 09:04:39,524 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:04:39,539 - DEBUG - [protocol.py:599] - < PING 55 f0 7d f1 [binary, 4 bytes]
2025-02-08 09:04:39,544 - DEBUG - [protocol.py:745] - > PONG 55 f0 7d f1 [binary, 4 bytes]
2025-02-08 09:04:59,524 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:04:59,525 - DEBUG - [protocol.py:745] - > PING 1b 6f 85 5e [binary, 4 bytes]
2025-02-08 09:04:59,533 - DEBUG - [protocol.py:599] - < PONG 1b 6f 85 5e [binary, 4 bytes]
2025-02-08 09:04:59,535 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:04:59,552 - DEBUG - [protocol.py:599] - < PING 9d e0 c5 a1 [binary, 4 bytes]
2025-02-08 09:04:59,554 - DEBUG - [protocol.py:745] - > PONG 9d e0 c5 a1 [binary, 4 bytes]
2025-02-08 09:05:20,530 - DEBUG - [protocol.py:599] - < PING 78 e9 65 44 [binary, 4 bytes]
2025-02-08 09:05:20,531 - DEBUG - [protocol.py:745] - > PONG 78 e9 65 44 [binary, 4 bytes]
2025-02-08 09:05:20,533 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:05:20,535 - DEBUG - [protocol.py:745] - > PING 20 0c 5b d3 [binary, 4 bytes]
2025-02-08 09:05:20,542 - DEBUG - [protocol.py:599] - < PONG 20 0c 5b d3 [binary, 4 bytes]
2025-02-08 09:05:20,544 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:05:20,574 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:05:20,575 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:05:20,577 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:05:20,577 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:05:20,611 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:05:20,612 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:05:20,612 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:05:20,613 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:05:20,614 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:05:20,615 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:05:20,859 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:05:20,860 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:05:20,860 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:05:20,860 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:05:20,861 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:05:20,861 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:05:21,161 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:05:21,162 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:05:21,385 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:05:21,386 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:05:21,386 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:05:21,386 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:05:21,387 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:05:21,387 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:05:21,609 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:05:21,609 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:05:21,610 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:05:21,822 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:05:21,823 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:05:21,823 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:05:22,105 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:05:22,106 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:05:22,106 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:05:22,319 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:05:22,319 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:05:22,320 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:05:22,320 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:05:22,320 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:05:22,545 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:05:22,546 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:05:22,546 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:05:22,547 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:05:22,548 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:05:22,548 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:05:22,548 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:05:22,549 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:05:22,583 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:05:22,583 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:05:22,584 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:05:22,585 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:05:22,585 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:05:22,586 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:05:22,586 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:05:22.585718",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:05:22,618 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:05:22,619 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:05:40,538 - DEBUG - [protocol.py:599] - < PING f3 66 43 c7 [binary, 4 bytes]
2025-02-08 09:05:40,540 - DEBUG - [protocol.py:745] - > PONG f3 66 43 c7 [binary, 4 bytes]
2025-02-08 09:05:40,542 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:05:40,543 - DEBUG - [protocol.py:745] - > PING 41 57 ca c6 [binary, 4 bytes]
2025-02-08 09:05:40,551 - DEBUG - [protocol.py:599] - < PONG 41 57 ca c6 [binary, 4 bytes]
2025-02-08 09:05:40,554 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:06:00,548 - DEBUG - [protocol.py:599] - < PING 9e 55 1c 3d [binary, 4 bytes]
2025-02-08 09:06:00,550 - DEBUG - [protocol.py:745] - > PONG 9e 55 1c 3d [binary, 4 bytes]
2025-02-08 09:06:00,552 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:06:00,554 - DEBUG - [protocol.py:745] - > PING 92 d6 61 50 [binary, 4 bytes]
2025-02-08 09:06:00,562 - DEBUG - [protocol.py:599] - < PONG 92 d6 61 50 [binary, 4 bytes]
2025-02-08 09:06:00,564 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:06:20,558 - DEBUG - [protocol.py:599] - < PING 65 15 68 ad [binary, 4 bytes]
2025-02-08 09:06:20,560 - DEBUG - [protocol.py:745] - > PONG 65 15 68 ad [binary, 4 bytes]
2025-02-08 09:06:20,563 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:06:20,564 - DEBUG - [protocol.py:745] - > PING 66 06 8e 54 [binary, 4 bytes]
2025-02-08 09:06:20,571 - DEBUG - [protocol.py:599] - < PONG 66 06 8e 54 [binary, 4 bytes]
2025-02-08 09:06:20,573 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:06:40,563 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:06:40,565 - DEBUG - [protocol.py:745] - > PING 94 18 61 c7 [binary, 4 bytes]
2025-02-08 09:06:40,567 - DEBUG - [protocol.py:599] - < PING fd 9a 2f a2 [binary, 4 bytes]
2025-02-08 09:06:40,569 - DEBUG - [protocol.py:745] - > PONG fd 9a 2f a2 [binary, 4 bytes]
2025-02-08 09:06:40,573 - DEBUG - [protocol.py:599] - < PONG 94 18 61 c7 [binary, 4 bytes]
2025-02-08 09:06:40,575 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:07:00,576 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:07:00,578 - DEBUG - [protocol.py:745] - > PING 3a b9 17 50 [binary, 4 bytes]
2025-02-08 09:07:00,581 - DEBUG - [protocol.py:599] - < PING 5d 84 38 3c [binary, 4 bytes]
2025-02-08 09:07:00,583 - DEBUG - [protocol.py:745] - > PONG 5d 84 38 3c [binary, 4 bytes]
2025-02-08 09:07:00,588 - DEBUG - [protocol.py:599] - < PONG 3a b9 17 50 [binary, 4 bytes]
2025-02-08 09:07:00,590 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:07:20,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:07:20,594 - DEBUG - [protocol.py:745] - > PING d5 19 14 ca [binary, 4 bytes]
2025-02-08 09:07:20,596 - DEBUG - [protocol.py:599] - < PING 7a b5 db 2c [binary, 4 bytes]
2025-02-08 09:07:20,599 - DEBUG - [protocol.py:745] - > PONG 7a b5 db 2c [binary, 4 bytes]
2025-02-08 09:07:20,602 - DEBUG - [protocol.py:599] - < PONG d5 19 14 ca [binary, 4 bytes]
2025-02-08 09:07:20,604 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:07:40,595 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:07:40,597 - DEBUG - [protocol.py:745] - > PING 4b ac d6 30 [binary, 4 bytes]
2025-02-08 09:07:40,602 - DEBUG - [protocol.py:599] - < PONG 4b ac d6 30 [binary, 4 bytes]
2025-02-08 09:07:40,604 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:07:40,608 - DEBUG - [protocol.py:599] - < PING 56 70 9e f0 [binary, 4 bytes]
2025-02-08 09:07:40,611 - DEBUG - [protocol.py:745] - > PONG 56 70 9e f0 [binary, 4 bytes]
2025-02-08 09:08:00,601 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:08:00,604 - DEBUG - [protocol.py:745] - > PING c2 c0 59 3f [binary, 4 bytes]
2025-02-08 09:08:00,613 - DEBUG - [protocol.py:599] - < PONG c2 c0 59 3f [binary, 4 bytes]
2025-02-08 09:08:00,615 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:08:00,621 - DEBUG - [protocol.py:599] - < PING e2 e3 9a 8b [binary, 4 bytes]
2025-02-08 09:08:00,624 - DEBUG - [protocol.py:745] - > PONG e2 e3 9a 8b [binary, 4 bytes]
2025-02-08 09:08:20,613 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:08:20,615 - DEBUG - [protocol.py:745] - > PING b9 d7 06 96 [binary, 4 bytes]
2025-02-08 09:08:20,623 - DEBUG - [protocol.py:599] - < PONG b9 d7 06 96 [binary, 4 bytes]
2025-02-08 09:08:20,625 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:08:20,630 - DEBUG - [protocol.py:599] - < PING 17 37 de 33 [binary, 4 bytes]
2025-02-08 09:08:20,632 - DEBUG - [protocol.py:745] - > PONG 17 37 de 33 [binary, 4 bytes]
2025-02-08 09:08:40,633 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:08:40,635 - DEBUG - [protocol.py:745] - > PING 2b dc af d1 [binary, 4 bytes]
2025-02-08 09:08:40,643 - DEBUG - [protocol.py:599] - < PONG 2b dc af d1 [binary, 4 bytes]
2025-02-08 09:08:40,645 - DEBUG - [protocol.py:599] - < PING ec 21 d2 93 [binary, 4 bytes]
2025-02-08 09:08:40,647 - DEBUG - [protocol.py:745] - > PONG ec 21 d2 93 [binary, 4 bytes]
2025-02-08 09:08:40,653 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:09:00,649 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:09:00,651 - DEBUG - [protocol.py:745] - > PING e0 33 20 d6 [binary, 4 bytes]
2025-02-08 09:09:00,655 - DEBUG - [protocol.py:599] - < PING 80 94 df 4b [binary, 4 bytes]
2025-02-08 09:09:00,657 - DEBUG - [protocol.py:745] - > PONG 80 94 df 4b [binary, 4 bytes]
2025-02-08 09:09:00,659 - DEBUG - [protocol.py:599] - < PONG e0 33 20 d6 [binary, 4 bytes]
2025-02-08 09:09:00,661 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:09:20,657 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:09:20,658 - DEBUG - [protocol.py:745] - > PING a4 51 1a 3b [binary, 4 bytes]
2025-02-08 09:09:20,663 - DEBUG - [protocol.py:599] - < PING af 54 2f 2b [binary, 4 bytes]
2025-02-08 09:09:20,665 - DEBUG - [protocol.py:745] - > PONG af 54 2f 2b [binary, 4 bytes]
2025-02-08 09:09:20,669 - DEBUG - [protocol.py:599] - < PONG a4 51 1a 3b [binary, 4 bytes]
2025-02-08 09:09:20,672 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:09:40,666 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:09:40,667 - DEBUG - [protocol.py:745] - > PING 92 9d ae ca [binary, 4 bytes]
2025-02-08 09:09:40,674 - DEBUG - [protocol.py:599] - < PING 5a 92 26 09 [binary, 4 bytes]
2025-02-08 09:09:40,675 - DEBUG - [protocol.py:745] - > PONG 5a 92 26 09 [binary, 4 bytes]
2025-02-08 09:09:40,680 - DEBUG - [protocol.py:599] - < PONG 92 9d ae ca [binary, 4 bytes]
2025-02-08 09:09:40,686 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:10:00,677 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:10:00,679 - DEBUG - [protocol.py:745] - > PING f0 6a 1a 4c [binary, 4 bytes]
2025-02-08 09:10:00,683 - DEBUG - [protocol.py:599] - < PING 7d 02 69 a9 [binary, 4 bytes]
2025-02-08 09:10:00,685 - DEBUG - [protocol.py:745] - > PONG 7d 02 69 a9 [binary, 4 bytes]
2025-02-08 09:10:00,689 - DEBUG - [protocol.py:599] - < PONG f0 6a 1a 4c [binary, 4 bytes]
2025-02-08 09:10:00,691 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:10:20,685 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:10:20,687 - DEBUG - [protocol.py:745] - > PING 98 aa 0f 74 [binary, 4 bytes]
2025-02-08 09:10:20,693 - DEBUG - [protocol.py:599] - < PING 33 fc c8 b5 [binary, 4 bytes]
2025-02-08 09:10:20,695 - DEBUG - [protocol.py:745] - > PONG 33 fc c8 b5 [binary, 4 bytes]
2025-02-08 09:10:20,698 - DEBUG - [protocol.py:599] - < PONG 98 aa 0f 74 [binary, 4 bytes]
2025-02-08 09:10:20,702 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:10:23,762 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:10:23,764 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:10:23,765 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:10:23,767 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:10:23,807 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:10:23,807 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:10:23,808 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:10:23,809 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:10:23,810 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:10:23,810 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:10:24,106 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:10:24,108 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:10:24,108 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:10:24,109 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:10:24,109 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:10:24,109 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:10:24,344 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:10:24,345 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:10:24,574 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:10:24,575 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:10:24,575 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:10:24,576 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:10:24,576 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:10:24,576 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:10:24,794 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:10:24,794 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:10:24,795 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:10:25,095 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:10:25,095 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:10:25,095 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:10:25,307 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:10:25,307 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:10:25,308 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:10:25,534 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:10:25,534 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:10:25,535 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:10:25,535 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:10:25,536 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:10:25,805 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:10:25,806 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:10:25,806 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:10:25,807 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:10:25,807 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:10:25,808 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:10:25,808 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:10:25,808 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:10:25,843 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:10:25,844 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:10:25,844 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:10:25,845 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:10:25,846 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:10:25,846 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:10:25,847 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:10:25.845314",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:10:25,888 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:10:25,889 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:10:40,687 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:10:40,689 - DEBUG - [protocol.py:745] - > PING 18 22 f1 38 [binary, 4 bytes]
2025-02-08 09:10:40,698 - DEBUG - [protocol.py:599] - < PONG 18 22 f1 38 [binary, 4 bytes]
2025-02-08 09:10:40,700 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:10:40,705 - DEBUG - [protocol.py:599] - < PING d5 fe 11 2e [binary, 4 bytes]
2025-02-08 09:10:40,708 - DEBUG - [protocol.py:745] - > PONG d5 fe 11 2e [binary, 4 bytes]
2025-02-08 09:11:00,687 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:11:00,690 - DEBUG - [protocol.py:745] - > PING 23 49 95 a5 [binary, 4 bytes]
2025-02-08 09:11:00,697 - DEBUG - [protocol.py:599] - < PONG 23 49 95 a5 [binary, 4 bytes]
2025-02-08 09:11:00,700 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:11:00,718 - DEBUG - [protocol.py:599] - < PING '`Śd' [text, 4 bytes]
2025-02-08 09:11:00,719 - DEBUG - [protocol.py:745] - > PONG '`Śd' [text, 4 bytes]
2025-02-08 09:11:20,695 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:11:20,697 - DEBUG - [protocol.py:745] - > PING c9 5b a6 5d [binary, 4 bytes]
2025-02-08 09:11:20,703 - DEBUG - [protocol.py:599] - < PONG c9 5b a6 5d [binary, 4 bytes]
2025-02-08 09:11:20,707 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:11:20,725 - DEBUG - [protocol.py:599] - < PING ea 9c 31 b5 [binary, 4 bytes]
2025-02-08 09:11:20,727 - DEBUG - [protocol.py:745] - > PONG ea 9c 31 b5 [binary, 4 bytes]
2025-02-08 09:11:40,722 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:11:40,724 - DEBUG - [protocol.py:745] - > PING '%֢\x03' [text, 4 bytes]
2025-02-08 09:11:40,733 - DEBUG - [protocol.py:599] - < PONG '%֢\x03' [text, 4 bytes]
2025-02-08 09:11:40,735 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:11:40,737 - DEBUG - [protocol.py:599] - < PING ea 25 d7 cf [binary, 4 bytes]
2025-02-08 09:11:40,740 - DEBUG - [protocol.py:745] - > PONG ea 25 d7 cf [binary, 4 bytes]
2025-02-08 09:12:00,741 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:12:00,743 - DEBUG - [protocol.py:745] - > PING 47 fa 19 30 [binary, 4 bytes]
2025-02-08 09:12:00,749 - DEBUG - [protocol.py:599] - < PONG 47 fa 19 30 [binary, 4 bytes]
2025-02-08 09:12:00,751 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:12:00,753 - DEBUG - [protocol.py:599] - < PING 8f 2f 63 fd [binary, 4 bytes]
2025-02-08 09:12:00,756 - DEBUG - [protocol.py:745] - > PONG 8f 2f 63 fd [binary, 4 bytes]
2025-02-08 09:12:20,751 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:12:20,753 - DEBUG - [protocol.py:745] - > PING 1a 89 7b d6 [binary, 4 bytes]
2025-02-08 09:12:20,760 - DEBUG - [protocol.py:599] - < PONG 1a 89 7b d6 [binary, 4 bytes]
2025-02-08 09:12:20,762 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:12:20,765 - DEBUG - [protocol.py:599] - < PING 'k\rvF' [text, 4 bytes]
2025-02-08 09:12:20,768 - DEBUG - [protocol.py:745] - > PONG 'k\rvF' [text, 4 bytes]
2025-02-08 09:12:40,750 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:12:40,752 - DEBUG - [protocol.py:745] - > PING dc 6d 40 7d [binary, 4 bytes]
2025-02-08 09:12:40,759 - DEBUG - [protocol.py:599] - < PONG dc 6d 40 7d [binary, 4 bytes]
2025-02-08 09:12:40,761 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:12:40,778 - DEBUG - [protocol.py:599] - < PING fa d7 3f f2 [binary, 4 bytes]
2025-02-08 09:12:40,781 - DEBUG - [protocol.py:745] - > PONG fa d7 3f f2 [binary, 4 bytes]
2025-02-08 09:13:00,768 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:13:00,770 - DEBUG - [protocol.py:745] - > PING b6 38 eb 95 [binary, 4 bytes]
2025-02-08 09:13:00,779 - DEBUG - [protocol.py:599] - < PONG b6 38 eb 95 [binary, 4 bytes]
2025-02-08 09:13:00,781 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:13:00,791 - DEBUG - [protocol.py:599] - < PING 'Y[=4' [text, 4 bytes]
2025-02-08 09:13:00,792 - DEBUG - [protocol.py:745] - > PONG 'Y[=4' [text, 4 bytes]
2025-02-08 09:13:20,783 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:13:20,789 - DEBUG - [protocol.py:745] - > PING '#F"_' [text, 4 bytes]
2025-02-08 09:13:20,797 - DEBUG - [protocol.py:599] - < PING 42 ca cc 4d [binary, 4 bytes]
2025-02-08 09:13:20,799 - DEBUG - [protocol.py:745] - > PONG 42 ca cc 4d [binary, 4 bytes]
2025-02-08 09:13:20,803 - DEBUG - [protocol.py:599] - < PONG '#F"_' [text, 4 bytes]
2025-02-08 09:13:20,807 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:13:40,801 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:13:40,803 - DEBUG - [protocol.py:745] - > PING 7a 81 77 73 [binary, 4 bytes]
2025-02-08 09:13:40,808 - DEBUG - [protocol.py:599] - < PING f4 a7 0b b9 [binary, 4 bytes]
2025-02-08 09:13:40,809 - DEBUG - [protocol.py:745] - > PONG f4 a7 0b b9 [binary, 4 bytes]
2025-02-08 09:13:40,813 - DEBUG - [protocol.py:599] - < PONG 7a 81 77 73 [binary, 4 bytes]
2025-02-08 09:13:40,815 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:14:00,819 - DEBUG - [protocol.py:599] - < PING ff c0 2b 5a [binary, 4 bytes]
2025-02-08 09:14:00,821 - DEBUG - [protocol.py:745] - > PONG ff c0 2b 5a [binary, 4 bytes]
2025-02-08 09:14:00,823 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:14:00,825 - DEBUG - [protocol.py:745] - > PING a9 dd c4 d2 [binary, 4 bytes]
2025-02-08 09:14:00,835 - DEBUG - [protocol.py:599] - < PONG a9 dd c4 d2 [binary, 4 bytes]
2025-02-08 09:14:00,840 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:14:20,827 - DEBUG - [protocol.py:599] - < PING 80 8b 64 1b [binary, 4 bytes]
2025-02-08 09:14:20,830 - DEBUG - [protocol.py:745] - > PONG 80 8b 64 1b [binary, 4 bytes]
2025-02-08 09:14:20,832 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:14:20,834 - DEBUG - [protocol.py:745] - > PING 57 64 8b 9d [binary, 4 bytes]
2025-02-08 09:14:20,839 - DEBUG - [protocol.py:599] - < PONG 57 64 8b 9d [binary, 4 bytes]
2025-02-08 09:14:20,842 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:14:40,836 - DEBUG - [protocol.py:599] - < PING 'Ʋ70' [text, 4 bytes]
2025-02-08 09:14:40,838 - DEBUG - [protocol.py:745] - > PONG 'Ʋ70' [text, 4 bytes]
2025-02-08 09:14:40,840 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:14:40,842 - DEBUG - [protocol.py:745] - > PING 26 63 28 e9 [binary, 4 bytes]
2025-02-08 09:14:40,850 - DEBUG - [protocol.py:599] - < PONG 26 63 28 e9 [binary, 4 bytes]
2025-02-08 09:14:40,853 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:15:00,843 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:15:00,845 - DEBUG - [protocol.py:745] - > PING db 8f 9a 30 [binary, 4 bytes]
2025-02-08 09:15:00,847 - DEBUG - [protocol.py:599] - < PING 'BK:p' [text, 4 bytes]
2025-02-08 09:15:00,849 - DEBUG - [protocol.py:745] - > PONG 'BK:p' [text, 4 bytes]
2025-02-08 09:15:00,853 - DEBUG - [protocol.py:599] - < PONG db 8f 9a 30 [binary, 4 bytes]
2025-02-08 09:15:00,855 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:15:20,856 - DEBUG - [protocol.py:599] - < PING 7c 69 23 c8 [binary, 4 bytes]
2025-02-08 09:15:20,858 - DEBUG - [protocol.py:745] - > PONG 7c 69 23 c8 [binary, 4 bytes]
2025-02-08 09:15:20,860 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:15:20,862 - DEBUG - [protocol.py:745] - > PING 'asm\x0e' [text, 4 bytes]
2025-02-08 09:15:20,870 - DEBUG - [protocol.py:599] - < PONG 'asm\x0e' [text, 4 bytes]
2025-02-08 09:15:20,871 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:15:26,994 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:15:26,997 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:15:26,998 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:15:26,999 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:15:27,040 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:15:27,041 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:15:27,041 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:15:27,043 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:15:27,043 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:15:27,044 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:15:27,282 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:15:27,282 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:15:27,283 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:15:27,283 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:15:27,284 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:15:27,284 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:15:27,509 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:15:27,509 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:15:27,725 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:15:27,725 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:15:27,726 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:15:27,726 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:15:27,726 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:15:27,727 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:15:28,001 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:15:28,002 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:15:28,002 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:15:28,217 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:15:28,217 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:15:28,217 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:15:28,436 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:15:28,436 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:15:28,438 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:15:28,707 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:15:28,708 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:15:28,708 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:15:28,709 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:15:28,709 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:15:28,926 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:15:28,926 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:15:28,927 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:15:28,927 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:15:28,928 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:15:28,928 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:15:28,928 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:15:28,928 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:15:28,962 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:15:28,962 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:15:28,963 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:15:28,964 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:15:28,965 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:15:28,965 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:15:28,966 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:15:28.964485",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:15:28,994 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:15:28,994 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:15:40,861 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:15:40,863 - DEBUG - [protocol.py:745] - > PING 6c 65 73 f6 [binary, 4 bytes]
2025-02-08 09:15:40,868 - DEBUG - [protocol.py:599] - < PING a1 76 c9 32 [binary, 4 bytes]
2025-02-08 09:15:40,869 - DEBUG - [protocol.py:745] - > PONG a1 76 c9 32 [binary, 4 bytes]
2025-02-08 09:15:40,874 - DEBUG - [protocol.py:599] - < PONG 6c 65 73 f6 [binary, 4 bytes]
2025-02-08 09:15:40,876 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:16:00,878 - DEBUG - [protocol.py:599] - < PING a5 55 aa 4a [binary, 4 bytes]
2025-02-08 09:16:00,880 - DEBUG - [protocol.py:745] - > PONG a5 55 aa 4a [binary, 4 bytes]
2025-02-08 09:16:00,881 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:16:00,882 - DEBUG - [protocol.py:745] - > PING ec 1a 29 e8 [binary, 4 bytes]
2025-02-08 09:16:00,887 - DEBUG - [protocol.py:599] - < PONG ec 1a 29 e8 [binary, 4 bytes]
2025-02-08 09:16:00,889 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:16:20,887 - DEBUG - [protocol.py:599] - < PING dc ae 6d e8 [binary, 4 bytes]
2025-02-08 09:16:20,889 - DEBUG - [protocol.py:745] - > PONG dc ae 6d e8 [binary, 4 bytes]
2025-02-08 09:16:20,890 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:16:20,891 - DEBUG - [protocol.py:745] - > PING 7f c4 56 ae [binary, 4 bytes]
2025-02-08 09:16:20,897 - DEBUG - [protocol.py:599] - < PONG 7f c4 56 ae [binary, 4 bytes]
2025-02-08 09:16:20,898 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:16:40,887 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:16:40,890 - DEBUG - [protocol.py:745] - > PING 3f 2e c8 75 [binary, 4 bytes]
2025-02-08 09:16:40,895 - DEBUG - [protocol.py:599] - < PING 48 8e 10 36 [binary, 4 bytes]
2025-02-08 09:16:40,897 - DEBUG - [protocol.py:745] - > PONG 48 8e 10 36 [binary, 4 bytes]
2025-02-08 09:16:40,900 - DEBUG - [protocol.py:599] - < PONG 3f 2e c8 75 [binary, 4 bytes]
2025-02-08 09:16:40,902 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:17:00,898 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:17:00,898 - DEBUG - [protocol.py:745] - > PING 4e 5d cc 2e [binary, 4 bytes]
2025-02-08 09:17:00,903 - DEBUG - [protocol.py:599] - < PING 77 6b 57 ed [binary, 4 bytes]
2025-02-08 09:17:00,904 - DEBUG - [protocol.py:745] - > PONG 77 6b 57 ed [binary, 4 bytes]
2025-02-08 09:17:00,904 - DEBUG - [protocol.py:599] - < PONG 4e 5d cc 2e [binary, 4 bytes]
2025-02-08 09:17:00,905 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:17:20,906 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:17:20,907 - DEBUG - [protocol.py:745] - > PING 47 82 a8 d5 [binary, 4 bytes]
2025-02-08 09:17:20,909 - DEBUG - [protocol.py:599] - < PING 14 a5 54 83 [binary, 4 bytes]
2025-02-08 09:17:20,910 - DEBUG - [protocol.py:745] - > PONG 14 a5 54 83 [binary, 4 bytes]
2025-02-08 09:17:20,913 - DEBUG - [protocol.py:599] - < PONG 47 82 a8 d5 [binary, 4 bytes]
2025-02-08 09:17:20,913 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:17:40,904 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:17:40,904 - DEBUG - [protocol.py:745] - > PING dc da 24 44 [binary, 4 bytes]
2025-02-08 09:17:40,910 - DEBUG - [protocol.py:599] - < PONG dc da 24 44 [binary, 4 bytes]
2025-02-08 09:17:40,911 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:17:40,916 - DEBUG - [protocol.py:599] - < PING 8f f8 3a f4 [binary, 4 bytes]
2025-02-08 09:17:40,916 - DEBUG - [protocol.py:745] - > PONG 8f f8 3a f4 [binary, 4 bytes]
2025-02-08 09:18:00,916 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:18:00,916 - DEBUG - [protocol.py:745] - > PING 36 28 9d 9e [binary, 4 bytes]
2025-02-08 09:18:00,920 - DEBUG - [protocol.py:599] - < PONG 36 28 9d 9e [binary, 4 bytes]
2025-02-08 09:18:00,921 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:18:00,922 - DEBUG - [protocol.py:599] - < PING 6c f8 5d 1e [binary, 4 bytes]
2025-02-08 09:18:00,922 - DEBUG - [protocol.py:745] - > PONG 6c f8 5d 1e [binary, 4 bytes]
2025-02-08 09:18:20,927 - DEBUG - [protocol.py:599] - < PING 02 f2 2e 1b [binary, 4 bytes]
2025-02-08 09:18:20,928 - DEBUG - [protocol.py:745] - > PONG 02 f2 2e 1b [binary, 4 bytes]
2025-02-08 09:18:20,928 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:18:20,929 - DEBUG - [protocol.py:745] - > PING 'x\x00V2' [text, 4 bytes]
2025-02-08 09:18:20,936 - DEBUG - [protocol.py:599] - < PONG 'x\x00V2' [text, 4 bytes]
2025-02-08 09:18:20,936 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:18:40,935 - DEBUG - [protocol.py:599] - < PING 92 f4 fc 14 [binary, 4 bytes]
2025-02-08 09:18:40,937 - DEBUG - [protocol.py:745] - > PONG 92 f4 fc 14 [binary, 4 bytes]
2025-02-08 09:18:40,939 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:18:40,940 - DEBUG - [protocol.py:745] - > PING 3a 7e f4 46 [binary, 4 bytes]
2025-02-08 09:18:40,947 - DEBUG - [protocol.py:599] - < PONG 3a 7e f4 46 [binary, 4 bytes]
2025-02-08 09:18:40,949 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:19:00,945 - DEBUG - [protocol.py:599] - < PING 5d 31 ac 83 [binary, 4 bytes]
2025-02-08 09:19:00,948 - DEBUG - [protocol.py:745] - > PONG 5d 31 ac 83 [binary, 4 bytes]
2025-02-08 09:19:00,950 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:19:00,951 - DEBUG - [protocol.py:745] - > PING 'ZŖb' [text, 4 bytes]
2025-02-08 09:19:00,960 - DEBUG - [protocol.py:599] - < PONG 'ZŖb' [text, 4 bytes]
2025-02-08 09:19:00,962 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:19:20,952 - DEBUG - [protocol.py:599] - < PING '\x02:!G' [text, 4 bytes]
2025-02-08 09:19:20,954 - DEBUG - [protocol.py:745] - > PONG '\x02:!G' [text, 4 bytes]
2025-02-08 09:19:20,956 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:19:20,958 - DEBUG - [protocol.py:745] - > PING 'Y\x03Ս' [text, 4 bytes]
2025-02-08 09:19:20,965 - DEBUG - [protocol.py:599] - < PONG 'Y\x03Ս' [text, 4 bytes]
2025-02-08 09:19:20,967 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:19:40,960 - DEBUG - [protocol.py:599] - < PING 53 8d 42 b5 [binary, 4 bytes]
2025-02-08 09:19:40,964 - DEBUG - [protocol.py:745] - > PONG 53 8d 42 b5 [binary, 4 bytes]
2025-02-08 09:19:40,966 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:19:40,967 - DEBUG - [protocol.py:745] - > PING 9a 5e 3e f1 [binary, 4 bytes]
2025-02-08 09:19:40,976 - DEBUG - [protocol.py:599] - < PONG 9a 5e 3e f1 [binary, 4 bytes]
2025-02-08 09:19:40,977 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:20:00,969 - DEBUG - [protocol.py:599] - < PING 'i|Mi' [text, 4 bytes]
2025-02-08 09:20:00,971 - DEBUG - [protocol.py:745] - > PONG 'i|Mi' [text, 4 bytes]
2025-02-08 09:20:00,973 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:20:00,974 - DEBUG - [protocol.py:745] - > PING '\x01Ki=' [text, 4 bytes]
2025-02-08 09:20:00,983 - DEBUG - [protocol.py:599] - < PONG '\x01Ki=' [text, 4 bytes]
2025-02-08 09:20:00,985 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:20:20,980 - DEBUG - [protocol.py:599] - < PING 2d 36 dc 30 [binary, 4 bytes]
2025-02-08 09:20:20,982 - DEBUG - [protocol.py:745] - > PONG 2d 36 dc 30 [binary, 4 bytes]
2025-02-08 09:20:20,985 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:20:20,986 - DEBUG - [protocol.py:745] - > PING 33 b1 37 3c [binary, 4 bytes]
2025-02-08 09:20:20,995 - DEBUG - [protocol.py:599] - < PONG 33 b1 37 3c [binary, 4 bytes]
2025-02-08 09:20:20,998 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:20:30,140 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:20:30,142 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:20:30,142 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:20:30,143 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:20:30,176 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:20:30,176 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:20:30,177 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:20:30,180 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:20:30,181 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:20:30,182 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:20:30,683 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:20:30,684 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:20:30,684 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:20:30,684 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:20:30,684 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:20:30,685 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:20:30,915 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:20:30,915 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:20:31,212 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:20:31,213 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:20:31,213 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:20:31,214 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:20:31,214 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:20:31,215 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:20:31,488 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:20:31,488 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:20:31,489 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:20:31,713 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:20:31,713 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:20:31,713 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:20:32,001 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:20:32,001 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:20:32,002 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:20:32,234 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:20:32,235 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:20:32,235 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:20:32,235 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:20:32,236 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:20:32,456 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:20:32,457 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:20:32,457 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:20:32,458 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:20:32,458 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:20:32,459 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:20:32,459 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:20:32,459 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:20:32,512 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:20:32,513 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:20:32,513 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:20:32,515 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:20:32,515 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:20:32,516 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:20:32,516 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:20:32.515804",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:20:32,552 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:20:32,553 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:20:40,984 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:20:40,986 - DEBUG - [protocol.py:745] - > PING '>\x11\x1b\x0c' [text, 4 bytes]
2025-02-08 09:20:40,989 - DEBUG - [protocol.py:599] - < PING 10 28 75 a5 [binary, 4 bytes]
2025-02-08 09:20:40,992 - DEBUG - [protocol.py:745] - > PONG 10 28 75 a5 [binary, 4 bytes]
2025-02-08 09:20:40,995 - DEBUG - [protocol.py:599] - < PONG '>\x11\x1b\x0c' [text, 4 bytes]
2025-02-08 09:20:40,997 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:21:00,989 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:21:00,991 - DEBUG - [protocol.py:745] - > PING 90 04 7d 04 [binary, 4 bytes]
2025-02-08 09:21:00,998 - DEBUG - [protocol.py:599] - < PONG 90 04 7d 04 [binary, 4 bytes]
2025-02-08 09:21:01,000 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:21:01,003 - DEBUG - [protocol.py:599] - < PING 12 71 36 88 [binary, 4 bytes]
2025-02-08 09:21:01,006 - DEBUG - [protocol.py:745] - > PONG 12 71 36 88 [binary, 4 bytes]
2025-02-08 09:21:20,997 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:21:20,999 - DEBUG - [protocol.py:745] - > PING 95 fe 0f 8b [binary, 4 bytes]
2025-02-08 09:21:21,007 - DEBUG - [protocol.py:599] - < PONG 95 fe 0f 8b [binary, 4 bytes]
2025-02-08 09:21:21,009 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:21:21,015 - DEBUG - [protocol.py:599] - < PING 12 eb 00 be [binary, 4 bytes]
2025-02-08 09:21:21,020 - DEBUG - [protocol.py:745] - > PONG 12 eb 00 be [binary, 4 bytes]
2025-02-08 09:21:41,005 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:21:41,007 - DEBUG - [protocol.py:745] - > PING 9b a0 c4 95 [binary, 4 bytes]
2025-02-08 09:21:41,016 - DEBUG - [protocol.py:599] - < PONG 9b a0 c4 95 [binary, 4 bytes]
2025-02-08 09:21:41,018 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:21:41,031 - DEBUG - [protocol.py:599] - < PING 07 ce 19 c1 [binary, 4 bytes]
2025-02-08 09:21:41,032 - DEBUG - [protocol.py:745] - > PONG 07 ce 19 c1 [binary, 4 bytes]
2025-02-08 09:22:01,023 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:22:01,026 - DEBUG - [protocol.py:745] - > PING f0 65 a5 03 [binary, 4 bytes]
2025-02-08 09:22:01,035 - DEBUG - [protocol.py:599] - < PONG f0 65 a5 03 [binary, 4 bytes]
2025-02-08 09:22:01,038 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:22:01,041 - DEBUG - [protocol.py:599] - < PING 55 71 c2 25 [binary, 4 bytes]
2025-02-08 09:22:01,044 - DEBUG - [protocol.py:745] - > PONG 55 71 c2 25 [binary, 4 bytes]
2025-02-08 09:22:21,044 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:22:21,045 - DEBUG - [protocol.py:745] - > PING 13 db 68 d2 [binary, 4 bytes]
2025-02-08 09:22:21,054 - DEBUG - [protocol.py:599] - < PONG 13 db 68 d2 [binary, 4 bytes]
2025-02-08 09:22:21,056 - DEBUG - [protocol.py:599] - < PING 31 d1 7d 67 [binary, 4 bytes]
2025-02-08 09:22:21,058 - DEBUG - [protocol.py:745] - > PONG 31 d1 7d 67 [binary, 4 bytes]
2025-02-08 09:22:21,062 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:22:41,054 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:22:41,057 - DEBUG - [protocol.py:745] - > PING 08 c9 6d ad [binary, 4 bytes]
2025-02-08 09:22:41,063 - DEBUG - [protocol.py:599] - < PONG 08 c9 6d ad [binary, 4 bytes]
2025-02-08 09:22:41,066 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:22:41,071 - DEBUG - [protocol.py:599] - < PING '(Y/^' [text, 4 bytes]
2025-02-08 09:22:41,074 - DEBUG - [protocol.py:745] - > PONG '(Y/^' [text, 4 bytes]
2025-02-08 09:23:01,082 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:23:01,084 - DEBUG - [protocol.py:745] - > PING 7a 55 1b e0 [binary, 4 bytes]
2025-02-08 09:23:01,089 - DEBUG - [protocol.py:599] - < PING 7a 70 84 96 [binary, 4 bytes]
2025-02-08 09:23:01,091 - DEBUG - [protocol.py:745] - > PONG 7a 70 84 96 [binary, 4 bytes]
2025-02-08 09:23:01,094 - DEBUG - [protocol.py:599] - < PONG 7a 55 1b e0 [binary, 4 bytes]
2025-02-08 09:23:01,096 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:23:21,096 - DEBUG - [protocol.py:599] - < PING '$\x0bKs' [text, 4 bytes]
2025-02-08 09:23:21,099 - DEBUG - [protocol.py:745] - > PONG '$\x0bKs' [text, 4 bytes]
2025-02-08 09:23:21,102 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:23:21,103 - DEBUG - [protocol.py:745] - > PING 66 90 47 ad [binary, 4 bytes]
2025-02-08 09:23:21,114 - DEBUG - [protocol.py:599] - < PONG 66 90 47 ad [binary, 4 bytes]
2025-02-08 09:23:21,117 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:23:41,107 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:23:41,109 - DEBUG - [protocol.py:745] - > PING 2e e5 20 f6 [binary, 4 bytes]
2025-02-08 09:23:41,113 - DEBUG - [protocol.py:599] - < PING fe 20 3a 28 [binary, 4 bytes]
2025-02-08 09:23:41,113 - DEBUG - [protocol.py:745] - > PONG fe 20 3a 28 [binary, 4 bytes]
2025-02-08 09:23:41,117 - DEBUG - [protocol.py:599] - < PONG 2e e5 20 f6 [binary, 4 bytes]
2025-02-08 09:23:41,120 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:24:01,121 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:24:01,124 - DEBUG - [protocol.py:745] - > PING 96 11 b9 7b [binary, 4 bytes]
2025-02-08 09:24:01,128 - DEBUG - [protocol.py:599] - < PING 24 80 ba 5d [binary, 4 bytes]
2025-02-08 09:24:01,129 - DEBUG - [protocol.py:745] - > PONG 24 80 ba 5d [binary, 4 bytes]
2025-02-08 09:24:01,133 - DEBUG - [protocol.py:599] - < PONG 96 11 b9 7b [binary, 4 bytes]
2025-02-08 09:24:01,137 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:24:21,124 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:24:21,126 - DEBUG - [protocol.py:745] - > PING 59 97 f4 b0 [binary, 4 bytes]
2025-02-08 09:24:21,135 - DEBUG - [protocol.py:599] - < PONG 59 97 f4 b0 [binary, 4 bytes]
2025-02-08 09:24:21,137 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:24:21,139 - DEBUG - [protocol.py:599] - < PING 5b 97 2e d8 [binary, 4 bytes]
2025-02-08 09:24:21,142 - DEBUG - [protocol.py:745] - > PONG 5b 97 2e d8 [binary, 4 bytes]
2025-02-08 09:24:41,130 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:24:41,132 - DEBUG - [protocol.py:745] - > PING 3c ce 36 e3 [binary, 4 bytes]
2025-02-08 09:24:41,141 - DEBUG - [protocol.py:599] - < PONG 3c ce 36 e3 [binary, 4 bytes]
2025-02-08 09:24:41,143 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:24:41,153 - DEBUG - [protocol.py:599] - < PING 84 f1 02 a4 [binary, 4 bytes]
2025-02-08 09:24:41,156 - DEBUG - [protocol.py:745] - > PONG 84 f1 02 a4 [binary, 4 bytes]
2025-02-08 09:25:01,167 - DEBUG - [protocol.py:599] - < PING '\x07!R\x0f' [text, 4 bytes]
2025-02-08 09:25:01,168 - DEBUG - [protocol.py:745] - > PONG '\x07!R\x0f' [text, 4 bytes]
2025-02-08 09:25:01,170 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:25:01,172 - DEBUG - [protocol.py:745] - > PING 77 91 b9 7f [binary, 4 bytes]
2025-02-08 09:25:01,182 - DEBUG - [protocol.py:599] - < PONG 77 91 b9 7f [binary, 4 bytes]
2025-02-08 09:25:01,184 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:25:21,175 - DEBUG - [protocol.py:599] - < PING d4 18 ea f4 [binary, 4 bytes]
2025-02-08 09:25:21,178 - DEBUG - [protocol.py:745] - > PONG d4 18 ea f4 [binary, 4 bytes]
2025-02-08 09:25:21,180 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:25:21,181 - DEBUG - [protocol.py:745] - > PING a8 36 0e 0c [binary, 4 bytes]
2025-02-08 09:25:21,191 - DEBUG - [protocol.py:599] - < PONG a8 36 0e 0c [binary, 4 bytes]
2025-02-08 09:25:21,195 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:25:33,677 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:25:33,680 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:25:33,682 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:25:33,683 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:25:33,749 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:25:33,750 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:25:33,750 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:25:33,752 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:25:33,752 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:25:33,753 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:25:34,058 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:25:34,059 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:25:34,060 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:25:34,060 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:25:34,061 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:25:34,062 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:25:34,308 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:25:34,309 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:25:34,534 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:25:34,534 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:25:34,534 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:25:34,535 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:25:34,535 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:25:34,535 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:25:34,763 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:25:34,763 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:25:34,764 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:25:35,059 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:25:35,059 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:25:35,060 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:25:35,278 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:25:35,278 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:25:35,278 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:25:35,506 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:25:35,506 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:25:35,507 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:25:35,507 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:25:35,507 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:25:35,773 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:25:35,774 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:25:35,774 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:25:35,775 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:25:35,776 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:25:35,777 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:25:35,777 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:25:35,777 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:25:35,812 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:25:35,813 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:25:35,814 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:25:35,816 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:25:35,816 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:25:35,817 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:25:35,817 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:25:35.815517",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:25:35,848 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:25:35,849 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:25:41,184 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:25:41,187 - DEBUG - [protocol.py:745] - > PING f6 31 07 61 [binary, 4 bytes]
2025-02-08 09:25:41,189 - DEBUG - [protocol.py:599] - < PING c8 43 5b f6 [binary, 4 bytes]
2025-02-08 09:25:41,190 - DEBUG - [protocol.py:745] - > PONG c8 43 5b f6 [binary, 4 bytes]
2025-02-08 09:25:41,194 - DEBUG - [protocol.py:599] - < PONG f6 31 07 61 [binary, 4 bytes]
2025-02-08 09:25:41,196 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:26:01,182 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:26:01,185 - DEBUG - [protocol.py:745] - > PING 41 66 fe 10 [binary, 4 bytes]
2025-02-08 09:26:01,192 - DEBUG - [protocol.py:599] - < PONG 41 66 fe 10 [binary, 4 bytes]
2025-02-08 09:26:01,195 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:26:01,199 - DEBUG - [protocol.py:599] - < PING a6 34 8f c5 [binary, 4 bytes]
2025-02-08 09:26:01,202 - DEBUG - [protocol.py:745] - > PONG a6 34 8f c5 [binary, 4 bytes]
2025-02-08 09:26:21,177 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:26:21,177 - DEBUG - [protocol.py:745] - > PING ec 91 e2 a0 [binary, 4 bytes]
2025-02-08 09:26:21,184 - DEBUG - [protocol.py:599] - < PONG ec 91 e2 a0 [binary, 4 bytes]
2025-02-08 09:26:21,184 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:26:21,212 - DEBUG - [protocol.py:599] - < PING 48 5f 80 b7 [binary, 4 bytes]
2025-02-08 09:26:21,213 - DEBUG - [protocol.py:745] - > PONG 48 5f 80 b7 [binary, 4 bytes]
2025-02-08 09:26:41,188 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:26:41,188 - DEBUG - [protocol.py:745] - > PING da 38 87 29 [binary, 4 bytes]
2025-02-08 09:26:41,192 - DEBUG - [protocol.py:599] - < PONG da 38 87 29 [binary, 4 bytes]
2025-02-08 09:26:41,194 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:26:41,219 - DEBUG - [protocol.py:599] - < PING 11 40 d0 64 [binary, 4 bytes]
2025-02-08 09:26:41,219 - DEBUG - [protocol.py:745] - > PONG 11 40 d0 64 [binary, 4 bytes]
2025-02-08 09:27:01,196 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:27:01,197 - DEBUG - [protocol.py:745] - > PING 44 f6 10 44 [binary, 4 bytes]
2025-02-08 09:27:01,202 - DEBUG - [protocol.py:599] - < PONG 44 f6 10 44 [binary, 4 bytes]
2025-02-08 09:27:01,203 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:27:01,222 - DEBUG - [protocol.py:599] - < PING 8b f1 49 41 [binary, 4 bytes]
2025-02-08 09:27:01,223 - DEBUG - [protocol.py:745] - > PONG 8b f1 49 41 [binary, 4 bytes]
2025-02-08 09:27:21,205 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:27:21,205 - DEBUG - [protocol.py:745] - > PING cf 45 1d 99 [binary, 4 bytes]
2025-02-08 09:27:21,212 - DEBUG - [protocol.py:599] - < PONG cf 45 1d 99 [binary, 4 bytes]
2025-02-08 09:27:21,213 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:27:21,227 - DEBUG - [protocol.py:599] - < PING 69 ea d5 52 [binary, 4 bytes]
2025-02-08 09:27:21,227 - DEBUG - [protocol.py:745] - > PONG 69 ea d5 52 [binary, 4 bytes]
2025-02-08 09:27:41,202 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:27:41,202 - DEBUG - [protocol.py:745] - > PING 78 eb 46 ba [binary, 4 bytes]
2025-02-08 09:27:41,205 - DEBUG - [protocol.py:599] - < PONG 78 eb 46 ba [binary, 4 bytes]
2025-02-08 09:27:41,206 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:27:41,233 - DEBUG - [protocol.py:599] - < PING 05 06 c8 36 [binary, 4 bytes]
2025-02-08 09:27:41,234 - DEBUG - [protocol.py:745] - > PONG 05 06 c8 36 [binary, 4 bytes]
2025-02-08 09:28:01,209 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:28:01,209 - DEBUG - [protocol.py:745] - > PING b4 01 8f a1 [binary, 4 bytes]
2025-02-08 09:28:01,215 - DEBUG - [protocol.py:599] - < PONG b4 01 8f a1 [binary, 4 bytes]
2025-02-08 09:28:01,215 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:28:01,240 - DEBUG - [protocol.py:599] - < PING 7c 75 31 b9 [binary, 4 bytes]
2025-02-08 09:28:01,241 - DEBUG - [protocol.py:745] - > PONG 7c 75 31 b9 [binary, 4 bytes]
2025-02-08 09:28:21,214 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:28:21,214 - DEBUG - [protocol.py:745] - > PING b1 0c 5d 9a [binary, 4 bytes]
2025-02-08 09:28:21,219 - DEBUG - [protocol.py:599] - < PONG b1 0c 5d 9a [binary, 4 bytes]
2025-02-08 09:28:21,219 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:28:21,246 - DEBUG - [protocol.py:599] - < PING a1 16 2a 7b [binary, 4 bytes]
2025-02-08 09:28:21,246 - DEBUG - [protocol.py:745] - > PONG a1 16 2a 7b [binary, 4 bytes]
2025-02-08 09:28:41,217 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:28:41,217 - DEBUG - [protocol.py:745] - > PING 3e 0d fc a2 [binary, 4 bytes]
2025-02-08 09:28:41,221 - DEBUG - [protocol.py:599] - < PONG 3e 0d fc a2 [binary, 4 bytes]
2025-02-08 09:28:41,222 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:28:41,252 - DEBUG - [protocol.py:599] - < PING 67 c3 70 2a [binary, 4 bytes]
2025-02-08 09:28:41,253 - DEBUG - [protocol.py:745] - > PONG 67 c3 70 2a [binary, 4 bytes]
2025-02-08 09:29:01,231 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:29:01,231 - DEBUG - [protocol.py:745] - > PING 9d 20 08 02 [binary, 4 bytes]
2025-02-08 09:29:01,237 - DEBUG - [protocol.py:599] - < PONG 9d 20 08 02 [binary, 4 bytes]
2025-02-08 09:29:01,237 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:29:01,257 - DEBUG - [protocol.py:599] - < PING 03 56 83 82 [binary, 4 bytes]
2025-02-08 09:29:01,257 - DEBUG - [protocol.py:745] - > PONG 03 56 83 82 [binary, 4 bytes]
2025-02-08 09:29:21,240 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:29:21,240 - DEBUG - [protocol.py:745] - > PING ']ٿ<' [text, 4 bytes]
2025-02-08 09:29:21,246 - DEBUG - [protocol.py:599] - < PONG ']ٿ<' [text, 4 bytes]
2025-02-08 09:29:21,246 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:29:21,264 - DEBUG - [protocol.py:599] - < PING 0f 43 a9 25 [binary, 4 bytes]
2025-02-08 09:29:21,264 - DEBUG - [protocol.py:745] - > PONG 0f 43 a9 25 [binary, 4 bytes]
2025-02-08 09:29:41,265 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:29:41,265 - DEBUG - [protocol.py:745] - > PING 01 e9 da fd [binary, 4 bytes]
2025-02-08 09:29:41,268 - DEBUG - [protocol.py:599] - < PING fc 1e df 85 [binary, 4 bytes]
2025-02-08 09:29:41,268 - DEBUG - [protocol.py:745] - > PONG fc 1e df 85 [binary, 4 bytes]
2025-02-08 09:29:41,271 - DEBUG - [protocol.py:599] - < PONG 01 e9 da fd [binary, 4 bytes]
2025-02-08 09:29:41,271 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:30:01,263 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:30:01,263 - DEBUG - [protocol.py:745] - > PING 12 d4 14 c7 [binary, 4 bytes]
2025-02-08 09:30:01,269 - DEBUG - [protocol.py:599] - < PONG 12 d4 14 c7 [binary, 4 bytes]
2025-02-08 09:30:01,270 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:30:01,275 - DEBUG - [protocol.py:599] - < PING e9 93 6d 7f [binary, 4 bytes]
2025-02-08 09:30:01,277 - DEBUG - [protocol.py:745] - > PONG e9 93 6d 7f [binary, 4 bytes]
2025-02-08 09:30:21,270 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:30:21,271 - DEBUG - [protocol.py:745] - > PING 60 d4 86 9e [binary, 4 bytes]
2025-02-08 09:30:21,278 - DEBUG - [protocol.py:599] - < PONG 60 d4 86 9e [binary, 4 bytes]
2025-02-08 09:30:21,279 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:30:21,282 - DEBUG - [protocol.py:599] - < PING cc 6b b2 94 [binary, 4 bytes]
2025-02-08 09:30:21,283 - DEBUG - [protocol.py:745] - > PONG cc 6b b2 94 [binary, 4 bytes]
2025-02-08 09:30:36,994 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:30:36,997 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:30:36,999 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:30:37,000 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:30:37,047 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:30:37,047 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:30:37,048 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:30:37,049 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:30:37,049 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:30:37,050 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:30:37,497 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:30:37,498 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:30:37,498 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:30:37,499 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:30:37,499 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:30:37,500 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:30:37,746 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:30:37,747 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:30:37,976 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:30:37,976 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:30:37,977 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:30:37,977 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:30:37,978 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:30:37,978 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:30:38,289 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:30:38,289 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:30:38,290 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:30:38,511 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:30:38,511 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:30:38,511 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:30:38,745 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:30:38,745 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:30:38,745 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:30:39,016 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:30:39,016 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:30:39,016 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:30:39,017 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:30:39,018 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:30:39,246 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:30:39,246 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:30:39,247 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:30:39,247 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:30:39,249 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:30:39,249 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:30:39,249 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:30:39,250 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:30:39,281 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:30:39,281 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:30:39,282 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:30:39,283 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:30:39,283 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:30:39,284 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:30:39,284 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:30:39.283474",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:30:39,316 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:30:39,316 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:30:41,283 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:30:41,285 - DEBUG - [protocol.py:745] - > PING 85 f0 6c 36 [binary, 4 bytes]
2025-02-08 09:30:41,290 - DEBUG - [protocol.py:599] - < PING 5b bb 98 17 [binary, 4 bytes]
2025-02-08 09:30:41,291 - DEBUG - [protocol.py:745] - > PONG 5b bb 98 17 [binary, 4 bytes]
2025-02-08 09:30:41,294 - DEBUG - [protocol.py:599] - < PONG 85 f0 6c 36 [binary, 4 bytes]
2025-02-08 09:30:41,297 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:31:01,299 - DEBUG - [protocol.py:599] - < PING 49 30 68 e6 [binary, 4 bytes]
2025-02-08 09:31:01,302 - DEBUG - [protocol.py:745] - > PONG 49 30 68 e6 [binary, 4 bytes]
2025-02-08 09:31:01,303 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:31:01,305 - DEBUG - [protocol.py:745] - > PING 1c 8e 8a f9 [binary, 4 bytes]
2025-02-08 09:31:01,312 - DEBUG - [protocol.py:599] - < PONG 1c 8e 8a f9 [binary, 4 bytes]
2025-02-08 09:31:01,314 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:31:21,312 - DEBUG - [protocol.py:599] - < PING 11 d5 09 2f [binary, 4 bytes]
2025-02-08 09:31:21,313 - DEBUG - [protocol.py:745] - > PONG 11 d5 09 2f [binary, 4 bytes]
2025-02-08 09:31:21,332 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:31:21,335 - DEBUG - [protocol.py:745] - > PING d8 8d e3 fd [binary, 4 bytes]
2025-02-08 09:31:21,344 - DEBUG - [protocol.py:599] - < PONG d8 8d e3 fd [binary, 4 bytes]
2025-02-08 09:31:21,348 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:31:41,320 - DEBUG - [protocol.py:599] - < PING bd 8c c0 02 [binary, 4 bytes]
2025-02-08 09:31:41,322 - DEBUG - [protocol.py:745] - > PONG bd 8c c0 02 [binary, 4 bytes]
2025-02-08 09:31:41,341 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:31:41,342 - DEBUG - [protocol.py:745] - > PING '\x14V\x12*' [text, 4 bytes]
2025-02-08 09:31:41,350 - DEBUG - [protocol.py:599] - < PONG '\x14V\x12*' [text, 4 bytes]
2025-02-08 09:31:41,351 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:32:01,331 - DEBUG - [protocol.py:599] - < PING 73 05 7f 96 [binary, 4 bytes]
2025-02-08 09:32:01,334 - DEBUG - [protocol.py:745] - > PONG 73 05 7f 96 [binary, 4 bytes]
2025-02-08 09:32:01,336 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:32:01,338 - DEBUG - [protocol.py:745] - > PING 0d e0 bc 17 [binary, 4 bytes]
2025-02-08 09:32:01,343 - DEBUG - [protocol.py:599] - < PONG 0d e0 bc 17 [binary, 4 bytes]
2025-02-08 09:32:01,346 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:32:21,340 - DEBUG - [protocol.py:599] - < PING d2 f2 42 e8 [binary, 4 bytes]
2025-02-08 09:32:21,342 - DEBUG - [protocol.py:745] - > PONG d2 f2 42 e8 [binary, 4 bytes]
2025-02-08 09:32:21,342 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:32:21,343 - DEBUG - [protocol.py:745] - > PING 07 8c 0c 7b [binary, 4 bytes]
2025-02-08 09:32:21,347 - DEBUG - [protocol.py:599] - < PONG 07 8c 0c 7b [binary, 4 bytes]
2025-02-08 09:32:21,354 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:32:41,348 - DEBUG - [protocol.py:599] - < PING 7d 6a 11 a5 [binary, 4 bytes]
2025-02-08 09:32:41,350 - DEBUG - [protocol.py:745] - > PONG 7d 6a 11 a5 [binary, 4 bytes]
2025-02-08 09:32:41,354 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:32:41,356 - DEBUG - [protocol.py:745] - > PING 7a 64 5b df [binary, 4 bytes]
2025-02-08 09:32:41,363 - DEBUG - [protocol.py:599] - < PONG 7a 64 5b df [binary, 4 bytes]
2025-02-08 09:32:41,365 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:33:01,357 - DEBUG - [protocol.py:599] - < PING c8 2e 70 61 [binary, 4 bytes]
2025-02-08 09:33:01,359 - DEBUG - [protocol.py:745] - > PONG c8 2e 70 61 [binary, 4 bytes]
2025-02-08 09:33:01,361 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:33:01,363 - DEBUG - [protocol.py:745] - > PING 8e 0c 62 4d [binary, 4 bytes]
2025-02-08 09:33:01,371 - DEBUG - [protocol.py:599] - < PONG 8e 0c 62 4d [binary, 4 bytes]
2025-02-08 09:33:01,375 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:33:21,366 - DEBUG - [protocol.py:599] - < PING 1b b3 3f 1d [binary, 4 bytes]
2025-02-08 09:33:21,367 - DEBUG - [protocol.py:745] - > PONG 1b b3 3f 1d [binary, 4 bytes]
2025-02-08 09:33:21,367 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:33:21,369 - DEBUG - [protocol.py:745] - > PING ec 5f 87 5c [binary, 4 bytes]
2025-02-08 09:33:21,374 - DEBUG - [protocol.py:599] - < PONG ec 5f 87 5c [binary, 4 bytes]
2025-02-08 09:33:21,375 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:33:41,372 - DEBUG - [protocol.py:599] - < PING 5f 51 8e 90 [binary, 4 bytes]
2025-02-08 09:33:41,373 - DEBUG - [protocol.py:745] - > PONG 5f 51 8e 90 [binary, 4 bytes]
2025-02-08 09:33:41,373 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:33:41,373 - DEBUG - [protocol.py:745] - > PING 61 e8 9e fd [binary, 4 bytes]
2025-02-08 09:33:41,379 - DEBUG - [protocol.py:599] - < PONG 61 e8 9e fd [binary, 4 bytes]
2025-02-08 09:33:41,380 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:34:01,377 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:34:01,378 - DEBUG - [protocol.py:745] - > PING c2 5f a5 3f [binary, 4 bytes]
2025-02-08 09:34:01,381 - DEBUG - [protocol.py:599] - < PING 5e 9d c4 08 [binary, 4 bytes]
2025-02-08 09:34:01,381 - DEBUG - [protocol.py:745] - > PONG 5e 9d c4 08 [binary, 4 bytes]
2025-02-08 09:34:01,381 - DEBUG - [protocol.py:599] - < PONG c2 5f a5 3f [binary, 4 bytes]
2025-02-08 09:34:01,383 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:34:21,372 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:34:21,374 - DEBUG - [protocol.py:745] - > PING 4f ac bd 17 [binary, 4 bytes]
2025-02-08 09:34:21,381 - DEBUG - [protocol.py:599] - < PONG 4f ac bd 17 [binary, 4 bytes]
2025-02-08 09:34:21,383 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:34:21,385 - DEBUG - [protocol.py:599] - < PING b5 04 c4 0d [binary, 4 bytes]
2025-02-08 09:34:21,388 - DEBUG - [protocol.py:745] - > PONG b5 04 c4 0d [binary, 4 bytes]
2025-02-08 09:34:41,378 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:34:41,379 - DEBUG - [protocol.py:745] - > PING a8 30 df 37 [binary, 4 bytes]
2025-02-08 09:34:41,384 - DEBUG - [protocol.py:599] - < PONG a8 30 df 37 [binary, 4 bytes]
2025-02-08 09:34:41,385 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:34:41,397 - DEBUG - [protocol.py:599] - < PING '\x03\x15{z' [text, 4 bytes]
2025-02-08 09:34:41,398 - DEBUG - [protocol.py:745] - > PONG '\x03\x15{z' [text, 4 bytes]
2025-02-08 09:35:01,389 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:35:01,391 - DEBUG - [protocol.py:745] - > PING 7f 33 c7 55 [binary, 4 bytes]
2025-02-08 09:35:01,399 - DEBUG - [protocol.py:599] - < PONG 7f 33 c7 55 [binary, 4 bytes]
2025-02-08 09:35:01,401 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:35:01,404 - DEBUG - [protocol.py:599] - < PING ad 40 43 b5 [binary, 4 bytes]
2025-02-08 09:35:01,405 - DEBUG - [protocol.py:745] - > PONG ad 40 43 b5 [binary, 4 bytes]
2025-02-08 09:35:21,401 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:35:21,403 - DEBUG - [protocol.py:745] - > PING a7 cd 41 84 [binary, 4 bytes]
2025-02-08 09:35:21,410 - DEBUG - [protocol.py:599] - < PONG a7 cd 41 84 [binary, 4 bytes]
2025-02-08 09:35:21,412 - DEBUG - [protocol.py:599] - < PING f6 92 34 99 [binary, 4 bytes]
2025-02-08 09:35:21,414 - DEBUG - [protocol.py:745] - > PONG f6 92 34 99 [binary, 4 bytes]
2025-02-08 09:35:21,419 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:35:40,441 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:35:40,442 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:35:40,443 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:35:40,444 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:35:40,473 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:35:40,474 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:35:40,475 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:35:40,479 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:35:40,479 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:35:40,480 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:35:40,722 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:35:40,723 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:35:40,724 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:35:40,724 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:35:40,725 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:35:40,725 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:35:40,965 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:35:40,965 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:35:41,277 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:35:41,277 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:35:41,278 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:35:41,278 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:35:41,278 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:35:41,279 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:35:41,508 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:35:41,509 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:35:41,509 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:35:41,740 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:35:41,741 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:35:41,742 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:35:42,020 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:35:42,020 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:35:42,021 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:35:42,251 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:35:42,252 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:35:42,252 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:35:42,252 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:35:42,252 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:35:42,495 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:35:42,495 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:35:42,496 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:35:42,496 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:35:42,496 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:35:42,498 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:35:42,498 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:35:42,498 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:35:42,500 - DEBUG - [protocol.py:599] - < PING 86 67 7c 59 [binary, 4 bytes]
2025-02-08 09:35:42,500 - DEBUG - [protocol.py:745] - > PONG 86 67 7c 59 [binary, 4 bytes]
2025-02-08 09:35:42,501 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:35:42,501 - DEBUG - [protocol.py:745] - > PING f4 e7 61 e6 [binary, 4 bytes]
2025-02-08 09:35:42,506 - DEBUG - [protocol.py:599] - < PONG f4 e7 61 e6 [binary, 4 bytes]
2025-02-08 09:35:42,508 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:35:42,532 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:35:42,532 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:35:42,533 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:35:42,534 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:35:42,534 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:35:42,535 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:35:42,535 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:35:42.534416",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:35:42,573 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:35:42,574 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:36:02,507 - DEBUG - [protocol.py:599] - < PING e3 cf 7c 03 [binary, 4 bytes]
2025-02-08 09:36:02,507 - DEBUG - [protocol.py:745] - > PONG e3 cf 7c 03 [binary, 4 bytes]
2025-02-08 09:36:02,508 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:36:02,508 - DEBUG - [protocol.py:745] - > PING 36 48 0e e1 [binary, 4 bytes]
2025-02-08 09:36:02,514 - DEBUG - [protocol.py:599] - < PONG 36 48 0e e1 [binary, 4 bytes]
2025-02-08 09:36:02,514 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:36:22,513 - DEBUG - [protocol.py:599] - < PING 6b e1 c1 d9 [binary, 4 bytes]
2025-02-08 09:36:22,515 - DEBUG - [protocol.py:745] - > PONG 6b e1 c1 d9 [binary, 4 bytes]
2025-02-08 09:36:22,517 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:36:22,519 - DEBUG - [protocol.py:745] - > PING 46 4c cf 7e [binary, 4 bytes]
2025-02-08 09:36:22,527 - DEBUG - [protocol.py:599] - < PONG 46 4c cf 7e [binary, 4 bytes]
2025-02-08 09:36:22,530 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:36:42,524 - DEBUG - [protocol.py:599] - < PING 4d 72 91 d9 [binary, 4 bytes]
2025-02-08 09:36:42,526 - DEBUG - [protocol.py:745] - > PONG 4d 72 91 d9 [binary, 4 bytes]
2025-02-08 09:36:42,528 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:36:42,530 - DEBUG - [protocol.py:745] - > PING 69 37 c0 ff [binary, 4 bytes]
2025-02-08 09:36:42,537 - DEBUG - [protocol.py:599] - < PONG 69 37 c0 ff [binary, 4 bytes]
2025-02-08 09:36:42,540 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:37:02,532 - DEBUG - [protocol.py:599] - < PING 64 e0 5e e8 [binary, 4 bytes]
2025-02-08 09:37:02,533 - DEBUG - [protocol.py:745] - > PONG 64 e0 5e e8 [binary, 4 bytes]
2025-02-08 09:37:02,537 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:37:02,539 - DEBUG - [protocol.py:745] - > PING b1 45 3d 62 [binary, 4 bytes]
2025-02-08 09:37:02,550 - DEBUG - [protocol.py:599] - < PONG b1 45 3d 62 [binary, 4 bytes]
2025-02-08 09:37:02,553 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:37:22,543 - DEBUG - [protocol.py:599] - < PING 0a f3 8d e9 [binary, 4 bytes]
2025-02-08 09:37:22,544 - DEBUG - [protocol.py:745] - > PONG 0a f3 8d e9 [binary, 4 bytes]
2025-02-08 09:37:22,546 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:37:22,548 - DEBUG - [protocol.py:745] - > PING 2b b4 25 d0 [binary, 4 bytes]
2025-02-08 09:37:22,556 - DEBUG - [protocol.py:599] - < PONG 2b b4 25 d0 [binary, 4 bytes]
2025-02-08 09:37:22,558 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:37:42,549 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:37:42,551 - DEBUG - [protocol.py:745] - > PING b1 cf 2f e0 [binary, 4 bytes]
2025-02-08 09:37:42,554 - DEBUG - [protocol.py:599] - < PING 0f cd 5b 6c [binary, 4 bytes]
2025-02-08 09:37:42,557 - DEBUG - [protocol.py:745] - > PONG 0f cd 5b 6c [binary, 4 bytes]
2025-02-08 09:37:42,562 - DEBUG - [protocol.py:599] - < PONG b1 cf 2f e0 [binary, 4 bytes]
2025-02-08 09:37:42,568 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:38:02,566 - DEBUG - [protocol.py:599] - < PING 7d 08 c6 5e [binary, 4 bytes]
2025-02-08 09:38:02,568 - DEBUG - [protocol.py:745] - > PONG 7d 08 c6 5e [binary, 4 bytes]
2025-02-08 09:38:02,571 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:38:02,573 - DEBUG - [protocol.py:745] - > PING 62 65 e7 77 [binary, 4 bytes]
2025-02-08 09:38:02,580 - DEBUG - [protocol.py:599] - < PONG 62 65 e7 77 [binary, 4 bytes]
2025-02-08 09:38:02,583 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:38:22,577 - DEBUG - [protocol.py:599] - < PING 06 5b b2 6b [binary, 4 bytes]
2025-02-08 09:38:22,579 - DEBUG - [protocol.py:745] - > PONG 06 5b b2 6b [binary, 4 bytes]
2025-02-08 09:38:22,581 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:38:22,583 - DEBUG - [protocol.py:745] - > PING 07 32 f4 06 [binary, 4 bytes]
2025-02-08 09:38:22,590 - DEBUG - [protocol.py:599] - < PONG 07 32 f4 06 [binary, 4 bytes]
2025-02-08 09:38:22,592 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:38:42,588 - DEBUG - [protocol.py:599] - < PING 'Z\x19 B' [text, 4 bytes]
2025-02-08 09:38:42,589 - DEBUG - [protocol.py:745] - > PONG 'Z\x19 B' [text, 4 bytes]
2025-02-08 09:38:42,591 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:38:42,592 - DEBUG - [protocol.py:745] - > PING 3a e3 40 ec [binary, 4 bytes]
2025-02-08 09:38:42,598 - DEBUG - [protocol.py:599] - < PONG 3a e3 40 ec [binary, 4 bytes]
2025-02-08 09:38:42,600 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:39:02,594 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:39:02,594 - DEBUG - [protocol.py:745] - > PING 2d 18 99 6a [binary, 4 bytes]
2025-02-08 09:39:02,596 - DEBUG - [protocol.py:599] - < PING 35 80 61 69 [binary, 4 bytes]
2025-02-08 09:39:02,596 - DEBUG - [protocol.py:745] - > PONG 35 80 61 69 [binary, 4 bytes]
2025-02-08 09:39:02,600 - DEBUG - [protocol.py:599] - < PONG 2d 18 99 6a [binary, 4 bytes]
2025-02-08 09:39:02,600 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:39:21,319 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 09:39:21,319 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 09:39:21,327 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 09:39:21,327 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 09:39:21,336 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 09:39:21,336 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 09:39:21,336 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 09:39:28,684 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 09:39:28,686 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 09:39:28,687 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 09:39:28,687 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 09:39:28,687 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 09:39:28,687 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 09:39:28,687 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 09:39:28,687 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 09:39:28,689 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 09:39:28,689 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 09:39:28,689 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 09:39:28,826 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 09:39:28,827 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 09:39:28,827 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 09:39:28,827 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 09:39:28,827 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 09:39:28,827 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: I8XfhFi0/QrFI5FPeXefeQ==
2025-02-08 09:39:28,830 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 09:39:28,830 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 09:39:28,830 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 09:39:28,851 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 09:39:28,851 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 09:39:28,851 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 09:39:28,851 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: dkrG5eCz0IvDxZBbyM5CZrfJ2VU=
2025-02-08 09:39:28,851 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 09:39:28,851 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 14:39:27 GMT
2025-02-08 09:39:28,851 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 09:39:28,851 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 09:39:28,854 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 09:39:29,951 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:39:29,951 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:39:29,951 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:39:29,951 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:39:29,993 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:39:29,993 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:39:29,993 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:39:29,993 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:39:29,993 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:39:29,993 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:39:30,230 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:39:30,230 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:39:30,230 - INFO - [printer_monitor_service.py:182] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 09:39:30,230 - DEBUG - [printer_monitor_service.py:189] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 09:39:30,263 - DEBUG - [printer_monitor_service.py:194] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 09:39:30,263 - INFO - [printer_monitor_service.py:199] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 09:39:30,265 - DEBUG - [printer_monitor_service.py:200] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:39:30,265 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:39:30,267 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:39:30,267 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:39:30,443 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:39:30,443 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:39:30,638 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:39:30,638 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:39:30,638 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:39:30,638 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:39:30,638 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:39:30,638 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:39:30,804 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:39:30,804 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:39:30,804 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:39:30,962 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:39:30,962 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:39:30,962 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:39:31,158 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:39:31,158 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:39:31,158 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:39:31,328 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:39:31,328 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:39:31,328 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:39:31,328 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:39:31,328 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:39:31,492 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:39:31,492 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:39:31,492 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:39:31,492 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:39:31,496 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:39:31,496 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:39:31,496 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:39:31,496 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:39:31,529 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:39:31,530 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:39:31,530 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:39:31,532 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:39:31,532 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:39:31,532 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:39:31,532 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:39:31.532170",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:39:31,564 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:39:31,564 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:39:48,851 - DEBUG - [protocol.py:599] - < PING 57 57 a6 22 [binary, 4 bytes]
2025-02-08 09:39:48,854 - DEBUG - [protocol.py:745] - > PONG 57 57 a6 22 [binary, 4 bytes]
2025-02-08 09:39:48,856 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:39:48,859 - DEBUG - [protocol.py:745] - > PING 19 18 03 97 [binary, 4 bytes]
2025-02-08 09:39:48,871 - DEBUG - [protocol.py:599] - < PONG 19 18 03 97 [binary, 4 bytes]
2025-02-08 09:39:48,872 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:40:08,851 - DEBUG - [protocol.py:599] - < PING bf fd 36 f8 [binary, 4 bytes]
2025-02-08 09:40:08,851 - DEBUG - [protocol.py:745] - > PONG bf fd 36 f8 [binary, 4 bytes]
2025-02-08 09:40:08,851 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:40:08,867 - DEBUG - [protocol.py:745] - > PING 7d d8 84 9e [binary, 4 bytes]
2025-02-08 09:40:08,879 - DEBUG - [protocol.py:599] - < PONG 7d d8 84 9e [binary, 4 bytes]
2025-02-08 09:40:08,880 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:40:28,867 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:40:28,867 - DEBUG - [protocol.py:745] - > PING 3f bd 26 83 [binary, 4 bytes]
2025-02-08 09:40:28,874 - DEBUG - [protocol.py:599] - < PONG 3f bd 26 83 [binary, 4 bytes]
2025-02-08 09:40:28,874 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:40:28,881 - DEBUG - [protocol.py:599] - < PING bb 54 b1 20 [binary, 4 bytes]
2025-02-08 09:40:28,882 - DEBUG - [protocol.py:745] - > PONG bb 54 b1 20 [binary, 4 bytes]
2025-02-08 09:40:48,867 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:40:48,867 - DEBUG - [protocol.py:745] - > PING '`\n.d' [text, 4 bytes]
2025-02-08 09:40:48,867 - DEBUG - [protocol.py:599] - < PONG '`\n.d' [text, 4 bytes]
2025-02-08 09:40:48,867 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:40:48,885 - DEBUG - [protocol.py:599] - < PING 78 fa 4e ca [binary, 4 bytes]
2025-02-08 09:40:48,887 - DEBUG - [protocol.py:745] - > PONG 78 fa 4e ca [binary, 4 bytes]
2025-02-08 09:41:08,878 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:41:08,878 - DEBUG - [protocol.py:745] - > PING ")Nb'" [text, 4 bytes]
2025-02-08 09:41:08,902 - DEBUG - [protocol.py:599] - < PONG ")Nb'" [text, 4 bytes]
2025-02-08 09:41:08,902 - DEBUG - [protocol.py:599] - < PING ac dd b8 98 [binary, 4 bytes]
2025-02-08 09:41:08,902 - DEBUG - [protocol.py:745] - > PONG ac dd b8 98 [binary, 4 bytes]
2025-02-08 09:41:08,904 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:41:28,893 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:41:28,895 - DEBUG - [protocol.py:745] - > PING d7 21 64 51 [binary, 4 bytes]
2025-02-08 09:41:28,907 - DEBUG - [protocol.py:599] - < PONG d7 21 64 51 [binary, 4 bytes]
2025-02-08 09:41:28,908 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:41:28,912 - DEBUG - [protocol.py:599] - < PING a3 47 8c 76 [binary, 4 bytes]
2025-02-08 09:41:28,914 - DEBUG - [protocol.py:745] - > PONG a3 47 8c 76 [binary, 4 bytes]
2025-02-08 09:41:48,910 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:41:48,910 - DEBUG - [protocol.py:745] - > PING 6b ae f5 ea [binary, 4 bytes]
2025-02-08 09:41:48,919 - DEBUG - [protocol.py:599] - < PONG 6b ae f5 ea [binary, 4 bytes]
2025-02-08 09:41:48,919 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:41:48,923 - DEBUG - [protocol.py:599] - < PING 3b b0 76 5e [binary, 4 bytes]
2025-02-08 09:41:48,923 - DEBUG - [protocol.py:745] - > PONG 3b b0 76 5e [binary, 4 bytes]
2025-02-08 09:42:08,927 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:42:08,928 - DEBUG - [protocol.py:745] - > PING cf 0f 5e f1 [binary, 4 bytes]
2025-02-08 09:42:08,935 - DEBUG - [protocol.py:599] - < PING ee 6e c0 6a [binary, 4 bytes]
2025-02-08 09:42:08,936 - DEBUG - [protocol.py:745] - > PONG ee 6e c0 6a [binary, 4 bytes]
2025-02-08 09:42:08,936 - DEBUG - [protocol.py:599] - < PONG cf 0f 5e f1 [binary, 4 bytes]
2025-02-08 09:42:08,936 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:42:28,943 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:42:28,943 - DEBUG - [protocol.py:745] - > PING e3 b4 e6 50 [binary, 4 bytes]
2025-02-08 09:42:28,945 - DEBUG - [protocol.py:599] - < PING 58 f8 65 b5 [binary, 4 bytes]
2025-02-08 09:42:28,945 - DEBUG - [protocol.py:745] - > PONG 58 f8 65 b5 [binary, 4 bytes]
2025-02-08 09:42:28,946 - DEBUG - [protocol.py:599] - < PONG e3 b4 e6 50 [binary, 4 bytes]
2025-02-08 09:42:28,946 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:42:48,949 - DEBUG - [protocol.py:599] - < PING 24 e4 99 5f [binary, 4 bytes]
2025-02-08 09:42:48,952 - DEBUG - [protocol.py:745] - > PONG 24 e4 99 5f [binary, 4 bytes]
2025-02-08 09:42:48,952 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:42:48,952 - DEBUG - [protocol.py:745] - > PING 53 2a 95 0e [binary, 4 bytes]
2025-02-08 09:42:48,967 - DEBUG - [protocol.py:599] - < PONG 53 2a 95 0e [binary, 4 bytes]
2025-02-08 09:42:48,968 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:43:08,963 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:43:08,963 - DEBUG - [protocol.py:745] - > PING 57 86 ee 00 [binary, 4 bytes]
2025-02-08 09:43:08,966 - DEBUG - [protocol.py:599] - < PING 1c ab 55 ae [binary, 4 bytes]
2025-02-08 09:43:08,966 - DEBUG - [protocol.py:745] - > PONG 1c ab 55 ae [binary, 4 bytes]
2025-02-08 09:43:08,970 - DEBUG - [protocol.py:599] - < PONG 57 86 ee 00 [binary, 4 bytes]
2025-02-08 09:43:08,971 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:43:28,974 - DEBUG - [protocol.py:599] - < PING 92 be c6 c8 [binary, 4 bytes]
2025-02-08 09:43:28,976 - DEBUG - [protocol.py:745] - > PONG 92 be c6 c8 [binary, 4 bytes]
2025-02-08 09:43:28,979 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:43:28,980 - DEBUG - [protocol.py:745] - > PING 8f 8b 91 e5 [binary, 4 bytes]
2025-02-08 09:43:28,989 - DEBUG - [protocol.py:599] - < PONG 8f 8b 91 e5 [binary, 4 bytes]
2025-02-08 09:43:28,991 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:43:48,976 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:43:48,976 - DEBUG - [protocol.py:745] - > PING e4 c2 1f f2 [binary, 4 bytes]
2025-02-08 09:43:48,982 - DEBUG - [protocol.py:599] - < PONG e4 c2 1f f2 [binary, 4 bytes]
2025-02-08 09:43:48,982 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:43:48,987 - DEBUG - [protocol.py:599] - < PING 07 1a 42 b2 [binary, 4 bytes]
2025-02-08 09:43:48,987 - DEBUG - [protocol.py:745] - > PONG 07 1a 42 b2 [binary, 4 bytes]
2025-02-08 09:44:08,979 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:44:08,981 - DEBUG - [protocol.py:745] - > PING b0 46 af c4 [binary, 4 bytes]
2025-02-08 09:44:08,981 - DEBUG - [protocol.py:599] - < PONG b0 46 af c4 [binary, 4 bytes]
2025-02-08 09:44:08,981 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:44:08,995 - DEBUG - [protocol.py:599] - < PING '-6\n~' [text, 4 bytes]
2025-02-08 09:44:08,997 - DEBUG - [protocol.py:745] - > PONG '-6\n~' [text, 4 bytes]
2025-02-08 09:44:28,994 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:44:28,996 - DEBUG - [protocol.py:745] - > PING 17 c4 3c 75 [binary, 4 bytes]
2025-02-08 09:44:29,004 - DEBUG - [protocol.py:599] - < PONG 17 c4 3c 75 [binary, 4 bytes]
2025-02-08 09:44:29,004 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:44:29,004 - DEBUG - [protocol.py:599] - < PING f9 24 7a ac [binary, 4 bytes]
2025-02-08 09:44:29,007 - DEBUG - [protocol.py:745] - > PONG f9 24 7a ac [binary, 4 bytes]
2025-02-08 09:44:32,649 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:44:32,651 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:44:32,652 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:44:32,652 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:44:32,700 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:44:32,701 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:44:32,701 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:44:32,702 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:44:32,702 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:44:32,703 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:44:32,895 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:44:32,897 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:44:32,897 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:44:32,897 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:44:32,897 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:44:32,897 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:44:33,115 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:44:33,116 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:44:33,276 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:44:33,277 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:44:33,278 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:44:33,278 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:44:33,279 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:44:33,279 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:44:33,445 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:44:33,445 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:44:33,446 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:44:33,666 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:44:33,666 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:44:33,666 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:44:33,831 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:44:33,832 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:44:33,832 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:44:33,994 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:44:33,995 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:44:33,995 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:44:33,995 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:44:33,995 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:44:34,158 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:44:34,158 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:44:34,159 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:44:34,160 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:44:34,160 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:44:34,161 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:44:34,161 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:44:34,161 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:44:34,193 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:44:34,193 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:44:34,194 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:44:34,194 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:44:34,196 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:44:34,196 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:44:34,196 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:44:34.194867",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:44:34,226 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:44:34,227 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:44:49,003 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:44:49,003 - DEBUG - [protocol.py:745] - > PING 'aLr ' [text, 4 bytes]
2025-02-08 09:44:49,008 - DEBUG - [protocol.py:599] - < PONG 'aLr ' [text, 4 bytes]
2025-02-08 09:44:49,009 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:44:49,012 - DEBUG - [protocol.py:599] - < PING ac 35 62 fb [binary, 4 bytes]
2025-02-08 09:44:49,012 - DEBUG - [protocol.py:745] - > PONG ac 35 62 fb [binary, 4 bytes]
2025-02-08 09:45:09,010 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:45:09,010 - DEBUG - [protocol.py:745] - > PING 84 86 a7 7d [binary, 4 bytes]
2025-02-08 09:45:09,016 - DEBUG - [protocol.py:599] - < PING 2b d0 cb e1 [binary, 4 bytes]
2025-02-08 09:45:09,016 - DEBUG - [protocol.py:745] - > PONG 2b d0 cb e1 [binary, 4 bytes]
2025-02-08 09:45:09,016 - DEBUG - [protocol.py:599] - < PONG 84 86 a7 7d [binary, 4 bytes]
2025-02-08 09:45:09,022 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:45:29,012 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:45:29,013 - DEBUG - [protocol.py:745] - > PING fc 0a 0b 3f [binary, 4 bytes]
2025-02-08 09:45:29,020 - DEBUG - [protocol.py:599] - < PONG fc 0a 0b 3f [binary, 4 bytes]
2025-02-08 09:45:29,020 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:45:29,028 - DEBUG - [protocol.py:599] - < PING 2a 79 e2 23 [binary, 4 bytes]
2025-02-08 09:45:29,029 - DEBUG - [protocol.py:745] - > PONG 2a 79 e2 23 [binary, 4 bytes]
2025-02-08 09:45:49,024 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:45:49,026 - DEBUG - [protocol.py:745] - > PING '̓\t^' [text, 4 bytes]
2025-02-08 09:45:49,033 - DEBUG - [protocol.py:599] - < PONG '̓\t^' [text, 4 bytes]
2025-02-08 09:45:49,034 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:45:49,038 - DEBUG - [protocol.py:599] - < PING 17 cc e4 d8 [binary, 4 bytes]
2025-02-08 09:45:49,038 - DEBUG - [protocol.py:745] - > PONG 17 cc e4 d8 [binary, 4 bytes]
2025-02-08 09:46:09,034 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:46:09,034 - DEBUG - [protocol.py:745] - > PING 65 dc 81 a4 [binary, 4 bytes]
2025-02-08 09:46:09,038 - DEBUG - [protocol.py:599] - < PONG 65 dc 81 a4 [binary, 4 bytes]
2025-02-08 09:46:09,039 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:46:09,050 - DEBUG - [protocol.py:599] - < PING 70 f3 30 80 [binary, 4 bytes]
2025-02-08 09:46:09,050 - DEBUG - [protocol.py:745] - > PONG 70 f3 30 80 [binary, 4 bytes]
2025-02-08 09:46:29,025 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:46:29,027 - DEBUG - [protocol.py:745] - > PING 88 b6 8a bb [binary, 4 bytes]
2025-02-08 09:46:29,036 - DEBUG - [protocol.py:599] - < PONG 88 b6 8a bb [binary, 4 bytes]
2025-02-08 09:46:29,037 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:46:29,056 - DEBUG - [protocol.py:599] - < PING a8 2c e8 58 [binary, 4 bytes]
2025-02-08 09:46:29,059 - DEBUG - [protocol.py:745] - > PONG a8 2c e8 58 [binary, 4 bytes]
2025-02-08 09:46:49,038 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:46:49,038 - DEBUG - [protocol.py:745] - > PING a4 8a ff be [binary, 4 bytes]
2025-02-08 09:46:49,044 - DEBUG - [protocol.py:599] - < PONG a4 8a ff be [binary, 4 bytes]
2025-02-08 09:46:49,045 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:46:49,065 - DEBUG - [protocol.py:599] - < PING f0 eb 82 5d [binary, 4 bytes]
2025-02-08 09:46:49,065 - DEBUG - [protocol.py:745] - > PONG f0 eb 82 5d [binary, 4 bytes]
2025-02-08 09:47:09,038 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:47:09,038 - DEBUG - [protocol.py:745] - > PING 78 b0 a7 6a [binary, 4 bytes]
2025-02-08 09:47:09,043 - DEBUG - [protocol.py:599] - < PONG 78 b0 a7 6a [binary, 4 bytes]
2025-02-08 09:47:09,043 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:47:09,072 - DEBUG - [protocol.py:599] - < PING bc 6e ec 18 [binary, 4 bytes]
2025-02-08 09:47:09,075 - DEBUG - [protocol.py:745] - > PONG bc 6e ec 18 [binary, 4 bytes]
2025-02-08 09:47:29,065 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:47:29,065 - DEBUG - [protocol.py:745] - > PING 3b a5 a4 25 [binary, 4 bytes]
2025-02-08 09:47:29,070 - DEBUG - [protocol.py:599] - < PONG 3b a5 a4 25 [binary, 4 bytes]
2025-02-08 09:47:29,070 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:47:29,083 - DEBUG - [protocol.py:599] - < PING 58 4b ae 92 [binary, 4 bytes]
2025-02-08 09:47:29,085 - DEBUG - [protocol.py:745] - > PONG 58 4b ae 92 [binary, 4 bytes]
2025-02-08 09:47:49,056 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:47:49,058 - DEBUG - [protocol.py:745] - > PING 2a bc 88 f0 [binary, 4 bytes]
2025-02-08 09:47:49,065 - DEBUG - [protocol.py:599] - < PONG 2a bc 88 f0 [binary, 4 bytes]
2025-02-08 09:47:49,067 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:47:49,089 - DEBUG - [protocol.py:599] - < PING e2 bd 4f 39 [binary, 4 bytes]
2025-02-08 09:47:49,091 - DEBUG - [protocol.py:745] - > PONG e2 bd 4f 39 [binary, 4 bytes]
2025-02-08 09:48:09,065 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:48:09,065 - DEBUG - [protocol.py:745] - > PING c3 0b b0 a7 [binary, 4 bytes]
2025-02-08 09:48:09,072 - DEBUG - [protocol.py:599] - < PONG c3 0b b0 a7 [binary, 4 bytes]
2025-02-08 09:48:09,073 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:48:09,100 - DEBUG - [protocol.py:599] - < PING 46 da 34 ef [binary, 4 bytes]
2025-02-08 09:48:09,101 - DEBUG - [protocol.py:745] - > PONG 46 da 34 ef [binary, 4 bytes]
2025-02-08 09:48:29,057 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:48:29,059 - DEBUG - [protocol.py:745] - > PING 55 e7 bb 09 [binary, 4 bytes]
2025-02-08 09:48:29,068 - DEBUG - [protocol.py:599] - < PONG 55 e7 bb 09 [binary, 4 bytes]
2025-02-08 09:48:29,069 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:48:29,106 - DEBUG - [protocol.py:599] - < PING 64 71 f9 b5 [binary, 4 bytes]
2025-02-08 09:48:29,106 - DEBUG - [protocol.py:745] - > PONG 64 71 f9 b5 [binary, 4 bytes]
2025-02-08 09:48:49,069 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:48:49,071 - DEBUG - [protocol.py:745] - > PING 29 55 ba 4b [binary, 4 bytes]
2025-02-08 09:48:49,080 - DEBUG - [protocol.py:599] - < PONG 29 55 ba 4b [binary, 4 bytes]
2025-02-08 09:48:49,083 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:48:49,113 - DEBUG - [protocol.py:599] - < PING eb e0 b8 c3 [binary, 4 bytes]
2025-02-08 09:48:49,115 - DEBUG - [protocol.py:745] - > PONG eb e0 b8 c3 [binary, 4 bytes]
2025-02-08 09:49:09,081 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:49:09,084 - DEBUG - [protocol.py:745] - > PING 91 4a e1 c2 [binary, 4 bytes]
2025-02-08 09:49:09,089 - DEBUG - [protocol.py:599] - < PONG 91 4a e1 c2 [binary, 4 bytes]
2025-02-08 09:49:09,091 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:49:09,121 - DEBUG - [protocol.py:599] - < PING e9 c4 07 a5 [binary, 4 bytes]
2025-02-08 09:49:09,123 - DEBUG - [protocol.py:745] - > PONG e9 c4 07 a5 [binary, 4 bytes]
2025-02-08 09:49:29,110 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:49:29,112 - DEBUG - [protocol.py:745] - > PING b2 d3 f5 ef [binary, 4 bytes]
2025-02-08 09:49:29,122 - DEBUG - [protocol.py:599] - < PONG b2 d3 f5 ef [binary, 4 bytes]
2025-02-08 09:49:29,123 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:49:29,133 - DEBUG - [protocol.py:599] - < PING d9 d4 e8 90 [binary, 4 bytes]
2025-02-08 09:49:29,135 - DEBUG - [protocol.py:745] - > PONG d9 d4 e8 90 [binary, 4 bytes]
2025-02-08 09:49:35,342 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:49:35,344 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:49:35,345 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:49:35,347 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:49:35,392 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:49:35,393 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:49:35,393 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:49:35,394 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:49:35,395 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:49:35,396 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:49:35,727 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:49:35,728 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:49:35,728 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:49:35,729 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:49:35,729 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:49:35,730 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:49:35,990 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:49:35,990 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:49:36,222 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:49:36,223 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:49:36,224 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:49:36,226 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:49:36,226 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:49:36,226 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:49:36,586 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:49:36,588 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:49:36,588 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:49:36,997 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:49:36,998 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:49:36,999 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:49:37,262 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:49:37,262 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:49:37,263 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:49:37,538 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:49:37,539 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:49:37,540 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:49:37,540 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:49:37,540 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:49:37,814 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:49:37,814 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:49:37,814 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:49:37,815 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:49:37,815 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:49:37,816 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:49:37,816 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:49:37,816 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:49:37,851 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:49:37,852 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:49:37,855 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:49:37,865 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:49:37,866 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:49:37,866 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:49:37,867 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:49:37.862748",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:49:37,906 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:49:37,915 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:49:49,104 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:49:49,106 - DEBUG - [protocol.py:745] - > PING '\x197\x1dN' [text, 4 bytes]
2025-02-08 09:49:49,113 - DEBUG - [protocol.py:599] - < PONG '\x197\x1dN' [text, 4 bytes]
2025-02-08 09:49:49,115 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:49:49,145 - DEBUG - [protocol.py:599] - < PING 43 4a d5 c9 [binary, 4 bytes]
2025-02-08 09:49:49,146 - DEBUG - [protocol.py:745] - > PONG 43 4a d5 c9 [binary, 4 bytes]
2025-02-08 09:50:09,107 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:50:09,107 - DEBUG - [protocol.py:745] - > PING 1f 4b 9e d2 [binary, 4 bytes]
2025-02-08 09:50:09,119 - DEBUG - [protocol.py:599] - < PONG 1f 4b 9e d2 [binary, 4 bytes]
2025-02-08 09:50:09,120 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:50:09,154 - DEBUG - [protocol.py:599] - < PING 3a a8 95 ca [binary, 4 bytes]
2025-02-08 09:50:09,155 - DEBUG - [protocol.py:745] - > PONG 3a a8 95 ca [binary, 4 bytes]
2025-02-08 09:50:29,110 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:50:29,111 - DEBUG - [protocol.py:745] - > PING f4 01 5f 01 [binary, 4 bytes]
2025-02-08 09:50:29,123 - DEBUG - [protocol.py:599] - < PONG f4 01 5f 01 [binary, 4 bytes]
2025-02-08 09:50:29,125 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:50:29,164 - DEBUG - [protocol.py:599] - < PING 71 63 be 93 [binary, 4 bytes]
2025-02-08 09:50:29,167 - DEBUG - [protocol.py:745] - > PONG 71 63 be 93 [binary, 4 bytes]
2025-02-08 09:50:49,115 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:50:49,118 - DEBUG - [protocol.py:745] - > PING 2a 70 3a df [binary, 4 bytes]
2025-02-08 09:50:49,124 - DEBUG - [protocol.py:599] - < PONG 2a 70 3a df [binary, 4 bytes]
2025-02-08 09:50:49,126 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:50:49,174 - DEBUG - [protocol.py:599] - < PING 8b 3c 4e 3b [binary, 4 bytes]
2025-02-08 09:50:49,175 - DEBUG - [protocol.py:745] - > PONG 8b 3c 4e 3b [binary, 4 bytes]
2025-02-08 09:51:09,117 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:51:09,119 - DEBUG - [protocol.py:745] - > PING '|jԍ' [text, 4 bytes]
2025-02-08 09:51:09,127 - DEBUG - [protocol.py:599] - < PONG '|jԍ' [text, 4 bytes]
2025-02-08 09:51:09,130 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:51:09,189 - DEBUG - [protocol.py:599] - < PING 17 60 2e b5 [binary, 4 bytes]
2025-02-08 09:51:09,189 - DEBUG - [protocol.py:745] - > PONG 17 60 2e b5 [binary, 4 bytes]
2025-02-08 09:51:29,117 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 09:51:29,119 - DEBUG - [protocol.py:745] - > PING 'xFG-' [text, 4 bytes]
2025-02-08 09:51:29,128 - DEBUG - [protocol.py:599] - < PONG 'xFG-' [text, 4 bytes]
2025-02-08 09:51:29,129 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 09:51:29,197 - DEBUG - [protocol.py:599] - < PING ce 30 0c db [binary, 4 bytes]
2025-02-08 09:51:29,202 - DEBUG - [protocol.py:745] - > PONG ce 30 0c db [binary, 4 bytes]
2025-02-08 09:51:49,016 - DEBUG - [protocol.py:599] - < CLOSE 1012 (service restart) [2 bytes]
2025-02-08 09:51:49,016 - DEBUG - [protocol.py:745] - > CLOSE 1012 (service restart) [2 bytes]
2025-02-08 09:51:49,032 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 09:51:49,032 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 09:51:49,032 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 09:51:49,032 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 09:51:49,032 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 09:51:49,040 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-08 09:54:39,015 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:54:39,015 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:54:39,015 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:54:39,015 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:54:39,050 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:54:39,050 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:54:39,050 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:54:39,050 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:54:39,053 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:54:39,053 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:54:39,293 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:54:39,294 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:54:39,294 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:54:39,294 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:54:39,294 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:54:39,294 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:54:39,516 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:54:39,516 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:54:39,803 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:54:39,803 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:54:39,803 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:54:39,803 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:54:39,803 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:54:39,803 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:54:40,038 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:54:40,038 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:54:40,038 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:54:40,253 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:54:40,253 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:54:40,253 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:54:40,524 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:54:40,524 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:54:40,524 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:54:40,758 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:54:40,758 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:54:40,758 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:54:40,758 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:54:40,758 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:54:40,963 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:54:40,965 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:54:40,965 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:54:40,965 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:54:40,965 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:54:40,965 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:54:40,965 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:54:40,968 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:54:40,993 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:54:41,001 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:54:41,003 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:54:41,004 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:54:41,004 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:54:41,004 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:54:41,010 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:54:41.004499",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:54:41,053 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:54:41,054 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 09:59:42,174 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 09:59:42,175 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:59:42,176 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:59:42,177 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:59:42,212 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:59:42,213 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:59:42,213 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:59:42,214 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 09:59:42,216 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 09:59:42,217 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 09:59:42,466 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 09:59:42,467 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 09:59:42,467 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 09:59:42,468 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 09:59:42,468 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:59:42,469 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 09:59:42,811 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 09:59:42,812 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:59:43,047 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:59:43,048 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:59:43,049 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 09:59:43,049 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 09:59:43,049 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 09:59:43,050 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:59:43,283 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:59:43,284 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:59:43,284 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:59:43,579 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:59:43,580 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:59:43,580 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:59:43,902 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:59:43,902 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:59:43,903 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 09:59:44,591 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 09:59:44,591 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 09:59:44,593 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 09:59:44,594 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 09:59:44,594 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 09:59:44,859 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 09:59:44,860 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 09:59:44,860 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 09:59:44,861 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 09:59:44,862 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 09:59:44,862 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 09:59:44,863 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 09:59:44,863 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:59:44,901 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 09:59:44,904 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 09:59:44,905 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 09:59:44,908 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 09:59:44,909 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 09:59:44,910 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 09:59:44,911 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T14:59:44.907652",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 09:59:44,959 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 09:59:44,960 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:04:46,115 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:04:46,118 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:04:46,119 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:04:46,119 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:04:46,154 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:04:46,155 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:04:46,156 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:04:46,158 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:04:46,159 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:04:46,159 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:04:46,485 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:04:46,486 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:04:46,486 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:04:46,487 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:04:46,487 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:04:46,487 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:04:46,713 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 10:04:46,714 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:04:46,953 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:04:46,954 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:04:46,954 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 10:04:46,954 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:04:46,955 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:04:46,955 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:04:47,253 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:04:47,253 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:04:47,254 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:04:47,487 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:04:47,487 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:04:47,488 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:04:47,706 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:04:47,707 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:04:47,707 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:04:47,937 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:04:47,938 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:04:47,938 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 10:04:47,938 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:04:47,939 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:04:48,216 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:04:48,216 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:04:48,216 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:04:48,217 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:04:48,218 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:04:48,218 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:04:48,218 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:04:48,219 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:04:48,251 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:04:48,252 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:04:48,252 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:04:48,253 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:04:48,254 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:04:48,254 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:04:48,254 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:04:48.253062",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:04:48,295 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:04:48,296 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:09:49,387 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:09:49,389 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:09:49,389 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:09:49,390 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:09:49,418 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:09:49,418 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:09:49,419 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:09:49,419 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:09:49,420 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:09:49,420 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:09:49,583 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:09:49,584 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:09:49,584 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:09:49,585 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:09:49,585 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:09:49,585 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:09:49,752 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139093
2025-02-08 10:09:49,753 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:09:49,966 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:09:49,966 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:09:49,967 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139093, 'color_pages': 111299, 'bw_pages': None}
2025-02-08 10:09:49,967 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:09:49,967 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:09:49,968 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:09:50,132 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:09:50,133 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:09:50,134 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:09:50,295 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:09:50,295 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:09:50,295 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:09:50,459 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:09:50,459 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:09:50,460 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:09:50,680 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111299
2025-02-08 10:09:50,681 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:09:50,681 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111299, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111299, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111299, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111299, 'max': 100, 'percentage': 100}}}
2025-02-08 10:09:50,681 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:09:50,682 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:09:50,843 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:09:50,843 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:09:50,844 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:09:50,844 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139093,
    "color_pages": 111299,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111299,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:09:50,845 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:09:50,845 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:09:50,846 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:09:50,846 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:09:50,876 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:09:50,877 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:09:50,877 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:09:50,877 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:09:50,879 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:09:50,879 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:09:50,880 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:09:50.877964",
  "printer_data": {
    "counters": {
      "total_pages": 139093,
      "color_pages": 111299,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111299,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:09:50,908 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:09:50,909 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:14:52,005 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:14:52,006 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:14:52,008 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:14:52,009 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:14:52,044 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:14:52,045 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:14:52,046 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:14:52,047 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:14:52,047 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:14:52,048 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:14:52,221 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:14:52,222 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:14:52,222 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:14:52,222 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:14:52,222 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:14:52,222 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:14:52,423 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:14:52,424 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:14:52,584 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:14:52,584 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:14:52,585 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:14:52,586 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:14:52,586 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:14:52,586 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:14:52,748 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:14:52,748 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:14:52,748 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:14:52,912 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:14:52,912 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:14:52,913 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:14:53,120 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:14:53,121 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:14:53,121 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:14:53,283 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:14:53,283 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:14:53,283 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:14:53,284 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:14:53,284 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:14:53,441 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:14:53,442 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:14:53,442 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:14:53,443 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:14:53,443 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:14:53,444 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:14:53,444 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:14:53,444 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:14:53,479 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:14:53,480 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:14:53,480 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:14:53,481 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:14:53,482 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:14:53,482 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:14:53,483 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:14:53.481184",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:14:53,523 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:14:53,524 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:19:54,614 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:19:54,614 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:19:54,616 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:19:54,616 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:19:54,647 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:19:54,647 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:19:54,648 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:19:54,648 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:19:54,650 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:19:54,650 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:19:54,871 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:19:54,872 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:19:54,872 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:19:54,872 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:19:54,873 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:19:54,873 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:19:55,043 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:19:55,044 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:19:55,217 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:19:55,217 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:19:55,218 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:19:55,218 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:19:55,218 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:19:55,219 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:19:55,424 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:19:55,425 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:19:55,425 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:19:55,591 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:19:55,591 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:19:55,592 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:19:55,755 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:19:55,756 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:19:55,756 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:19:55,930 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:19:55,930 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:19:55,931 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:19:55,933 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:19:55,933 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:19:56,144 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:19:56,145 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:19:56,145 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:19:56,146 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:19:56,146 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:19:56,147 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:19:56,147 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:19:56,147 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:19:56,177 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:19:56,177 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:19:56,177 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:19:56,178 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:19:56,179 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:19:56,179 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:19:56,181 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:19:56.178892",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:19:56,208 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:19:56,209 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:21:33,641 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 10:21:33,644 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 10:21:33,645 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 10:21:33,645 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 10:21:33,645 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 10:21:33,645 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 10:21:33,645 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 10:21:33,645 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 10:21:33,645 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 10:21:33,645 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 10:21:33,645 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 10:21:33,690 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 10:21:33,690 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 10:21:33,696 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 10:21:33,696 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 10:21:33,697 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 10:21:33,697 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: ZcTy/k7Iqb78/9+6ldG9SA==
2025-02-08 10:21:33,697 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 10:21:33,697 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 10:21:33,699 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 10:21:33,721 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 10:21:33,723 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 10:21:33,723 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 10:21:33,724 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: 0J8d1mLHIe4Oo5mxVSq7YNs8qrU=
2025-02-08 10:21:33,724 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 10:21:33,724 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 15:21:32 GMT
2025-02-08 10:21:33,724 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 10:21:33,724 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 10:21:33,724 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 10:21:34,895 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:21:34,895 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:21:34,897 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:21:34,897 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:21:34,944 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:21:34,944 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:21:34,944 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:21:34,948 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:21:34,948 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:21:34,950 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:21:35,148 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:21:35,148 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:21:35,148 - INFO - [printer_monitor_service.py:182] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 10:21:35,148 - DEBUG - [printer_monitor_service.py:189] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 10:21:35,186 - DEBUG - [printer_monitor_service.py:194] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 10:21:35,186 - INFO - [printer_monitor_service.py:199] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 10:21:35,186 - DEBUG - [printer_monitor_service.py:200] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:21:35,188 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:21:35,188 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:21:35,188 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:21:35,366 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:21:35,366 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:21:35,575 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:21:35,575 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:21:35,575 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:21:35,577 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:21:35,577 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:21:35,577 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:21:35,751 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:21:35,751 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:21:35,751 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:21:35,918 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:21:35,918 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:21:35,918 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:21:36,137 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:21:36,137 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:21:36,137 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:21:36,308 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:21:36,308 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:21:36,308 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:21:36,308 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:21:36,309 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:21:36,478 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:21:36,478 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:21:36,478 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:21:36,479 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:21:36,479 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:21:36,480 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:21:36,480 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:21:36,481 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:21:36,505 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:21:36,505 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:21:36,505 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:21:36,505 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:21:36,505 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:21:36,505 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:21:36,505 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:21:36.505609",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:21:36,533 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:21:36,533 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:21:53,726 - DEBUG - [protocol.py:599] - < PING e8 8b 6c 91 [binary, 4 bytes]
2025-02-08 10:21:53,729 - DEBUG - [protocol.py:745] - > PONG e8 8b 6c 91 [binary, 4 bytes]
2025-02-08 10:21:53,733 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:21:53,737 - DEBUG - [protocol.py:745] - > PING ce 80 d4 2f [binary, 4 bytes]
2025-02-08 10:21:53,749 - DEBUG - [protocol.py:599] - < PONG ce 80 d4 2f [binary, 4 bytes]
2025-02-08 10:21:53,760 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:22:13,734 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:22:13,737 - DEBUG - [protocol.py:745] - > PING ac 1b c4 23 [binary, 4 bytes]
2025-02-08 10:22:13,740 - DEBUG - [protocol.py:599] - < PING 4a 43 df 0c [binary, 4 bytes]
2025-02-08 10:22:13,747 - DEBUG - [protocol.py:745] - > PONG 4a 43 df 0c [binary, 4 bytes]
2025-02-08 10:22:13,754 - DEBUG - [protocol.py:599] - < PONG ac 1b c4 23 [binary, 4 bytes]
2025-02-08 10:22:13,759 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:22:33,744 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:22:33,746 - DEBUG - [protocol.py:745] - > PING d6 f4 70 f5 [binary, 4 bytes]
2025-02-08 10:22:33,746 - DEBUG - [protocol.py:599] - < PONG d6 f4 70 f5 [binary, 4 bytes]
2025-02-08 10:22:33,746 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:22:33,762 - DEBUG - [protocol.py:599] - < PING be a1 b6 c3 [binary, 4 bytes]
2025-02-08 10:22:33,762 - DEBUG - [protocol.py:745] - > PONG be a1 b6 c3 [binary, 4 bytes]
2025-02-08 10:22:53,773 - DEBUG - [protocol.py:599] - < PING 69 47 e2 39 [binary, 4 bytes]
2025-02-08 10:22:53,774 - DEBUG - [protocol.py:745] - > PONG 69 47 e2 39 [binary, 4 bytes]
2025-02-08 10:22:53,775 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:22:53,775 - DEBUG - [protocol.py:745] - > PING 9f 46 fb 34 [binary, 4 bytes]
2025-02-08 10:22:53,780 - DEBUG - [protocol.py:599] - < PONG 9f 46 fb 34 [binary, 4 bytes]
2025-02-08 10:22:53,782 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:23:13,779 - DEBUG - [protocol.py:599] - < PING cd 02 98 f8 [binary, 4 bytes]
2025-02-08 10:23:13,779 - DEBUG - [protocol.py:745] - > PONG cd 02 98 f8 [binary, 4 bytes]
2025-02-08 10:23:13,780 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:23:13,780 - DEBUG - [protocol.py:745] - > PING bb ef f0 08 [binary, 4 bytes]
2025-02-08 10:23:13,785 - DEBUG - [protocol.py:599] - < PONG bb ef f0 08 [binary, 4 bytes]
2025-02-08 10:23:13,786 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:23:33,772 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:23:33,772 - DEBUG - [protocol.py:745] - > PING 8c d2 c8 75 [binary, 4 bytes]
2025-02-08 10:23:33,784 - DEBUG - [protocol.py:599] - < PONG 8c d2 c8 75 [binary, 4 bytes]
2025-02-08 10:23:33,784 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:23:33,791 - DEBUG - [protocol.py:599] - < PING 8d d1 b8 5d [binary, 4 bytes]
2025-02-08 10:23:33,792 - DEBUG - [protocol.py:745] - > PONG 8d d1 b8 5d [binary, 4 bytes]
2025-02-08 10:23:53,797 - DEBUG - [protocol.py:599] - < PING 56 b4 22 8f [binary, 4 bytes]
2025-02-08 10:23:53,799 - DEBUG - [protocol.py:745] - > PONG 56 b4 22 8f [binary, 4 bytes]
2025-02-08 10:23:53,800 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:23:53,801 - DEBUG - [protocol.py:745] - > PING 'ƞއ' [text, 4 bytes]
2025-02-08 10:23:53,807 - DEBUG - [protocol.py:599] - < PONG 'ƞއ' [text, 4 bytes]
2025-02-08 10:23:53,808 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:24:13,808 - DEBUG - [protocol.py:599] - < PING 48 25 2b db [binary, 4 bytes]
2025-02-08 10:24:13,809 - DEBUG - [protocol.py:745] - > PONG 48 25 2b db [binary, 4 bytes]
2025-02-08 10:24:13,811 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:24:13,813 - DEBUG - [protocol.py:745] - > PING 64 02 1b d6 [binary, 4 bytes]
2025-02-08 10:24:13,817 - DEBUG - [protocol.py:599] - < PONG 64 02 1b d6 [binary, 4 bytes]
2025-02-08 10:24:13,818 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:24:33,811 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:24:33,813 - DEBUG - [protocol.py:745] - > PING e6 96 7b 00 [binary, 4 bytes]
2025-02-08 10:24:33,821 - DEBUG - [protocol.py:599] - < PING b1 be db 52 [binary, 4 bytes]
2025-02-08 10:24:33,823 - DEBUG - [protocol.py:745] - > PONG b1 be db 52 [binary, 4 bytes]
2025-02-08 10:24:33,826 - DEBUG - [protocol.py:599] - < PONG e6 96 7b 00 [binary, 4 bytes]
2025-02-08 10:24:33,830 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:24:53,827 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:24:53,829 - DEBUG - [protocol.py:745] - > PING '3\x01\rG' [text, 4 bytes]
2025-02-08 10:24:53,830 - DEBUG - [protocol.py:599] - < PING 10 88 17 f1 [binary, 4 bytes]
2025-02-08 10:24:53,831 - DEBUG - [protocol.py:745] - > PONG 10 88 17 f1 [binary, 4 bytes]
2025-02-08 10:24:53,836 - DEBUG - [protocol.py:599] - < PONG '3\x01\rG' [text, 4 bytes]
2025-02-08 10:24:53,836 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:25:13,823 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:25:13,823 - DEBUG - [protocol.py:745] - > PING e2 9e ca 10 [binary, 4 bytes]
2025-02-08 10:25:13,830 - DEBUG - [protocol.py:599] - < PONG e2 9e ca 10 [binary, 4 bytes]
2025-02-08 10:25:13,830 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:25:13,840 - DEBUG - [protocol.py:599] - < PING 73 ee 5e 66 [binary, 4 bytes]
2025-02-08 10:25:13,841 - DEBUG - [protocol.py:745] - > PONG 73 ee 5e 66 [binary, 4 bytes]
2025-02-08 10:25:33,846 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:25:33,846 - DEBUG - [protocol.py:745] - > PING a2 e2 8a c3 [binary, 4 bytes]
2025-02-08 10:25:33,852 - DEBUG - [protocol.py:599] - < PONG a2 e2 8a c3 [binary, 4 bytes]
2025-02-08 10:25:33,853 - DEBUG - [protocol.py:599] - < PING 16 5d ce ee [binary, 4 bytes]
2025-02-08 10:25:33,854 - DEBUG - [protocol.py:745] - > PONG 16 5d ce ee [binary, 4 bytes]
2025-02-08 10:25:33,856 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:25:53,843 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:25:53,843 - DEBUG - [protocol.py:745] - > PING 2a d1 7c ec [binary, 4 bytes]
2025-02-08 10:25:53,850 - DEBUG - [protocol.py:599] - < PONG 2a d1 7c ec [binary, 4 bytes]
2025-02-08 10:25:53,850 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:25:53,859 - DEBUG - [protocol.py:599] - < PING b6 28 85 75 [binary, 4 bytes]
2025-02-08 10:25:53,861 - DEBUG - [protocol.py:745] - > PONG b6 28 85 75 [binary, 4 bytes]
2025-02-08 10:26:13,860 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:26:13,862 - DEBUG - [protocol.py:745] - > PING 6e 9c 20 33 [binary, 4 bytes]
2025-02-08 10:26:13,862 - DEBUG - [protocol.py:599] - < PING f2 c0 6e 31 [binary, 4 bytes]
2025-02-08 10:26:13,862 - DEBUG - [protocol.py:745] - > PONG f2 c0 6e 31 [binary, 4 bytes]
2025-02-08 10:26:13,870 - DEBUG - [protocol.py:599] - < PONG 6e 9c 20 33 [binary, 4 bytes]
2025-02-08 10:26:13,870 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:26:33,866 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:26:33,866 - DEBUG - [protocol.py:745] - > PING '.\x14Y\x1f' [text, 4 bytes]
2025-02-08 10:26:33,873 - DEBUG - [protocol.py:599] - < PING 40 d7 26 bf [binary, 4 bytes]
2025-02-08 10:26:33,874 - DEBUG - [protocol.py:745] - > PONG 40 d7 26 bf [binary, 4 bytes]
2025-02-08 10:26:33,874 - DEBUG - [protocol.py:599] - < PONG '.\x14Y\x1f' [text, 4 bytes]
2025-02-08 10:26:33,876 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:26:37,660 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:26:37,662 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:26:37,662 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:26:37,662 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:26:37,689 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:26:37,689 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:26:37,689 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:26:37,689 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:26:37,691 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:26:37,691 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:26:38,002 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:26:38,002 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:26:38,002 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:26:38,002 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:26:38,002 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:26:38,002 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:26:38,393 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:26:38,393 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:26:38,650 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:26:38,650 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:26:38,650 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:26:38,650 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:26:38,650 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:26:38,650 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:26:38,872 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:26:38,872 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:26:38,872 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:26:39,158 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:26:39,158 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:26:39,158 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:26:39,378 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:26:39,378 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:26:39,378 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:26:39,683 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:26:39,683 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:26:39,683 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:26:39,683 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:26:39,683 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:26:39,902 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:26:39,903 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:26:39,903 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:26:39,903 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:26:39,903 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:26:39,903 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:26:39,903 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:26:39,903 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:26:39,935 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4}]...
2025-02-08 10:26:39,935 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:26:39,935 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:26:39,935 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:26:39,935 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:26:39,935 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:26:39,935 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:26:39.935491",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:26:39,966 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:26:39,967 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:26:53,885 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:26:53,885 - DEBUG - [protocol.py:745] - > PING f1 aa 2d d9 [binary, 4 bytes]
2025-02-08 10:26:53,887 - DEBUG - [protocol.py:599] - < PING 00 b0 35 6f [binary, 4 bytes]
2025-02-08 10:26:53,889 - DEBUG - [protocol.py:745] - > PONG 00 b0 35 6f [binary, 4 bytes]
2025-02-08 10:26:53,889 - DEBUG - [protocol.py:599] - < PONG f1 aa 2d d9 [binary, 4 bytes]
2025-02-08 10:26:53,897 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:27:13,890 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:27:13,890 - DEBUG - [protocol.py:745] - > PING 1a f3 e6 c6 [binary, 4 bytes]
2025-02-08 10:27:13,890 - DEBUG - [protocol.py:599] - < PING '*fg<' [text, 4 bytes]
2025-02-08 10:27:13,890 - DEBUG - [protocol.py:745] - > PONG '*fg<' [text, 4 bytes]
2025-02-08 10:27:13,901 - DEBUG - [protocol.py:599] - < PONG 1a f3 e6 c6 [binary, 4 bytes]
2025-02-08 10:27:13,901 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:27:33,898 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:27:33,901 - DEBUG - [protocol.py:745] - > PING c3 81 18 dc [binary, 4 bytes]
2025-02-08 10:27:33,903 - DEBUG - [protocol.py:599] - < PING '귈\x0c' [text, 4 bytes]
2025-02-08 10:27:33,905 - DEBUG - [protocol.py:745] - > PONG '귈\x0c' [text, 4 bytes]
2025-02-08 10:27:33,913 - DEBUG - [protocol.py:599] - < PONG c3 81 18 dc [binary, 4 bytes]
2025-02-08 10:27:33,916 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:27:53,915 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:27:53,917 - DEBUG - [protocol.py:745] - > PING 1d 99 eb 7c [binary, 4 bytes]
2025-02-08 10:27:53,921 - DEBUG - [protocol.py:599] - < PING ce bf 65 b2 [binary, 4 bytes]
2025-02-08 10:27:53,923 - DEBUG - [protocol.py:745] - > PONG ce bf 65 b2 [binary, 4 bytes]
2025-02-08 10:27:53,927 - DEBUG - [protocol.py:599] - < PONG 1d 99 eb 7c [binary, 4 bytes]
2025-02-08 10:27:53,929 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:28:13,915 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:28:13,915 - DEBUG - [protocol.py:745] - > PING 21 eb 2f 1b [binary, 4 bytes]
2025-02-08 10:28:13,915 - DEBUG - [protocol.py:599] - < PONG 21 eb 2f 1b [binary, 4 bytes]
2025-02-08 10:28:13,915 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:28:13,933 - DEBUG - [protocol.py:599] - < PING 97 da 1a ec [binary, 4 bytes]
2025-02-08 10:28:13,933 - DEBUG - [protocol.py:745] - > PONG 97 da 1a ec [binary, 4 bytes]
2025-02-08 10:28:33,926 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:28:33,928 - DEBUG - [protocol.py:745] - > PING d8 96 32 dd [binary, 4 bytes]
2025-02-08 10:28:33,934 - DEBUG - [protocol.py:599] - < PONG d8 96 32 dd [binary, 4 bytes]
2025-02-08 10:28:33,934 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:28:33,943 - DEBUG - [protocol.py:599] - < PING '@`I\x1e' [text, 4 bytes]
2025-02-08 10:28:33,944 - DEBUG - [protocol.py:745] - > PONG '@`I\x1e' [text, 4 bytes]
2025-02-08 10:28:53,934 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:28:53,939 - DEBUG - [protocol.py:745] - > PING 4d 78 f4 2c [binary, 4 bytes]
2025-02-08 10:28:53,943 - DEBUG - [protocol.py:599] - < PONG 4d 78 f4 2c [binary, 4 bytes]
2025-02-08 10:28:53,944 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:28:53,953 - DEBUG - [protocol.py:599] - < PING '6{1(' [text, 4 bytes]
2025-02-08 10:28:53,954 - DEBUG - [protocol.py:745] - > PONG '6{1(' [text, 4 bytes]
2025-02-08 10:28:55,463 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:28:55,463 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 10:28:55,465 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:28:55,465 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 10:28:55,476 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 10:28:55,476 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 10:28:55,476 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 10:29:00,842 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 10:29:00,845 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 10:29:00,845 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 10:29:00,845 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 10:29:00,845 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 10:29:00,845 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 10:29:00,845 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 10:29:00,845 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 10:29:00,845 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 10:29:00,845 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 10:29:00,845 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 10:29:00,897 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 10:29:00,897 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 10:29:00,906 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 10:29:00,906 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 10:29:00,906 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 10:29:00,910 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: hg47hCQJqTXiEJx3uE/w4w==
2025-02-08 10:29:00,911 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 10:29:00,912 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 10:29:00,912 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 10:29:00,933 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 10:29:00,933 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 10:29:00,933 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 10:29:00,933 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: zPDAbsgoRAfdBNsJRQIgFUD7IJA=
2025-02-08 10:29:00,933 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 10:29:00,933 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 15:28:59 GMT
2025-02-08 10:29:00,933 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 10:29:00,933 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 10:29:00,933 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 10:29:02,046 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:29:02,046 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:29:02,048 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:29:02,048 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:29:02,078 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":"o...
2025-02-08 10:29:02,078 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:29:02,080 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": "offline",
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-08 10:29:02,080 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:29:02,080 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:29:02,080 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:29:02,261 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:29:02,261 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:29:02,261 - INFO - [printer_monitor_service.py:182] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 10:29:02,261 - DEBUG - [printer_monitor_service.py:189] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 10:29:02,279 - DEBUG - [printer_monitor_service.py:194] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 10:29:02,289 - INFO - [printer_monitor_service.py:199] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 10:29:02,289 - DEBUG - [printer_monitor_service.py:200] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:29:02,290 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:29:02,290 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:29:02,292 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:29:02,460 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:29:02,460 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:02,651 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:29:02,651 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:29:02,651 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:29:02,651 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:29:02,651 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:29:02,651 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:02,815 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:29:02,816 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:29:02,816 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:02,983 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:29:02,984 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:29:02,984 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:03,181 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:29:03,181 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:29:03,181 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:03,345 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:29:03,345 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:29:03,345 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:29:03,345 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:29:03,345 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:29:03,514 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:29:03,514 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:29:03,515 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:29:03,515 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:29:03,515 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:29:03,516 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:29:03,516 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:29:03,516 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:29:03,560 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":"o...
2025-02-08 10:29:03,561 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:29:03,561 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": "offline",
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-08 10:29:03,561 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:29:03,561 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:29:03,561 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:29:03,561 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:29:03.561217",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:29:03,611 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:29:03,611 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:29:03,611 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 10:29:03,611 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 10:29:03,611 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:29:03,785 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 10:29:03,785 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 10:29:03,785 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:29:03,785 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 10:29:03,790 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:29:03,790 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:29:04,005 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 10:29:04,005 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:04,174 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:29:04,174 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:29:04,174 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 10:29:04,174 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 10:29:04,174 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:29:04,174 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:04,336 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:29:04,336 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:29:04,340 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:04,539 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:29:04,539 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:29:04,539 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:04,691 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:29:04,691 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:29:04,691 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:29:04,870 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:29:04,874 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:29:04,874 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 10:29:04,874 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 10:29:04,874 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:29:05,033 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:29:05,033 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:29:05,033 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 10:29:05,033 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:29:05,039 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.41
2025-02-08 10:29:05,039 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:29:05,039 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:29:05,039 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:29:05,078 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":"offline","client_id":4},{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","statu...
2025-02-08 10:29:05,078 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:29:05,078 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": "offline",
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-08 10:29:05,086 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:29:05,086 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:29:05,086 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:29:05,086 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "Taller",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:29:05.086379",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:29:05,112 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 10:29:05,112 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 10:29:05,112 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:29:05,112 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:29:05,112 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:29:09,354 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:29:09,355 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:29:09,355 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:29:09,355 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:29:09,360 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:29:09,362 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:29:09,362 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:29:09,414 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:29:09,415 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:29:09,415 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-08 10:29:09,417 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:29:09,417 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:29:09,417 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:29:09,419 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "Taller",
  "brand": "Canon",
  "model": "ICR 3525",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:29:09.417626",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:29:09,450 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:29:09,451 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:29:20,937 - DEBUG - [protocol.py:599] - < PING 4d 18 64 b2 [binary, 4 bytes]
2025-02-08 10:29:20,937 - DEBUG - [protocol.py:745] - > PONG 4d 18 64 b2 [binary, 4 bytes]
2025-02-08 10:29:20,937 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:29:20,937 - DEBUG - [protocol.py:745] - > PING 18 93 3c f9 [binary, 4 bytes]
2025-02-08 10:29:20,937 - DEBUG - [protocol.py:599] - < PONG 18 93 3c f9 [binary, 4 bytes]
2025-02-08 10:29:20,944 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:29:40,933 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:29:40,934 - DEBUG - [protocol.py:745] - > PING c5 6e 80 76 [binary, 4 bytes]
2025-02-08 10:29:40,944 - DEBUG - [protocol.py:599] - < PONG c5 6e 80 76 [binary, 4 bytes]
2025-02-08 10:29:40,946 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:29:40,951 - DEBUG - [protocol.py:599] - < PING f9 ab 82 47 [binary, 4 bytes]
2025-02-08 10:29:40,955 - DEBUG - [protocol.py:745] - > PONG f9 ab 82 47 [binary, 4 bytes]
2025-02-08 10:30:00,936 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:30:00,936 - DEBUG - [protocol.py:745] - > PING 87 ca a5 83 [binary, 4 bytes]
2025-02-08 10:30:00,943 - DEBUG - [protocol.py:599] - < PONG 87 ca a5 83 [binary, 4 bytes]
2025-02-08 10:30:00,944 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:30:00,963 - DEBUG - [protocol.py:599] - < PING 0c af a5 a6 [binary, 4 bytes]
2025-02-08 10:30:00,964 - DEBUG - [protocol.py:745] - > PONG 0c af a5 a6 [binary, 4 bytes]
2025-02-08 10:30:20,948 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:30:20,951 - DEBUG - [protocol.py:745] - > PING 17 d8 7f f3 [binary, 4 bytes]
2025-02-08 10:30:20,953 - DEBUG - [protocol.py:599] - < PONG 17 d8 7f f3 [binary, 4 bytes]
2025-02-08 10:30:20,953 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:30:20,965 - DEBUG - [protocol.py:599] - < PING 13 a8 93 0a [binary, 4 bytes]
2025-02-08 10:30:20,965 - DEBUG - [protocol.py:745] - > PONG 13 a8 93 0a [binary, 4 bytes]
2025-02-08 10:30:40,981 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:30:40,982 - DEBUG - [protocol.py:745] - > PING 15 d1 fe bc [binary, 4 bytes]
2025-02-08 10:30:40,989 - DEBUG - [protocol.py:599] - < PING 8d 8f 85 cb [binary, 4 bytes]
2025-02-08 10:30:40,990 - DEBUG - [protocol.py:745] - > PONG 8d 8f 85 cb [binary, 4 bytes]
2025-02-08 10:30:40,993 - DEBUG - [protocol.py:599] - < PONG 15 d1 fe bc [binary, 4 bytes]
2025-02-08 10:30:40,995 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:31:00,981 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:31:00,981 - DEBUG - [protocol.py:745] - > PING 8f 75 b4 03 [binary, 4 bytes]
2025-02-08 10:31:00,987 - DEBUG - [protocol.py:599] - < PONG 8f 75 b4 03 [binary, 4 bytes]
2025-02-08 10:31:00,988 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:31:00,998 - DEBUG - [protocol.py:599] - < PING 34 25 b4 ea [binary, 4 bytes]
2025-02-08 10:31:00,999 - DEBUG - [protocol.py:745] - > PONG 34 25 b4 ea [binary, 4 bytes]
2025-02-08 10:31:20,990 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:31:20,991 - DEBUG - [protocol.py:745] - > PING f4 86 fc d9 [binary, 4 bytes]
2025-02-08 10:31:20,997 - DEBUG - [protocol.py:599] - < PONG f4 86 fc d9 [binary, 4 bytes]
2025-02-08 10:31:20,997 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:31:21,004 - DEBUG - [protocol.py:599] - < PING b4 c8 7a ae [binary, 4 bytes]
2025-02-08 10:31:21,006 - DEBUG - [protocol.py:745] - > PONG b4 c8 7a ae [binary, 4 bytes]
2025-02-08 10:31:41,003 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:31:41,005 - DEBUG - [protocol.py:745] - > PING c4 e3 a0 59 [binary, 4 bytes]
2025-02-08 10:31:41,013 - DEBUG - [protocol.py:599] - < PING 5d fd 3b d4 [binary, 4 bytes]
2025-02-08 10:31:41,013 - DEBUG - [protocol.py:745] - > PONG 5d fd 3b d4 [binary, 4 bytes]
2025-02-08 10:31:41,017 - DEBUG - [protocol.py:599] - < PONG c4 e3 a0 59 [binary, 4 bytes]
2025-02-08 10:31:41,020 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:32:01,022 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:32:01,023 - DEBUG - [protocol.py:745] - > PING eb 47 1c 00 [binary, 4 bytes]
2025-02-08 10:32:01,025 - DEBUG - [protocol.py:599] - < PING b1 f5 15 c8 [binary, 4 bytes]
2025-02-08 10:32:01,026 - DEBUG - [protocol.py:745] - > PONG b1 f5 15 c8 [binary, 4 bytes]
2025-02-08 10:32:01,026 - DEBUG - [protocol.py:599] - < PONG eb 47 1c 00 [binary, 4 bytes]
2025-02-08 10:32:01,029 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:32:21,031 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:32:21,033 - DEBUG - [protocol.py:745] - > PING 8b 74 6b e7 [binary, 4 bytes]
2025-02-08 10:32:21,036 - DEBUG - [protocol.py:599] - < PING fd 5b 7f 59 [binary, 4 bytes]
2025-02-08 10:32:21,037 - DEBUG - [protocol.py:745] - > PONG fd 5b 7f 59 [binary, 4 bytes]
2025-02-08 10:32:21,042 - DEBUG - [protocol.py:599] - < PONG 8b 74 6b e7 [binary, 4 bytes]
2025-02-08 10:32:21,043 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:32:41,040 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:32:41,042 - DEBUG - [protocol.py:745] - > PING 11 6c ea a4 [binary, 4 bytes]
2025-02-08 10:32:41,044 - DEBUG - [protocol.py:599] - < PING d5 dd 1c 97 [binary, 4 bytes]
2025-02-08 10:32:41,046 - DEBUG - [protocol.py:745] - > PONG d5 dd 1c 97 [binary, 4 bytes]
2025-02-08 10:32:41,050 - DEBUG - [protocol.py:599] - < PONG 11 6c ea a4 [binary, 4 bytes]
2025-02-08 10:32:41,052 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:33:01,051 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:33:01,051 - DEBUG - [protocol.py:745] - > PING 83 16 f2 4e [binary, 4 bytes]
2025-02-08 10:33:01,053 - DEBUG - [protocol.py:599] - < PING 14 b1 a8 f4 [binary, 4 bytes]
2025-02-08 10:33:01,053 - DEBUG - [protocol.py:745] - > PONG 14 b1 a8 f4 [binary, 4 bytes]
2025-02-08 10:33:01,059 - DEBUG - [protocol.py:599] - < PONG 83 16 f2 4e [binary, 4 bytes]
2025-02-08 10:33:01,060 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:33:21,059 - DEBUG - [protocol.py:599] - < PING 1a c4 41 53 [binary, 4 bytes]
2025-02-08 10:33:21,059 - DEBUG - [protocol.py:745] - > PONG 1a c4 41 53 [binary, 4 bytes]
2025-02-08 10:33:21,059 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:33:21,063 - DEBUG - [protocol.py:745] - > PING 53 dd ca 14 [binary, 4 bytes]
2025-02-08 10:33:21,068 - DEBUG - [protocol.py:599] - < PONG 53 dd ca 14 [binary, 4 bytes]
2025-02-08 10:33:21,070 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:33:41,063 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:33:41,063 - DEBUG - [protocol.py:745] - > PING cf 0f 2a 3c [binary, 4 bytes]
2025-02-08 10:33:41,068 - DEBUG - [protocol.py:599] - < PING 66 c5 7f 95 [binary, 4 bytes]
2025-02-08 10:33:41,068 - DEBUG - [protocol.py:745] - > PONG 66 c5 7f 95 [binary, 4 bytes]
2025-02-08 10:33:41,073 - DEBUG - [protocol.py:599] - < PONG cf 0f 2a 3c [binary, 4 bytes]
2025-02-08 10:33:41,073 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:34:01,074 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:34:01,076 - DEBUG - [protocol.py:745] - > PING f8 1e be 37 [binary, 4 bytes]
2025-02-08 10:34:01,079 - DEBUG - [protocol.py:599] - < PING '&~@\x06' [text, 4 bytes]
2025-02-08 10:34:01,080 - DEBUG - [protocol.py:745] - > PONG '&~@\x06' [text, 4 bytes]
2025-02-08 10:34:01,084 - DEBUG - [protocol.py:599] - < PONG f8 1e be 37 [binary, 4 bytes]
2025-02-08 10:34:01,086 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:34:10,567 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:34:10,567 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:34:10,568 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:34:10,569 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:34:10,608 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:34:10,609 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:34:10,610 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:34:10,613 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:34:10,614 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:34:10,614 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:34:10,800 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:34:10,800 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:34:10,801 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:34:10,801 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:34:10,801 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:34:10,801 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:34:10,964 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:34:10,965 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:11,228 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:34:11,229 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:34:11,229 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:34:11,229 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:34:11,229 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:34:11,231 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:11,408 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:34:11,409 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:34:11,409 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:11,602 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:34:11,602 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:34:11,603 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:11,808 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:34:11,808 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:34:11,809 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:11,970 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:34:11,970 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:34:11,971 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:34:11,971 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:34:11,971 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:34:12,132 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:34:12,132 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:34:12,133 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:34:12,133 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:34:12,133 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:34:12,134 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:34:12,134 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:34:12,134 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:34:12,165 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:34:12,166 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:34:12,166 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:34:12,168 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:34:12,168 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:34:12,169 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:34:12,169 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:34:12.168159",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:34:12,199 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:34:12,200 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:34:12,200 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 10:34:12,201 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 10:34:12,201 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:34:12,362 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 10:34:12,363 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 10:34:12,364 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:34:12,364 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 10:34:12,365 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:34:12,365 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:34:12,582 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 10:34:12,583 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:12,745 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:34:12,745 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:34:12,745 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 10:34:12,746 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 10:34:12,746 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:34:12,747 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:12,903 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:34:12,904 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:34:12,904 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:13,091 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:34:13,092 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:34:13,092 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:13,258 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:34:13,259 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:34:13,260 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:34:13,415 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:34:13,415 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:34:13,416 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 10:34:13,416 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 10:34:13,416 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:34:13,566 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:34:13,568 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:34:13,568 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 10:34:13,569 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:34:13,569 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.41
2025-02-08 10:34:13,570 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:34:13,570 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:34:13,570 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:34:13,603 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:34:13,603 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:34:13,604 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:34:13,605 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:34:13,605 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:34:13,606 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:34:13,606 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "Taller",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:34:13.605628",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:34:13,640 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 10:34:13,641 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 10:34:13,642 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:34:13,642 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:34:13,642 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:34:17,896 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:34:17,898 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:34:17,899 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:34:17,900 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:34:17,901 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:34:17,902 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:34:17,903 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:34:17,947 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:34:17,947 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:34:17,948 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:34:17,950 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:34:17,951 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:34:17,951 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:34:17,951 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "Taller",
  "brand": "Canon",
  "model": "ICR 3525",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:34:17.950436",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:34:17,983 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:34:17,984 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:34:21,082 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:34:21,083 - DEBUG - [protocol.py:745] - > PING a9 ff b8 42 [binary, 4 bytes]
2025-02-08 10:34:21,090 - DEBUG - [protocol.py:599] - < PING c4 a0 ad 28 [binary, 4 bytes]
2025-02-08 10:34:21,092 - DEBUG - [protocol.py:745] - > PONG c4 a0 ad 28 [binary, 4 bytes]
2025-02-08 10:34:21,095 - DEBUG - [protocol.py:599] - < PONG a9 ff b8 42 [binary, 4 bytes]
2025-02-08 10:34:21,097 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:34:41,100 - DEBUG - [protocol.py:599] - < PING 4e 90 54 b7 [binary, 4 bytes]
2025-02-08 10:34:41,102 - DEBUG - [protocol.py:745] - > PONG 4e 90 54 b7 [binary, 4 bytes]
2025-02-08 10:34:41,104 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:34:41,105 - DEBUG - [protocol.py:745] - > PING d4 a0 eb 4d [binary, 4 bytes]
2025-02-08 10:34:41,111 - DEBUG - [protocol.py:599] - < PONG d4 a0 eb 4d [binary, 4 bytes]
2025-02-08 10:34:41,112 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:35:01,108 - DEBUG - [protocol.py:599] - < PING 'UoǪ' [text, 4 bytes]
2025-02-08 10:35:01,110 - DEBUG - [protocol.py:745] - > PONG 'UoǪ' [text, 4 bytes]
2025-02-08 10:35:01,135 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:35:01,136 - DEBUG - [protocol.py:745] - > PING f2 16 8f 2e [binary, 4 bytes]
2025-02-08 10:35:01,143 - DEBUG - [protocol.py:599] - < PONG f2 16 8f 2e [binary, 4 bytes]
2025-02-08 10:35:01,144 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:35:21,118 - DEBUG - [protocol.py:599] - < PING 86 28 ba c4 [binary, 4 bytes]
2025-02-08 10:35:21,120 - DEBUG - [protocol.py:745] - > PONG 86 28 ba c4 [binary, 4 bytes]
2025-02-08 10:35:21,149 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:35:21,151 - DEBUG - [protocol.py:745] - > PING d0 cc 53 cf [binary, 4 bytes]
2025-02-08 10:35:21,157 - DEBUG - [protocol.py:599] - < PONG d0 cc 53 cf [binary, 4 bytes]
2025-02-08 10:35:21,159 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:35:41,128 - DEBUG - [protocol.py:599] - < PING 02 88 28 57 [binary, 4 bytes]
2025-02-08 10:35:41,129 - DEBUG - [protocol.py:745] - > PONG 02 88 28 57 [binary, 4 bytes]
2025-02-08 10:35:41,130 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:35:41,130 - DEBUG - [protocol.py:745] - > PING 7d 4c 35 a7 [binary, 4 bytes]
2025-02-08 10:35:41,135 - DEBUG - [protocol.py:599] - < PONG 7d 4c 35 a7 [binary, 4 bytes]
2025-02-08 10:35:41,136 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:36:01,120 - DEBUG - [protocol.py:599] - < PING '\x13l\x1c$' [text, 4 bytes]
2025-02-08 10:36:01,136 - DEBUG - [protocol.py:745] - > PONG '\x13l\x1c$' [text, 4 bytes]
2025-02-08 10:36:01,138 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:36:01,138 - DEBUG - [protocol.py:745] - > PING bb 6e b4 69 [binary, 4 bytes]
2025-02-08 10:36:01,138 - DEBUG - [protocol.py:599] - < PONG bb 6e b4 69 [binary, 4 bytes]
2025-02-08 10:36:01,138 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:36:21,138 - DEBUG - [protocol.py:599] - < PING 3e e0 45 d5 [binary, 4 bytes]
2025-02-08 10:36:21,138 - DEBUG - [protocol.py:745] - > PONG 3e e0 45 d5 [binary, 4 bytes]
2025-02-08 10:36:21,147 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:36:21,149 - DEBUG - [protocol.py:745] - > PING 48 92 3e e8 [binary, 4 bytes]
2025-02-08 10:36:21,153 - DEBUG - [protocol.py:599] - < PONG 48 92 3e e8 [binary, 4 bytes]
2025-02-08 10:36:21,155 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:36:41,154 - DEBUG - [protocol.py:599] - < PING '¡\x1b2' [text, 4 bytes]
2025-02-08 10:36:41,157 - DEBUG - [protocol.py:745] - > PONG '¡\x1b2' [text, 4 bytes]
2025-02-08 10:36:41,159 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:36:41,159 - DEBUG - [protocol.py:745] - > PING fb 7e 48 80 [binary, 4 bytes]
2025-02-08 10:36:41,164 - DEBUG - [protocol.py:599] - < PONG fb 7e 48 80 [binary, 4 bytes]
2025-02-08 10:36:41,164 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:37:01,164 - DEBUG - [protocol.py:599] - < PING cc 8c fe c1 [binary, 4 bytes]
2025-02-08 10:37:01,165 - DEBUG - [protocol.py:745] - > PONG cc 8c fe c1 [binary, 4 bytes]
2025-02-08 10:37:01,168 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:37:01,170 - DEBUG - [protocol.py:745] - > PING 1e b8 16 35 [binary, 4 bytes]
2025-02-08 10:37:01,177 - DEBUG - [protocol.py:599] - < PONG 1e b8 16 35 [binary, 4 bytes]
2025-02-08 10:37:01,179 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:37:21,171 - DEBUG - [protocol.py:599] - < PING d4 35 e0 6e [binary, 4 bytes]
2025-02-08 10:37:21,172 - DEBUG - [protocol.py:745] - > PONG d4 35 e0 6e [binary, 4 bytes]
2025-02-08 10:37:21,176 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:37:21,179 - DEBUG - [protocol.py:745] - > PING 10 ea 63 79 [binary, 4 bytes]
2025-02-08 10:37:21,187 - DEBUG - [protocol.py:599] - < PONG 10 ea 63 79 [binary, 4 bytes]
2025-02-08 10:37:21,188 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:37:41,182 - DEBUG - [protocol.py:599] - < PING d3 7b a4 28 [binary, 4 bytes]
2025-02-08 10:37:41,185 - DEBUG - [protocol.py:745] - > PONG d3 7b a4 28 [binary, 4 bytes]
2025-02-08 10:37:41,186 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:37:41,188 - DEBUG - [protocol.py:745] - > PING b3 17 06 5e [binary, 4 bytes]
2025-02-08 10:37:41,196 - DEBUG - [protocol.py:599] - < PONG b3 17 06 5e [binary, 4 bytes]
2025-02-08 10:37:41,199 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:38:01,197 - DEBUG - [protocol.py:599] - < PING 'p\n\x16B' [text, 4 bytes]
2025-02-08 10:38:01,198 - DEBUG - [protocol.py:745] - > PONG 'p\n\x16B' [text, 4 bytes]
2025-02-08 10:38:01,201 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:38:01,202 - DEBUG - [protocol.py:745] - > PING 05 98 4b b6 [binary, 4 bytes]
2025-02-08 10:38:01,210 - DEBUG - [protocol.py:599] - < PONG 05 98 4b b6 [binary, 4 bytes]
2025-02-08 10:38:01,212 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:38:21,206 - DEBUG - [protocol.py:599] - < PING 5d ea 24 5d [binary, 4 bytes]
2025-02-08 10:38:21,208 - DEBUG - [protocol.py:745] - > PONG 5d ea 24 5d [binary, 4 bytes]
2025-02-08 10:38:21,210 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:38:21,211 - DEBUG - [protocol.py:745] - > PING ec ca 34 45 [binary, 4 bytes]
2025-02-08 10:38:21,217 - DEBUG - [protocol.py:599] - < PONG ec ca 34 45 [binary, 4 bytes]
2025-02-08 10:38:21,218 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:38:41,218 - DEBUG - [protocol.py:599] - < PING 87 58 47 38 [binary, 4 bytes]
2025-02-08 10:38:41,220 - DEBUG - [protocol.py:745] - > PONG 87 58 47 38 [binary, 4 bytes]
2025-02-08 10:38:41,220 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:38:41,223 - DEBUG - [protocol.py:745] - > PING f2 ef 67 cc [binary, 4 bytes]
2025-02-08 10:38:41,467 - DEBUG - [protocol.py:599] - < PONG f2 ef 67 cc [binary, 4 bytes]
2025-02-08 10:38:41,468 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:39:01,229 - DEBUG - [protocol.py:599] - < PING 30 66 25 b4 [binary, 4 bytes]
2025-02-08 10:39:01,230 - DEBUG - [protocol.py:745] - > PONG 30 66 25 b4 [binary, 4 bytes]
2025-02-08 10:39:01,231 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:39:01,232 - DEBUG - [protocol.py:745] - > PING 8c 54 cc 94 [binary, 4 bytes]
2025-02-08 10:39:01,241 - DEBUG - [protocol.py:599] - < PONG 8c 54 cc 94 [binary, 4 bytes]
2025-02-08 10:39:01,242 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:39:19,093 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:39:19,095 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:39:19,096 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:39:19,098 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:39:19,137 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:39:19,139 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:39:19,140 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:39:19,144 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:39:19,145 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:39:19,147 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:39:19,325 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:39:19,326 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:39:19,326 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:39:19,327 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:39:19,327 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:39:19,327 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:39:19,489 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:39:19,489 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:19,683 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:39:19,684 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:39:19,684 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:39:19,684 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:39:19,686 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:39:19,686 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:19,842 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:39:19,843 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:39:19,843 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:19,998 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:39:19,998 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:39:19,999 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:20,158 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:39:20,159 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:39:20,159 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:20,357 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:39:20,358 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:39:20,358 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:39:20,359 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:39:20,359 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:39:20,510 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:39:20,511 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:39:20,511 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:39:20,511 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:39:20,512 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:39:20,512 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:39:20,512 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:39:20,514 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:39:20,550 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:39:20,551 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:39:20,552 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:39:20,554 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:39:20,557 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:39:20,558 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:39:20,559 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:39:20.554893",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:39:20,591 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:39:20,591 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:39:20,592 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 10:39:20,593 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 10:39:20,593 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:39:20,751 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 10:39:20,752 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 10:39:20,752 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:39:20,753 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 10:39:20,753 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:39:20,753 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:39:20,950 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 10:39:20,951 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:21,107 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:39:21,108 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:39:21,108 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 10:39:21,108 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 10:39:21,108 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:39:21,109 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:21,265 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:39:21,265 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:39:21,265 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:21,435 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:39:21,435 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:39:21,435 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:21,626 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:39:21,627 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:39:21,628 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:39:21,777 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:39:21,778 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:39:21,778 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 10:39:21,778 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 10:39:21,778 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:39:21,931 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:39:21,931 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:39:21,931 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 10:39:21,931 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:39:21,933 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.41
2025-02-08 10:39:21,933 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:39:21,933 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:39:21,934 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:39:21,934 - DEBUG - [protocol.py:599] - < PING 31 fa 87 d8 [binary, 4 bytes]
2025-02-08 10:39:21,935 - DEBUG - [protocol.py:745] - > PONG 31 fa 87 d8 [binary, 4 bytes]
2025-02-08 10:39:21,935 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:39:21,935 - DEBUG - [protocol.py:745] - > PING 98 63 d7 5f [binary, 4 bytes]
2025-02-08 10:39:21,943 - DEBUG - [protocol.py:599] - < PONG 98 63 d7 5f [binary, 4 bytes]
2025-02-08 10:39:21,944 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:39:21,972 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":null,"client_id":4},{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":nu...
2025-02-08 10:39:21,973 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:39:21,975 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:39:21,978 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:39:21,979 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:39:21,980 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:39:21,981 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "Taller",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:39:21.977385",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:39:22,048 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 10:39:22,049 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 10:39:22,050 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:39:22,051 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:39:22,052 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:39:26,315 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:39:26,316 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:39:26,317 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:39:26,318 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:39:26,320 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:39:26,321 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:39:26,321 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:39:26,365 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:39:26,366 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:39:26,367 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:39:26,369 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:39:26,370 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:39:26,370 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:39:26,371 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "Taller",
  "brand": "Canon",
  "model": "ICR 3525",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:39:26.369678",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:39:26,621 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:39:26,625 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:39:41,942 - DEBUG - [protocol.py:599] - < PING bf de 3b 2e [binary, 4 bytes]
2025-02-08 10:39:41,943 - DEBUG - [protocol.py:745] - > PONG bf de 3b 2e [binary, 4 bytes]
2025-02-08 10:39:41,946 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:39:41,947 - DEBUG - [protocol.py:745] - > PING ee 5e ec c3 [binary, 4 bytes]
2025-02-08 10:39:41,952 - DEBUG - [protocol.py:599] - < PONG ee 5e ec c3 [binary, 4 bytes]
2025-02-08 10:39:41,953 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:40:01,951 - DEBUG - [protocol.py:599] - < PING 81 a9 2a ff [binary, 4 bytes]
2025-02-08 10:40:01,951 - DEBUG - [protocol.py:745] - > PONG 81 a9 2a ff [binary, 4 bytes]
2025-02-08 10:40:01,951 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:40:01,953 - DEBUG - [protocol.py:745] - > PING f0 7c c5 de [binary, 4 bytes]
2025-02-08 10:40:01,958 - DEBUG - [protocol.py:599] - < PONG f0 7c c5 de [binary, 4 bytes]
2025-02-08 10:40:01,959 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:40:21,955 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:40:21,957 - DEBUG - [protocol.py:745] - > PING 28 0c 0f c4 [binary, 4 bytes]
2025-02-08 10:40:21,960 - DEBUG - [protocol.py:599] - < PING 1f d6 ce 44 [binary, 4 bytes]
2025-02-08 10:40:21,962 - DEBUG - [protocol.py:745] - > PONG 1f d6 ce 44 [binary, 4 bytes]
2025-02-08 10:40:21,967 - DEBUG - [protocol.py:599] - < PONG 28 0c 0f c4 [binary, 4 bytes]
2025-02-08 10:40:21,969 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:40:41,970 - DEBUG - [protocol.py:599] - < PING 99 71 a9 3b [binary, 4 bytes]
2025-02-08 10:40:41,973 - DEBUG - [protocol.py:745] - > PONG 99 71 a9 3b [binary, 4 bytes]
2025-02-08 10:40:41,975 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:40:41,978 - DEBUG - [protocol.py:745] - > PING b2 2c 5b 72 [binary, 4 bytes]
2025-02-08 10:40:41,985 - DEBUG - [protocol.py:599] - < PONG b2 2c 5b 72 [binary, 4 bytes]
2025-02-08 10:40:41,988 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:41:01,982 - DEBUG - [protocol.py:599] - < PING 5d d1 c5 3a [binary, 4 bytes]
2025-02-08 10:41:01,982 - DEBUG - [protocol.py:745] - > PONG 5d d1 c5 3a [binary, 4 bytes]
2025-02-08 10:41:02,005 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:41:02,005 - DEBUG - [protocol.py:745] - > PING e9 75 f2 89 [binary, 4 bytes]
2025-02-08 10:41:02,010 - DEBUG - [protocol.py:599] - < PONG e9 75 f2 89 [binary, 4 bytes]
2025-02-08 10:41:02,010 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:41:19,598 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:41:19,600 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 10:41:19,603 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:41:19,603 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 10:41:19,609 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 10:41:19,611 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 10:41:19,612 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 10:41:24,240 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 10:41:24,241 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 10:41:24,242 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 10:41:24,242 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 10:41:24,242 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 10:41:24,242 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 10:41:24,242 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 10:41:24,242 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 10:41:24,242 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 10:41:24,242 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 10:41:24,242 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 10:41:24,289 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 10:41:24,290 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 10:41:24,290 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 10:41:24,290 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 10:41:24,290 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 10:41:24,290 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: W+8AanU5QCUEeN3Y26qGkA==
2025-02-08 10:41:24,290 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 10:41:24,290 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 10:41:24,290 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 10:41:24,309 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 10:41:24,309 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 10:41:24,312 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 10:41:24,312 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: MuzwwcEDkeB1lvR1PI6QHRTd0To=
2025-02-08 10:41:24,312 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 10:41:24,312 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 15:41:22 GMT
2025-02-08 10:41:24,312 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 10:41:24,315 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 10:41:24,315 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 10:41:25,385 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:41:25,385 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:41:25,392 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:41:25,392 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:41:25,422 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:41:25,422 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:41:25,422 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:41:25,422 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:41:25,422 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:41:25,422 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:41:25,600 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:41:25,600 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:41:25,600 - INFO - [printer_monitor_service.py:182] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 10:41:25,600 - DEBUG - [printer_monitor_service.py:189] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 10:41:25,634 - DEBUG - [printer_monitor_service.py:194] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 10:41:25,634 - INFO - [printer_monitor_service.py:199] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 10:41:25,634 - DEBUG - [printer_monitor_service.py:200] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:41:25,636 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:41:25,636 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:41:25,636 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:41:25,801 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:41:25,801 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:25,985 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:41:25,985 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:41:25,985 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:41:25,985 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:41:25,985 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:41:25,985 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:26,174 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:41:26,174 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:41:26,174 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:26,334 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:41:26,334 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:41:26,334 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:26,561 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:41:26,562 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:41:26,562 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:26,773 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:41:26,778 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:41:26,778 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:41:26,778 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:41:26,779 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:41:26,942 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:41:26,942 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:41:26,942 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:41:26,942 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:41:26,946 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:41:26,946 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:41:26,946 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:41:26,946 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:41:26,976 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:41:26,976 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:41:26,982 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:41:26,985 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:41:26,986 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:41:26,988 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:41:26,990 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:41:26.985248",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:41:27,020 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:41:27,020 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:41:27,020 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 10:41:27,020 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 10:41:27,020 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:41:27,201 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 10:41:27,201 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 10:41:27,202 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:41:27,202 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 10:41:27,202 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:41:27,203 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:41:27,423 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 10:41:27,424 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:27,608 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:41:27,608 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:41:27,608 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 10:41:27,608 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 10:41:27,608 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:41:27,608 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:27,809 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:41:27,809 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:41:27,809 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:28,027 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:41:28,028 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:41:28,028 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:28,197 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:41:28,198 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:41:28,198 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:41:28,369 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:41:28,370 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:41:28,370 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 10:41:28,370 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 10:41:28,371 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:41:28,533 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:41:28,533 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:41:28,536 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 10:41:28,536 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:41:28,537 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.41
2025-02-08 10:41:28,537 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:41:28,537 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:41:28,537 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:41:28,572 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":null,"client_id":4},{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":nu...
2025-02-08 10:41:28,572 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:41:28,572 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:41:28,572 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:41:28,577 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:41:28,577 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:41:28,577 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "Taller",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:41:28.572610",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:41:28,612 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 10:41:28,613 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 10:41:28,613 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:41:28,613 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:41:28,613 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:41:32,889 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:41:32,891 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:41:32,892 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:41:32,892 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:41:32,895 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:41:32,895 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:41:32,895 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:41:32,956 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:41:32,956 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:41:32,956 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:41:32,956 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:41:32,956 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:41:32,956 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:41:32,956 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "Taller",
  "brand": "Canon",
  "model": "ICR 3525",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:41:32.956393",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:41:33,000 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:41:33,003 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:41:44,311 - DEBUG - [protocol.py:599] - < PING e5 50 1d d8 [binary, 4 bytes]
2025-02-08 10:41:44,311 - DEBUG - [protocol.py:745] - > PONG e5 50 1d d8 [binary, 4 bytes]
2025-02-08 10:41:44,344 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:41:44,347 - DEBUG - [protocol.py:745] - > PING '~_\x7f&' [text, 4 bytes]
2025-02-08 10:41:44,357 - DEBUG - [protocol.py:599] - < PONG '~_\x7f&' [text, 4 bytes]
2025-02-08 10:41:44,362 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:42:04,323 - DEBUG - [protocol.py:599] - < PING 71 0f 6d b6 [binary, 4 bytes]
2025-02-08 10:42:04,323 - DEBUG - [protocol.py:745] - > PONG 71 0f 6d b6 [binary, 4 bytes]
2025-02-08 10:42:04,378 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:42:04,381 - DEBUG - [protocol.py:745] - > PING 0e d2 9a fb [binary, 4 bytes]
2025-02-08 10:42:04,394 - DEBUG - [protocol.py:599] - < PONG 0e d2 9a fb [binary, 4 bytes]
2025-02-08 10:42:04,394 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:42:24,335 - DEBUG - [protocol.py:599] - < PING 00 f4 06 f9 [binary, 4 bytes]
2025-02-08 10:42:24,337 - DEBUG - [protocol.py:745] - > PONG 00 f4 06 f9 [binary, 4 bytes]
2025-02-08 10:42:24,399 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:42:24,401 - DEBUG - [protocol.py:745] - > PING 14 89 63 9a [binary, 4 bytes]
2025-02-08 10:42:24,401 - DEBUG - [protocol.py:599] - < PONG 14 89 63 9a [binary, 4 bytes]
2025-02-08 10:42:24,401 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:42:44,344 - DEBUG - [protocol.py:599] - < PING bf c2 3b c8 [binary, 4 bytes]
2025-02-08 10:42:44,347 - DEBUG - [protocol.py:745] - > PONG bf c2 3b c8 [binary, 4 bytes]
2025-02-08 10:42:44,395 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:42:44,398 - DEBUG - [protocol.py:745] - > PING d5 c9 9e 4d [binary, 4 bytes]
2025-02-08 10:42:44,398 - DEBUG - [protocol.py:599] - < PONG d5 c9 9e 4d [binary, 4 bytes]
2025-02-08 10:42:44,398 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:43:04,347 - DEBUG - [protocol.py:599] - < PING b8 7a f1 7f [binary, 4 bytes]
2025-02-08 10:43:04,359 - DEBUG - [protocol.py:745] - > PONG b8 7a f1 7f [binary, 4 bytes]
2025-02-08 10:43:04,407 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:43:04,415 - DEBUG - [protocol.py:745] - > PING 09 e4 d1 44 [binary, 4 bytes]
2025-02-08 10:43:04,424 - DEBUG - [protocol.py:599] - < PONG 09 e4 d1 44 [binary, 4 bytes]
2025-02-08 10:43:04,432 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:43:24,373 - DEBUG - [protocol.py:599] - < PING 1e e5 a5 ec [binary, 4 bytes]
2025-02-08 10:43:24,375 - DEBUG - [protocol.py:745] - > PONG 1e e5 a5 ec [binary, 4 bytes]
2025-02-08 10:43:24,431 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:43:24,437 - DEBUG - [protocol.py:745] - > PING e9 b2 ce 06 [binary, 4 bytes]
2025-02-08 10:43:24,446 - DEBUG - [protocol.py:599] - < PONG e9 b2 ce 06 [binary, 4 bytes]
2025-02-08 10:43:24,447 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:43:44,383 - DEBUG - [protocol.py:599] - < PING da 66 3c b8 [binary, 4 bytes]
2025-02-08 10:43:44,384 - DEBUG - [protocol.py:745] - > PONG da 66 3c b8 [binary, 4 bytes]
2025-02-08 10:43:44,436 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:43:44,438 - DEBUG - [protocol.py:745] - > PING ba 72 58 4f [binary, 4 bytes]
2025-02-08 10:43:44,447 - DEBUG - [protocol.py:599] - < PONG ba 72 58 4f [binary, 4 bytes]
2025-02-08 10:43:44,450 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:43:59,848 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:43:59,848 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 10:43:59,859 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:43:59,862 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 10:43:59,864 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 10:43:59,868 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 10:43:59,873 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 10:44:04,263 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 10:44:04,265 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 10:44:04,265 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 10:44:04,265 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 10:44:04,266 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 10:44:04,266 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 10:44:04,266 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 10:44:04,266 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 10:44:04,266 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 10:44:04,266 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 10:44:04,266 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 10:44:04,317 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 10:44:04,318 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 10:44:04,319 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 10:44:04,319 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 10:44:04,319 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 10:44:04,319 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: TkLZMyzJXtnEjM2qxV96uQ==
2025-02-08 10:44:04,321 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 10:44:04,321 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 10:44:04,321 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 10:44:04,373 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 10:44:04,373 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 10:44:04,373 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 10:44:04,375 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: NY9feP5xBHUdcdrSQ3Pk4lfMkZo=
2025-02-08 10:44:04,375 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 10:44:04,375 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 15:44:03 GMT
2025-02-08 10:44:04,375 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 10:44:04,375 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 10:44:04,376 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 10:44:05,484 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:44:05,484 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:44:05,484 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:44:05,499 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:44:05,535 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:44:05,536 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:44:05,538 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:44:05,539 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:44:05,540 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:44:05,541 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:44:05,713 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:44:05,713 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:44:05,713 - INFO - [printer_monitor_service.py:182] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 10:44:05,713 - DEBUG - [printer_monitor_service.py:189] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 10:44:05,739 - DEBUG - [printer_monitor_service.py:194] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 10:44:05,739 - INFO - [printer_monitor_service.py:199] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 10:44:05,739 - DEBUG - [printer_monitor_service.py:200] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:44:05,745 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:44:05,745 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:44:05,745 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:44:05,908 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:44:05,908 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:06,100 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:44:06,100 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:44:06,100 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:44:06,100 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:44:06,100 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:44:06,100 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:06,261 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:44:06,261 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:44:06,261 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:06,418 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:44:06,418 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:44:06,418 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:06,615 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:44:06,615 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:44:06,615 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:06,776 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:44:06,776 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:44:06,776 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:44:06,776 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:44:06,776 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:44:06,934 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:44:06,934 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:44:06,934 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:44:06,934 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:44:06,934 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:44:06,934 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:44:06,934 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:44:06,940 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:44:06,970 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:44:06,970 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:44:06,970 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:44:06,975 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:44:06,975 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:44:06,976 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:44:06,976 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:44:06.975666",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:44:07,002 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:44:07,014 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:44:07,014 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 10:44:07,014 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 10:44:07,014 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:44:07,170 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 10:44:07,170 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 10:44:07,170 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:44:07,170 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 10:44:07,170 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:44:07,170 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:44:07,375 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 10:44:07,375 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:07,534 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:44:07,534 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:44:07,534 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 10:44:07,537 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 10:44:07,537 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:44:07,537 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:07,694 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:44:07,694 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:44:07,694 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:07,891 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:44:07,891 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:44:07,891 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:08,050 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:44:08,050 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:44:08,050 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:44:08,211 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:44:08,211 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:44:08,211 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 10:44:08,213 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 10:44:08,213 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:44:08,367 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:44:08,369 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:44:08,369 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 10:44:08,369 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:44:08,369 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.41
2025-02-08 10:44:08,369 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:44:08,369 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:44:08,369 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:44:08,401 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":null,"client_id":4},{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":nu...
2025-02-08 10:44:08,401 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:44:08,401 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:44:08,404 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:44:08,404 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:44:08,405 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:44:08,405 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "Taller",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:44:08.404796",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:44:08,437 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 10:44:08,437 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 10:44:08,438 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:44:08,438 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:44:08,438 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:44:12,721 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:44:12,721 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:44:12,721 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:44:12,721 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:44:12,723 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:44:12,723 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:44:12,723 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:44:12,753 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:44:12,753 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:44:12,753 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:44:12,754 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:44:12,755 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:44:12,755 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:44:12,755 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "Taller",
  "brand": "Canon",
  "model": "ICR 3525",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:44:12.754962",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:44:12,793 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:44:12,793 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:44:24,363 - DEBUG - [protocol.py:599] - < PING 74 9b dc 2e [binary, 4 bytes]
2025-02-08 10:44:24,364 - DEBUG - [protocol.py:745] - > PONG 74 9b dc 2e [binary, 4 bytes]
2025-02-08 10:44:24,367 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:44:24,367 - DEBUG - [protocol.py:745] - > PING fe ea 8a 60 [binary, 4 bytes]
2025-02-08 10:44:24,373 - DEBUG - [protocol.py:599] - < PONG fe ea 8a 60 [binary, 4 bytes]
2025-02-08 10:44:24,373 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:44:44,374 - DEBUG - [protocol.py:599] - < PING 01 37 9c 6e [binary, 4 bytes]
2025-02-08 10:44:44,378 - DEBUG - [protocol.py:745] - > PONG 01 37 9c 6e [binary, 4 bytes]
2025-02-08 10:44:44,380 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:44:44,381 - DEBUG - [protocol.py:745] - > PING 0e e8 55 a7 [binary, 4 bytes]
2025-02-08 10:44:44,393 - DEBUG - [protocol.py:599] - < PONG 0e e8 55 a7 [binary, 4 bytes]
2025-02-08 10:44:44,395 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:45:04,381 - DEBUG - [protocol.py:599] - < PING f0 30 21 80 [binary, 4 bytes]
2025-02-08 10:45:04,381 - DEBUG - [protocol.py:745] - > PONG f0 30 21 80 [binary, 4 bytes]
2025-02-08 10:45:04,381 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:45:04,381 - DEBUG - [protocol.py:745] - > PING 'Wʀ)' [text, 4 bytes]
2025-02-08 10:45:04,623 - DEBUG - [protocol.py:599] - < PONG 'Wʀ)' [text, 4 bytes]
2025-02-08 10:45:04,623 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:45:24,393 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:45:24,393 - DEBUG - [protocol.py:745] - > PING 8b dc 7f 79 [binary, 4 bytes]
2025-02-08 10:45:24,398 - DEBUG - [protocol.py:599] - < PING 01 77 cf 6f [binary, 4 bytes]
2025-02-08 10:45:24,398 - DEBUG - [protocol.py:745] - > PONG 01 77 cf 6f [binary, 4 bytes]
2025-02-08 10:45:24,404 - DEBUG - [protocol.py:599] - < PONG 8b dc 7f 79 [binary, 4 bytes]
2025-02-08 10:45:24,406 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:45:44,382 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:45:44,382 - DEBUG - [protocol.py:745] - > PING d2 69 f7 75 [binary, 4 bytes]
2025-02-08 10:45:44,390 - DEBUG - [protocol.py:599] - < PONG d2 69 f7 75 [binary, 4 bytes]
2025-02-08 10:45:44,391 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:45:44,410 - DEBUG - [protocol.py:599] - < PING 0b ec 96 3d [binary, 4 bytes]
2025-02-08 10:45:44,413 - DEBUG - [protocol.py:745] - > PONG 0b ec 96 3d [binary, 4 bytes]
2025-02-08 10:46:04,391 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:46:04,393 - DEBUG - [protocol.py:745] - > PING f8 9a 2e 8f [binary, 4 bytes]
2025-02-08 10:46:04,402 - DEBUG - [protocol.py:599] - < PONG f8 9a 2e 8f [binary, 4 bytes]
2025-02-08 10:46:04,404 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:46:04,424 - DEBUG - [protocol.py:599] - < PING 38 fe 37 cc [binary, 4 bytes]
2025-02-08 10:46:04,425 - DEBUG - [protocol.py:745] - > PONG 38 fe 37 cc [binary, 4 bytes]
2025-02-08 10:46:24,389 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:46:24,389 - DEBUG - [protocol.py:745] - > PING 5d 0a aa ec [binary, 4 bytes]
2025-02-08 10:46:24,394 - DEBUG - [protocol.py:599] - < PONG 5d 0a aa ec [binary, 4 bytes]
2025-02-08 10:46:24,394 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:46:24,430 - DEBUG - [protocol.py:599] - < PING 93 5b b7 14 [binary, 4 bytes]
2025-02-08 10:46:24,434 - DEBUG - [protocol.py:745] - > PONG 93 5b b7 14 [binary, 4 bytes]
2025-02-08 10:46:44,402 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:46:44,403 - DEBUG - [protocol.py:745] - > PING 87 b5 ed 40 [binary, 4 bytes]
2025-02-08 10:46:44,410 - DEBUG - [protocol.py:599] - < PONG 87 b5 ed 40 [binary, 4 bytes]
2025-02-08 10:46:44,413 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:46:44,440 - DEBUG - [protocol.py:599] - < PING c0 c3 61 d4 [binary, 4 bytes]
2025-02-08 10:46:44,441 - DEBUG - [protocol.py:745] - > PONG c0 c3 61 d4 [binary, 4 bytes]
2025-02-08 10:47:04,411 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:47:04,412 - DEBUG - [protocol.py:745] - > PING a3 c2 c8 49 [binary, 4 bytes]
2025-02-08 10:47:04,416 - DEBUG - [protocol.py:599] - < PONG a3 c2 c8 49 [binary, 4 bytes]
2025-02-08 10:47:04,416 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:47:04,447 - DEBUG - [protocol.py:599] - < PING 73 99 08 c0 [binary, 4 bytes]
2025-02-08 10:47:04,449 - DEBUG - [protocol.py:745] - > PONG 73 99 08 c0 [binary, 4 bytes]
2025-02-08 10:47:24,434 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:47:24,435 - DEBUG - [protocol.py:745] - > PING 't(ý' [text, 4 bytes]
2025-02-08 10:47:24,440 - DEBUG - [protocol.py:599] - < PONG 't(ý' [text, 4 bytes]
2025-02-08 10:47:24,441 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:47:24,457 - DEBUG - [protocol.py:599] - < PING 4d 00 86 96 [binary, 4 bytes]
2025-02-08 10:47:24,457 - DEBUG - [protocol.py:745] - > PONG 4d 00 86 96 [binary, 4 bytes]
2025-02-08 10:47:44,429 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:47:44,430 - DEBUG - [protocol.py:745] - > PING 0d 07 e4 73 [binary, 4 bytes]
2025-02-08 10:47:44,438 - DEBUG - [protocol.py:599] - < PONG 0d 07 e4 73 [binary, 4 bytes]
2025-02-08 10:47:44,440 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:47:44,463 - DEBUG - [protocol.py:599] - < PING 'À):' [text, 4 bytes]
2025-02-08 10:47:44,464 - DEBUG - [protocol.py:745] - > PONG 'À):' [text, 4 bytes]
2025-02-08 10:48:04,446 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:48:04,447 - DEBUG - [protocol.py:745] - > PING '\u0fe1u' [text, 4 bytes]
2025-02-08 10:48:04,464 - DEBUG - [protocol.py:599] - < PONG '\u0fe1u' [text, 4 bytes]
2025-02-08 10:48:04,465 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:48:04,472 - DEBUG - [protocol.py:599] - < PING fd fb 96 59 [binary, 4 bytes]
2025-02-08 10:48:04,473 - DEBUG - [protocol.py:745] - > PONG fd fb 96 59 [binary, 4 bytes]
2025-02-08 10:48:24,454 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:48:24,456 - DEBUG - [protocol.py:745] - > PING b5 a3 e8 02 [binary, 4 bytes]
2025-02-08 10:48:24,467 - DEBUG - [protocol.py:599] - < PONG b5 a3 e8 02 [binary, 4 bytes]
2025-02-08 10:48:24,468 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:48:24,755 - DEBUG - [protocol.py:599] - < PING 93 5d 01 57 [binary, 4 bytes]
2025-02-08 10:48:24,756 - DEBUG - [protocol.py:745] - > PONG 93 5d 01 57 [binary, 4 bytes]
2025-02-08 10:48:34,593 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:48:34,594 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 10:48:34,601 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:48:34,603 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 10:48:34,603 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 10:48:34,604 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 10:48:34,605 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 10:48:39,126 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 10:48:39,128 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 10:48:39,128 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 10:48:39,128 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 10:48:39,128 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 10:48:39,128 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 10:48:39,128 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 10:48:39,129 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 10:48:39,129 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 10:48:39,129 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 10:48:39,129 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 10:48:39,178 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 10:48:39,179 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 10:48:39,179 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 10:48:39,180 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 10:48:39,180 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 10:48:39,181 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: QwTtiXe79kP29xCDNWXdWA==
2025-02-08 10:48:39,181 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 10:48:39,181 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 10:48:39,181 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 10:48:39,202 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 10:48:39,203 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 10:48:39,203 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 10:48:39,204 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: JRlvtmlt9rAQGQ3JJsHPGThYS3A=
2025-02-08 10:48:39,204 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 10:48:39,204 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 15:48:37 GMT
2025-02-08 10:48:39,205 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 10:48:39,205 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 10:48:39,206 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 10:48:40,314 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:48:40,315 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:48:40,315 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:48:40,316 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:48:40,345 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:48:40,346 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:48:40,346 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:48:40,347 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.79, Marca: Ricoh
2025-02-08 10:48:40,347 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.79
2025-02-08 10:48:40,348 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:48:40,526 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.1.1.0: RICOH MP C307 1.25 / RICOH Network Printer C model / RICOH Network Scanner C model / RICOH Network Facsimile C model
2025-02-08 10:48:40,526 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.79 responde correctamente
2025-02-08 10:48:40,526 - INFO - [printer_monitor_service.py:182] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 10:48:40,526 - DEBUG - [printer_monitor_service.py:189] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 10:48:40,551 - DEBUG - [printer_monitor_service.py:194] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 10:48:40,551 - INFO - [printer_monitor_service.py:199] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 10:48:40,552 - DEBUG - [printer_monitor_service.py:200] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:48:40,552 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.79
2025-02-08 10:48:40,553 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:48:40,554 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:48:40,722 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 139097
2025-02-08 10:48:40,723 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:40,913 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:48:40,913 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:48:40,914 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.79: {'total_pages': 139097, 'color_pages': 111303, 'bw_pages': None}
2025-02-08 10:48:40,915 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.79
2025-02-08 10:48:40,915 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:48:40,915 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:41,076 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:48:41,076 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:48:41,077 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:41,233 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:48:41,233 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:48:41,234 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:41,428 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:48:41,429 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:48:41,429 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:41,591 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 111303
2025-02-08 10:48:41,592 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.79
2025-02-08 10:48:41,592 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.79: {'toners': {'black': {'level': 111303, 'max': 100, 'percentage': 100}, 'cyan': {'level': 111303, 'max': 100, 'percentage': 100}, 'magenta': {'level': 111303, 'max': 100, 'percentage': 100}, 'yellow': {'level': 111303, 'max': 100, 'percentage': 100}}}
2025-02-08 10:48:41,592 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.79
2025-02-08 10:48:41,592 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.79 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:48:41,749 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.79 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:48:41,749 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.79: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:48:41,750 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.79
2025-02-08 10:48:41,750 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 139097,
    "color_pages": 111303,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 111303,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:48:41,751 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.79
2025-02-08 10:48:41,751 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:48:41,751 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:48:41,752 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:48:41,781 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:48:41,782 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:48:41,782 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:48:41,783 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:48:41,783 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:48:41,784 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:48:41,784 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.79",
  "name": "RRHH",
  "brand": "Ricoh",
  "model": "MPC 307",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:48:41.783661",
  "printer_data": {
    "counters": {
      "total_pages": 139097,
      "color_pages": 111303,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 111303,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:48:41,816 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.79
2025-02-08 10:48:41,817 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.79
2025-02-08 10:48:41,817 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 10:48:41,817 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 10:48:41,817 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:48:41,991 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 10:48:41,992 - INFO - [printer_monitor_service.py:527] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 10:48:41,992 - DEBUG - [printer_monitor_service.py:179] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 10:48:41,993 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 10:48:41,993 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:48:41,994 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 10:48:42,203 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 10:48:42,204 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:42,363 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:48:42,364 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:48:42,365 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 10:48:42,365 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 10:48:42,365 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 10:48:42,365 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:42,525 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:48:42,526 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:48:42,526 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:42,720 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:48:42,720 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:48:42,721 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:42,909 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:48:42,910 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:48:42,910 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 10:48:43,072 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 10:48:43,073 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 10:48:43,073 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 10:48:43,073 - INFO - [printer_monitor_service.py:548] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 10:48:43,073 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 10:48:43,235 - DEBUG - [printer_monitor_service.py:342] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 10:48:43,236 - INFO - [printer_monitor_service.py:579] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 10:48:43,236 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 10:48:43,237 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 10:48:43,237 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.41
2025-02-08 10:48:43,237 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:48:43,237 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:48:43,237 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:48:43,272 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":null,"client_id":4},{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":nu...
2025-02-08 10:48:43,273 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:48:43,274 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:48:43,274 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:48:43,276 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:48:43,276 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:48:43,276 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "Taller",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:48:43.274805",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 10:48:43,314 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 10:48:43,314 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 10:48:43,314 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:48:43,315 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:48:43,315 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:48:47,564 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:48:47,565 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:48:47,567 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:48:47,568 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:48:47,570 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:48:47,571 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:48:47,572 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:48:47,632 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.79","brand":"Ricoh","model":"MPC 307","name":"RRHH","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"Taller","status":nu...
2025-02-08 10:48:47,633 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 3 impresoras
2025-02-08 10:48:47,633 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.79",
    "brand": "Ricoh",
    "model": "MPC 307",
    "name": "RRHH",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "Taller",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:48:47,635 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:48:47,635 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:48:47,635 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:48:47,636 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "Taller",
  "brand": "Canon",
  "model": "ICR 3525",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:48:47.634351",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:48:47,672 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:48:47,672 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:48:59,206 - DEBUG - [protocol.py:599] - < PING 1c b4 e6 a9 [binary, 4 bytes]
2025-02-08 10:48:59,208 - DEBUG - [protocol.py:745] - > PONG 1c b4 e6 a9 [binary, 4 bytes]
2025-02-08 10:48:59,220 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:48:59,222 - DEBUG - [protocol.py:745] - > PING fd 7a 4b a5 [binary, 4 bytes]
2025-02-08 10:48:59,231 - DEBUG - [protocol.py:599] - < PONG fd 7a 4b a5 [binary, 4 bytes]
2025-02-08 10:48:59,233 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:49:08,764 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:49:08,766 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 10:49:08,774 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:49:08,776 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 10:49:08,778 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 10:49:08,780 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 10:49:08,784 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 10:49:13,433 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 10:49:13,435 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 10:49:13,435 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 10:49:13,435 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 10:49:13,435 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 10:49:13,436 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 10:49:13,436 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 10:49:13,436 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 10:49:13,436 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 10:49:13,436 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 10:49:13,436 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 10:49:13,485 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 10:49:13,486 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 10:49:13,486 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 10:49:13,486 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 10:49:13,486 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 10:49:13,486 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: UKb7m+mnyphaAzoBA8hv+g==
2025-02-08 10:49:13,488 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 10:49:13,488 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 10:49:13,488 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 10:49:13,502 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 10:49:13,503 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 10:49:13,503 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 10:49:13,503 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: AyDC7GhMRmwUaAXyowoR99kckLk=
2025-02-08 10:49:13,504 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 10:49:13,504 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 15:49:12 GMT
2025-02-08 10:49:13,504 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 10:49:13,504 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 10:49:13,505 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 10:49:14,589 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:49:14,590 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:49:14,590 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:49:14,591 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:49:14,621 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"ICR 3525","name":"Taller","status":null,"client_id":4}]...
2025-02-08 10:49:14,621 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:49:14,622 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:49:14,622 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:49:14,623 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:49:14,623 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:49:18,838 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:49:18,839 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:49:18,839 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:49:18,839 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:49:18,841 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:49:18,841 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:49:18,841 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:49:18,882 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"ICR 3525","name":"Taller","status":null,"client_id":4}]...
2025-02-08 10:49:18,882 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:49:18,882 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "ICR 3525",
    "name": "Taller",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:49:18,884 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:49:18,884 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:49:18,884 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:49:18,884 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "Taller",
  "brand": "Canon",
  "model": "ICR 3525",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:49:18.884982",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:49:18,929 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:49:18,930 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:49:33,502 - DEBUG - [protocol.py:599] - < PING 0c 5d 6b f2 [binary, 4 bytes]
2025-02-08 10:49:33,504 - DEBUG - [protocol.py:745] - > PONG 0c 5d 6b f2 [binary, 4 bytes]
2025-02-08 10:49:33,506 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:49:33,508 - DEBUG - [protocol.py:745] - > PING 89 f9 a8 58 [binary, 4 bytes]
2025-02-08 10:49:33,515 - DEBUG - [protocol.py:599] - < PONG 89 f9 a8 58 [binary, 4 bytes]
2025-02-08 10:49:33,518 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:49:53,514 - DEBUG - [protocol.py:599] - < PING ca 3a 79 2f [binary, 4 bytes]
2025-02-08 10:49:53,515 - DEBUG - [protocol.py:745] - > PONG ca 3a 79 2f [binary, 4 bytes]
2025-02-08 10:49:53,518 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:49:53,519 - DEBUG - [protocol.py:745] - > PING ec 4b 12 7a [binary, 4 bytes]
2025-02-08 10:49:53,526 - DEBUG - [protocol.py:599] - < PONG ec 4b 12 7a [binary, 4 bytes]
2025-02-08 10:49:53,528 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:50:13,524 - DEBUG - [protocol.py:599] - < PING f2 c2 23 bc [binary, 4 bytes]
2025-02-08 10:50:13,526 - DEBUG - [protocol.py:745] - > PONG f2 c2 23 bc [binary, 4 bytes]
2025-02-08 10:50:13,528 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:50:13,529 - DEBUG - [protocol.py:745] - > PING c0 db 8d 58 [binary, 4 bytes]
2025-02-08 10:50:13,541 - DEBUG - [protocol.py:599] - < PONG c0 db 8d 58 [binary, 4 bytes]
2025-02-08 10:50:13,543 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:50:33,535 - DEBUG - [protocol.py:599] - < PING a1 a5 35 b3 [binary, 4 bytes]
2025-02-08 10:50:33,537 - DEBUG - [protocol.py:745] - > PONG a1 a5 35 b3 [binary, 4 bytes]
2025-02-08 10:50:33,540 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:50:33,541 - DEBUG - [protocol.py:745] - > PING d9 46 4b 9c [binary, 4 bytes]
2025-02-08 10:50:33,546 - DEBUG - [protocol.py:599] - < PONG d9 46 4b 9c [binary, 4 bytes]
2025-02-08 10:50:33,547 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:50:53,546 - DEBUG - [protocol.py:599] - < PING ';q\x0e\x07' [text, 4 bytes]
2025-02-08 10:50:53,547 - DEBUG - [protocol.py:745] - > PONG ';q\x0e\x07' [text, 4 bytes]
2025-02-08 10:50:53,550 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:50:53,551 - DEBUG - [protocol.py:745] - > PING c0 91 c6 2e [binary, 4 bytes]
2025-02-08 10:50:53,560 - DEBUG - [protocol.py:599] - < PONG c0 91 c6 2e [binary, 4 bytes]
2025-02-08 10:50:53,562 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:51:06,725 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:51:06,728 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 10:51:06,739 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:51:06,741 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 10:51:06,741 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 10:51:06,743 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 10:51:06,744 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 10:51:10,875 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 10:51:10,878 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 10:51:10,878 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 10:51:10,878 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 10:51:10,878 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 10:51:10,878 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 10:51:10,878 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 10:51:10,878 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 10:51:10,878 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 10:51:10,878 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 10:51:10,878 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 10:51:10,927 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 10:51:10,927 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 10:51:10,929 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 10:51:10,929 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 10:51:10,929 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 10:51:10,930 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 4F9tqgP3zsyepO4Bm4rwwQ==
2025-02-08 10:51:10,930 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 10:51:10,930 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 10:51:10,930 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 10:51:10,948 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 10:51:10,948 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 10:51:10,948 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 10:51:10,948 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: YAh+lKHtkdcj7eCJHiHiv4GWPyo=
2025-02-08 10:51:10,948 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 10:51:10,948 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 15:51:09 GMT
2025-02-08 10:51:10,948 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 10:51:10,948 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 10:51:10,948 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 10:51:12,045 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:51:12,046 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:51:12,047 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:51:12,047 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:51:12,079 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":"offline","client_id":4}]...
2025-02-08 10:51:12,080 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:51:12,080 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-08 10:51:12,080 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:51:12,081 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:51:12,081 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:51:16,294 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:51:16,294 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:51:16,295 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:51:16,296 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:51:16,297 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:51:16,297 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:51:16,297 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:51:16,331 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":"offline","client_id":4}]...
2025-02-08 10:51:16,331 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:51:16,341 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-08 10:51:16,343 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:51:16,343 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:51:16,344 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:51:16,344 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:51:16.341974",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:51:16,382 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:51:16,384 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:51:30,941 - DEBUG - [protocol.py:599] - < PING b7 36 99 e9 [binary, 4 bytes]
2025-02-08 10:51:30,955 - DEBUG - [protocol.py:745] - > PONG b7 36 99 e9 [binary, 4 bytes]
2025-02-08 10:51:30,955 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:51:30,961 - DEBUG - [protocol.py:745] - > PING 88 9b ce 5c [binary, 4 bytes]
2025-02-08 10:51:30,970 - DEBUG - [protocol.py:599] - < PONG 88 9b ce 5c [binary, 4 bytes]
2025-02-08 10:51:30,972 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:51:50,954 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:51:50,956 - DEBUG - [protocol.py:745] - > PING 13 1c 1a 9e [binary, 4 bytes]
2025-02-08 10:51:50,956 - DEBUG - [protocol.py:599] - < PONG 13 1c 1a 9e [binary, 4 bytes]
2025-02-08 10:51:50,956 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:51:50,966 - DEBUG - [protocol.py:599] - < PING dc 4c ff 91 [binary, 4 bytes]
2025-02-08 10:51:50,968 - DEBUG - [protocol.py:745] - > PONG dc 4c ff 91 [binary, 4 bytes]
2025-02-08 10:52:10,965 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:52:10,967 - DEBUG - [protocol.py:745] - > PING 47 ae a0 4f [binary, 4 bytes]
2025-02-08 10:52:10,967 - DEBUG - [protocol.py:599] - < PONG 47 ae a0 4f [binary, 4 bytes]
2025-02-08 10:52:10,967 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:52:10,983 - DEBUG - [protocol.py:599] - < PING be 48 9f bf [binary, 4 bytes]
2025-02-08 10:52:10,983 - DEBUG - [protocol.py:745] - > PONG be 48 9f bf [binary, 4 bytes]
2025-02-08 10:52:30,995 - DEBUG - [protocol.py:599] - < PING 2b f5 07 c8 [binary, 4 bytes]
2025-02-08 10:52:30,995 - DEBUG - [protocol.py:745] - > PONG 2b f5 07 c8 [binary, 4 bytes]
2025-02-08 10:52:30,995 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:52:30,995 - DEBUG - [protocol.py:745] - > PING f4 fd e8 72 [binary, 4 bytes]
2025-02-08 10:52:30,995 - DEBUG - [protocol.py:599] - < PONG f4 fd e8 72 [binary, 4 bytes]
2025-02-08 10:52:31,007 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:52:51,008 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:52:51,008 - DEBUG - [protocol.py:745] - > PING 78 04 17 d1 [binary, 4 bytes]
2025-02-08 10:52:51,012 - DEBUG - [protocol.py:599] - < PING 17 98 d5 75 [binary, 4 bytes]
2025-02-08 10:52:51,014 - DEBUG - [protocol.py:745] - > PONG 17 98 d5 75 [binary, 4 bytes]
2025-02-08 10:52:51,017 - DEBUG - [protocol.py:599] - < PONG 78 04 17 d1 [binary, 4 bytes]
2025-02-08 10:52:51,017 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:53:11,016 - DEBUG - [protocol.py:599] - < PING 71 a0 e7 84 [binary, 4 bytes]
2025-02-08 10:53:11,016 - DEBUG - [protocol.py:745] - > PONG 71 a0 e7 84 [binary, 4 bytes]
2025-02-08 10:53:11,026 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:53:11,026 - DEBUG - [protocol.py:745] - > PING ae 91 a1 cd [binary, 4 bytes]
2025-02-08 10:53:11,032 - DEBUG - [protocol.py:599] - < PONG ae 91 a1 cd [binary, 4 bytes]
2025-02-08 10:53:11,034 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:53:31,031 - DEBUG - [protocol.py:599] - < PING 62 5d da d7 [binary, 4 bytes]
2025-02-08 10:53:31,032 - DEBUG - [protocol.py:745] - > PONG 62 5d da d7 [binary, 4 bytes]
2025-02-08 10:53:31,052 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:53:31,053 - DEBUG - [protocol.py:745] - > PING 4f 93 58 cd [binary, 4 bytes]
2025-02-08 10:53:31,061 - DEBUG - [protocol.py:599] - < PONG 4f 93 58 cd [binary, 4 bytes]
2025-02-08 10:53:31,062 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:53:51,024 - DEBUG - [protocol.py:599] - < PING f2 fc ef 9b [binary, 4 bytes]
2025-02-08 10:53:51,040 - DEBUG - [protocol.py:745] - > PONG f2 fc ef 9b [binary, 4 bytes]
2025-02-08 10:53:51,042 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:53:51,042 - DEBUG - [protocol.py:745] - > PING ab b5 5c 2d [binary, 4 bytes]
2025-02-08 10:53:51,044 - DEBUG - [protocol.py:599] - < PONG ab b5 5c 2d [binary, 4 bytes]
2025-02-08 10:53:51,051 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:54:11,045 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:54:11,045 - DEBUG - [protocol.py:745] - > PING dc 44 e6 3f [binary, 4 bytes]
2025-02-08 10:54:11,050 - DEBUG - [protocol.py:599] - < PING 4b 90 6a d3 [binary, 4 bytes]
2025-02-08 10:54:11,050 - DEBUG - [protocol.py:745] - > PONG 4b 90 6a d3 [binary, 4 bytes]
2025-02-08 10:54:11,054 - DEBUG - [protocol.py:599] - < PONG dc 44 e6 3f [binary, 4 bytes]
2025-02-08 10:54:11,057 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:54:31,050 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:54:31,050 - DEBUG - [protocol.py:745] - > PING 9c 27 75 45 [binary, 4 bytes]
2025-02-08 10:54:31,050 - DEBUG - [protocol.py:599] - < PING 19 54 b8 bb [binary, 4 bytes]
2025-02-08 10:54:31,050 - DEBUG - [protocol.py:745] - > PONG 19 54 b8 bb [binary, 4 bytes]
2025-02-08 10:54:31,063 - DEBUG - [protocol.py:599] - < PONG 9c 27 75 45 [binary, 4 bytes]
2025-02-08 10:54:31,066 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:54:51,057 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:54:51,057 - DEBUG - [protocol.py:745] - > PING 'e@93' [text, 4 bytes]
2025-02-08 10:54:51,057 - DEBUG - [protocol.py:599] - < PONG 'e@93' [text, 4 bytes]
2025-02-08 10:54:51,057 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:54:51,073 - DEBUG - [protocol.py:599] - < PING 01 71 91 74 [binary, 4 bytes]
2025-02-08 10:54:51,075 - DEBUG - [protocol.py:745] - > PONG 01 71 91 74 [binary, 4 bytes]
2025-02-08 10:55:11,085 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:55:11,086 - DEBUG - [protocol.py:745] - > PING 56 c6 74 20 [binary, 4 bytes]
2025-02-08 10:55:11,088 - DEBUG - [protocol.py:599] - < PING af 84 e7 6a [binary, 4 bytes]
2025-02-08 10:55:11,088 - DEBUG - [protocol.py:745] - > PONG af 84 e7 6a [binary, 4 bytes]
2025-02-08 10:55:11,088 - DEBUG - [protocol.py:599] - < PONG 56 c6 74 20 [binary, 4 bytes]
2025-02-08 10:55:11,088 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:55:31,085 - DEBUG - [protocol.py:599] - < PING 4a a4 e8 bf [binary, 4 bytes]
2025-02-08 10:55:31,101 - DEBUG - [protocol.py:745] - > PONG 4a a4 e8 bf [binary, 4 bytes]
2025-02-08 10:55:31,103 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:55:31,103 - DEBUG - [protocol.py:745] - > PING 8c d5 bb e2 [binary, 4 bytes]
2025-02-08 10:55:31,103 - DEBUG - [protocol.py:599] - < PONG 8c d5 bb e2 [binary, 4 bytes]
2025-02-08 10:55:31,103 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:55:51,107 - DEBUG - [protocol.py:599] - < PING 1f 69 f5 7c [binary, 4 bytes]
2025-02-08 10:55:51,107 - DEBUG - [protocol.py:745] - > PONG 1f 69 f5 7c [binary, 4 bytes]
2025-02-08 10:55:51,107 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:55:51,107 - DEBUG - [protocol.py:745] - > PING 50 e0 b2 7d [binary, 4 bytes]
2025-02-08 10:55:51,117 - DEBUG - [protocol.py:599] - < PONG 50 e0 b2 7d [binary, 4 bytes]
2025-02-08 10:55:51,120 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:56:11,117 - DEBUG - [protocol.py:599] - < PING '2&̛' [text, 4 bytes]
2025-02-08 10:56:11,118 - DEBUG - [protocol.py:745] - > PONG '2&̛' [text, 4 bytes]
2025-02-08 10:56:11,121 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:56:11,123 - DEBUG - [protocol.py:745] - > PING 6b 45 78 d0 [binary, 4 bytes]
2025-02-08 10:56:11,129 - DEBUG - [protocol.py:599] - < PONG 6b 45 78 d0 [binary, 4 bytes]
2025-02-08 10:56:11,131 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:56:17,476 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:56:17,477 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:56:17,477 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:56:17,479 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:56:17,510 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 10:56:17,511 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:56:17,512 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:56:17,514 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:56:17,516 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:56:17,517 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:56:19,278 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:56:19,280 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 10:56:19,288 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 10:56:19,290 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 10:56:19,293 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 10:56:19,295 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 10:56:19,296 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 10:56:25,640 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 10:56:25,642 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 10:56:25,642 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 10:56:25,642 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 10:56:25,642 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 10:56:25,642 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 10:56:25,643 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 10:56:25,643 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 10:56:25,643 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 10:56:25,643 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 10:56:25,643 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 10:56:25,691 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 10:56:25,692 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 10:56:25,692 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 10:56:25,693 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 10:56:25,693 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 10:56:25,693 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: Af25Wt0fe8mXYam+puqkjw==
2025-02-08 10:56:25,693 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 10:56:25,695 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 10:56:25,695 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 10:56:25,712 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 10:56:25,713 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 10:56:25,713 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 10:56:25,713 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: g1D1ttDhg6Euft3DufV4BBvEhgw=
2025-02-08 10:56:25,713 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 10:56:25,714 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 15:56:24 GMT
2025-02-08 10:56:25,714 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 10:56:25,714 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 10:56:25,715 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 10:56:26,796 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 10:56:26,797 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:56:26,797 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:56:26,797 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:56:26,829 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 10:56:26,829 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:56:26,829 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:56:26,830 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 10:56:26,830 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 10:56:26,831 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 10:56:31,044 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 10:56:31,045 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 10:56:31,047 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 10:56:31,048 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 10:56:31,050 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 10:56:31,051 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 10:56:31,052 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:56:31,092 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 10:56:31,093 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 10:56:31,094 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 10:56:31,095 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 10:56:31,096 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 10:56:31,097 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 10:56:31,097 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T15:56:31.095935",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 10:56:31,126 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 10:56:31,128 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 10:56:45,708 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:56:45,709 - DEBUG - [protocol.py:745] - > PING 1d 69 8f ba [binary, 4 bytes]
2025-02-08 10:56:45,715 - DEBUG - [protocol.py:599] - < PING 5c 0a ed 30 [binary, 4 bytes]
2025-02-08 10:56:45,716 - DEBUG - [protocol.py:745] - > PONG 5c 0a ed 30 [binary, 4 bytes]
2025-02-08 10:56:45,724 - DEBUG - [protocol.py:599] - < PONG 1d 69 8f ba [binary, 4 bytes]
2025-02-08 10:56:45,724 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:57:05,715 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:57:05,716 - DEBUG - [protocol.py:745] - > PING 13 8b b9 5a [binary, 4 bytes]
2025-02-08 10:57:05,722 - DEBUG - [protocol.py:599] - < PING 55 ac 2e 7e [binary, 4 bytes]
2025-02-08 10:57:05,723 - DEBUG - [protocol.py:745] - > PONG 55 ac 2e 7e [binary, 4 bytes]
2025-02-08 10:57:05,727 - DEBUG - [protocol.py:599] - < PONG 13 8b b9 5a [binary, 4 bytes]
2025-02-08 10:57:05,728 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:57:25,716 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:57:25,717 - DEBUG - [protocol.py:745] - > PING af 53 de 96 [binary, 4 bytes]
2025-02-08 10:57:25,726 - DEBUG - [protocol.py:599] - < PONG af 53 de 96 [binary, 4 bytes]
2025-02-08 10:57:25,726 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:57:25,734 - DEBUG - [protocol.py:599] - < PING f4 04 68 9b [binary, 4 bytes]
2025-02-08 10:57:25,735 - DEBUG - [protocol.py:745] - > PONG f4 04 68 9b [binary, 4 bytes]
2025-02-08 10:57:45,734 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:57:45,737 - DEBUG - [protocol.py:745] - > PING ff 8a 83 d1 [binary, 4 bytes]
2025-02-08 10:57:45,743 - DEBUG - [protocol.py:599] - < PING 88 69 14 6b [binary, 4 bytes]
2025-02-08 10:57:45,744 - DEBUG - [protocol.py:745] - > PONG 88 69 14 6b [binary, 4 bytes]
2025-02-08 10:57:45,746 - DEBUG - [protocol.py:599] - < PONG ff 8a 83 d1 [binary, 4 bytes]
2025-02-08 10:57:45,747 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:58:05,739 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:58:05,739 - DEBUG - [protocol.py:745] - > PING 30 d0 7f 61 [binary, 4 bytes]
2025-02-08 10:58:05,746 - DEBUG - [protocol.py:599] - < PONG 30 d0 7f 61 [binary, 4 bytes]
2025-02-08 10:58:05,747 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:58:05,750 - DEBUG - [protocol.py:599] - < PING d1 80 d5 2e [binary, 4 bytes]
2025-02-08 10:58:05,752 - DEBUG - [protocol.py:745] - > PONG d1 80 d5 2e [binary, 4 bytes]
2025-02-08 10:58:25,759 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:58:25,761 - DEBUG - [protocol.py:745] - > PING 4b ae 93 80 [binary, 4 bytes]
2025-02-08 10:58:25,763 - DEBUG - [protocol.py:599] - < PING a2 5f 25 c5 [binary, 4 bytes]
2025-02-08 10:58:25,765 - DEBUG - [protocol.py:745] - > PONG a2 5f 25 c5 [binary, 4 bytes]
2025-02-08 10:58:25,766 - DEBUG - [protocol.py:599] - < PONG 4b ae 93 80 [binary, 4 bytes]
2025-02-08 10:58:25,767 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:58:45,757 - DEBUG - [protocol.py:599] - < PING 9b 47 18 90 [binary, 4 bytes]
2025-02-08 10:58:45,771 - DEBUG - [protocol.py:745] - > PONG 9b 47 18 90 [binary, 4 bytes]
2025-02-08 10:58:45,773 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:58:45,775 - DEBUG - [protocol.py:745] - > PING fa ad 96 05 [binary, 4 bytes]
2025-02-08 10:58:45,775 - DEBUG - [protocol.py:599] - < PONG fa ad 96 05 [binary, 4 bytes]
2025-02-08 10:58:45,775 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:58:51,387 - DEBUG - [protocol.py:599] - < TEXT '{"type":"install_printer","printer_ip":"192.168...LTA 554eSeriesPCL.zip"}' [224 bytes]
2025-02-08 10:58:51,387 - DEBUG - [agent_service.py:152] - Mensaje recibido del servidor: {"type":"install_printer","printer_ip":"192.168.18.78","manufacturer":"Konica Minolta","model":"bizhub 554e","driver_url":"http://161.132.39.159:8000/drivers/17/download","driver_filename":"KONICA MINOLTA 554eSeriesPCL.zip"}
2025-02-08 10:58:51,389 - DEBUG - [agent_service.py:156] - Mensaje decodificado: {
  "type": "install_printer",
  "printer_ip": "192.168.18.78",
  "manufacturer": "Konica Minolta",
  "model": "bizhub 554e",
  "driver_url": "http://161.132.39.159:8000/drivers/17/download",
  "driver_filename": "KONICA MINOLTA 554eSeriesPCL.zip"
}
2025-02-08 10:58:51,391 - DEBUG - [agent_service.py:176] - Procesando mensaje tipo: install_printer
2025-02-08 10:58:51,391 - DEBUG - [agent_service.py:230] - Nombre del driver a usar: KONICA MINOLTA 554eSeriesPCL
2025-02-08 10:58:51,395 - DEBUG - [agent_service.py:234] - Driver se guardará en: C:\Users\pc\AppData\Local\Temp\tmp1ybm_v6z\KONICA MINOLTA 554eSeriesPCL.zip
2025-02-08 10:58:51,396 - DEBUG - [agent_service.py:237] - Iniciando descarga desde: http://161.132.39.159:8000/drivers/17/download
2025-02-08 10:58:52,485 - DEBUG - [agent_service.py:243] - Descargados 12214238 bytes
2025-02-08 10:58:52,711 - DEBUG - [agent_service.py:253] - ZIP extraído en: C:\Users\pc\AppData\Local\Temp\tmp1ybm_v6z\extracted
2025-02-08 10:58:52,711 - INFO - [printer_service.py:24] - Extrayendo drivers en: C:\Users\pc\AppData\Local\Temp\tmp544b64bo
2025-02-08 10:58:52,719 - DEBUG - [printer_service.py:29] - Contenido del ZIP: ['BH554ePCL6Winx64_5400ES/koayjj_a.km_', 'BH554ePCL6Winx64_5400ES/koayjj_b.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_b.km_', 'BH554ePCL6Winx64_5400ES/koayjj_c.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_c.km_', 'BH554ePCL6Winx64_5400ES/koayjj_c.kp_', 'BH554ePCL6Winx64_5400ES/koayjj_d.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_d.kp_', 'BH554ePCL6Winx64_5400ES/koayjj_e.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_f.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_f.fl_', 'BH554ePCL6Winx64_5400ES/koayjj_g.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_j.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_j.in_', 'BH554ePCL6Winx64_5400ES/koayjj_k.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_l.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_m.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_m.kp_', 'BH554ePCL6Winx64_5400ES/koayjj_n.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_o.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_p.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_q.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_r.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_s.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_t.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_u.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_w.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_w.ex_', 'BH554ePCL6Winx64_5400ES/koayjj_x.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_y.dl_', 'BH554ePCL6Winx64_5400ES/koayjj__.cat', 'BH554ePCL6Winx64_5400ES/koayjj__.cd_', 'BH554ePCL6Winx64_5400ES/koayjj__.cg_', 'BH554ePCL6Winx64_5400ES/koayjj__.ch_', 'BH554ePCL6Winx64_5400ES/koayjj__.cu_', 'BH554ePCL6Winx64_5400ES/KOAYJJ__.INF', 'BH554ePCL6Winx64_5400ES/koayjj__.kd_', 'BH554ePCL6Winx64_5400ES/koayjj__.kg_', 'BH554ePCL6Winx64_5400ES/koayjj__.kp_', 'BH554ePCL6Winx64_5400ES/koayjj__.ku_', 'BH554ePCL6Winx64_5400ES/koayjj__.md_', 'BH554ePCL6Winx64_5400ES/koayjj__.mg_', 'BH554ePCL6Winx64_5400ES/koayjj__.mu_', 'BH554ePCL6Winx64_5400ES/KOAYJJ__.UNF', 'BH554ePCL6Winx64_5400ES/koayjj__.yd_', 'BH554ePCL6Winx64_5400ES/koayjj__.yg_', 'BH554ePCL6Winx64_5400ES/koayjj__.yu_', 'BH554ePCL6Winx64_5400ES/kobdrvapiif.dl_', 'BH554ePCL6Winx64_5400ES/kobdrvapiif32.dl_', 'BH554ePCL6Winx64_5400ES/kobdrvapiw64.ex_', 'BH554ePCL6Winx64_5400ES/Readme.txt']
2025-02-08 10:58:52,910 - INFO - [printer_service.py:45] - Encontrado archivo INF: KOAYJJ__.INF (3209 bytes)
2025-02-08 10:58:52,914 - INFO - [printer_service.py:68] - Usando único archivo INF encontrado: KOAYJJ__.INF
2025-02-08 10:58:52,914 - INFO - [printer_service.py:71] - Usando archivo INF final: C:\Users\pc\AppData\Local\Temp\tmp544b64bo\BH554ePCL6Winx64_5400ES\KOAYJJ__.INF
2025-02-08 10:58:52,914 - INFO - [printer_service.py:109] - Instalando driver desde C:\Users\pc\AppData\Local\Temp\tmp544b64bo\BH554ePCL6Winx64_5400ES\KOAYJJ__.INF
2025-02-08 10:58:52,914 - INFO - [printer_service.py:110] - Usando nombre de driver: KONICA MINOLTA 554eSeriesPCL
2025-02-08 10:58:52,970 - INFO - [printer_service.py:119] - Expandido koayjj_b.dl_ a koayjj_b.dl
2025-02-08 10:58:53,016 - INFO - [printer_service.py:119] - Expandido koayjj_c.dl_ a koayjj_c.dl
2025-02-08 10:58:53,084 - INFO - [printer_service.py:119] - Expandido koayjj_d.dl_ a koayjj_d.dl
2025-02-08 10:58:53,137 - INFO - [printer_service.py:119] - Expandido koayjj_e.dl_ a koayjj_e.dl
2025-02-08 10:58:53,178 - INFO - [printer_service.py:119] - Expandido koayjj_f.dl_ a koayjj_f.dl
2025-02-08 10:58:53,223 - INFO - [printer_service.py:119] - Expandido koayjj_g.dl_ a koayjj_g.dl
2025-02-08 10:58:53,265 - INFO - [printer_service.py:119] - Expandido koayjj_j.dl_ a koayjj_j.dl
2025-02-08 10:58:53,336 - INFO - [printer_service.py:119] - Expandido koayjj_k.dl_ a koayjj_k.dl
2025-02-08 10:58:53,379 - INFO - [printer_service.py:119] - Expandido koayjj_l.dl_ a koayjj_l.dl
2025-02-08 10:58:53,439 - INFO - [printer_service.py:119] - Expandido koayjj_m.dl_ a koayjj_m.dl
2025-02-08 10:58:53,482 - INFO - [printer_service.py:119] - Expandido koayjj_n.dl_ a koayjj_n.dl
2025-02-08 10:58:53,530 - INFO - [printer_service.py:119] - Expandido koayjj_o.dl_ a koayjj_o.dl
2025-02-08 10:58:53,571 - INFO - [printer_service.py:119] - Expandido koayjj_p.dl_ a koayjj_p.dl
2025-02-08 10:58:53,620 - INFO - [printer_service.py:119] - Expandido koayjj_q.dl_ a koayjj_q.dl
2025-02-08 10:58:53,675 - INFO - [printer_service.py:119] - Expandido koayjj_r.dl_ a koayjj_r.dl
2025-02-08 10:58:53,715 - INFO - [printer_service.py:119] - Expandido koayjj_s.dl_ a koayjj_s.dl
2025-02-08 10:58:53,757 - INFO - [printer_service.py:119] - Expandido koayjj_t.dl_ a koayjj_t.dl
2025-02-08 10:58:53,828 - INFO - [printer_service.py:119] - Expandido koayjj_u.dl_ a koayjj_u.dl
2025-02-08 10:58:53,874 - INFO - [printer_service.py:119] - Expandido koayjj_w.dl_ a koayjj_w.dl
2025-02-08 10:58:53,926 - INFO - [printer_service.py:119] - Expandido koayjj_x.dl_ a koayjj_x.dl
2025-02-08 10:58:53,976 - INFO - [printer_service.py:119] - Expandido koayjj_y.dl_ a koayjj_y.dl
2025-02-08 10:58:54,016 - INFO - [printer_service.py:119] - Expandido kobdrvapiif.dl_ a kobdrvapiif.dl
2025-02-08 10:58:54,056 - INFO - [printer_service.py:119] - Expandido kobdrvapiif32.dl_ a kobdrvapiif32.dl
2025-02-08 10:58:54,056 - INFO - [printer_service.py:122] - Instalando driver usando pnputil...
2025-02-08 10:58:54,150 - ERROR - [printer_service.py:242] - Error en instalación: Command '['pnputil', '-i', '-a', 'C:\\Users\\pc\\AppData\\Local\\Temp\\tmp544b64bo\\BH554ePCL6Winx64_5400ES\\KOAYJJ__.INF']' returned non-zero exit status 5.
2025-02-08 10:58:54,181 - INFO - [agent_service.py:266] - Printer installation result: {'success': False, 'message': "Error en instalación: Command '['pnputil', '-i', '-a', 'C:\\\\Users\\\\pc\\\\AppData\\\\Local\\\\Temp\\\\tmp544b64bo\\\\BH554ePCL6Winx64_5400ES\\\\KOAYJJ__.INF']' returned non-zero exit status 5."}
2025-02-08 10:58:54,181 - DEBUG - [protocol.py:745] - > TEXT '{"type": "installation_result", "success": fals...n-zero exit status 5."}' [264 bytes]
2025-02-08 10:59:05,774 - DEBUG - [protocol.py:599] - < PING 'ޣe[' [text, 4 bytes]
2025-02-08 10:59:05,774 - DEBUG - [protocol.py:745] - > PONG 'ޣe[' [text, 4 bytes]
2025-02-08 10:59:05,785 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:59:05,785 - DEBUG - [protocol.py:745] - > PING b5 23 c7 9e [binary, 4 bytes]
2025-02-08 10:59:05,797 - DEBUG - [protocol.py:599] - < PONG b5 23 c7 9e [binary, 4 bytes]
2025-02-08 10:59:05,799 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:59:25,790 - DEBUG - [protocol.py:599] - < PING a1 4d 14 40 [binary, 4 bytes]
2025-02-08 10:59:25,793 - DEBUG - [protocol.py:745] - > PONG a1 4d 14 40 [binary, 4 bytes]
2025-02-08 10:59:25,795 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:59:25,797 - DEBUG - [protocol.py:745] - > PING 59 fa 64 21 [binary, 4 bytes]
2025-02-08 10:59:25,803 - DEBUG - [protocol.py:599] - < PONG 59 fa 64 21 [binary, 4 bytes]
2025-02-08 10:59:25,805 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 10:59:45,795 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 10:59:45,797 - DEBUG - [protocol.py:745] - > PING 63 6c af 00 [binary, 4 bytes]
2025-02-08 10:59:45,803 - DEBUG - [protocol.py:599] - < PING 3c e8 27 c5 [binary, 4 bytes]
2025-02-08 10:59:45,805 - DEBUG - [protocol.py:745] - > PONG 3c e8 27 c5 [binary, 4 bytes]
2025-02-08 10:59:45,809 - DEBUG - [protocol.py:599] - < PONG 63 6c af 00 [binary, 4 bytes]
2025-02-08 10:59:45,815 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:00:05,812 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:00:05,815 - DEBUG - [protocol.py:745] - > PING '\x0fj0\x06' [text, 4 bytes]
2025-02-08 11:00:05,820 - DEBUG - [protocol.py:599] - < PING ae d4 b1 3e [binary, 4 bytes]
2025-02-08 11:00:05,822 - DEBUG - [protocol.py:745] - > PONG ae d4 b1 3e [binary, 4 bytes]
2025-02-08 11:00:05,826 - DEBUG - [protocol.py:599] - < PONG '\x0fj0\x06' [text, 4 bytes]
2025-02-08 11:00:05,830 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:01:01,932 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 11:01:01,934 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 11:01:01,934 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 11:01:01,934 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 11:01:01,934 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 11:01:01,934 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 11:01:01,934 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 11:01:01,934 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 11:01:01,934 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 2s
2025-02-08 11:01:01,934 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 1
2025-02-08 11:01:01,934 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 11:01:01,975 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 11:01:01,975 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 11:01:01,975 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 11:01:01,983 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 11:01:01,983 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 11:01:01,983 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: kAXKRCWpfEtH5z4uSrvltw==
2025-02-08 11:01:01,983 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 11:01:01,983 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 11:01:01,983 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 11:01:02,006 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 11:01:02,006 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 11:01:02,006 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 11:01:02,006 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: 020QYbKhx5CWbyJTs/ytnlIMobw=
2025-02-08 11:01:02,006 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 11:01:02,006 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 16:01:00 GMT
2025-02-08 11:01:02,006 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 11:01:02,009 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 11:01:02,009 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 11:01:03,293 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:01:03,293 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:01:03,309 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:01:03,310 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:01:03,405 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:01:03,405 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:01:03,405 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:01:03,405 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:01:03,405 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:01:03,412 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:01:07,659 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 11:01:07,659 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 11:01:07,674 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 11:01:07,674 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:01:07,674 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:01:07,674 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:01:07,683 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:01:07,722 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:01:07,722 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:01:07,723 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:01:07,723 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:01:07,723 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:01:07,726 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 11:01:07,726 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:01:07.723806",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 11:01:07,789 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:01:07,790 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:01:22,006 - DEBUG - [protocol.py:599] - < PING 36 34 4d 9b [binary, 4 bytes]
2025-02-08 11:01:22,008 - DEBUG - [protocol.py:745] - > PONG 36 34 4d 9b [binary, 4 bytes]
2025-02-08 11:01:22,012 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:01:22,014 - DEBUG - [protocol.py:745] - > PING d1 f4 8b 6e [binary, 4 bytes]
2025-02-08 11:01:22,020 - DEBUG - [protocol.py:599] - < PONG d1 f4 8b 6e [binary, 4 bytes]
2025-02-08 11:01:22,021 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:01:42,016 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:01:42,016 - DEBUG - [protocol.py:745] - > PING 8b 4c ca d8 [binary, 4 bytes]
2025-02-08 11:01:42,019 - DEBUG - [protocol.py:599] - < PING 55 2c 79 c7 [binary, 4 bytes]
2025-02-08 11:01:42,020 - DEBUG - [protocol.py:745] - > PONG 55 2c 79 c7 [binary, 4 bytes]
2025-02-08 11:01:42,022 - DEBUG - [protocol.py:599] - < PONG 8b 4c ca d8 [binary, 4 bytes]
2025-02-08 11:01:42,025 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:01:55,574 - DEBUG - [protocol.py:599] - < TEXT '{"type":"install_printer","printer_ip":"192.168...LTA 554eSeriesPCL.zip"}' [224 bytes]
2025-02-08 11:01:55,574 - DEBUG - [agent_service.py:152] - Mensaje recibido del servidor: {"type":"install_printer","printer_ip":"192.168.18.78","manufacturer":"Konica Minolta","model":"bizhub 554e","driver_url":"http://161.132.39.159:8000/drivers/17/download","driver_filename":"KONICA MINOLTA 554eSeriesPCL.zip"}
2025-02-08 11:01:55,577 - DEBUG - [agent_service.py:156] - Mensaje decodificado: {
  "type": "install_printer",
  "printer_ip": "192.168.18.78",
  "manufacturer": "Konica Minolta",
  "model": "bizhub 554e",
  "driver_url": "http://161.132.39.159:8000/drivers/17/download",
  "driver_filename": "KONICA MINOLTA 554eSeriesPCL.zip"
}
2025-02-08 11:01:55,577 - DEBUG - [agent_service.py:176] - Procesando mensaje tipo: install_printer
2025-02-08 11:01:55,578 - DEBUG - [agent_service.py:230] - Nombre del driver a usar: KONICA MINOLTA 554eSeriesPCL
2025-02-08 11:01:55,582 - DEBUG - [agent_service.py:234] - Driver se guardará en: C:\Users\pc\AppData\Local\Temp\tmpzk5xni01\KONICA MINOLTA 554eSeriesPCL.zip
2025-02-08 11:01:55,583 - DEBUG - [agent_service.py:237] - Iniciando descarga desde: http://161.132.39.159:8000/drivers/17/download
2025-02-08 11:01:56,680 - DEBUG - [agent_service.py:243] - Descargados 12214238 bytes
2025-02-08 11:01:56,870 - DEBUG - [agent_service.py:253] - ZIP extraído en: C:\Users\pc\AppData\Local\Temp\tmpzk5xni01\extracted
2025-02-08 11:01:56,871 - INFO - [printer_service.py:24] - Extrayendo drivers en: C:\Users\pc\AppData\Local\Temp\tmp53fkoabc
2025-02-08 11:01:56,872 - DEBUG - [printer_service.py:29] - Contenido del ZIP: ['BH554ePCL6Winx64_5400ES/koayjj_a.km_', 'BH554ePCL6Winx64_5400ES/koayjj_b.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_b.km_', 'BH554ePCL6Winx64_5400ES/koayjj_c.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_c.km_', 'BH554ePCL6Winx64_5400ES/koayjj_c.kp_', 'BH554ePCL6Winx64_5400ES/koayjj_d.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_d.kp_', 'BH554ePCL6Winx64_5400ES/koayjj_e.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_f.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_f.fl_', 'BH554ePCL6Winx64_5400ES/koayjj_g.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_j.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_j.in_', 'BH554ePCL6Winx64_5400ES/koayjj_k.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_l.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_m.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_m.kp_', 'BH554ePCL6Winx64_5400ES/koayjj_n.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_o.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_p.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_q.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_r.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_s.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_t.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_u.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_w.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_w.ex_', 'BH554ePCL6Winx64_5400ES/koayjj_x.dl_', 'BH554ePCL6Winx64_5400ES/koayjj_y.dl_', 'BH554ePCL6Winx64_5400ES/koayjj__.cat', 'BH554ePCL6Winx64_5400ES/koayjj__.cd_', 'BH554ePCL6Winx64_5400ES/koayjj__.cg_', 'BH554ePCL6Winx64_5400ES/koayjj__.ch_', 'BH554ePCL6Winx64_5400ES/koayjj__.cu_', 'BH554ePCL6Winx64_5400ES/KOAYJJ__.INF', 'BH554ePCL6Winx64_5400ES/koayjj__.kd_', 'BH554ePCL6Winx64_5400ES/koayjj__.kg_', 'BH554ePCL6Winx64_5400ES/koayjj__.kp_', 'BH554ePCL6Winx64_5400ES/koayjj__.ku_', 'BH554ePCL6Winx64_5400ES/koayjj__.md_', 'BH554ePCL6Winx64_5400ES/koayjj__.mg_', 'BH554ePCL6Winx64_5400ES/koayjj__.mu_', 'BH554ePCL6Winx64_5400ES/KOAYJJ__.UNF', 'BH554ePCL6Winx64_5400ES/koayjj__.yd_', 'BH554ePCL6Winx64_5400ES/koayjj__.yg_', 'BH554ePCL6Winx64_5400ES/koayjj__.yu_', 'BH554ePCL6Winx64_5400ES/kobdrvapiif.dl_', 'BH554ePCL6Winx64_5400ES/kobdrvapiif32.dl_', 'BH554ePCL6Winx64_5400ES/kobdrvapiw64.ex_', 'BH554ePCL6Winx64_5400ES/Readme.txt']
2025-02-08 11:01:57,038 - INFO - [printer_service.py:45] - Encontrado archivo INF: KOAYJJ__.INF (3209 bytes)
2025-02-08 11:01:57,038 - INFO - [printer_service.py:68] - Usando único archivo INF encontrado: KOAYJJ__.INF
2025-02-08 11:01:57,039 - INFO - [printer_service.py:71] - Usando archivo INF final: C:\Users\pc\AppData\Local\Temp\tmp53fkoabc\BH554ePCL6Winx64_5400ES\KOAYJJ__.INF
2025-02-08 11:01:57,039 - INFO - [printer_service.py:109] - Instalando driver desde C:\Users\pc\AppData\Local\Temp\tmp53fkoabc\BH554ePCL6Winx64_5400ES\KOAYJJ__.INF
2025-02-08 11:01:57,039 - INFO - [printer_service.py:110] - Usando nombre de driver: KONICA MINOLTA 554eSeriesPCL
2025-02-08 11:01:57,092 - INFO - [printer_service.py:119] - Expandido koayjj_b.dl_ a koayjj_b.dl
2025-02-08 11:01:57,135 - INFO - [printer_service.py:119] - Expandido koayjj_c.dl_ a koayjj_c.dl
2025-02-08 11:01:57,205 - INFO - [printer_service.py:119] - Expandido koayjj_d.dl_ a koayjj_d.dl
2025-02-08 11:01:57,258 - INFO - [printer_service.py:119] - Expandido koayjj_e.dl_ a koayjj_e.dl
2025-02-08 11:01:57,301 - INFO - [printer_service.py:119] - Expandido koayjj_f.dl_ a koayjj_f.dl
2025-02-08 11:01:57,338 - INFO - [printer_service.py:119] - Expandido koayjj_g.dl_ a koayjj_g.dl
2025-02-08 11:01:57,381 - INFO - [printer_service.py:119] - Expandido koayjj_j.dl_ a koayjj_j.dl
2025-02-08 11:01:57,541 - INFO - [printer_service.py:119] - Expandido koayjj_k.dl_ a koayjj_k.dl
2025-02-08 11:01:57,583 - INFO - [printer_service.py:119] - Expandido koayjj_l.dl_ a koayjj_l.dl
2025-02-08 11:01:57,648 - INFO - [printer_service.py:119] - Expandido koayjj_m.dl_ a koayjj_m.dl
2025-02-08 11:01:57,692 - INFO - [printer_service.py:119] - Expandido koayjj_n.dl_ a koayjj_n.dl
2025-02-08 11:01:57,740 - INFO - [printer_service.py:119] - Expandido koayjj_o.dl_ a koayjj_o.dl
2025-02-08 11:01:57,782 - INFO - [printer_service.py:119] - Expandido koayjj_p.dl_ a koayjj_p.dl
2025-02-08 11:01:57,828 - INFO - [printer_service.py:119] - Expandido koayjj_q.dl_ a koayjj_q.dl
2025-02-08 11:01:57,899 - INFO - [printer_service.py:119] - Expandido koayjj_r.dl_ a koayjj_r.dl
2025-02-08 11:01:57,964 - INFO - [printer_service.py:119] - Expandido koayjj_s.dl_ a koayjj_s.dl
2025-02-08 11:01:58,019 - INFO - [printer_service.py:119] - Expandido koayjj_t.dl_ a koayjj_t.dl
2025-02-08 11:01:58,105 - INFO - [printer_service.py:119] - Expandido koayjj_u.dl_ a koayjj_u.dl
2025-02-08 11:01:58,157 - INFO - [printer_service.py:119] - Expandido koayjj_w.dl_ a koayjj_w.dl
2025-02-08 11:01:58,228 - INFO - [printer_service.py:119] - Expandido koayjj_x.dl_ a koayjj_x.dl
2025-02-08 11:01:58,282 - INFO - [printer_service.py:119] - Expandido koayjj_y.dl_ a koayjj_y.dl
2025-02-08 11:01:58,339 - INFO - [printer_service.py:119] - Expandido kobdrvapiif.dl_ a kobdrvapiif.dl
2025-02-08 11:01:58,386 - INFO - [printer_service.py:119] - Expandido kobdrvapiif32.dl_ a kobdrvapiif32.dl
2025-02-08 11:01:58,388 - INFO - [printer_service.py:122] - Instalando driver usando pnputil...
2025-02-08 11:01:58,520 - INFO - [printer_service.py:126] - Instalando driver de impresora: KONICA MINOLTA 554eSeriesPCL
2025-02-08 11:02:05,615 - INFO - [printer_service.py:144] - Verificando instalación del driver...
2025-02-08 11:02:07,457 - INFO - [printer_service.py:150] - Drivers instalados:


Name         : Universal Print Class Driver
Manufacturer : Microsoft

Name         : Send to Microsoft OneNote 16 Driver
Manufacturer : Microsoft

Name         : Microsoft Virtual Print Class Driver
Manufacturer : Microsoft

Name         : Microsoft Software Printer Driver
Manufacturer : Microsoft

Name         : Microsoft Print To PDF
Manufacturer : Microsoft

Name         : Microsoft IPP Class Driver
Manufacturer : Microsoft

Name         : RICOH MP C4503 PCL 6
Manufacturer : Ricoh

Name         : Microsoft Shared Fax Driver
Manufacturer : Microsoft

Name         : Microsoft enhanced Point and Print compatibility driver
Manufacturer : Microsoft

Name         : KONICA MINOLTA 554eSeriesPCL
Manufacturer : KONICA MINOLTA

Name         : Canon Generic Plus PCL6
Manufacturer : Canon

Name         : Microsoft enhanced Point and Print compatibility driver
Manufacturer : Microsoft




2025-02-08 11:02:07,457 - INFO - [printer_service.py:154] - Verificando puerto TCP/IP: IP_192.168.18.78
2025-02-08 11:02:08,302 - INFO - [printer_service.py:187] - Creando nuevo puerto TCP/IP...
2025-02-08 11:02:09,216 - INFO - [printer_service.py:196] - Verificando si la impresora Konica Minolta bizhub 554e ya existe...
2025-02-08 11:02:10,012 - INFO - [printer_service.py:229] - Instalando nueva impresora...
2025-02-08 11:02:15,416 - INFO - [agent_service.py:266] - Printer installation result: {'success': True, 'message': 'Impresora Konica Minolta bizhub 554e instalada/actualizada correctamente'}
2025-02-08 11:02:15,423 - DEBUG - [protocol.py:745] - > TEXT '{"type": "installation_result", "success": true...alizada correctamente"}' [135 bytes]
2025-02-08 11:02:15,457 - DEBUG - [protocol.py:599] - < PING 3e 18 c7 dd [binary, 4 bytes]
2025-02-08 11:02:15,458 - DEBUG - [protocol.py:745] - > PONG 3e 18 c7 dd [binary, 4 bytes]
2025-02-08 11:02:15,460 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:02:15,462 - DEBUG - [protocol.py:745] - > PING 55 6f a0 e0 [binary, 4 bytes]
2025-02-08 11:02:15,466 - DEBUG - [protocol.py:599] - < PONG 55 6f a0 e0 [binary, 4 bytes]
2025-02-08 11:02:15,467 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:02:35,466 - DEBUG - [protocol.py:599] - < PING ce 29 20 b9 [binary, 4 bytes]
2025-02-08 11:02:35,466 - DEBUG - [protocol.py:745] - > PONG ce 29 20 b9 [binary, 4 bytes]
2025-02-08 11:02:35,467 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:02:35,468 - DEBUG - [protocol.py:745] - > PING ab dd a4 1f [binary, 4 bytes]
2025-02-08 11:02:35,473 - DEBUG - [protocol.py:599] - < PONG ab dd a4 1f [binary, 4 bytes]
2025-02-08 11:02:35,473 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:02:55,464 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:02:55,464 - DEBUG - [protocol.py:745] - > PING d6 9f b1 a1 [binary, 4 bytes]
2025-02-08 11:02:55,468 - DEBUG - [protocol.py:599] - < PONG d6 9f b1 a1 [binary, 4 bytes]
2025-02-08 11:02:55,468 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:02:55,468 - DEBUG - [protocol.py:599] - < PING b4 87 b8 bd [binary, 4 bytes]
2025-02-08 11:02:55,476 - DEBUG - [protocol.py:745] - > PONG b4 87 b8 bd [binary, 4 bytes]
2025-02-08 11:03:15,465 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:03:15,465 - DEBUG - [protocol.py:745] - > PING 97 4b 97 ba [binary, 4 bytes]
2025-02-08 11:03:15,473 - DEBUG - [protocol.py:599] - < PONG 97 4b 97 ba [binary, 4 bytes]
2025-02-08 11:03:15,473 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:03:15,481 - DEBUG - [protocol.py:599] - < PING d2 79 4c 45 [binary, 4 bytes]
2025-02-08 11:03:15,482 - DEBUG - [protocol.py:745] - > PONG d2 79 4c 45 [binary, 4 bytes]
2025-02-08 11:03:35,468 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:03:35,468 - DEBUG - [protocol.py:745] - > PING '\x0bR\x7fE' [text, 4 bytes]
2025-02-08 11:03:35,478 - DEBUG - [protocol.py:599] - < PONG '\x0bR\x7fE' [text, 4 bytes]
2025-02-08 11:03:35,479 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:03:35,489 - DEBUG - [protocol.py:599] - < PING 41 b0 70 62 [binary, 4 bytes]
2025-02-08 11:03:35,490 - DEBUG - [protocol.py:745] - > PONG 41 b0 70 62 [binary, 4 bytes]
2025-02-08 11:03:55,462 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:03:55,463 - DEBUG - [protocol.py:745] - > PING 38 14 07 cb [binary, 4 bytes]
2025-02-08 11:03:55,471 - DEBUG - [protocol.py:599] - < PONG 38 14 07 cb [binary, 4 bytes]
2025-02-08 11:03:55,471 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:03:55,496 - DEBUG - [protocol.py:599] - < PING f9 26 fd cc [binary, 4 bytes]
2025-02-08 11:03:55,497 - DEBUG - [protocol.py:745] - > PONG f9 26 fd cc [binary, 4 bytes]
2025-02-08 11:04:15,490 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:04:15,491 - DEBUG - [protocol.py:745] - > PING d1 8e 91 a5 [binary, 4 bytes]
2025-02-08 11:04:15,498 - DEBUG - [protocol.py:599] - < PONG d1 8e 91 a5 [binary, 4 bytes]
2025-02-08 11:04:15,499 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:04:15,506 - DEBUG - [protocol.py:599] - < PING 6c a0 c9 98 [binary, 4 bytes]
2025-02-08 11:04:15,511 - DEBUG - [protocol.py:745] - > PONG 6c a0 c9 98 [binary, 4 bytes]
2025-02-08 11:04:35,506 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:04:35,507 - DEBUG - [protocol.py:745] - > PING cc 66 b1 be [binary, 4 bytes]
2025-02-08 11:04:35,512 - DEBUG - [protocol.py:599] - < PONG cc 66 b1 be [binary, 4 bytes]
2025-02-08 11:04:35,512 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:04:35,512 - DEBUG - [protocol.py:599] - < PING d9 8e 6b a5 [binary, 4 bytes]
2025-02-08 11:04:35,512 - DEBUG - [protocol.py:745] - > PONG d9 8e 6b a5 [binary, 4 bytes]
2025-02-08 11:04:55,514 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:04:55,514 - DEBUG - [protocol.py:745] - > PING e6 59 fc 4f [binary, 4 bytes]
2025-02-08 11:04:55,517 - DEBUG - [protocol.py:599] - < PONG e6 59 fc 4f [binary, 4 bytes]
2025-02-08 11:04:55,517 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:04:55,528 - DEBUG - [protocol.py:599] - < PING ed 43 32 8a [binary, 4 bytes]
2025-02-08 11:04:55,528 - DEBUG - [protocol.py:745] - > PONG ed 43 32 8a [binary, 4 bytes]
2025-02-08 11:05:15,535 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:05:15,537 - DEBUG - [protocol.py:745] - > PING c8 7c 3c 39 [binary, 4 bytes]
2025-02-08 11:05:15,538 - DEBUG - [protocol.py:599] - < PING b7 ad 1f 59 [binary, 4 bytes]
2025-02-08 11:05:15,543 - DEBUG - [protocol.py:745] - > PONG b7 ad 1f 59 [binary, 4 bytes]
2025-02-08 11:05:15,546 - DEBUG - [protocol.py:599] - < PONG c8 7c 3c 39 [binary, 4 bytes]
2025-02-08 11:05:15,546 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:05:35,545 - DEBUG - [protocol.py:599] - < PING fe d3 fa 82 [binary, 4 bytes]
2025-02-08 11:05:35,545 - DEBUG - [protocol.py:745] - > PONG fe d3 fa 82 [binary, 4 bytes]
2025-02-08 11:05:35,553 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:05:35,553 - DEBUG - [protocol.py:745] - > PING 38 5d a5 e5 [binary, 4 bytes]
2025-02-08 11:05:35,792 - DEBUG - [protocol.py:599] - < PONG 38 5d a5 e5 [binary, 4 bytes]
2025-02-08 11:05:35,793 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:05:55,561 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:05:55,561 - DEBUG - [protocol.py:745] - > PING 20 90 2d 10 [binary, 4 bytes]
2025-02-08 11:05:55,566 - DEBUG - [protocol.py:599] - < PING 'gO?7' [text, 4 bytes]
2025-02-08 11:05:55,566 - DEBUG - [protocol.py:745] - > PONG 'gO?7' [text, 4 bytes]
2025-02-08 11:05:55,570 - DEBUG - [protocol.py:599] - < PONG 20 90 2d 10 [binary, 4 bytes]
2025-02-08 11:05:55,573 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:06:08,922 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:06:08,922 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:06:08,922 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:06:08,922 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:06:08,954 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:06:08,963 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:06:08,964 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:06:08,965 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:06:08,965 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:06:08,965 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:06:13,174 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 11:06:13,174 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 11:06:13,179 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 11:06:13,179 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:06:13,179 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:06:13,179 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:06:13,179 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:06:13,223 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:06:13,230 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:06:13,230 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:06:13,237 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:06:13,238 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:06:13,240 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 11:06:13,240 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:06:13.237684",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 11:06:13,270 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:06:13,270 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:06:15,564 - DEBUG - [protocol.py:599] - < PING e8 54 28 03 [binary, 4 bytes]
2025-02-08 11:06:15,564 - DEBUG - [protocol.py:745] - > PONG e8 54 28 03 [binary, 4 bytes]
2025-02-08 11:06:15,579 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:06:15,579 - DEBUG - [protocol.py:745] - > PING 30 64 90 3f [binary, 4 bytes]
2025-02-08 11:06:15,579 - DEBUG - [protocol.py:599] - < PONG 30 64 90 3f [binary, 4 bytes]
2025-02-08 11:06:15,586 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:06:35,580 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:06:35,580 - DEBUG - [protocol.py:745] - > PING 26 19 e4 85 [binary, 4 bytes]
2025-02-08 11:06:35,583 - DEBUG - [protocol.py:599] - < PING 64 16 a3 bc [binary, 4 bytes]
2025-02-08 11:06:35,583 - DEBUG - [protocol.py:745] - > PONG 64 16 a3 bc [binary, 4 bytes]
2025-02-08 11:06:35,583 - DEBUG - [protocol.py:599] - < PONG 26 19 e4 85 [binary, 4 bytes]
2025-02-08 11:06:35,592 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:06:55,583 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:06:55,586 - DEBUG - [protocol.py:745] - > PING f0 3b f2 b5 [binary, 4 bytes]
2025-02-08 11:06:55,593 - DEBUG - [protocol.py:599] - < PONG f0 3b f2 b5 [binary, 4 bytes]
2025-02-08 11:06:55,593 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:06:55,593 - DEBUG - [protocol.py:599] - < PING 99 1f ee 7e [binary, 4 bytes]
2025-02-08 11:06:55,599 - DEBUG - [protocol.py:745] - > PONG 99 1f ee 7e [binary, 4 bytes]
2025-02-08 11:07:15,597 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:07:15,597 - DEBUG - [protocol.py:745] - > PING d9 87 fe c0 [binary, 4 bytes]
2025-02-08 11:07:15,609 - DEBUG - [protocol.py:599] - < PONG d9 87 fe c0 [binary, 4 bytes]
2025-02-08 11:07:15,609 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:07:15,616 - DEBUG - [protocol.py:599] - < PING ad 61 33 78 [binary, 4 bytes]
2025-02-08 11:07:15,616 - DEBUG - [protocol.py:745] - > PONG ad 61 33 78 [binary, 4 bytes]
2025-02-08 11:07:35,608 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:07:35,608 - DEBUG - [protocol.py:745] - > PING 88 4f 73 80 [binary, 4 bytes]
2025-02-08 11:07:35,617 - DEBUG - [protocol.py:599] - < PONG 88 4f 73 80 [binary, 4 bytes]
2025-02-08 11:07:35,617 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:07:35,625 - DEBUG - [protocol.py:599] - < PING 6c 29 90 2d [binary, 4 bytes]
2025-02-08 11:07:35,627 - DEBUG - [protocol.py:745] - > PONG 6c 29 90 2d [binary, 4 bytes]
2025-02-08 11:07:55,612 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:07:55,612 - DEBUG - [protocol.py:745] - > PING 7d 5b 66 d1 [binary, 4 bytes]
2025-02-08 11:07:55,617 - DEBUG - [protocol.py:599] - < PONG 7d 5b 66 d1 [binary, 4 bytes]
2025-02-08 11:07:55,617 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:07:55,630 - DEBUG - [protocol.py:599] - < PING f9 4e a1 63 [binary, 4 bytes]
2025-02-08 11:07:55,630 - DEBUG - [protocol.py:745] - > PONG f9 4e a1 63 [binary, 4 bytes]
2025-02-08 11:08:15,599 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:08:15,599 - DEBUG - [protocol.py:745] - > PING 96 52 c7 4a [binary, 4 bytes]
2025-02-08 11:08:15,606 - DEBUG - [protocol.py:599] - < PONG 96 52 c7 4a [binary, 4 bytes]
2025-02-08 11:08:15,610 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:08:15,647 - DEBUG - [protocol.py:599] - < PING ca 2d cb 7d [binary, 4 bytes]
2025-02-08 11:08:15,648 - DEBUG - [protocol.py:745] - > PONG ca 2d cb 7d [binary, 4 bytes]
2025-02-08 11:08:35,612 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:08:35,612 - DEBUG - [protocol.py:745] - > PING d4 dc 2a 3b [binary, 4 bytes]
2025-02-08 11:08:35,616 - DEBUG - [protocol.py:599] - < PONG d4 dc 2a 3b [binary, 4 bytes]
2025-02-08 11:08:35,616 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:08:35,649 - DEBUG - [protocol.py:599] - < PING 44 78 81 60 [binary, 4 bytes]
2025-02-08 11:08:35,649 - DEBUG - [protocol.py:745] - > PONG 44 78 81 60 [binary, 4 bytes]
2025-02-08 11:08:55,613 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:08:55,613 - DEBUG - [protocol.py:745] - > PING 34 b2 02 01 [binary, 4 bytes]
2025-02-08 11:08:55,622 - DEBUG - [protocol.py:599] - < PONG 34 b2 02 01 [binary, 4 bytes]
2025-02-08 11:08:55,622 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:08:55,664 - DEBUG - [protocol.py:599] - < PING 86 e2 fe f4 [binary, 4 bytes]
2025-02-08 11:08:55,664 - DEBUG - [protocol.py:745] - > PONG 86 e2 fe f4 [binary, 4 bytes]
2025-02-08 11:09:15,638 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:09:15,638 - DEBUG - [protocol.py:745] - > PING 29 e6 19 60 [binary, 4 bytes]
2025-02-08 11:09:15,643 - DEBUG - [protocol.py:599] - < PONG 29 e6 19 60 [binary, 4 bytes]
2025-02-08 11:09:15,643 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:09:15,682 - DEBUG - [protocol.py:599] - < PING ab 2e 9e 8e [binary, 4 bytes]
2025-02-08 11:09:15,682 - DEBUG - [protocol.py:745] - > PONG ab 2e 9e 8e [binary, 4 bytes]
2025-02-08 11:09:35,644 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:09:35,644 - DEBUG - [protocol.py:745] - > PING c0 39 ba 9a [binary, 4 bytes]
2025-02-08 11:09:35,644 - DEBUG - [protocol.py:599] - < PONG c0 39 ba 9a [binary, 4 bytes]
2025-02-08 11:09:35,644 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:09:35,678 - DEBUG - [protocol.py:599] - < PING 'U\x01Do' [text, 4 bytes]
2025-02-08 11:09:35,678 - DEBUG - [protocol.py:745] - > PONG 'U\x01Do' [text, 4 bytes]
2025-02-08 11:09:55,661 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:09:55,661 - DEBUG - [protocol.py:745] - > PING 74 00 67 fa [binary, 4 bytes]
2025-02-08 11:09:55,669 - DEBUG - [protocol.py:599] - < PONG 74 00 67 fa [binary, 4 bytes]
2025-02-08 11:09:55,669 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:09:55,694 - DEBUG - [protocol.py:599] - < PING 96 e3 ba c6 [binary, 4 bytes]
2025-02-08 11:09:55,694 - DEBUG - [protocol.py:745] - > PONG 96 e3 ba c6 [binary, 4 bytes]
2025-02-08 11:10:15,678 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:10:15,678 - DEBUG - [protocol.py:745] - > PING a9 a6 9c 63 [binary, 4 bytes]
2025-02-08 11:10:15,686 - DEBUG - [protocol.py:599] - < PONG a9 a6 9c 63 [binary, 4 bytes]
2025-02-08 11:10:15,686 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:10:15,695 - DEBUG - [protocol.py:599] - < PING 14 bb c4 34 [binary, 4 bytes]
2025-02-08 11:10:15,695 - DEBUG - [protocol.py:745] - > PONG 14 bb c4 34 [binary, 4 bytes]
2025-02-08 11:10:35,693 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:10:35,695 - DEBUG - [protocol.py:745] - > PING ec d5 fd f8 [binary, 4 bytes]
2025-02-08 11:10:35,702 - DEBUG - [protocol.py:599] - < PONG ec d5 fd f8 [binary, 4 bytes]
2025-02-08 11:10:35,702 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:10:35,712 - DEBUG - [protocol.py:599] - < PING '\\F\x7f$' [text, 4 bytes]
2025-02-08 11:10:35,712 - DEBUG - [protocol.py:745] - > PONG '\\F\x7f$' [text, 4 bytes]
2025-02-08 11:10:55,721 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:10:55,723 - DEBUG - [protocol.py:745] - > PING 9d 21 19 54 [binary, 4 bytes]
2025-02-08 11:10:55,728 - DEBUG - [protocol.py:599] - < PING 23 c9 05 1a [binary, 4 bytes]
2025-02-08 11:10:55,728 - DEBUG - [protocol.py:745] - > PONG 23 c9 05 1a [binary, 4 bytes]
2025-02-08 11:10:55,737 - DEBUG - [protocol.py:599] - < PONG 9d 21 19 54 [binary, 4 bytes]
2025-02-08 11:10:55,741 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:11:14,369 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:11:14,369 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:11:14,384 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:11:14,384 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:11:14,417 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:11:14,417 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:11:14,417 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:11:14,420 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:11:14,420 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:11:14,420 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:11:18,661 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 11:11:18,661 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 11:11:18,665 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 11:11:18,667 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:11:18,669 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:11:18,671 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:11:18,671 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:11:18,675 - DEBUG - [protocol.py:599] - < PING a6 a0 a2 68 [binary, 4 bytes]
2025-02-08 11:11:18,677 - DEBUG - [protocol.py:745] - > PONG a6 a0 a2 68 [binary, 4 bytes]
2025-02-08 11:11:18,684 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:11:18,684 - DEBUG - [protocol.py:745] - > PING 8d 53 e4 28 [binary, 4 bytes]
2025-02-08 11:11:18,695 - DEBUG - [protocol.py:599] - < PONG 8d 53 e4 28 [binary, 4 bytes]
2025-02-08 11:11:18,695 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:11:18,725 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:11:18,725 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:11:18,725 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:11:18,743 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:11:18,743 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:11:18,743 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 11:11:18,743 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:11:18.741196",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 11:11:18,791 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:11:18,791 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:11:38,692 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:11:38,692 - DEBUG - [protocol.py:745] - > PING '\x12\x06xH' [text, 4 bytes]
2025-02-08 11:11:38,692 - DEBUG - [protocol.py:599] - < PING b4 00 25 35 [binary, 4 bytes]
2025-02-08 11:11:38,700 - DEBUG - [protocol.py:745] - > PONG b4 00 25 35 [binary, 4 bytes]
2025-02-08 11:11:38,700 - DEBUG - [protocol.py:599] - < PONG '\x12\x06xH' [text, 4 bytes]
2025-02-08 11:11:38,700 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:11:58,708 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:11:58,708 - DEBUG - [protocol.py:745] - > PING 61 a9 92 72 [binary, 4 bytes]
2025-02-08 11:11:58,711 - DEBUG - [protocol.py:599] - < PING 4e 58 ac 85 [binary, 4 bytes]
2025-02-08 11:11:58,711 - DEBUG - [protocol.py:745] - > PONG 4e 58 ac 85 [binary, 4 bytes]
2025-02-08 11:11:58,717 - DEBUG - [protocol.py:599] - < PONG 61 a9 92 72 [binary, 4 bytes]
2025-02-08 11:11:58,720 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:12:18,725 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:12:18,725 - DEBUG - [protocol.py:745] - > PING 10 95 1e 0e [binary, 4 bytes]
2025-02-08 11:12:18,731 - DEBUG - [protocol.py:599] - < PING 9f a3 94 c1 [binary, 4 bytes]
2025-02-08 11:12:18,731 - DEBUG - [protocol.py:745] - > PONG 9f a3 94 c1 [binary, 4 bytes]
2025-02-08 11:12:18,734 - DEBUG - [protocol.py:599] - < PONG 10 95 1e 0e [binary, 4 bytes]
2025-02-08 11:12:18,737 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:12:38,741 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:12:38,741 - DEBUG - [protocol.py:745] - > PING fd 6d c9 ea [binary, 4 bytes]
2025-02-08 11:12:38,744 - DEBUG - [protocol.py:599] - < PING 0b 82 b5 ab [binary, 4 bytes]
2025-02-08 11:12:38,750 - DEBUG - [protocol.py:745] - > PONG 0b 82 b5 ab [binary, 4 bytes]
2025-02-08 11:12:38,752 - DEBUG - [protocol.py:599] - < PONG fd 6d c9 ea [binary, 4 bytes]
2025-02-08 11:12:38,754 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:12:58,740 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:12:58,742 - DEBUG - [protocol.py:745] - > PING 5f 84 70 d0 [binary, 4 bytes]
2025-02-08 11:12:58,745 - DEBUG - [protocol.py:599] - < PONG 5f 84 70 d0 [binary, 4 bytes]
2025-02-08 11:12:58,745 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:12:58,758 - DEBUG - [protocol.py:599] - < PING 87 a1 d5 66 [binary, 4 bytes]
2025-02-08 11:12:58,758 - DEBUG - [protocol.py:745] - > PONG 87 a1 d5 66 [binary, 4 bytes]
2025-02-08 11:13:18,754 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:13:18,754 - DEBUG - [protocol.py:745] - > PING d1 96 3d f0 [binary, 4 bytes]
2025-02-08 11:13:18,760 - DEBUG - [protocol.py:599] - < PONG d1 96 3d f0 [binary, 4 bytes]
2025-02-08 11:13:18,760 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:13:18,770 - DEBUG - [protocol.py:599] - < PING 9d 55 fa d6 [binary, 4 bytes]
2025-02-08 11:13:18,770 - DEBUG - [protocol.py:745] - > PONG 9d 55 fa d6 [binary, 4 bytes]
2025-02-08 11:13:38,756 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:13:38,756 - DEBUG - [protocol.py:745] - > PING 0f b3 5c 81 [binary, 4 bytes]
2025-02-08 11:13:38,762 - DEBUG - [protocol.py:599] - < PONG 0f b3 5c 81 [binary, 4 bytes]
2025-02-08 11:13:38,762 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:13:38,775 - DEBUG - [protocol.py:599] - < PING 17 9f 5c a8 [binary, 4 bytes]
2025-02-08 11:13:38,775 - DEBUG - [protocol.py:745] - > PONG 17 9f 5c a8 [binary, 4 bytes]
2025-02-08 11:13:58,772 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:13:58,772 - DEBUG - [protocol.py:745] - > PING e1 f6 73 09 [binary, 4 bytes]
2025-02-08 11:13:58,776 - DEBUG - [protocol.py:599] - < PONG e1 f6 73 09 [binary, 4 bytes]
2025-02-08 11:13:58,776 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:13:58,784 - DEBUG - [protocol.py:599] - < PING b0 80 78 5f [binary, 4 bytes]
2025-02-08 11:13:58,786 - DEBUG - [protocol.py:745] - > PONG b0 80 78 5f [binary, 4 bytes]
2025-02-08 11:14:18,775 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:14:18,775 - DEBUG - [protocol.py:745] - > PING 9c 31 5c b5 [binary, 4 bytes]
2025-02-08 11:14:18,780 - DEBUG - [protocol.py:599] - < PONG 9c 31 5c b5 [binary, 4 bytes]
2025-02-08 11:14:18,780 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:14:18,792 - DEBUG - [protocol.py:599] - < PING c5 c0 58 f6 [binary, 4 bytes]
2025-02-08 11:14:18,792 - DEBUG - [protocol.py:745] - > PONG c5 c0 58 f6 [binary, 4 bytes]
2025-02-08 11:14:38,786 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:14:38,786 - DEBUG - [protocol.py:745] - > PING 1c 92 c9 3e [binary, 4 bytes]
2025-02-08 11:14:38,788 - DEBUG - [protocol.py:599] - < PONG 1c 92 c9 3e [binary, 4 bytes]
2025-02-08 11:14:38,788 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:14:38,797 - DEBUG - [protocol.py:599] - < PING 9c 74 29 59 [binary, 4 bytes]
2025-02-08 11:14:38,797 - DEBUG - [protocol.py:745] - > PONG 9c 74 29 59 [binary, 4 bytes]
2025-02-08 11:14:58,800 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:14:58,800 - DEBUG - [protocol.py:745] - > PING 23 83 72 74 [binary, 4 bytes]
2025-02-08 11:14:58,802 - DEBUG - [protocol.py:599] - < PING 1a a5 41 b9 [binary, 4 bytes]
2025-02-08 11:14:58,802 - DEBUG - [protocol.py:745] - > PONG 1a a5 41 b9 [binary, 4 bytes]
2025-02-08 11:14:58,807 - DEBUG - [protocol.py:599] - < PONG 23 83 72 74 [binary, 4 bytes]
2025-02-08 11:14:58,807 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:15:18,807 - DEBUG - [protocol.py:599] - < PING f3 a4 3a 73 [binary, 4 bytes]
2025-02-08 11:15:18,809 - DEBUG - [protocol.py:745] - > PONG f3 a4 3a 73 [binary, 4 bytes]
2025-02-08 11:15:18,810 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:15:18,810 - DEBUG - [protocol.py:745] - > PING 5f be 56 86 [binary, 4 bytes]
2025-02-08 11:15:18,825 - DEBUG - [protocol.py:599] - < PONG 5f be 56 86 [binary, 4 bytes]
2025-02-08 11:15:18,825 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:15:38,802 - DEBUG - [protocol.py:599] - < PING 34 ee 3a b5 [binary, 4 bytes]
2025-02-08 11:15:38,802 - DEBUG - [protocol.py:745] - > PONG 34 ee 3a b5 [binary, 4 bytes]
2025-02-08 11:15:38,818 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:15:38,819 - DEBUG - [protocol.py:745] - > PING 3e bd 81 e6 [binary, 4 bytes]
2025-02-08 11:15:38,823 - DEBUG - [protocol.py:599] - < PONG 3e bd 81 e6 [binary, 4 bytes]
2025-02-08 11:15:38,823 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:15:58,815 - DEBUG - [protocol.py:599] - < PING 54 bb 49 92 [binary, 4 bytes]
2025-02-08 11:15:58,815 - DEBUG - [protocol.py:745] - > PONG 54 bb 49 92 [binary, 4 bytes]
2025-02-08 11:15:58,846 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:15:58,847 - DEBUG - [protocol.py:745] - > PING 'dIn\x11' [text, 4 bytes]
2025-02-08 11:15:58,850 - DEBUG - [protocol.py:599] - < PONG 'dIn\x11' [text, 4 bytes]
2025-02-08 11:15:58,850 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:16:19,851 - DEBUG - [protocol.py:599] - < PING f6 7a 48 14 [binary, 4 bytes]
2025-02-08 11:16:19,851 - DEBUG - [protocol.py:745] - > PONG f6 7a 48 14 [binary, 4 bytes]
2025-02-08 11:16:19,853 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:16:19,854 - DEBUG - [protocol.py:745] - > PING 61 d4 ed d8 [binary, 4 bytes]
2025-02-08 11:16:19,860 - DEBUG - [protocol.py:599] - < PONG 61 d4 ed d8 [binary, 4 bytes]
2025-02-08 11:16:19,861 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:16:19,888 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:16:19,888 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:16:19,889 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:16:19,889 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:16:19,915 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:16:19,916 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:16:19,916 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:16:19,916 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:16:19,916 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:16:19,918 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:16:24,134 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 11:16:24,136 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 11:16:24,139 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 11:16:24,140 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:16:24,141 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:16:24,142 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:16:24,143 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:16:24,182 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:16:24,182 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:16:24,184 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:16:24,185 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:16:24,185 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:16:24,186 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 11:16:24,186 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:16:24.185482",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 11:16:24,215 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:16:24,216 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:16:39,856 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:16:39,857 - DEBUG - [protocol.py:745] - > PING 03 a0 b4 87 [binary, 4 bytes]
2025-02-08 11:16:39,860 - DEBUG - [protocol.py:599] - < PING e8 08 b4 f4 [binary, 4 bytes]
2025-02-08 11:16:39,861 - DEBUG - [protocol.py:745] - > PONG e8 08 b4 f4 [binary, 4 bytes]
2025-02-08 11:16:39,865 - DEBUG - [protocol.py:599] - < PONG 03 a0 b4 87 [binary, 4 bytes]
2025-02-08 11:16:39,866 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:16:59,855 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:16:59,857 - DEBUG - [protocol.py:745] - > PING 'ە+8' [text, 4 bytes]
2025-02-08 11:16:59,865 - DEBUG - [protocol.py:599] - < PING 80 9e 5a e7 [binary, 4 bytes]
2025-02-08 11:16:59,867 - DEBUG - [protocol.py:745] - > PONG 80 9e 5a e7 [binary, 4 bytes]
2025-02-08 11:16:59,872 - DEBUG - [protocol.py:599] - < PONG 'ە+8' [text, 4 bytes]
2025-02-08 11:16:59,892 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:17:19,865 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:17:19,866 - DEBUG - [protocol.py:745] - > PING b7 f8 fb da [binary, 4 bytes]
2025-02-08 11:17:19,876 - DEBUG - [protocol.py:599] - < PING d0 65 d0 e4 [binary, 4 bytes]
2025-02-08 11:17:19,878 - DEBUG - [protocol.py:745] - > PONG d0 65 d0 e4 [binary, 4 bytes]
2025-02-08 11:17:19,884 - DEBUG - [protocol.py:599] - < PONG b7 f8 fb da [binary, 4 bytes]
2025-02-08 11:17:19,886 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:17:39,874 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:17:39,875 - DEBUG - [protocol.py:745] - > PING b8 ad e0 98 [binary, 4 bytes]
2025-02-08 11:17:39,884 - DEBUG - [protocol.py:599] - < PONG b8 ad e0 98 [binary, 4 bytes]
2025-02-08 11:17:39,885 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:17:39,890 - DEBUG - [protocol.py:599] - < PING ce ba 08 cf [binary, 4 bytes]
2025-02-08 11:17:39,893 - DEBUG - [protocol.py:745] - > PONG ce ba 08 cf [binary, 4 bytes]
2025-02-08 11:17:59,863 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:17:59,863 - DEBUG - [protocol.py:745] - > PING 86 e2 6d 4f [binary, 4 bytes]
2025-02-08 11:17:59,875 - DEBUG - [protocol.py:599] - < PONG 86 e2 6d 4f [binary, 4 bytes]
2025-02-08 11:17:59,875 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:17:59,895 - DEBUG - [protocol.py:599] - < PING 13 05 a6 40 [binary, 4 bytes]
2025-02-08 11:17:59,895 - DEBUG - [protocol.py:745] - > PONG 13 05 a6 40 [binary, 4 bytes]
2025-02-08 11:18:19,886 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:18:19,886 - DEBUG - [protocol.py:745] - > PING 42 e0 1b c6 [binary, 4 bytes]
2025-02-08 11:18:19,893 - DEBUG - [protocol.py:599] - < PONG 42 e0 1b c6 [binary, 4 bytes]
2025-02-08 11:18:19,893 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:18:19,908 - DEBUG - [protocol.py:599] - < PING 00 aa 9c c5 [binary, 4 bytes]
2025-02-08 11:18:19,908 - DEBUG - [protocol.py:745] - > PONG 00 aa 9c c5 [binary, 4 bytes]
2025-02-08 11:18:39,901 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:18:39,901 - DEBUG - [protocol.py:745] - > PING 67 4d 6d dd [binary, 4 bytes]
2025-02-08 11:18:39,912 - DEBUG - [protocol.py:599] - < PONG 67 4d 6d dd [binary, 4 bytes]
2025-02-08 11:18:39,912 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:18:39,919 - DEBUG - [protocol.py:599] - < PING f3 31 37 57 [binary, 4 bytes]
2025-02-08 11:18:39,919 - DEBUG - [protocol.py:745] - > PONG f3 31 37 57 [binary, 4 bytes]
2025-02-08 11:18:59,905 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:18:59,905 - DEBUG - [protocol.py:745] - > PING b7 3f b5 ed [binary, 4 bytes]
2025-02-08 11:18:59,917 - DEBUG - [protocol.py:599] - < PONG b7 3f b5 ed [binary, 4 bytes]
2025-02-08 11:18:59,917 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:18:59,929 - DEBUG - [protocol.py:599] - < PING 7d b6 f4 ca [binary, 4 bytes]
2025-02-08 11:18:59,929 - DEBUG - [protocol.py:745] - > PONG 7d b6 f4 ca [binary, 4 bytes]
2025-02-08 11:19:19,917 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:19:19,917 - DEBUG - [protocol.py:745] - > PING 5f 2a 7d d7 [binary, 4 bytes]
2025-02-08 11:19:19,925 - DEBUG - [protocol.py:599] - < PONG 5f 2a 7d d7 [binary, 4 bytes]
2025-02-08 11:19:19,927 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:19:20,218 - DEBUG - [protocol.py:599] - < PING 3f 7d 1a c3 [binary, 4 bytes]
2025-02-08 11:19:20,218 - DEBUG - [protocol.py:745] - > PONG 3f 7d 1a c3 [binary, 4 bytes]
2025-02-08 11:19:39,947 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:19:39,947 - DEBUG - [protocol.py:745] - > PING 4c ef 6d e6 [binary, 4 bytes]
2025-02-08 11:19:39,953 - DEBUG - [protocol.py:599] - < PONG 4c ef 6d e6 [binary, 4 bytes]
2025-02-08 11:19:39,953 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:19:40,224 - DEBUG - [protocol.py:599] - < PING 68 cd 5c 97 [binary, 4 bytes]
2025-02-08 11:19:40,224 - DEBUG - [protocol.py:745] - > PONG 68 cd 5c 97 [binary, 4 bytes]
2025-02-08 11:19:59,964 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:19:59,964 - DEBUG - [protocol.py:745] - > PING a9 08 b7 13 [binary, 4 bytes]
2025-02-08 11:19:59,969 - DEBUG - [protocol.py:599] - < PONG a9 08 b7 13 [binary, 4 bytes]
2025-02-08 11:19:59,969 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:20:00,234 - DEBUG - [protocol.py:599] - < PING 8b 2c 6f e3 [binary, 4 bytes]
2025-02-08 11:20:00,234 - DEBUG - [protocol.py:745] - > PONG 8b 2c 6f e3 [binary, 4 bytes]
2025-02-08 11:20:19,979 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:20:19,981 - DEBUG - [protocol.py:745] - > PING f6 1f ae 71 [binary, 4 bytes]
2025-02-08 11:20:19,987 - DEBUG - [protocol.py:599] - < PONG f6 1f ae 71 [binary, 4 bytes]
2025-02-08 11:20:19,988 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:20:20,242 - DEBUG - [protocol.py:599] - < PING 61 5e c1 7c [binary, 4 bytes]
2025-02-08 11:20:20,242 - DEBUG - [protocol.py:745] - > PONG 61 5e c1 7c [binary, 4 bytes]
2025-02-08 11:20:39,992 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:20:39,992 - DEBUG - [protocol.py:745] - > PING ec ce ef 94 [binary, 4 bytes]
2025-02-08 11:20:40,008 - DEBUG - [protocol.py:599] - < PONG ec ce ef 94 [binary, 4 bytes]
2025-02-08 11:20:40,010 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:20:40,254 - DEBUG - [protocol.py:599] - < PING a0 46 17 32 [binary, 4 bytes]
2025-02-08 11:20:40,254 - DEBUG - [protocol.py:745] - > PONG a0 46 17 32 [binary, 4 bytes]
2025-02-08 11:20:59,996 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:20:59,996 - DEBUG - [protocol.py:745] - > PING 5e fd e2 bc [binary, 4 bytes]
2025-02-08 11:21:00,001 - DEBUG - [protocol.py:599] - < PONG 5e fd e2 bc [binary, 4 bytes]
2025-02-08 11:21:00,005 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:21:00,256 - DEBUG - [protocol.py:599] - < PING 27 f2 eb 00 [binary, 4 bytes]
2025-02-08 11:21:00,256 - DEBUG - [protocol.py:745] - > PONG 27 f2 eb 00 [binary, 4 bytes]
2025-02-08 11:21:19,998 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:21:19,998 - DEBUG - [protocol.py:745] - > PING 48 cb 49 9c [binary, 4 bytes]
2025-02-08 11:21:20,003 - DEBUG - [protocol.py:599] - < PONG 48 cb 49 9c [binary, 4 bytes]
2025-02-08 11:21:20,003 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:21:20,272 - DEBUG - [protocol.py:599] - < PING 30 27 d4 54 [binary, 4 bytes]
2025-02-08 11:21:20,272 - DEBUG - [protocol.py:745] - > PONG 30 27 d4 54 [binary, 4 bytes]
2025-02-08 11:21:25,321 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:21:25,321 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:21:25,337 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:21:25,338 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:21:25,370 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:21:25,370 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:21:25,376 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:21:25,377 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:21:25,377 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:21:25,377 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:21:29,564 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 11:21:29,564 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 11:21:29,567 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 11:21:29,567 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:21:29,567 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:21:29,567 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:21:29,567 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:21:29,614 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:21:29,616 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:21:29,618 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:21:29,624 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:21:29,624 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:21:29,624 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 11:21:29,624 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:21:29.621948",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 11:21:29,666 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:21:29,666 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:21:40,012 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:21:40,012 - DEBUG - [protocol.py:745] - > PING dd 97 ac 12 [binary, 4 bytes]
2025-02-08 11:21:40,012 - DEBUG - [protocol.py:599] - < PONG dd 97 ac 12 [binary, 4 bytes]
2025-02-08 11:21:40,012 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:21:40,286 - DEBUG - [protocol.py:599] - < PING cf 19 48 3e [binary, 4 bytes]
2025-02-08 11:21:40,286 - DEBUG - [protocol.py:745] - > PONG cf 19 48 3e [binary, 4 bytes]
2025-02-08 11:22:00,017 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:22:00,017 - DEBUG - [protocol.py:745] - > PING 28 80 34 ef [binary, 4 bytes]
2025-02-08 11:22:00,019 - DEBUG - [protocol.py:599] - < PONG 28 80 34 ef [binary, 4 bytes]
2025-02-08 11:22:00,019 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:22:00,292 - DEBUG - [protocol.py:599] - < PING 64 ae 01 92 [binary, 4 bytes]
2025-02-08 11:22:00,292 - DEBUG - [protocol.py:745] - > PONG 64 ae 01 92 [binary, 4 bytes]
2025-02-08 11:22:20,020 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:22:20,021 - DEBUG - [protocol.py:745] - > PING 13 b9 3e b4 [binary, 4 bytes]
2025-02-08 11:22:20,031 - DEBUG - [protocol.py:599] - < PONG 13 b9 3e b4 [binary, 4 bytes]
2025-02-08 11:22:20,033 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:22:20,305 - DEBUG - [protocol.py:599] - < PING 8b f6 26 08 [binary, 4 bytes]
2025-02-08 11:22:20,305 - DEBUG - [protocol.py:745] - > PONG 8b f6 26 08 [binary, 4 bytes]
2025-02-08 11:22:40,026 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:22:40,028 - DEBUG - [protocol.py:745] - > PING a3 db 8e df [binary, 4 bytes]
2025-02-08 11:22:40,036 - DEBUG - [protocol.py:599] - < PONG a3 db 8e df [binary, 4 bytes]
2025-02-08 11:22:40,038 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:22:40,311 - DEBUG - [protocol.py:599] - < PING 98 d0 29 a9 [binary, 4 bytes]
2025-02-08 11:22:40,313 - DEBUG - [protocol.py:745] - > PONG 98 d0 29 a9 [binary, 4 bytes]
2025-02-08 11:23:00,020 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:23:00,023 - DEBUG - [protocol.py:745] - > PING 42 dc 8b ee [binary, 4 bytes]
2025-02-08 11:23:00,033 - DEBUG - [protocol.py:599] - < PONG 42 dc 8b ee [binary, 4 bytes]
2025-02-08 11:23:00,035 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:23:00,324 - DEBUG - [protocol.py:599] - < PING 55 fd 34 e2 [binary, 4 bytes]
2025-02-08 11:23:00,325 - DEBUG - [protocol.py:745] - > PONG 55 fd 34 e2 [binary, 4 bytes]
2025-02-08 11:23:20,039 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:23:20,039 - DEBUG - [protocol.py:745] - > PING 0a 4f cb f3 [binary, 4 bytes]
2025-02-08 11:23:20,047 - DEBUG - [protocol.py:599] - < PONG 0a 4f cb f3 [binary, 4 bytes]
2025-02-08 11:23:20,047 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:23:20,334 - DEBUG - [protocol.py:599] - < PING 2d 74 e1 df [binary, 4 bytes]
2025-02-08 11:23:20,336 - DEBUG - [protocol.py:745] - > PONG 2d 74 e1 df [binary, 4 bytes]
2025-02-08 11:23:40,056 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:23:40,057 - DEBUG - [protocol.py:745] - > PING ':ụ' [text, 4 bytes]
2025-02-08 11:23:40,070 - DEBUG - [protocol.py:599] - < PONG ':ụ' [text, 4 bytes]
2025-02-08 11:23:40,073 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:23:40,345 - DEBUG - [protocol.py:599] - < PING bf 10 fa e2 [binary, 4 bytes]
2025-02-08 11:23:40,346 - DEBUG - [protocol.py:745] - > PONG bf 10 fa e2 [binary, 4 bytes]
2025-02-08 11:24:00,074 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:24:00,075 - DEBUG - [protocol.py:745] - > PING d4 51 b0 50 [binary, 4 bytes]
2025-02-08 11:24:00,082 - DEBUG - [protocol.py:599] - < PONG d4 51 b0 50 [binary, 4 bytes]
2025-02-08 11:24:00,082 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:24:00,356 - DEBUG - [protocol.py:599] - < PING 74 b6 a6 4d [binary, 4 bytes]
2025-02-08 11:24:00,357 - DEBUG - [protocol.py:745] - > PONG 74 b6 a6 4d [binary, 4 bytes]
2025-02-08 11:24:20,086 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:24:20,088 - DEBUG - [protocol.py:745] - > PING 85 6b a3 58 [binary, 4 bytes]
2025-02-08 11:24:20,094 - DEBUG - [protocol.py:599] - < PONG 85 6b a3 58 [binary, 4 bytes]
2025-02-08 11:24:20,096 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:24:20,368 - DEBUG - [protocol.py:599] - < PING 8b 31 c7 fc [binary, 4 bytes]
2025-02-08 11:24:20,370 - DEBUG - [protocol.py:745] - > PONG 8b 31 c7 fc [binary, 4 bytes]
2025-02-08 11:24:40,130 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:24:40,141 - DEBUG - [protocol.py:745] - > PING 93 be ab 48 [binary, 4 bytes]
2025-02-08 11:24:40,149 - DEBUG - [protocol.py:599] - < PONG 93 be ab 48 [binary, 4 bytes]
2025-02-08 11:24:40,149 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:24:40,379 - DEBUG - [protocol.py:599] - < PING 63 8b 27 96 [binary, 4 bytes]
2025-02-08 11:24:40,381 - DEBUG - [protocol.py:745] - > PONG 63 8b 27 96 [binary, 4 bytes]
2025-02-08 11:25:00,134 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:25:00,134 - DEBUG - [protocol.py:745] - > PING 8a c1 c4 f1 [binary, 4 bytes]
2025-02-08 11:25:00,142 - DEBUG - [protocol.py:599] - < PONG 8a c1 c4 f1 [binary, 4 bytes]
2025-02-08 11:25:00,142 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:25:00,387 - DEBUG - [protocol.py:599] - < PING b2 ff 7c 7a [binary, 4 bytes]
2025-02-08 11:25:00,409 - DEBUG - [protocol.py:745] - > PONG b2 ff 7c 7a [binary, 4 bytes]
2025-02-08 11:25:20,135 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:25:20,137 - DEBUG - [protocol.py:745] - > PING 30 d6 36 a0 [binary, 4 bytes]
2025-02-08 11:25:20,146 - DEBUG - [protocol.py:599] - < PONG 30 d6 36 a0 [binary, 4 bytes]
2025-02-08 11:25:20,147 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:25:20,416 - DEBUG - [protocol.py:599] - < PING 'JA|K' [text, 4 bytes]
2025-02-08 11:25:20,417 - DEBUG - [protocol.py:745] - > PONG 'JA|K' [text, 4 bytes]
2025-02-08 11:25:40,146 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:25:40,149 - DEBUG - [protocol.py:745] - > PING 51 f5 89 cc [binary, 4 bytes]
2025-02-08 11:25:40,160 - DEBUG - [protocol.py:599] - < PONG 51 f5 89 cc [binary, 4 bytes]
2025-02-08 11:25:40,162 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:25:40,425 - DEBUG - [protocol.py:599] - < PING de ef 8c 9c [binary, 4 bytes]
2025-02-08 11:25:40,426 - DEBUG - [protocol.py:745] - > PONG de ef 8c 9c [binary, 4 bytes]
2025-02-08 11:26:00,153 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:26:00,154 - DEBUG - [protocol.py:745] - > PING ab 0c d2 5c [binary, 4 bytes]
2025-02-08 11:26:00,163 - DEBUG - [protocol.py:599] - < PONG ab 0c d2 5c [binary, 4 bytes]
2025-02-08 11:26:00,165 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:26:00,437 - DEBUG - [protocol.py:599] - < PING e4 46 fc 1b [binary, 4 bytes]
2025-02-08 11:26:00,438 - DEBUG - [protocol.py:745] - > PONG e4 46 fc 1b [binary, 4 bytes]
2025-02-08 11:26:20,156 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:26:20,157 - DEBUG - [protocol.py:745] - > PING 89 8c ef 8a [binary, 4 bytes]
2025-02-08 11:26:20,168 - DEBUG - [protocol.py:599] - < PONG 89 8c ef 8a [binary, 4 bytes]
2025-02-08 11:26:20,169 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:26:20,437 - DEBUG - [protocol.py:599] - < PING 37 45 da 2b [binary, 4 bytes]
2025-02-08 11:26:20,437 - DEBUG - [protocol.py:745] - > PONG 37 45 da 2b [binary, 4 bytes]
2025-02-08 11:26:30,766 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:26:30,766 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:26:30,767 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:26:30,767 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:26:30,801 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:26:30,802 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:26:30,804 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:26:30,814 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:26:30,815 - INFO - [printer_monitor_service.py:518] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:26:30,816 - DEBUG - [printer_monitor_service.py:317] - 🔍 Consultando SNMP 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:26:35,114 - ERROR - [printer_monitor_service.py:330] - ❌ Error SNMP para 192.168.18.27: No SNMP response received before timeout
2025-02-08 11:26:35,114 - WARNING - [printer_monitor_service.py:529] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 11:26:35,117 - ERROR - [printer_monitor_service.py:122] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 11:26:35,120 - INFO - [printer_monitor_service.py:427] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:26:35,120 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:26:35,122 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:26:35,124 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:26:35,162 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:26:35,162 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:26:35,167 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:26:35,170 - DEBUG - [printer_monitor_service.py:479] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:26:35,170 - DEBUG - [printer_monitor_service.py:480] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:26:35,172 - DEBUG - [printer_monitor_service.py:481] - Parámetros: {'agent_id': '1'}
2025-02-08 11:26:35,172 - DEBUG - [printer_monitor_service.py:482] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:26:35.170049",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 11:26:35,200 - INFO - [printer_monitor_service.py:493] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:26:35,203 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:26:40,170 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:26:40,170 - DEBUG - [protocol.py:745] - > PING 4e 8f 77 f4 [binary, 4 bytes]
2025-02-08 11:26:40,180 - DEBUG - [protocol.py:599] - < PONG 4e 8f 77 f4 [binary, 4 bytes]
2025-02-08 11:26:40,180 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:26:40,451 - DEBUG - [protocol.py:599] - < PING 1e c1 d9 02 [binary, 4 bytes]
2025-02-08 11:26:40,451 - DEBUG - [protocol.py:745] - > PONG 1e c1 d9 02 [binary, 4 bytes]
2025-02-08 11:27:00,177 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:27:00,177 - DEBUG - [protocol.py:745] - > PING '`\x04fb' [text, 4 bytes]
2025-02-08 11:27:00,184 - DEBUG - [protocol.py:599] - < PONG '`\x04fb' [text, 4 bytes]
2025-02-08 11:27:00,184 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:27:00,461 - DEBUG - [protocol.py:599] - < PING d6 78 54 82 [binary, 4 bytes]
2025-02-08 11:27:00,461 - DEBUG - [protocol.py:745] - > PONG d6 78 54 82 [binary, 4 bytes]
2025-02-08 11:27:20,184 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:27:20,185 - DEBUG - [protocol.py:745] - > PING 75 e4 57 ce [binary, 4 bytes]
2025-02-08 11:27:20,192 - DEBUG - [protocol.py:599] - < PONG 75 e4 57 ce [binary, 4 bytes]
2025-02-08 11:27:20,194 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:27:20,469 - DEBUG - [protocol.py:599] - < PING d8 54 67 29 [binary, 4 bytes]
2025-02-08 11:27:20,470 - DEBUG - [protocol.py:745] - > PONG d8 54 67 29 [binary, 4 bytes]
2025-02-08 11:27:40,195 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:27:40,195 - DEBUG - [protocol.py:745] - > PING 8b 74 47 fa [binary, 4 bytes]
2025-02-08 11:27:40,201 - DEBUG - [protocol.py:599] - < PONG 8b 74 47 fa [binary, 4 bytes]
2025-02-08 11:27:40,201 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:27:40,475 - DEBUG - [protocol.py:599] - < PING 68 92 39 f8 [binary, 4 bytes]
2025-02-08 11:27:40,475 - DEBUG - [protocol.py:745] - > PONG 68 92 39 f8 [binary, 4 bytes]
2025-02-08 11:28:00,201 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:28:00,400 - DEBUG - [protocol.py:745] - > PING e0 15 6a e5 [binary, 4 bytes]
2025-02-08 11:28:00,416 - DEBUG - [protocol.py:599] - < PONG e0 15 6a e5 [binary, 4 bytes]
2025-02-08 11:28:00,419 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:28:00,482 - DEBUG - [protocol.py:599] - < PING 97 57 5c 7e [binary, 4 bytes]
2025-02-08 11:28:00,482 - DEBUG - [protocol.py:745] - > PONG 97 57 5c 7e [binary, 4 bytes]
2025-02-08 11:28:01,506 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:28:01,508 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 11:28:01,512 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:28:01,512 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 11:28:01,519 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 11:28:01,521 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 11:28:01,523 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 11:29:58,043 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 11:29:58,045 - INFO - [printer_monitor_service.py:49] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 11:29:58,046 - DEBUG - [printer_monitor_service.py:50] - Verificando configuración inicial:
2025-02-08 11:29:58,046 - DEBUG - [printer_monitor_service.py:51] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 11:29:58,046 - DEBUG - [printer_monitor_service.py:52] -   CLIENT_TOKEN presente: Sí
2025-02-08 11:29:58,046 - DEBUG - [printer_monitor_service.py:53] -   AGENT_TOKEN presente: Sí
2025-02-08 11:29:58,046 - DEBUG - [printer_monitor_service.py:54] -   SNMP Community: public
2025-02-08 11:29:58,046 - DEBUG - [printer_monitor_service.py:55] -   SNMP Port: 161
2025-02-08 11:29:58,046 - DEBUG - [printer_monitor_service.py:56] -   SNMP Timeout: 3s
2025-02-08 11:29:58,046 - DEBUG - [printer_monitor_service.py:57] -   SNMP Retries: 2
2025-02-08 11:29:58,046 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 11:29:58,079 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 11:29:58,079 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 11:29:58,079 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 11:29:58,079 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 11:29:58,079 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 11:29:58,079 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 6j+bypMhvfUzNAV6+aogjQ==
2025-02-08 11:29:58,079 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 11:29:58,079 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 11:29:58,079 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 11:29:58,103 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 11:29:58,103 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 11:29:58,107 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 11:29:58,107 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: cmFxdf7sxxwmJyIkckJIj61qF5s=
2025-02-08 11:29:58,107 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 11:29:58,108 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 16:29:57 GMT
2025-02-08 11:29:58,108 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 11:29:58,110 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 11:29:58,110 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 11:29:59,215 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:29:59,215 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:29:59,215 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:29:59,215 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:29:59,249 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:29:59,249 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:29:59,249 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:29:59,249 - INFO - [printer_monitor_service.py:118] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:29:59,249 - INFO - [printer_monitor_service.py:545] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:29:59,249 - DEBUG - [printer_monitor_service.py:328] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:29:59,249 - DEBUG - [printer_monitor_service.py:333] - Probando con community string 'public'
2025-02-08 11:30:08,305 - INFO - [printer_monitor_service.py:358] - ✅ Conexión exitosa con community 'public'
2025-02-08 11:30:08,322 - DEBUG - [printer_monitor_service.py:359] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:30:08,323 - INFO - [printer_monitor_service.py:554] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:30:08,323 - INFO - [printer_monitor_service.py:182] - 🔍 Obteniendo OIDs para marca Canon
2025-02-08 11:30:08,323 - DEBUG - [printer_monitor_service.py:189] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Canon
2025-02-08 11:30:08,354 - DEBUG - [printer_monitor_service.py:194] - 📥 Respuesta OIDs (200): [{"brand":"Canon","model_family":"Color","description":"","oid_total_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_color_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_bw_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_black_toner_level":"","oid_cyan_toner_level":"","oid_magenta_toner_level":"","oid_yellow_toner_level":"","id":6}]
2025-02-08 11:30:08,354 - INFO - [printer_monitor_service.py:199] - ✅ OIDs obtenidos y cacheados para Canon
2025-02-08 11:30:08,356 - DEBUG - [printer_monitor_service.py:200] - 📋 OIDs: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:30:08,356 - DEBUG - [printer_monitor_service.py:221] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:30:08,356 - DEBUG - [printer_monitor_service.py:222] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:30:08,359 - DEBUG - [printer_monitor_service.py:328] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:30:08,359 - DEBUG - [printer_monitor_service.py:333] - Probando con community string 'public'
2025-02-08 11:30:08,512 - INFO - [printer_monitor_service.py:358] - ✅ Conexión exitosa con community 'public'
2025-02-08 11:30:08,512 - DEBUG - [printer_monitor_service.py:359] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:30:08,512 - DEBUG - [printer_monitor_service.py:328] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:30:08,512 - DEBUG - [printer_monitor_service.py:333] - Probando con community string 'public'
2025-02-08 11:30:08,706 - INFO - [printer_monitor_service.py:358] - ✅ Conexión exitosa con community 'public'
2025-02-08 11:30:08,706 - DEBUG - [printer_monitor_service.py:359] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:30:08,708 - DEBUG - [printer_monitor_service.py:328] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:30:08,708 - DEBUG - [printer_monitor_service.py:333] - Probando con community string 'public'
2025-02-08 11:30:08,860 - INFO - [printer_monitor_service.py:358] - ✅ Conexión exitosa con community 'public'
2025-02-08 11:30:08,860 - DEBUG - [printer_monitor_service.py:359] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:30:08,860 - DEBUG - [printer_monitor_service.py:237] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88198, 'color_pages': 88198, 'bw_pages': 88198}
2025-02-08 11:30:08,860 - DEBUG - [printer_monitor_service.py:255] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:30:08,860 - DEBUG - [printer_monitor_service.py:256] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:30:08,860 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:30:08,860 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:30:08,860 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:30:08,860 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:30:08,866 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:30:08,866 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:30:08,866 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:30:08,866 - WARNING - [printer_monitor_service.py:314] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:30:08,866 - DEBUG - [printer_monitor_service.py:294] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:30:08,866 - INFO - [printer_monitor_service.py:575] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:30:08,866 - DEBUG - [printer_monitor_service.py:328] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:30:08,866 - DEBUG - [printer_monitor_service.py:333] - Probando con community string 'public'
2025-02-08 11:30:09,024 - INFO - [printer_monitor_service.py:358] - ✅ Conexión exitosa con community 'public'
2025-02-08 11:30:09,024 - DEBUG - [printer_monitor_service.py:359] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 11:30:09,024 - INFO - [printer_monitor_service.py:606] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 11:30:09,024 - INFO - [printer_monitor_service.py:152] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:30:09,024 - DEBUG - [printer_monitor_service.py:153] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88198,
    "color_pages": 88198,
    "bw_pages": 88198
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:30:09,024 - INFO - [printer_monitor_service.py:454] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:30:09,030 - INFO - [printer_monitor_service.py:67] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:30:09,030 - DEBUG - [printer_monitor_service.py:79] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:30:09,030 - DEBUG - [printer_monitor_service.py:80] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:30:09,065 - DEBUG - [printer_monitor_service.py:85] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:30:09,065 - INFO - [printer_monitor_service.py:89] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:30:09,065 - DEBUG - [printer_monitor_service.py:90] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:30:09,065 - DEBUG - [printer_monitor_service.py:506] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:30:09,071 - DEBUG - [printer_monitor_service.py:507] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:30:09,071 - DEBUG - [printer_monitor_service.py:508] - Parámetros: {'agent_id': '1'}
2025-02-08 11:30:09,071 - DEBUG - [printer_monitor_service.py:509] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:30:09.065996",
  "printer_data": {
    "counters": {
      "total_pages": 88198,
      "color_pages": 88198,
      "bw_pages": 88198
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:30:09,129 - INFO - [printer_monitor_service.py:520] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:30:09,130 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:30:18,103 - DEBUG - [protocol.py:599] - < PING 12 73 a9 02 [binary, 4 bytes]
2025-02-08 11:30:18,104 - DEBUG - [protocol.py:745] - > PONG 12 73 a9 02 [binary, 4 bytes]
2025-02-08 11:30:18,109 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:30:18,110 - DEBUG - [protocol.py:745] - > PING b0 fd 44 38 [binary, 4 bytes]
2025-02-08 11:30:18,114 - DEBUG - [protocol.py:599] - < PONG b0 fd 44 38 [binary, 4 bytes]
2025-02-08 11:30:18,115 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:30:38,100 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:30:38,102 - DEBUG - [protocol.py:745] - > PING 'BPB\x06' [text, 4 bytes]
2025-02-08 11:30:38,111 - DEBUG - [protocol.py:599] - < PONG 'BPB\x06' [text, 4 bytes]
2025-02-08 11:30:38,112 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:30:38,116 - DEBUG - [protocol.py:599] - < PING bb d4 ec 63 [binary, 4 bytes]
2025-02-08 11:30:38,118 - DEBUG - [protocol.py:745] - > PONG bb d4 ec 63 [binary, 4 bytes]
2025-02-08 11:30:58,128 - DEBUG - [protocol.py:599] - < PING f6 69 eb 2e [binary, 4 bytes]
2025-02-08 11:30:58,130 - DEBUG - [protocol.py:745] - > PONG f6 69 eb 2e [binary, 4 bytes]
2025-02-08 11:30:58,135 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:30:58,142 - DEBUG - [protocol.py:745] - > PING 82 16 1e 54 [binary, 4 bytes]
2025-02-08 11:30:58,151 - DEBUG - [protocol.py:599] - < PONG 82 16 1e 54 [binary, 4 bytes]
2025-02-08 11:30:58,153 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:31:18,139 - DEBUG - [protocol.py:599] - < PING 1a 89 21 2a [binary, 4 bytes]
2025-02-08 11:31:18,139 - DEBUG - [protocol.py:745] - > PONG 1a 89 21 2a [binary, 4 bytes]
2025-02-08 11:31:18,141 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:31:18,141 - DEBUG - [protocol.py:745] - > PING 96 90 e4 f1 [binary, 4 bytes]
2025-02-08 11:31:18,146 - DEBUG - [protocol.py:599] - < PONG 96 90 e4 f1 [binary, 4 bytes]
2025-02-08 11:31:18,147 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:31:38,142 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:31:38,144 - DEBUG - [protocol.py:745] - > PING fc 0b 6f 25 [binary, 4 bytes]
2025-02-08 11:31:38,147 - DEBUG - [protocol.py:599] - < PING 6c 94 c0 09 [binary, 4 bytes]
2025-02-08 11:31:38,148 - DEBUG - [protocol.py:745] - > PONG 6c 94 c0 09 [binary, 4 bytes]
2025-02-08 11:31:38,152 - DEBUG - [protocol.py:599] - < PONG fc 0b 6f 25 [binary, 4 bytes]
2025-02-08 11:31:38,153 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:31:58,149 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:31:58,150 - DEBUG - [protocol.py:745] - > PING 51 44 b6 ce [binary, 4 bytes]
2025-02-08 11:31:58,153 - DEBUG - [protocol.py:599] - < PING 33 e1 52 4a [binary, 4 bytes]
2025-02-08 11:31:58,155 - DEBUG - [protocol.py:745] - > PONG 33 e1 52 4a [binary, 4 bytes]
2025-02-08 11:31:58,157 - DEBUG - [protocol.py:599] - < PONG 51 44 b6 ce [binary, 4 bytes]
2025-02-08 11:31:58,158 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:32:18,152 - DEBUG - [protocol.py:599] - < PING de 4c 5d 1e [binary, 4 bytes]
2025-02-08 11:32:18,152 - DEBUG - [protocol.py:745] - > PONG de 4c 5d 1e [binary, 4 bytes]
2025-02-08 11:32:18,166 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:32:18,166 - DEBUG - [protocol.py:745] - > PING f6 7c d3 76 [binary, 4 bytes]
2025-02-08 11:32:18,172 - DEBUG - [protocol.py:599] - < PONG f6 7c d3 76 [binary, 4 bytes]
2025-02-08 11:32:18,172 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:32:38,158 - DEBUG - [protocol.py:599] - < PING a0 6f ef 66 [binary, 4 bytes]
2025-02-08 11:32:38,158 - DEBUG - [protocol.py:745] - > PONG a0 6f ef 66 [binary, 4 bytes]
2025-02-08 11:32:38,178 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:32:38,180 - DEBUG - [protocol.py:745] - > PING fd e1 61 59 [binary, 4 bytes]
2025-02-08 11:32:38,189 - DEBUG - [protocol.py:599] - < PONG fd e1 61 59 [binary, 4 bytes]
2025-02-08 11:32:38,190 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:32:58,180 - DEBUG - [protocol.py:599] - < PING b0 01 1b 29 [binary, 4 bytes]
2025-02-08 11:32:58,180 - DEBUG - [protocol.py:745] - > PONG b0 01 1b 29 [binary, 4 bytes]
2025-02-08 11:32:58,188 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:32:58,188 - DEBUG - [protocol.py:745] - > PING 6d 78 45 89 [binary, 4 bytes]
2025-02-08 11:32:58,191 - DEBUG - [protocol.py:599] - < PONG 6d 78 45 89 [binary, 4 bytes]
2025-02-08 11:32:58,196 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:33:01,318 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:33:01,318 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 11:33:01,328 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:33:01,330 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 11:33:01,332 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 11:33:01,332 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 11:33:01,332 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 11:33:05,880 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 11:33:05,882 - INFO - [printer_monitor_service.py:50] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 11:33:05,882 - DEBUG - [printer_monitor_service.py:51] - Verificando configuración inicial:
2025-02-08 11:33:05,882 - DEBUG - [printer_monitor_service.py:52] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 11:33:05,882 - DEBUG - [printer_monitor_service.py:53] -   CLIENT_TOKEN presente: Sí
2025-02-08 11:33:05,882 - DEBUG - [printer_monitor_service.py:54] -   AGENT_TOKEN presente: Sí
2025-02-08 11:33:05,882 - DEBUG - [printer_monitor_service.py:55] -   SNMP Community: public
2025-02-08 11:33:05,883 - DEBUG - [printer_monitor_service.py:56] -   SNMP Port: 161
2025-02-08 11:33:05,883 - DEBUG - [printer_monitor_service.py:57] -   SNMP Timeout: 3s
2025-02-08 11:33:05,883 - DEBUG - [printer_monitor_service.py:58] -   SNMP Retries: 2
2025-02-08 11:33:05,883 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 11:33:05,920 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 11:33:05,920 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 11:33:05,925 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 11:33:05,925 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 11:33:05,925 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 11:33:05,925 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: 6Anc1xqcuGmNx96uIKXQqw==
2025-02-08 11:33:05,925 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 11:33:05,925 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 11:33:05,928 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 11:33:05,952 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 11:33:05,952 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 11:33:05,952 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 11:33:05,952 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: BG7mfevUF6cDirAQfxuAOZGglXI=
2025-02-08 11:33:05,952 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 11:33:05,952 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 16:33:04 GMT
2025-02-08 11:33:05,952 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 11:33:05,956 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 11:33:05,957 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 11:33:07,144 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:33:07,146 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:33:07,146 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:33:07,146 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:33:07,175 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:33:07,175 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:33:07,182 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:33:07,182 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:33:07,185 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:33:07,185 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:33:07,185 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:07,359 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:07,359 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:33:07,359 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:33:07,361 - INFO - [printer_monitor_service.py:183] - 🔍 Obteniendo OIDs para marca Canon
2025-02-08 11:33:07,361 - DEBUG - [printer_monitor_service.py:190] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Canon
2025-02-08 11:33:07,382 - DEBUG - [printer_monitor_service.py:195] - 📥 Respuesta OIDs (200): [{"brand":"Canon","model_family":"Color","description":"","oid_total_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_color_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_bw_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_black_toner_level":"","oid_cyan_toner_level":"","oid_magenta_toner_level":"","oid_yellow_toner_level":"","id":6}]
2025-02-08 11:33:07,382 - INFO - [printer_monitor_service.py:200] - ✅ OIDs obtenidos y cacheados para Canon
2025-02-08 11:33:07,382 - DEBUG - [printer_monitor_service.py:201] - 📋 OIDs: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:33:07,382 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:33:07,390 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:33:07,390 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:33:07,390 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:07,542 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:07,544 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:33:07,544 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:33:07,546 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:07,719 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:07,719 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:33:07,719 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:33:07,721 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:07,869 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:07,869 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:33:07,869 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88198, 'color_pages': 88198, 'bw_pages': 88198}
2025-02-08 11:33:07,869 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:33:07,869 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:33:07,869 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:07,869 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:07,869 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:07,869 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:07,869 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:07,869 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:07,869 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:07,876 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:07,876 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:33:07,876 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:33:07,876 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:33:07,876 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:08,027 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:08,027 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:33:08,027 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:33:08,027 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:33:08,027 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88198,
    "color_pages": 88198,
    "bw_pages": 88198
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:33:08,027 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:33:08,027 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:33:08,027 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:33:08,027 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:33:08,058 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4}]...
2025-02-08 11:33:08,058 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 1 impresoras
2025-02-08 11:33:08,058 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:33:08,058 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:33:08,058 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:33:08,058 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:33:08,058 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:33:08.058389",
  "printer_data": {
    "counters": {
      "total_pages": 88198,
      "color_pages": 88198,
      "bw_pages": 88198
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:33:08,108 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:33:08,108 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:33:25,950 - DEBUG - [protocol.py:599] - < PING '\x171BH' [text, 4 bytes]
2025-02-08 11:33:25,950 - DEBUG - [protocol.py:745] - > PONG '\x171BH' [text, 4 bytes]
2025-02-08 11:33:25,978 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:33:25,978 - DEBUG - [protocol.py:745] - > PING '{ K.' [text, 4 bytes]
2025-02-08 11:33:25,980 - DEBUG - [protocol.py:599] - < PONG '{ K.' [text, 4 bytes]
2025-02-08 11:33:25,980 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:33:27,365 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:33:27,366 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 11:33:27,374 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:33:27,374 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 11:33:27,376 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 11:33:27,377 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 11:33:27,377 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 11:33:31,537 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 11:33:31,543 - INFO - [printer_monitor_service.py:50] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 11:33:31,543 - DEBUG - [printer_monitor_service.py:51] - Verificando configuración inicial:
2025-02-08 11:33:31,545 - DEBUG - [printer_monitor_service.py:52] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 11:33:31,545 - DEBUG - [printer_monitor_service.py:53] -   CLIENT_TOKEN presente: Sí
2025-02-08 11:33:31,545 - DEBUG - [printer_monitor_service.py:54] -   AGENT_TOKEN presente: Sí
2025-02-08 11:33:31,545 - DEBUG - [printer_monitor_service.py:55] -   SNMP Community: public
2025-02-08 11:33:31,545 - DEBUG - [printer_monitor_service.py:56] -   SNMP Port: 161
2025-02-08 11:33:31,545 - DEBUG - [printer_monitor_service.py:57] -   SNMP Timeout: 3s
2025-02-08 11:33:31,545 - DEBUG - [printer_monitor_service.py:58] -   SNMP Retries: 2
2025-02-08 11:33:31,545 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 11:33:31,576 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 11:33:31,589 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 11:33:31,591 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 11:33:31,591 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 11:33:31,591 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 11:33:31,591 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: kkdwwALkWpz6HuIVlIDTIA==
2025-02-08 11:33:31,591 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 11:33:31,591 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 11:33:31,596 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 11:33:31,618 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 11:33:31,620 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 11:33:31,620 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 11:33:31,620 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: rmGSEdhEVDcghAUjW5Q+dQKX8TU=
2025-02-08 11:33:31,620 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 11:33:31,623 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 16:33:30 GMT
2025-02-08 11:33:31,624 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 11:33:31,624 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 11:33:31,624 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 11:33:32,751 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:33:32,751 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:33:32,753 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:33:32,753 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:33:32,783 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:33:32,785 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:33:32,787 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-08 11:33:32,788 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:33:32,788 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:33:32,789 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:33:32,789 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:32,952 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:32,952 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:33:32,952 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:33:32,952 - INFO - [printer_monitor_service.py:183] - 🔍 Obteniendo OIDs para marca Canon
2025-02-08 11:33:32,952 - DEBUG - [printer_monitor_service.py:190] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Canon
2025-02-08 11:33:32,967 - DEBUG - [printer_monitor_service.py:195] - 📥 Respuesta OIDs (200): [{"brand":"Canon","model_family":"Color","description":"","oid_total_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_color_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_bw_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_black_toner_level":"","oid_cyan_toner_level":"","oid_magenta_toner_level":"","oid_yellow_toner_level":"","id":6}]
2025-02-08 11:33:32,967 - INFO - [printer_monitor_service.py:200] - ✅ OIDs obtenidos y cacheados para Canon
2025-02-08 11:33:32,979 - DEBUG - [printer_monitor_service.py:201] - 📋 OIDs: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:33:32,980 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:33:32,980 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:33:32,980 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:33:32,980 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:33,135 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:33,135 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:33:33,137 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:33:33,137 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:33,316 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:33,316 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:33:33,316 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:33:33,316 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:33,471 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:33,471 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88198
2025-02-08 11:33:33,471 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88198, 'color_pages': 88198, 'bw_pages': 88198}
2025-02-08 11:33:33,471 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:33:33,471 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:33:33,471 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:33,479 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:33,479 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:33,479 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:33,479 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:33,479 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:33,480 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:33,480 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:33:33,480 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:33:33,480 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:33:33,482 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:33:33,482 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:33,633 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:33,633 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:33:33,636 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:33:33,636 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:33:33,636 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88198,
    "color_pages": 88198,
    "bw_pages": 88198
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:33:33,636 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:33:33,636 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:33:33,636 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:33:33,636 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:33:33,666 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:33:33,666 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:33:33,672 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": "offline",
    "client_id": 4
  }
]
2025-02-08 11:33:33,672 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:33:33,672 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:33:33,672 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:33:33,672 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:33:33.672380",
  "printer_data": {
    "counters": {
      "total_pages": 88198,
      "color_pages": 88198,
      "bw_pages": 88198
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:33:33,701 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:33:33,701 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:33:33,701 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 11:33:33,701 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 11:33:33,708 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:33:33,708 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:33,908 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:33,908 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 11:33:33,908 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 11:33:33,908 - INFO - [printer_monitor_service.py:183] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 11:33:33,908 - DEBUG - [printer_monitor_service.py:190] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 11:33:33,932 - DEBUG - [printer_monitor_service.py:195] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 11:33:33,932 - INFO - [printer_monitor_service.py:200] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 11:33:33,932 - DEBUG - [printer_monitor_service.py:201] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:33:33,936 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 11:33:33,936 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:33:33,936 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 11:33:33,936 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:34,091 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:34,091 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 11:33:34,091 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:33:34,096 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:34,243 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:34,243 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:33:34,248 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:33:34,248 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 11:33:34,248 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 11:33:34,248 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:33:34,248 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:33:34,248 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:34,406 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:34,406 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:33:34,408 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:33:34,408 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:33:34,408 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:34,600 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:34,600 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:33:34,600 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:33:34,600 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:33:34,600 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:34,757 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:34,757 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:33:34,757 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:33:34,757 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:33:34,757 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:34,915 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:34,915 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:33:34,915 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:33:34,915 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 11:33:34,915 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 11:33:34,915 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:33:34,922 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:33:35,107 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:33:35,107 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:33:35,107 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:33:35,110 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 11:33:35,110 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 11:33:35,110 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 11:33:35,110 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:33:35,111 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:33:35,111 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:33:35,138 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":"offline","client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR"...
2025-02-08 11:33:35,138 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:33:35,144 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": "offline",
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:33:35,144 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:33:35,144 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:33:35,144 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:33:35,144 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:33:35.144257",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:33:35,171 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 11:33:35,171 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 11:33:51,626 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:33:51,626 - DEBUG - [protocol.py:745] - > PING 26 f5 9e fd [binary, 4 bytes]
2025-02-08 11:33:51,636 - DEBUG - [protocol.py:599] - < PING ab 3f 3e 3a [binary, 4 bytes]
2025-02-08 11:33:51,637 - DEBUG - [protocol.py:745] - > PONG ab 3f 3e 3a [binary, 4 bytes]
2025-02-08 11:33:51,642 - DEBUG - [protocol.py:599] - < PONG 26 f5 9e fd [binary, 4 bytes]
2025-02-08 11:33:51,645 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:34:11,618 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:34:11,618 - DEBUG - [protocol.py:745] - > PING f3 e8 68 41 [binary, 4 bytes]
2025-02-08 11:34:11,625 - DEBUG - [protocol.py:599] - < PONG f3 e8 68 41 [binary, 4 bytes]
2025-02-08 11:34:11,625 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:34:11,639 - DEBUG - [protocol.py:599] - < PING c1 3b da 87 [binary, 4 bytes]
2025-02-08 11:34:11,639 - DEBUG - [protocol.py:745] - > PONG c1 3b da 87 [binary, 4 bytes]
2025-02-08 11:34:31,631 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:34:31,631 - DEBUG - [protocol.py:745] - > PING 53 84 31 5c [binary, 4 bytes]
2025-02-08 11:34:31,639 - DEBUG - [protocol.py:599] - < PONG 53 84 31 5c [binary, 4 bytes]
2025-02-08 11:34:31,639 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:34:31,663 - DEBUG - [protocol.py:599] - < PING c5 4a bf 44 [binary, 4 bytes]
2025-02-08 11:34:31,663 - DEBUG - [protocol.py:745] - > PONG c5 4a bf 44 [binary, 4 bytes]
2025-02-08 11:34:51,643 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:34:51,644 - DEBUG - [protocol.py:745] - > PING '\x1c\x1ex[' [text, 4 bytes]
2025-02-08 11:34:51,654 - DEBUG - [protocol.py:599] - < PONG '\x1c\x1ex[' [text, 4 bytes]
2025-02-08 11:34:51,655 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:34:51,671 - DEBUG - [protocol.py:599] - < PING d1 17 72 6b [binary, 4 bytes]
2025-02-08 11:34:51,672 - DEBUG - [protocol.py:745] - > PONG d1 17 72 6b [binary, 4 bytes]
2025-02-08 11:35:11,660 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:35:11,660 - DEBUG - [protocol.py:745] - > PING a6 cd 80 37 [binary, 4 bytes]
2025-02-08 11:35:11,668 - DEBUG - [protocol.py:599] - < PONG a6 cd 80 37 [binary, 4 bytes]
2025-02-08 11:35:11,668 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:35:11,682 - DEBUG - [protocol.py:599] - < PING f6 ce dd 64 [binary, 4 bytes]
2025-02-08 11:35:11,682 - DEBUG - [protocol.py:745] - > PONG f6 ce dd 64 [binary, 4 bytes]
2025-02-08 11:35:31,677 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:35:31,677 - DEBUG - [protocol.py:745] - > PING 01 6c ed 48 [binary, 4 bytes]
2025-02-08 11:35:31,686 - DEBUG - [protocol.py:599] - < PONG 01 6c ed 48 [binary, 4 bytes]
2025-02-08 11:35:31,688 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:35:31,688 - DEBUG - [protocol.py:599] - < PING 'Q_9;' [text, 4 bytes]
2025-02-08 11:35:31,688 - DEBUG - [protocol.py:745] - > PONG 'Q_9;' [text, 4 bytes]
2025-02-08 11:35:51,690 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:35:51,697 - DEBUG - [protocol.py:745] - > PING f4 22 48 cb [binary, 4 bytes]
2025-02-08 11:35:51,708 - DEBUG - [protocol.py:599] - < PING ab e9 22 63 [binary, 4 bytes]
2025-02-08 11:35:51,708 - DEBUG - [protocol.py:745] - > PONG ab e9 22 63 [binary, 4 bytes]
2025-02-08 11:35:51,712 - DEBUG - [protocol.py:599] - < PONG f4 22 48 cb [binary, 4 bytes]
2025-02-08 11:35:51,714 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:36:11,700 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:36:11,701 - DEBUG - [protocol.py:745] - > PING ')+B\x01' [text, 4 bytes]
2025-02-08 11:36:11,710 - DEBUG - [protocol.py:599] - < PONG ')+B\x01' [text, 4 bytes]
2025-02-08 11:36:11,711 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:36:11,717 - DEBUG - [protocol.py:599] - < PING 76 db ea 26 [binary, 4 bytes]
2025-02-08 11:36:11,718 - DEBUG - [protocol.py:745] - > PONG 76 db ea 26 [binary, 4 bytes]
2025-02-08 11:36:31,707 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:36:31,707 - DEBUG - [protocol.py:745] - > PING 4a a8 b1 96 [binary, 4 bytes]
2025-02-08 11:36:31,713 - DEBUG - [protocol.py:599] - < PONG 4a a8 b1 96 [binary, 4 bytes]
2025-02-08 11:36:31,713 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:36:31,723 - DEBUG - [protocol.py:599] - < PING ac 75 39 aa [binary, 4 bytes]
2025-02-08 11:36:31,725 - DEBUG - [protocol.py:745] - > PONG ac 75 39 aa [binary, 4 bytes]
2025-02-08 11:36:51,719 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:36:51,721 - DEBUG - [protocol.py:745] - > PING 05 f2 17 22 [binary, 4 bytes]
2025-02-08 11:36:51,730 - DEBUG - [protocol.py:599] - < PONG 05 f2 17 22 [binary, 4 bytes]
2025-02-08 11:36:51,732 - DEBUG - [protocol.py:599] - < PING '\x0bHd\\' [text, 4 bytes]
2025-02-08 11:36:51,733 - DEBUG - [protocol.py:745] - > PONG '\x0bHd\\' [text, 4 bytes]
2025-02-08 11:36:51,736 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:37:11,733 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:37:11,736 - DEBUG - [protocol.py:745] - > PING ab fd 95 1b [binary, 4 bytes]
2025-02-08 11:37:11,741 - DEBUG - [protocol.py:599] - < PING 89 32 4c b4 [binary, 4 bytes]
2025-02-08 11:37:11,741 - DEBUG - [protocol.py:745] - > PONG 89 32 4c b4 [binary, 4 bytes]
2025-02-08 11:37:11,746 - DEBUG - [protocol.py:599] - < PONG ab fd 95 1b [binary, 4 bytes]
2025-02-08 11:37:11,747 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:37:31,743 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:37:31,743 - DEBUG - [protocol.py:745] - > PING 10 26 d5 79 [binary, 4 bytes]
2025-02-08 11:37:31,749 - DEBUG - [protocol.py:599] - < PING 'J\x0cJ\x08' [text, 4 bytes]
2025-02-08 11:37:31,751 - DEBUG - [protocol.py:745] - > PONG 'J\x0cJ\x08' [text, 4 bytes]
2025-02-08 11:37:31,751 - DEBUG - [protocol.py:599] - < PONG 10 26 d5 79 [binary, 4 bytes]
2025-02-08 11:37:31,756 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:37:51,757 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:37:51,757 - DEBUG - [protocol.py:745] - > PING b5 64 ea 88 [binary, 4 bytes]
2025-02-08 11:37:51,761 - DEBUG - [protocol.py:599] - < PING fd e8 a0 e4 [binary, 4 bytes]
2025-02-08 11:37:51,761 - DEBUG - [protocol.py:745] - > PONG fd e8 a0 e4 [binary, 4 bytes]
2025-02-08 11:37:51,767 - DEBUG - [protocol.py:599] - < PONG b5 64 ea 88 [binary, 4 bytes]
2025-02-08 11:37:51,769 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:38:11,765 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:38:11,765 - DEBUG - [protocol.py:745] - > PING ba 70 84 5e [binary, 4 bytes]
2025-02-08 11:38:11,770 - DEBUG - [protocol.py:599] - < PING 53 1c f2 55 [binary, 4 bytes]
2025-02-08 11:38:11,770 - DEBUG - [protocol.py:745] - > PONG 53 1c f2 55 [binary, 4 bytes]
2025-02-08 11:38:11,775 - DEBUG - [protocol.py:599] - < PONG ba 70 84 5e [binary, 4 bytes]
2025-02-08 11:38:11,777 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:38:31,773 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:38:31,773 - DEBUG - [protocol.py:745] - > PING 77 25 a9 f3 [binary, 4 bytes]
2025-02-08 11:38:31,773 - DEBUG - [protocol.py:599] - < PONG 77 25 a9 f3 [binary, 4 bytes]
2025-02-08 11:38:31,773 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:38:31,780 - DEBUG - [protocol.py:599] - < PING 28 de 42 dd [binary, 4 bytes]
2025-02-08 11:38:31,780 - DEBUG - [protocol.py:745] - > PONG 28 de 42 dd [binary, 4 bytes]
2025-02-08 11:38:36,279 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:38:36,279 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:38:36,283 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:38:36,283 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:38:36,308 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:38:36,308 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:38:36,308 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:38:36,308 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:38:36,308 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:38:36,308 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:38:36,308 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:36,482 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:36,482 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:38:36,482 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:38:36,482 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 11:38:36,482 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:38:36,482 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:38:36,482 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:38:36,482 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:36,639 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:36,639 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:38:36,639 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:38:36,639 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:36,815 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:36,815 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:38:36,815 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:38:36,815 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:37,013 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:37,013 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:38:37,013 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 11:38:37,013 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:38:37,013 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:38:37,013 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:38:37,013 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:38:37,013 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:38:37,013 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:38:37,013 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:38:37,013 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:38:37,020 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:38:37,020 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:38:37,020 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:38:37,020 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:38:37,020 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:38:37,020 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:37,199 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:37,199 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:38:37,201 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:38:37,201 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:38:37,201 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:38:37,201 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:38:37,203 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:38:37,203 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:38:37,203 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:38:37,227 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:38:37,227 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:38:37,227 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:38:37,240 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:38:37,240 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:38:37,240 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:38:37,242 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:38:37.240585",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:38:37,264 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:38:37,264 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:38:37,264 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 11:38:37,269 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 11:38:37,269 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:38:37,269 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:37,451 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:37,451 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 11:38:37,458 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 11:38:37,458 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 11:38:37,458 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 11:38:37,458 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:38:37,458 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 11:38:37,458 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:37,668 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:37,668 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 11:38:37,668 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:38:37,668 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:37,831 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:37,831 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:38:37,837 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:38:37,837 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 11:38:37,837 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 11:38:37,837 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:38:37,837 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:38:37,837 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:37,995 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:37,995 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:38:37,995 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:38:37,995 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:38:37,995 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:38,203 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:38,203 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:38:38,205 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:38:38,205 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:38:38,205 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:38,360 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:38,360 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:38:38,360 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:38:38,360 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:38:38,360 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:38,520 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:38,520 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:38:38,520 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:38:38,520 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 11:38:38,520 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 11:38:38,520 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:38:38,520 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:38,688 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:38,688 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:38:38,694 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:38:38,694 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 11:38:38,694 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 11:38:38,694 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 11:38:38,694 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:38:38,694 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:38:38,694 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:38:38,730 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:38:38,730 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:38:38,731 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:38:38,731 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:38:38,731 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:38:38,731 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:38:38,731 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:38:38.731477",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:38:38,774 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 11:38:38,774 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 11:38:51,778 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:38:51,780 - DEBUG - [protocol.py:745] - > PING 0f 90 c3 e5 [binary, 4 bytes]
2025-02-08 11:38:51,783 - DEBUG - [protocol.py:599] - < PING 70 9d 37 3c [binary, 4 bytes]
2025-02-08 11:38:51,783 - DEBUG - [protocol.py:745] - > PONG 70 9d 37 3c [binary, 4 bytes]
2025-02-08 11:38:51,783 - DEBUG - [protocol.py:599] - < PONG 0f 90 c3 e5 [binary, 4 bytes]
2025-02-08 11:38:51,793 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:38:54,277 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:38:54,277 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 11:38:54,283 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:38:54,288 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 11:38:54,289 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 11:38:54,291 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 11:38:54,291 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 11:38:58,504 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 11:38:58,510 - INFO - [printer_monitor_service.py:50] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 11:38:58,510 - DEBUG - [printer_monitor_service.py:51] - Verificando configuración inicial:
2025-02-08 11:38:58,510 - DEBUG - [printer_monitor_service.py:52] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 11:38:58,510 - DEBUG - [printer_monitor_service.py:53] -   CLIENT_TOKEN presente: Sí
2025-02-08 11:38:58,510 - DEBUG - [printer_monitor_service.py:54] -   AGENT_TOKEN presente: Sí
2025-02-08 11:38:58,510 - DEBUG - [printer_monitor_service.py:55] -   SNMP Community: public
2025-02-08 11:38:58,510 - DEBUG - [printer_monitor_service.py:56] -   SNMP Port: 161
2025-02-08 11:38:58,510 - DEBUG - [printer_monitor_service.py:57] -   SNMP Timeout: 3s
2025-02-08 11:38:58,510 - DEBUG - [printer_monitor_service.py:58] -   SNMP Retries: 2
2025-02-08 11:38:58,510 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 11:38:58,554 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 11:38:58,554 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 11:38:58,554 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 11:38:58,554 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 11:38:58,554 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 11:38:58,554 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: LkpWk4oosAbpRc8AtZ2lPg==
2025-02-08 11:38:58,554 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 11:38:58,554 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 11:38:58,554 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 11:38:58,568 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 11:38:58,568 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 11:38:58,568 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 11:38:58,568 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: hpbIqOX1vYkPCgQCMHBcnMxmU78=
2025-02-08 11:38:58,568 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 11:38:58,568 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 16:38:57 GMT
2025-02-08 11:38:58,568 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 11:38:58,568 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 11:38:58,568 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 11:38:59,678 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:38:59,678 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:38:59,678 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:38:59,678 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:38:59,716 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:38:59,718 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:38:59,718 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:38:59,718 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:38:59,720 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:38:59,720 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:38:59,720 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:38:59,905 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:38:59,905 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:38:59,905 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:38:59,910 - INFO - [printer_monitor_service.py:183] - 🔍 Obteniendo OIDs para marca Canon
2025-02-08 11:38:59,910 - DEBUG - [printer_monitor_service.py:190] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Canon
2025-02-08 11:38:59,933 - DEBUG - [printer_monitor_service.py:195] - 📥 Respuesta OIDs (200): [{"brand":"Canon","model_family":"Color","description":"","oid_total_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_color_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_bw_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_black_toner_level":"","oid_cyan_toner_level":"","oid_magenta_toner_level":"","oid_yellow_toner_level":"","id":6}]
2025-02-08 11:38:59,933 - INFO - [printer_monitor_service.py:200] - ✅ OIDs obtenidos y cacheados para Canon
2025-02-08 11:38:59,933 - DEBUG - [printer_monitor_service.py:201] - 📋 OIDs: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:38:59,933 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:38:59,933 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:38:59,933 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:38:59,933 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:00,100 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:00,100 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:39:00,100 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:39:00,100 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:00,298 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:00,298 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:39:00,298 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:39:00,310 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:00,511 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:00,511 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:39:00,513 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 11:39:00,513 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:39:00,513 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:39:00,513 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:39:00,513 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:39:00,513 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:39:00,513 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:39:00,513 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:39:00,513 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:39:00,513 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:39:00,513 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:39:00,516 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:39:00,516 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:39:00,516 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:39:00,516 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:00,674 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:00,674 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:39:00,674 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:39:00,674 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:39:00,674 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:39:00,674 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:39:00,674 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:39:00,674 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:39:00,674 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:39:00,712 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:39:00,712 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:39:00,714 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:39:00,715 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:39:00,715 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:39:00,716 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:39:00,716 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:39:00.714125",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:39:00,744 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:39:00,745 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:39:00,746 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 11:39:00,746 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 11:39:00,746 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:39:00,747 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:00,959 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:00,960 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 11:39:00,961 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 11:39:00,961 - INFO - [printer_monitor_service.py:183] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 11:39:00,961 - DEBUG - [printer_monitor_service.py:190] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 11:39:00,980 - DEBUG - [printer_monitor_service.py:195] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 11:39:00,981 - INFO - [printer_monitor_service.py:200] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 11:39:00,981 - DEBUG - [printer_monitor_service.py:201] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:39:00,981 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 11:39:00,982 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:39:00,982 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 11:39:00,985 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:01,156 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:01,157 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 11:39:01,158 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:39:01,158 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:01,326 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:01,326 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:39:01,327 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:39:01,327 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 11:39:01,327 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 11:39:01,327 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:39:01,328 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:39:01,328 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:01,494 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:01,495 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:39:01,496 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:39:01,496 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:39:01,496 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:01,720 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:01,720 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:39:01,722 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:39:01,722 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:39:01,722 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:01,899 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:01,899 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:39:01,899 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:39:01,902 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:39:01,902 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:02,057 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:02,057 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:39:02,057 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:39:02,057 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 11:39:02,057 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 11:39:02,057 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:39:02,057 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:39:02,261 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:39:02,261 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:39:02,263 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:39:02,263 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 11:39:02,263 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 11:39:02,263 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 11:39:02,264 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:39:02,264 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:39:02,264 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:39:02,297 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:39:02,297 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:39:02,307 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:39:02,307 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:39:02,307 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:39:02,307 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:39:02,307 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:39:02.307719",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:39:02,394 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 11:39:02,394 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 11:39:18,567 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:39:18,569 - DEBUG - [protocol.py:745] - > PING 10 29 ed 9b [binary, 4 bytes]
2025-02-08 11:39:18,572 - DEBUG - [protocol.py:599] - < PONG 10 29 ed 9b [binary, 4 bytes]
2025-02-08 11:39:18,578 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:39:18,578 - DEBUG - [protocol.py:599] - < PING 60 13 23 d5 [binary, 4 bytes]
2025-02-08 11:39:18,578 - DEBUG - [protocol.py:745] - > PONG 60 13 23 d5 [binary, 4 bytes]
2025-02-08 11:39:38,577 - DEBUG - [protocol.py:599] - < PING 15 b0 a9 86 [binary, 4 bytes]
2025-02-08 11:39:38,588 - DEBUG - [protocol.py:745] - > PONG 15 b0 a9 86 [binary, 4 bytes]
2025-02-08 11:39:38,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:39:38,593 - DEBUG - [protocol.py:745] - > PING 8b bd 44 58 [binary, 4 bytes]
2025-02-08 11:39:38,597 - DEBUG - [protocol.py:599] - < PONG 8b bd 44 58 [binary, 4 bytes]
2025-02-08 11:39:38,597 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:39:58,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:39:58,592 - DEBUG - [protocol.py:745] - > PING e1 7c 71 d0 [binary, 4 bytes]
2025-02-08 11:39:58,596 - DEBUG - [protocol.py:599] - < PING ")%'\x0e" [text, 4 bytes]
2025-02-08 11:39:58,597 - DEBUG - [protocol.py:745] - > PONG ")%'\x0e" [text, 4 bytes]
2025-02-08 11:39:58,597 - DEBUG - [protocol.py:599] - < PONG e1 7c 71 d0 [binary, 4 bytes]
2025-02-08 11:39:58,597 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:40:18,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:40:18,592 - DEBUG - [protocol.py:745] - > PING ea 17 e8 c2 [binary, 4 bytes]
2025-02-08 11:40:18,598 - DEBUG - [protocol.py:599] - < PONG ea 17 e8 c2 [binary, 4 bytes]
2025-02-08 11:40:18,599 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:40:18,607 - DEBUG - [protocol.py:599] - < PING 64 d5 b7 d5 [binary, 4 bytes]
2025-02-08 11:40:18,608 - DEBUG - [protocol.py:745] - > PONG 64 d5 b7 d5 [binary, 4 bytes]
2025-02-08 11:40:38,608 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:40:38,610 - DEBUG - [protocol.py:745] - > PING 41 8b 17 e7 [binary, 4 bytes]
2025-02-08 11:40:38,615 - DEBUG - [protocol.py:599] - < PING cb 89 dd 35 [binary, 4 bytes]
2025-02-08 11:40:38,616 - DEBUG - [protocol.py:745] - > PONG cb 89 dd 35 [binary, 4 bytes]
2025-02-08 11:40:38,618 - DEBUG - [protocol.py:599] - < PONG 41 8b 17 e7 [binary, 4 bytes]
2025-02-08 11:40:38,620 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:40:58,606 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:40:58,610 - DEBUG - [protocol.py:745] - > PING 't\x1f$G' [text, 4 bytes]
2025-02-08 11:40:58,614 - DEBUG - [protocol.py:599] - < PONG 't\x1f$G' [text, 4 bytes]
2025-02-08 11:40:58,614 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:40:58,623 - DEBUG - [protocol.py:599] - < PING ee 61 40 f3 [binary, 4 bytes]
2025-02-08 11:40:58,626 - DEBUG - [protocol.py:745] - > PONG ee 61 40 f3 [binary, 4 bytes]
2025-02-08 11:41:18,626 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:41:18,628 - DEBUG - [protocol.py:745] - > PING e6 e3 3e 80 [binary, 4 bytes]
2025-02-08 11:41:18,631 - DEBUG - [protocol.py:599] - < PING 8a 5c 58 62 [binary, 4 bytes]
2025-02-08 11:41:18,631 - DEBUG - [protocol.py:745] - > PONG 8a 5c 58 62 [binary, 4 bytes]
2025-02-08 11:41:18,634 - DEBUG - [protocol.py:599] - < PONG e6 e3 3e 80 [binary, 4 bytes]
2025-02-08 11:41:18,639 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:41:38,625 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:41:38,625 - DEBUG - [protocol.py:745] - > PING 8f 65 c8 59 [binary, 4 bytes]
2025-02-08 11:41:38,627 - DEBUG - [protocol.py:599] - < PONG 8f 65 c8 59 [binary, 4 bytes]
2025-02-08 11:41:38,627 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:41:38,641 - DEBUG - [protocol.py:599] - < PING 29 84 0b c7 [binary, 4 bytes]
2025-02-08 11:41:38,643 - DEBUG - [protocol.py:745] - > PONG 29 84 0b c7 [binary, 4 bytes]
2025-02-08 11:41:58,639 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:41:58,639 - DEBUG - [protocol.py:745] - > PING e8 42 cf 81 [binary, 4 bytes]
2025-02-08 11:41:58,645 - DEBUG - [protocol.py:599] - < PONG e8 42 cf 81 [binary, 4 bytes]
2025-02-08 11:41:58,645 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:41:58,653 - DEBUG - [protocol.py:599] - < PING 0d 36 d0 04 [binary, 4 bytes]
2025-02-08 11:41:58,653 - DEBUG - [protocol.py:745] - > PONG 0d 36 d0 04 [binary, 4 bytes]
2025-02-08 11:42:18,656 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:42:18,656 - DEBUG - [protocol.py:745] - > PING 3e a5 68 03 [binary, 4 bytes]
2025-02-08 11:42:18,656 - DEBUG - [protocol.py:599] - < PING ba ed 3a 79 [binary, 4 bytes]
2025-02-08 11:42:18,661 - DEBUG - [protocol.py:745] - > PONG ba ed 3a 79 [binary, 4 bytes]
2025-02-08 11:42:18,661 - DEBUG - [protocol.py:599] - < PONG 3e a5 68 03 [binary, 4 bytes]
2025-02-08 11:42:18,661 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:42:38,649 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:42:38,650 - DEBUG - [protocol.py:745] - > PING 8b 8e 7a 39 [binary, 4 bytes]
2025-02-08 11:42:38,658 - DEBUG - [protocol.py:599] - < PONG 8b 8e 7a 39 [binary, 4 bytes]
2025-02-08 11:42:38,658 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:42:38,664 - DEBUG - [protocol.py:599] - < PING 64 e9 1a c6 [binary, 4 bytes]
2025-02-08 11:42:38,664 - DEBUG - [protocol.py:745] - > PONG 64 e9 1a c6 [binary, 4 bytes]
2025-02-08 11:42:58,674 - DEBUG - [protocol.py:599] - < PING a2 e0 ae a6 [binary, 4 bytes]
2025-02-08 11:42:58,674 - DEBUG - [protocol.py:745] - > PONG a2 e0 ae a6 [binary, 4 bytes]
2025-02-08 11:42:58,676 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:42:58,676 - DEBUG - [protocol.py:745] - > PING d1 36 2f e7 [binary, 4 bytes]
2025-02-08 11:42:58,679 - DEBUG - [protocol.py:599] - < PONG d1 36 2f e7 [binary, 4 bytes]
2025-02-08 11:42:58,679 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:43:18,682 - DEBUG - [protocol.py:599] - < PING e3 f3 2c e7 [binary, 4 bytes]
2025-02-08 11:43:18,682 - DEBUG - [protocol.py:745] - > PONG e3 f3 2c e7 [binary, 4 bytes]
2025-02-08 11:43:18,682 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:43:18,682 - DEBUG - [protocol.py:745] - > PING c3 5a ee 99 [binary, 4 bytes]
2025-02-08 11:43:18,688 - DEBUG - [protocol.py:599] - < PONG c3 5a ee 99 [binary, 4 bytes]
2025-02-08 11:43:18,688 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:43:22,037 - DEBUG - [protocol.py:745] - > CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:43:22,037 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 11:43:22,043 - DEBUG - [protocol.py:599] - < CLOSE 1000 (OK) [2 bytes]
2025-02-08 11:43:22,043 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 11:43:22,043 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 11:43:22,043 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 11:43:22,043 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 11:43:28,379 - DEBUG - [proactor_events.py:625] - Using proactor: IocpProactor
2025-02-08 11:43:28,381 - INFO - [printer_monitor_service.py:50] - PrinterMonitorService inicializado con URL: ws://161.132.39.159:8000
2025-02-08 11:43:28,381 - DEBUG - [printer_monitor_service.py:51] - Verificando configuración inicial:
2025-02-08 11:43:28,382 - DEBUG - [printer_monitor_service.py:52] -   SERVER_URL: ws://161.132.39.159:8000
2025-02-08 11:43:28,382 - DEBUG - [printer_monitor_service.py:53] -   CLIENT_TOKEN presente: Sí
2025-02-08 11:43:28,382 - DEBUG - [printer_monitor_service.py:54] -   AGENT_TOKEN presente: Sí
2025-02-08 11:43:28,382 - DEBUG - [printer_monitor_service.py:55] -   SNMP Community: public
2025-02-08 11:43:28,382 - DEBUG - [printer_monitor_service.py:56] -   SNMP Port: 161
2025-02-08 11:43:28,382 - DEBUG - [printer_monitor_service.py:57] -   SNMP Timeout: 3s
2025-02-08 11:43:28,382 - DEBUG - [printer_monitor_service.py:58] -   SNMP Retries: 2
2025-02-08 11:43:28,382 - DEBUG - [agent_service.py:128] - 🔗 Conectando al servidor WebSocket: ws://161.132.39.159:8000/api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6
2025-02-08 11:43:28,423 - DEBUG - [protocol.py:175] - = connection is CONNECTING
2025-02-08 11:43:28,423 - DEBUG - [client.py:307] - > GET /api/v1/ws/agent/agt_32499ebe03d94fee8d8e5dd9446f46a6 HTTP/1.1
2025-02-08 11:43:28,423 - DEBUG - [client.py:309] - > Host: 161.132.39.159:8000
2025-02-08 11:43:28,423 - DEBUG - [client.py:309] - > Upgrade: websocket
2025-02-08 11:43:28,423 - DEBUG - [client.py:309] - > Connection: Upgrade
2025-02-08 11:43:28,423 - DEBUG - [client.py:309] - > Sec-WebSocket-Key: sOvtzG0eiNL1X9iE08lboA==
2025-02-08 11:43:28,423 - DEBUG - [client.py:309] - > Sec-WebSocket-Version: 13
2025-02-08 11:43:28,423 - DEBUG - [client.py:309] - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-02-08 11:43:28,423 - DEBUG - [client.py:309] - > User-Agent: Python/3.10 websockets/14.2
2025-02-08 11:43:28,440 - DEBUG - [client.py:333] - < HTTP/1.1 101 Switching Protocols
2025-02-08 11:43:28,440 - DEBUG - [client.py:335] - < Upgrade: websocket
2025-02-08 11:43:28,440 - DEBUG - [client.py:335] - < Connection: Upgrade
2025-02-08 11:43:28,440 - DEBUG - [client.py:335] - < Sec-WebSocket-Accept: Na18ZUtxGFjdZ+6nQxjPW75K3EM=
2025-02-08 11:43:28,440 - DEBUG - [client.py:335] - < Sec-WebSocket-Extensions: permessage-deflate
2025-02-08 11:43:28,440 - DEBUG - [client.py:335] - < date: Sat, 08 Feb 2025 16:43:26 GMT
2025-02-08 11:43:28,440 - DEBUG - [client.py:335] - < server: uvicorn
2025-02-08 11:43:28,440 - DEBUG - [protocol.py:175] - = connection is OPEN
2025-02-08 11:43:28,440 - INFO - [agent_service.py:131] - ✅ Conectado al servidor WebSocket correctamente.
2025-02-08 11:43:29,562 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:43:29,562 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:43:29,565 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:43:29,565 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:43:29,594 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:43:29,594 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:43:29,594 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:43:29,596 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:43:29,596 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:43:29,596 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:43:29,596 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:29,774 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:29,774 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:43:29,775 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:43:29,775 - INFO - [printer_monitor_service.py:183] - 🔍 Obteniendo OIDs para marca Canon
2025-02-08 11:43:29,775 - DEBUG - [printer_monitor_service.py:190] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Canon
2025-02-08 11:43:29,785 - DEBUG - [printer_monitor_service.py:195] - 📥 Respuesta OIDs (200): [{"brand":"Canon","model_family":"Color","description":"","oid_total_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_color_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_total_bw_pages":".1.3.6.1.4.1.1602.1.11.2.1.1.3.2","oid_black_toner_level":"","oid_cyan_toner_level":"","oid_magenta_toner_level":"","oid_yellow_toner_level":"","id":6}]
2025-02-08 11:43:29,785 - INFO - [printer_monitor_service.py:200] - ✅ OIDs obtenidos y cacheados para Canon
2025-02-08 11:43:29,785 - DEBUG - [printer_monitor_service.py:201] - 📋 OIDs: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:43:29,785 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:43:29,785 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:43:29,785 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:43:29,785 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:29,950 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:29,950 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:43:29,950 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:43:29,956 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:30,139 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:30,139 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:43:30,143 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:43:30,143 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:30,294 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:30,294 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:43:30,294 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 11:43:30,299 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:43:30,299 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:43:30,299 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:43:30,301 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:43:30,301 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:43:30,301 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:43:30,301 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:43:30,301 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:43:30,302 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:43:30,302 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:43:30,302 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:43:30,302 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:43:30,302 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:43:30,303 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:30,459 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:30,459 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 11:43:30,459 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 11:43:30,464 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:43:30,464 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:43:30,464 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:43:30,464 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:43:30,464 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:43:30,464 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:43:30,486 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:43:30,486 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:43:30,486 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:43:30,486 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:43:30,498 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:43:30,500 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:43:30,500 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:43:30.486209",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:43:30,531 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:43:30,531 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:43:30,531 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 11:43:30,533 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 11:43:30,533 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:43:30,533 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:30,727 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:30,727 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 11:43:30,733 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 11:43:30,733 - INFO - [printer_monitor_service.py:183] - 🔍 Obteniendo OIDs para marca Ricoh
2025-02-08 11:43:30,733 - DEBUG - [printer_monitor_service.py:190] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/printer-oids/brands/Ricoh
2025-02-08 11:43:30,757 - DEBUG - [printer_monitor_service.py:195] - 📥 Respuesta OIDs (200): [{"brand":"Ricoh","model_family":"Color","description":"","oid_total_pages":"1.3.6.1.2.1.43.10.2.1.4.1.1","oid_total_color_pages":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_total_bw_pages":null,"oid_black_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_cyan_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_magenta_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","oid_yellow_toner_level":"1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11","id":5}]
2025-02-08 11:43:30,757 - INFO - [printer_monitor_service.py:200] - ✅ OIDs obtenidos y cacheados para Ricoh
2025-02-08 11:43:30,757 - DEBUG - [printer_monitor_service.py:201] - 📋 OIDs: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:43:30,757 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 11:43:30,757 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:43:30,757 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 11:43:30,757 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:30,915 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:30,915 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 11:43:30,915 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:43:30,919 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:31,071 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:31,071 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:43:31,071 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:43:31,071 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 11:43:31,071 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 11:43:31,071 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:43:31,071 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:43:31,071 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:31,247 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:31,247 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:43:31,248 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:43:31,249 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:43:31,249 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:31,458 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:31,458 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:43:31,461 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:43:31,461 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:43:31,461 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:31,631 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:31,632 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:43:31,634 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:43:31,634 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:43:31,634 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:31,829 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:31,829 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:43:31,830 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:43:31,830 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 11:43:31,830 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 11:43:31,831 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:43:31,831 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:43:32,034 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:43:32,034 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:43:32,035 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:43:32,035 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 11:43:32,035 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 11:43:32,035 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 11:43:32,035 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:43:32,035 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:43:32,035 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:43:32,057 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:43:32,057 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:43:32,057 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:43:32,068 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:43:32,068 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:43:32,068 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:43:32,068 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:43:32.068173",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:43:32,089 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 11:43:32,096 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 11:43:48,441 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:43:48,442 - DEBUG - [protocol.py:745] - > PING 'یQ\x0c' [text, 4 bytes]
2025-02-08 11:43:48,448 - DEBUG - [protocol.py:599] - < PING 07 17 ad da [binary, 4 bytes]
2025-02-08 11:43:48,450 - DEBUG - [protocol.py:745] - > PONG 07 17 ad da [binary, 4 bytes]
2025-02-08 11:43:48,454 - DEBUG - [protocol.py:599] - < PONG 'یQ\x0c' [text, 4 bytes]
2025-02-08 11:43:48,455 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:44:08,451 - DEBUG - [protocol.py:599] - < PING 76 ec 31 94 [binary, 4 bytes]
2025-02-08 11:44:08,451 - DEBUG - [protocol.py:745] - > PONG 76 ec 31 94 [binary, 4 bytes]
2025-02-08 11:44:08,463 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:44:08,465 - DEBUG - [protocol.py:745] - > PING 71 98 91 04 [binary, 4 bytes]
2025-02-08 11:44:08,471 - DEBUG - [protocol.py:599] - < PONG 71 98 91 04 [binary, 4 bytes]
2025-02-08 11:44:08,473 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:44:28,464 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:44:28,466 - DEBUG - [protocol.py:745] - > PING 99 c8 65 be [binary, 4 bytes]
2025-02-08 11:44:28,466 - DEBUG - [protocol.py:599] - < PING ad 9f 34 69 [binary, 4 bytes]
2025-02-08 11:44:28,470 - DEBUG - [protocol.py:745] - > PONG ad 9f 34 69 [binary, 4 bytes]
2025-02-08 11:44:28,474 - DEBUG - [protocol.py:599] - < PONG 99 c8 65 be [binary, 4 bytes]
2025-02-08 11:44:28,476 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:44:48,463 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:44:48,465 - DEBUG - [protocol.py:745] - > PING 70 48 53 a7 [binary, 4 bytes]
2025-02-08 11:44:48,475 - DEBUG - [protocol.py:599] - < PONG 70 48 53 a7 [binary, 4 bytes]
2025-02-08 11:44:48,478 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:44:48,479 - DEBUG - [protocol.py:599] - < PING e7 3d b5 68 [binary, 4 bytes]
2025-02-08 11:44:48,483 - DEBUG - [protocol.py:745] - > PONG e7 3d b5 68 [binary, 4 bytes]
2025-02-08 11:45:08,480 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:45:08,480 - DEBUG - [protocol.py:745] - > PING '\x06߱\x1e' [text, 4 bytes]
2025-02-08 11:45:08,486 - DEBUG - [protocol.py:599] - < PING 92 7a b0 04 [binary, 4 bytes]
2025-02-08 11:45:08,495 - DEBUG - [protocol.py:745] - > PONG 92 7a b0 04 [binary, 4 bytes]
2025-02-08 11:45:08,498 - DEBUG - [protocol.py:599] - < PONG '\x06߱\x1e' [text, 4 bytes]
2025-02-08 11:45:08,530 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:45:28,488 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:45:28,489 - DEBUG - [protocol.py:745] - > PING c4 dd c4 94 [binary, 4 bytes]
2025-02-08 11:45:28,498 - DEBUG - [protocol.py:599] - < PONG c4 dd c4 94 [binary, 4 bytes]
2025-02-08 11:45:28,501 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:45:28,503 - DEBUG - [protocol.py:599] - < PING 65 10 5a fa [binary, 4 bytes]
2025-02-08 11:45:28,505 - DEBUG - [protocol.py:745] - > PONG 65 10 5a fa [binary, 4 bytes]
2025-02-08 11:45:48,503 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:45:48,505 - DEBUG - [protocol.py:745] - > PING 4c 6d 86 30 [binary, 4 bytes]
2025-02-08 11:45:48,513 - DEBUG - [protocol.py:599] - < PONG 4c 6d 86 30 [binary, 4 bytes]
2025-02-08 11:45:48,514 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:45:48,515 - DEBUG - [protocol.py:599] - < PING b9 e4 6f d8 [binary, 4 bytes]
2025-02-08 11:45:48,515 - DEBUG - [protocol.py:745] - > PONG b9 e4 6f d8 [binary, 4 bytes]
2025-02-08 11:46:08,520 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:46:08,520 - DEBUG - [protocol.py:745] - > PING 1c 15 03 a2 [binary, 4 bytes]
2025-02-08 11:46:08,521 - DEBUG - [protocol.py:599] - < PING fe fd e5 e0 [binary, 4 bytes]
2025-02-08 11:46:08,522 - DEBUG - [protocol.py:745] - > PONG fe fd e5 e0 [binary, 4 bytes]
2025-02-08 11:46:08,525 - DEBUG - [protocol.py:599] - < PONG 1c 15 03 a2 [binary, 4 bytes]
2025-02-08 11:46:08,525 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:46:28,527 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:46:28,529 - DEBUG - [protocol.py:745] - > PING 99 78 bf 6c [binary, 4 bytes]
2025-02-08 11:46:28,532 - DEBUG - [protocol.py:599] - < PING f8 07 a7 41 [binary, 4 bytes]
2025-02-08 11:46:28,533 - DEBUG - [protocol.py:745] - > PONG f8 07 a7 41 [binary, 4 bytes]
2025-02-08 11:46:28,538 - DEBUG - [protocol.py:599] - < PONG 99 78 bf 6c [binary, 4 bytes]
2025-02-08 11:46:28,539 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:46:48,532 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:46:48,534 - DEBUG - [protocol.py:745] - > PING 3a 6b 7a ec [binary, 4 bytes]
2025-02-08 11:46:48,540 - DEBUG - [protocol.py:599] - < PING 85 9a a9 61 [binary, 4 bytes]
2025-02-08 11:46:48,541 - DEBUG - [protocol.py:745] - > PONG 85 9a a9 61 [binary, 4 bytes]
2025-02-08 11:46:48,543 - DEBUG - [protocol.py:599] - < PONG 3a 6b 7a ec [binary, 4 bytes]
2025-02-08 11:46:48,544 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:47:08,548 - DEBUG - [protocol.py:599] - < PING c3 15 4b 73 [binary, 4 bytes]
2025-02-08 11:47:08,549 - DEBUG - [protocol.py:745] - > PONG c3 15 4b 73 [binary, 4 bytes]
2025-02-08 11:47:08,551 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:47:08,552 - DEBUG - [protocol.py:745] - > PING f9 39 fe 31 [binary, 4 bytes]
2025-02-08 11:47:08,561 - DEBUG - [protocol.py:599] - < PONG f9 39 fe 31 [binary, 4 bytes]
2025-02-08 11:47:08,562 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:47:28,557 - DEBUG - [protocol.py:599] - < PING 96 60 8c 93 [binary, 4 bytes]
2025-02-08 11:47:28,559 - DEBUG - [protocol.py:745] - > PONG 96 60 8c 93 [binary, 4 bytes]
2025-02-08 11:47:28,560 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:47:28,561 - DEBUG - [protocol.py:745] - > PING 7d c9 22 50 [binary, 4 bytes]
2025-02-08 11:47:28,566 - DEBUG - [protocol.py:599] - < PONG 7d c9 22 50 [binary, 4 bytes]
2025-02-08 11:47:28,568 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:47:48,566 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:47:48,567 - DEBUG - [protocol.py:745] - > PING 38 be 7f 69 [binary, 4 bytes]
2025-02-08 11:47:48,572 - DEBUG - [protocol.py:599] - < PING 40 3e 58 81 [binary, 4 bytes]
2025-02-08 11:47:48,573 - DEBUG - [protocol.py:745] - > PONG 40 3e 58 81 [binary, 4 bytes]
2025-02-08 11:47:48,575 - DEBUG - [protocol.py:599] - < PONG 38 be 7f 69 [binary, 4 bytes]
2025-02-08 11:47:48,578 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:48:08,583 - DEBUG - [protocol.py:599] - < PING a5 eb 4d d2 [binary, 4 bytes]
2025-02-08 11:48:08,584 - DEBUG - [protocol.py:745] - > PONG a5 eb 4d d2 [binary, 4 bytes]
2025-02-08 11:48:08,587 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:48:08,588 - DEBUG - [protocol.py:745] - > PING c1 f5 49 75 [binary, 4 bytes]
2025-02-08 11:48:08,597 - DEBUG - [protocol.py:599] - < PONG c1 f5 49 75 [binary, 4 bytes]
2025-02-08 11:48:08,598 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:48:28,591 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:48:28,591 - DEBUG - [protocol.py:745] - > PING e4 a6 d7 39 [binary, 4 bytes]
2025-02-08 11:48:28,593 - DEBUG - [protocol.py:599] - < PING ae da be 1b [binary, 4 bytes]
2025-02-08 11:48:28,593 - DEBUG - [protocol.py:745] - > PONG ae da be 1b [binary, 4 bytes]
2025-02-08 11:48:28,600 - DEBUG - [protocol.py:599] - < PONG e4 a6 d7 39 [binary, 4 bytes]
2025-02-08 11:48:28,600 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:48:33,199 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:48:33,201 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:48:33,201 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:48:33,201 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:48:33,231 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:48:33,232 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:48:33,232 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:48:33,233 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 11:48:33,233 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 11:48:33,233 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:48:33,233 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:33,397 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:33,397 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 11:48:33,398 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 11:48:33,398 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 11:48:33,398 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 11:48:33,399 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:48:33,399 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 11:48:33,400 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:33,595 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:33,595 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 11:48:33,595 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:48:33,596 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:33,823 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:33,823 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:48:33,823 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:48:33,824 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 11:48:33,824 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 11:48:33,824 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:48:33,824 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:48:33,824 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:34,037 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:34,037 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:48:34,037 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:48:34,037 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:48:34,037 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:34,201 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:34,201 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:48:34,202 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:48:34,202 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:48:34,202 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:34,379 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:34,379 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:48:34,381 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:48:34,381 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:48:34,381 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:34,614 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:34,615 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:48:34,615 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:48:34,615 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 11:48:34,615 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 11:48:34,616 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:48:34,616 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:34,790 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:34,790 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:48:34,791 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:48:34,791 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 11:48:34,791 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 11:48:34,792 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 11:48:34,792 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:48:34,792 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:48:34,792 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:48:34,827 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:48:34,827 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:48:34,827 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:48:34,828 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:48:34,828 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:48:34,828 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:48:34,828 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:48:34.827123",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:48:34,857 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 11:48:34,858 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 11:48:34,858 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:48:34,858 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:48:34,858 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:48:34,858 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:35,092 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:35,093 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:48:35,093 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:48:35,094 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 11:48:35,095 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:48:35,096 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:48:35,096 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:48:35,096 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:35,433 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:35,433 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:48:35,433 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:48:35,433 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:35,650 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:35,650 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:48:35,651 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:48:35,651 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:35,838 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:35,839 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:48:35,841 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 11:48:35,841 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:48:35,841 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:48:35,842 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:48:35,842 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:48:35,842 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:48:35,842 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:48:35,842 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:48:35,842 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:48:35,842 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:48:35,844 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:48:35,844 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:48:35,844 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:48:35,844 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:48:35,845 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:48:36,012 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:48:36,012 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 11:48:36,012 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 11:48:36,013 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:48:36,013 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:48:36,013 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:48:36,013 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:48:36,014 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:48:36,014 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:48:36,047 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:48:36,048 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:48:36,049 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:48:36,050 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:48:36,050 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:48:36,051 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:48:36,052 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:48:36.050375",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:48:36,085 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:48:36,085 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:48:48,599 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:48:48,601 - DEBUG - [protocol.py:745] - > PING f0 70 11 a1 [binary, 4 bytes]
2025-02-08 11:48:48,603 - DEBUG - [protocol.py:599] - < PING fd ec 86 05 [binary, 4 bytes]
2025-02-08 11:48:48,605 - DEBUG - [protocol.py:745] - > PONG fd ec 86 05 [binary, 4 bytes]
2025-02-08 11:48:48,609 - DEBUG - [protocol.py:599] - < PONG f0 70 11 a1 [binary, 4 bytes]
2025-02-08 11:48:48,610 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:49:08,614 - DEBUG - [protocol.py:599] - < PING 4a de df 6a [binary, 4 bytes]
2025-02-08 11:49:08,614 - DEBUG - [protocol.py:745] - > PONG 4a de df 6a [binary, 4 bytes]
2025-02-08 11:49:08,615 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:49:08,615 - DEBUG - [protocol.py:745] - > PING 2b 11 7e 94 [binary, 4 bytes]
2025-02-08 11:49:08,622 - DEBUG - [protocol.py:599] - < PONG 2b 11 7e 94 [binary, 4 bytes]
2025-02-08 11:49:08,623 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:49:28,628 - DEBUG - [protocol.py:599] - < PING 'HQ\x1cG' [text, 4 bytes]
2025-02-08 11:49:28,630 - DEBUG - [protocol.py:745] - > PONG 'HQ\x1cG' [text, 4 bytes]
2025-02-08 11:49:28,633 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:49:28,634 - DEBUG - [protocol.py:745] - > PING ea 9b 3c 57 [binary, 4 bytes]
2025-02-08 11:49:28,642 - DEBUG - [protocol.py:599] - < PONG ea 9b 3c 57 [binary, 4 bytes]
2025-02-08 11:49:28,644 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:49:48,634 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:49:48,635 - DEBUG - [protocol.py:745] - > PING 3f 1e 83 26 [binary, 4 bytes]
2025-02-08 11:49:48,637 - DEBUG - [protocol.py:599] - < PING '{ҙ\t' [text, 4 bytes]
2025-02-08 11:49:48,639 - DEBUG - [protocol.py:745] - > PONG '{ҙ\t' [text, 4 bytes]
2025-02-08 11:49:48,643 - DEBUG - [protocol.py:599] - < PONG 3f 1e 83 26 [binary, 4 bytes]
2025-02-08 11:49:48,643 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:50:08,647 - DEBUG - [protocol.py:599] - < PING d7 7b aa 96 [binary, 4 bytes]
2025-02-08 11:50:08,648 - DEBUG - [protocol.py:745] - > PONG d7 7b aa 96 [binary, 4 bytes]
2025-02-08 11:50:08,650 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:50:08,651 - DEBUG - [protocol.py:745] - > PING 2d 1c 93 23 [binary, 4 bytes]
2025-02-08 11:50:08,656 - DEBUG - [protocol.py:599] - < PONG 2d 1c 93 23 [binary, 4 bytes]
2025-02-08 11:50:08,657 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:50:28,655 - DEBUG - [protocol.py:599] - < PING f2 3d 96 2e [binary, 4 bytes]
2025-02-08 11:50:28,657 - DEBUG - [protocol.py:745] - > PONG f2 3d 96 2e [binary, 4 bytes]
2025-02-08 11:50:28,660 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:50:28,661 - DEBUG - [protocol.py:745] - > PING 64 d3 01 64 [binary, 4 bytes]
2025-02-08 11:50:28,669 - DEBUG - [protocol.py:599] - < PONG 64 d3 01 64 [binary, 4 bytes]
2025-02-08 11:50:28,670 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:50:48,667 - DEBUG - [protocol.py:599] - < PING 5e 25 e7 f3 [binary, 4 bytes]
2025-02-08 11:50:48,668 - DEBUG - [protocol.py:745] - > PONG 5e 25 e7 f3 [binary, 4 bytes]
2025-02-08 11:50:48,670 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:50:48,672 - DEBUG - [protocol.py:745] - > PING 50 a1 dc 1b [binary, 4 bytes]
2025-02-08 11:50:48,679 - DEBUG - [protocol.py:599] - < PONG 50 a1 dc 1b [binary, 4 bytes]
2025-02-08 11:50:48,681 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:51:08,675 - DEBUG - [protocol.py:599] - < PING 'M0\x00?' [text, 4 bytes]
2025-02-08 11:51:08,677 - DEBUG - [protocol.py:745] - > PONG 'M0\x00?' [text, 4 bytes]
2025-02-08 11:51:08,678 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:51:08,680 - DEBUG - [protocol.py:745] - > PING 41 45 4e 9b [binary, 4 bytes]
2025-02-08 11:51:08,694 - DEBUG - [protocol.py:599] - < PONG 41 45 4e 9b [binary, 4 bytes]
2025-02-08 11:51:08,696 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:51:28,683 - DEBUG - [protocol.py:599] - < PING b9 ad 85 2c [binary, 4 bytes]
2025-02-08 11:51:28,684 - DEBUG - [protocol.py:745] - > PONG b9 ad 85 2c [binary, 4 bytes]
2025-02-08 11:51:28,686 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:51:28,688 - DEBUG - [protocol.py:745] - > PING ca 8d 48 c1 [binary, 4 bytes]
2025-02-08 11:51:28,693 - DEBUG - [protocol.py:599] - < PONG ca 8d 48 c1 [binary, 4 bytes]
2025-02-08 11:51:28,694 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:51:48,680 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:51:48,681 - DEBUG - [protocol.py:745] - > PING 7c b7 cd 60 [binary, 4 bytes]
2025-02-08 11:51:48,688 - DEBUG - [protocol.py:599] - < PONG 7c b7 cd 60 [binary, 4 bytes]
2025-02-08 11:51:48,689 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:51:48,697 - DEBUG - [protocol.py:599] - < PING '\x0f\x0eY{' [text, 4 bytes]
2025-02-08 11:51:48,698 - DEBUG - [protocol.py:745] - > PONG '\x0f\x0eY{' [text, 4 bytes]
2025-02-08 11:52:08,694 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:52:08,696 - DEBUG - [protocol.py:745] - > PING c7 8f 1f ad [binary, 4 bytes]
2025-02-08 11:52:08,707 - DEBUG - [protocol.py:599] - < PONG c7 8f 1f ad [binary, 4 bytes]
2025-02-08 11:52:08,709 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:52:08,713 - DEBUG - [protocol.py:599] - < PING 51 aa 74 3f [binary, 4 bytes]
2025-02-08 11:52:08,714 - DEBUG - [protocol.py:745] - > PONG 51 aa 74 3f [binary, 4 bytes]
2025-02-08 11:52:28,709 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:52:28,709 - DEBUG - [protocol.py:745] - > PING c1 d1 11 5b [binary, 4 bytes]
2025-02-08 11:52:28,714 - DEBUG - [protocol.py:599] - < PONG c1 d1 11 5b [binary, 4 bytes]
2025-02-08 11:52:28,715 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:52:28,724 - DEBUG - [protocol.py:599] - < PING f9 6b ec 33 [binary, 4 bytes]
2025-02-08 11:52:28,725 - DEBUG - [protocol.py:745] - > PONG f9 6b ec 33 [binary, 4 bytes]
2025-02-08 11:52:48,720 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:52:48,721 - DEBUG - [protocol.py:745] - > PING 55 89 36 25 [binary, 4 bytes]
2025-02-08 11:52:48,731 - DEBUG - [protocol.py:599] - < PING ac 8c 60 8a [binary, 4 bytes]
2025-02-08 11:52:48,732 - DEBUG - [protocol.py:745] - > PONG ac 8c 60 8a [binary, 4 bytes]
2025-02-08 11:52:48,733 - DEBUG - [protocol.py:599] - < PONG 55 89 36 25 [binary, 4 bytes]
2025-02-08 11:52:48,735 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:53:08,727 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:53:08,729 - DEBUG - [protocol.py:745] - > PING 79 cf ff 16 [binary, 4 bytes]
2025-02-08 11:53:08,734 - DEBUG - [protocol.py:599] - < PONG 79 cf ff 16 [binary, 4 bytes]
2025-02-08 11:53:08,735 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:53:08,741 - DEBUG - [protocol.py:599] - < PING 4a c6 e5 f9 [binary, 4 bytes]
2025-02-08 11:53:08,742 - DEBUG - [protocol.py:745] - > PONG 4a c6 e5 f9 [binary, 4 bytes]
2025-02-08 11:53:28,729 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:53:28,730 - DEBUG - [protocol.py:745] - > PING c7 2d 36 c1 [binary, 4 bytes]
2025-02-08 11:53:28,739 - DEBUG - [protocol.py:599] - < PONG c7 2d 36 c1 [binary, 4 bytes]
2025-02-08 11:53:28,740 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:53:28,749 - DEBUG - [protocol.py:599] - < PING 85 ce 42 89 [binary, 4 bytes]
2025-02-08 11:53:28,751 - DEBUG - [protocol.py:745] - > PONG 85 ce 42 89 [binary, 4 bytes]
2025-02-08 11:53:37,178 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:53:37,179 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:53:37,179 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:53:37,180 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:53:37,208 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:53:37,208 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:53:37,209 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:53:37,209 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 11:53:37,210 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 11:53:37,210 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:53:37,211 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:37,423 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:37,424 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 11:53:37,424 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 11:53:37,424 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 11:53:37,424 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 11:53:37,425 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:53:37,425 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 11:53:37,425 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:37,601 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:37,601 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 11:53:37,602 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:53:37,602 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:37,759 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:37,759 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:53:37,760 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:53:37,760 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 11:53:37,760 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 11:53:37,760 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:53:37,761 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:53:37,762 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:37,961 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:37,962 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:53:37,963 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:53:37,963 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:53:37,963 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:38,115 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:38,116 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:53:38,116 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:53:38,116 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:53:38,116 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:38,267 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:38,267 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:53:38,268 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:53:38,269 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:53:38,269 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:38,426 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:38,426 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:53:38,426 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:53:38,426 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 11:53:38,426 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 11:53:38,426 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:53:38,427 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:38,620 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:38,620 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:53:38,620 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:53:38,620 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 11:53:38,620 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 11:53:38,620 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 11:53:38,621 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:53:38,621 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:53:38,621 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:53:38,651 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:53:38,651 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:53:38,651 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:53:38,652 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:53:38,652 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:53:38,652 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:53:38,653 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:53:38.652641",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:53:38,678 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 11:53:38,678 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 11:53:38,679 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:53:38,679 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:53:38,679 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:53:38,679 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:38,835 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:38,835 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:53:38,836 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:53:38,836 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 11:53:38,837 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:53:38,838 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:53:38,839 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:53:38,839 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:39,032 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:39,032 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:53:39,033 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:53:39,034 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:39,265 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:39,265 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:53:39,265 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:53:39,266 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:39,448 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:39,448 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:53:39,448 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 11:53:39,449 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:53:39,449 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:53:39,449 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:53:39,450 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:53:39,450 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:53:39,452 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:53:39,452 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:53:39,452 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:53:39,452 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:53:39,452 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:53:39,452 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:53:39,454 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:53:39,455 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:53:39,455 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:53:39,635 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:53:39,635 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 11:53:39,636 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 11:53:39,636 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:53:39,637 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:53:39,637 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:53:39,637 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:53:39,637 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:53:39,637 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:53:39,669 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:53:39,670 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:53:39,670 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:53:39,671 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:53:39,671 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:53:39,671 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:53:39,673 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:53:39.671991",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:53:39,718 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:53:39,718 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:53:48,735 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:53:48,736 - DEBUG - [protocol.py:745] - > PING db 5a f9 3f [binary, 4 bytes]
2025-02-08 11:53:48,741 - DEBUG - [protocol.py:599] - < PONG db 5a f9 3f [binary, 4 bytes]
2025-02-08 11:53:48,743 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:53:48,757 - DEBUG - [protocol.py:599] - < PING 66 76 90 ed [binary, 4 bytes]
2025-02-08 11:53:48,758 - DEBUG - [protocol.py:745] - > PONG 66 76 90 ed [binary, 4 bytes]
2025-02-08 11:54:08,743 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:54:08,744 - DEBUG - [protocol.py:745] - > PING 'd˄\x00' [text, 4 bytes]
2025-02-08 11:54:08,760 - DEBUG - [protocol.py:599] - < PONG 'd˄\x00' [text, 4 bytes]
2025-02-08 11:54:08,762 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:54:08,764 - DEBUG - [protocol.py:599] - < PING 'dI5?' [text, 4 bytes]
2025-02-08 11:54:08,765 - DEBUG - [protocol.py:745] - > PONG 'dI5?' [text, 4 bytes]
2025-02-08 11:54:28,754 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:54:28,755 - DEBUG - [protocol.py:745] - > PING '(d\x0f\t' [text, 4 bytes]
2025-02-08 11:54:28,767 - DEBUG - [protocol.py:599] - < PONG '(d\x0f\t' [text, 4 bytes]
2025-02-08 11:54:28,769 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:54:28,777 - DEBUG - [protocol.py:599] - < PING 'I\x7fK\x0f' [text, 4 bytes]
2025-02-08 11:54:28,778 - DEBUG - [protocol.py:745] - > PONG 'I\x7fK\x0f' [text, 4 bytes]
2025-02-08 11:54:48,786 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:54:48,787 - DEBUG - [protocol.py:745] - > PING 8b ed ab dd [binary, 4 bytes]
2025-02-08 11:54:48,788 - DEBUG - [protocol.py:599] - < PING 2a 35 8c 06 [binary, 4 bytes]
2025-02-08 11:54:48,789 - DEBUG - [protocol.py:745] - > PONG 2a 35 8c 06 [binary, 4 bytes]
2025-02-08 11:54:48,792 - DEBUG - [protocol.py:599] - < PONG 8b ed ab dd [binary, 4 bytes]
2025-02-08 11:54:48,794 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:55:08,797 - DEBUG - [protocol.py:599] - < PING 4d 16 75 c6 [binary, 4 bytes]
2025-02-08 11:55:08,799 - DEBUG - [protocol.py:745] - > PONG 4d 16 75 c6 [binary, 4 bytes]
2025-02-08 11:55:08,801 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:55:08,802 - DEBUG - [protocol.py:745] - > PING c3 4c 39 50 [binary, 4 bytes]
2025-02-08 11:55:08,807 - DEBUG - [protocol.py:599] - < PONG c3 4c 39 50 [binary, 4 bytes]
2025-02-08 11:55:08,808 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:55:28,804 - DEBUG - [protocol.py:599] - < PING 0f 4f b1 ed [binary, 4 bytes]
2025-02-08 11:55:28,804 - DEBUG - [protocol.py:745] - > PONG 0f 4f b1 ed [binary, 4 bytes]
2025-02-08 11:55:28,805 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:55:28,805 - DEBUG - [protocol.py:745] - > PING '\\!\x06&' [text, 4 bytes]
2025-02-08 11:55:28,813 - DEBUG - [protocol.py:599] - < PONG '\\!\x06&' [text, 4 bytes]
2025-02-08 11:55:28,813 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:55:48,813 - DEBUG - [protocol.py:599] - < PING 4b 22 f1 44 [binary, 4 bytes]
2025-02-08 11:55:48,815 - DEBUG - [protocol.py:745] - > PONG 4b 22 f1 44 [binary, 4 bytes]
2025-02-08 11:55:48,817 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:55:48,818 - DEBUG - [protocol.py:745] - > PING 15 f8 d3 02 [binary, 4 bytes]
2025-02-08 11:55:48,827 - DEBUG - [protocol.py:599] - < PONG 15 f8 d3 02 [binary, 4 bytes]
2025-02-08 11:55:48,829 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:56:08,824 - DEBUG - [protocol.py:599] - < PING 0d c9 b1 c9 [binary, 4 bytes]
2025-02-08 11:56:08,826 - DEBUG - [protocol.py:745] - > PONG 0d c9 b1 c9 [binary, 4 bytes]
2025-02-08 11:56:08,828 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:56:08,829 - DEBUG - [protocol.py:745] - > PING f1 a7 95 31 [binary, 4 bytes]
2025-02-08 11:56:08,835 - DEBUG - [protocol.py:599] - < PONG f1 a7 95 31 [binary, 4 bytes]
2025-02-08 11:56:08,836 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:56:28,831 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:56:28,831 - DEBUG - [protocol.py:745] - > PING 72 ed 23 8f [binary, 4 bytes]
2025-02-08 11:56:28,832 - DEBUG - [protocol.py:599] - < PING 4f ff 29 8a [binary, 4 bytes]
2025-02-08 11:56:28,833 - DEBUG - [protocol.py:745] - > PONG 4f ff 29 8a [binary, 4 bytes]
2025-02-08 11:56:28,836 - DEBUG - [protocol.py:599] - < PONG 72 ed 23 8f [binary, 4 bytes]
2025-02-08 11:56:28,837 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:56:48,840 - DEBUG - [protocol.py:599] - < PING eb 10 d4 21 [binary, 4 bytes]
2025-02-08 11:56:48,841 - DEBUG - [protocol.py:745] - > PONG eb 10 d4 21 [binary, 4 bytes]
2025-02-08 11:56:48,843 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:56:48,843 - DEBUG - [protocol.py:745] - > PING 37 cc 99 f6 [binary, 4 bytes]
2025-02-08 11:56:48,848 - DEBUG - [protocol.py:599] - < PONG 37 cc 99 f6 [binary, 4 bytes]
2025-02-08 11:56:48,849 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:57:08,847 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:57:08,847 - DEBUG - [protocol.py:745] - > PING 56 d2 19 cf [binary, 4 bytes]
2025-02-08 11:57:08,849 - DEBUG - [protocol.py:599] - < PING f6 65 4a 43 [binary, 4 bytes]
2025-02-08 11:57:08,850 - DEBUG - [protocol.py:745] - > PONG f6 65 4a 43 [binary, 4 bytes]
2025-02-08 11:57:08,855 - DEBUG - [protocol.py:599] - < PONG 56 d2 19 cf [binary, 4 bytes]
2025-02-08 11:57:08,856 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:57:28,851 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:57:28,852 - DEBUG - [protocol.py:745] - > PING a1 16 6e 14 [binary, 4 bytes]
2025-02-08 11:57:28,856 - DEBUG - [protocol.py:599] - < PING 46 e7 f0 0a [binary, 4 bytes]
2025-02-08 11:57:28,858 - DEBUG - [protocol.py:745] - > PONG 46 e7 f0 0a [binary, 4 bytes]
2025-02-08 11:57:28,860 - DEBUG - [protocol.py:599] - < PONG a1 16 6e 14 [binary, 4 bytes]
2025-02-08 11:57:28,862 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:57:48,865 - DEBUG - [protocol.py:599] - < PING 6e ec aa 03 [binary, 4 bytes]
2025-02-08 11:57:48,867 - DEBUG - [protocol.py:745] - > PONG 6e ec aa 03 [binary, 4 bytes]
2025-02-08 11:57:48,870 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:57:48,872 - DEBUG - [protocol.py:745] - > PING 4a 7c 08 e2 [binary, 4 bytes]
2025-02-08 11:57:48,880 - DEBUG - [protocol.py:599] - < PONG 4a 7c 08 e2 [binary, 4 bytes]
2025-02-08 11:57:48,882 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:58:08,873 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:58:08,875 - DEBUG - [protocol.py:745] - > PING ce d3 80 63 [binary, 4 bytes]
2025-02-08 11:58:08,881 - DEBUG - [protocol.py:599] - < PING d2 20 16 a1 [binary, 4 bytes]
2025-02-08 11:58:08,883 - DEBUG - [protocol.py:745] - > PONG d2 20 16 a1 [binary, 4 bytes]
2025-02-08 11:58:08,885 - DEBUG - [protocol.py:599] - < PONG ce d3 80 63 [binary, 4 bytes]
2025-02-08 11:58:08,886 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:58:28,877 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:58:28,878 - DEBUG - [protocol.py:745] - > PING 8a 74 4e 41 [binary, 4 bytes]
2025-02-08 11:58:28,887 - DEBUG - [protocol.py:599] - < PONG 8a 74 4e 41 [binary, 4 bytes]
2025-02-08 11:58:28,889 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:58:28,891 - DEBUG - [protocol.py:599] - < PING 0f e9 b0 5c [binary, 4 bytes]
2025-02-08 11:58:28,892 - DEBUG - [protocol.py:745] - > PONG 0f e9 b0 5c [binary, 4 bytes]
2025-02-08 11:58:40,819 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 11:58:40,820 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:58:40,820 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:58:40,820 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:58:40,850 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:58:40,850 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:58:40,850 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:58:40,852 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 11:58:40,853 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 11:58:40,854 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:58:40,854 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:41,052 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:41,052 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 11:58:41,052 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 11:58:41,052 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 11:58:41,053 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 11:58:41,053 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:58:41,053 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 11:58:41,054 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:41,300 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:41,300 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 11:58:41,301 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:58:41,301 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:41,753 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:41,754 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:58:41,755 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:58:41,756 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 11:58:41,757 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 11:58:41,757 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 11:58:41,758 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:58:41,759 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:41,982 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:41,982 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:58:41,984 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:58:41,984 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:58:41,984 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:42,212 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:42,213 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:58:42,213 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:58:42,213 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:58:42,213 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:42,414 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:42,414 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:58:42,415 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:58:42,415 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 11:58:42,415 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:42,604 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:42,604 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 11:58:42,605 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 11:58:42,605 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 11:58:42,605 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 11:58:42,605 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:58:42,605 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:42,814 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:42,814 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 11:58:42,814 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 11:58:42,815 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 11:58:42,815 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 11:58:42,815 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 11:58:42,815 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:58:42,816 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:58:42,816 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:58:42,844 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 11:58:42,845 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:58:42,845 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:58:42,848 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:58:42,848 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:58:42,850 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:58:42,850 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:58:42.847339",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:58:42,885 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 11:58:42,886 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 11:58:42,886 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 11:58:42,886 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 11:58:42,887 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 11:58:42,887 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:43,105 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:43,105 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 11:58:43,106 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 11:58:43,106 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 11:58:43,106 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 11:58:43,107 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:58:43,107 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:58:43,107 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:43,311 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:43,312 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:58:43,312 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:58:43,312 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:43,508 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:43,508 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:58:43,509 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 11:58:43,509 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:43,725 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:43,726 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 11:58:43,726 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 11:58:43,726 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 11:58:43,726 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 11:58:43,727 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:58:43,727 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:58:43,727 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:58:43,727 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:58:43,728 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:58:43,728 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:58:43,728 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:58:43,728 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 11:58:43,729 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 11:58:43,730 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 11:58:43,730 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 11:58:43,730 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 11:58:43,917 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 11:58:43,917 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 11:58:43,918 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 11:58:43,918 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 11:58:43,919 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 11:58:43,919 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 11:58:43,919 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 11:58:43,919 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 11:58:43,919 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:58:43,969 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 11:58:43,970 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 11:58:43,970 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 11:58:43,974 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 11:58:43,974 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 11:58:43,974 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 11:58:43,975 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T16:58:43.972974",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 11:58:44,006 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 11:58:44,006 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 11:58:48,867 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:58:48,867 - DEBUG - [protocol.py:745] - > PING ec 04 ad 75 [binary, 4 bytes]
2025-02-08 11:58:48,874 - DEBUG - [protocol.py:599] - < PONG ec 04 ad 75 [binary, 4 bytes]
2025-02-08 11:58:48,875 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:58:48,900 - DEBUG - [protocol.py:599] - < PING da 59 00 f2 [binary, 4 bytes]
2025-02-08 11:58:48,901 - DEBUG - [protocol.py:745] - > PONG da 59 00 f2 [binary, 4 bytes]
2025-02-08 11:59:08,875 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:59:08,876 - DEBUG - [protocol.py:745] - > PING 7e d7 ce cb [binary, 4 bytes]
2025-02-08 11:59:08,884 - DEBUG - [protocol.py:599] - < PONG 7e d7 ce cb [binary, 4 bytes]
2025-02-08 11:59:08,886 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:59:08,907 - DEBUG - [protocol.py:599] - < PING 2b d9 a9 81 [binary, 4 bytes]
2025-02-08 11:59:08,908 - DEBUG - [protocol.py:745] - > PONG 2b d9 a9 81 [binary, 4 bytes]
2025-02-08 11:59:28,873 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:59:28,875 - DEBUG - [protocol.py:745] - > PING f4 5d ba d9 [binary, 4 bytes]
2025-02-08 11:59:28,884 - DEBUG - [protocol.py:599] - < PONG f4 5d ba d9 [binary, 4 bytes]
2025-02-08 11:59:28,885 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:59:28,917 - DEBUG - [protocol.py:599] - < PING 6e 70 aa 81 [binary, 4 bytes]
2025-02-08 11:59:28,919 - DEBUG - [protocol.py:745] - > PONG 6e 70 aa 81 [binary, 4 bytes]
2025-02-08 11:59:48,886 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 11:59:48,888 - DEBUG - [protocol.py:745] - > PING c7 0e ef 1d [binary, 4 bytes]
2025-02-08 11:59:48,897 - DEBUG - [protocol.py:599] - < PONG c7 0e ef 1d [binary, 4 bytes]
2025-02-08 11:59:48,898 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 11:59:48,924 - DEBUG - [protocol.py:599] - < PING fd 8b 2b 29 [binary, 4 bytes]
2025-02-08 11:59:48,926 - DEBUG - [protocol.py:745] - > PONG fd 8b 2b 29 [binary, 4 bytes]
2025-02-08 12:00:08,884 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:00:08,885 - DEBUG - [protocol.py:745] - > PING e3 39 83 6b [binary, 4 bytes]
2025-02-08 12:00:08,894 - DEBUG - [protocol.py:599] - < PONG e3 39 83 6b [binary, 4 bytes]
2025-02-08 12:00:08,897 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:00:08,935 - DEBUG - [protocol.py:599] - < PING 0e f9 ce c1 [binary, 4 bytes]
2025-02-08 12:00:08,937 - DEBUG - [protocol.py:745] - > PONG 0e f9 ce c1 [binary, 4 bytes]
2025-02-08 12:00:28,904 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:00:28,906 - DEBUG - [protocol.py:745] - > PING 26 8d 47 4e [binary, 4 bytes]
2025-02-08 12:00:28,914 - DEBUG - [protocol.py:599] - < PONG 26 8d 47 4e [binary, 4 bytes]
2025-02-08 12:00:28,916 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:00:28,943 - DEBUG - [protocol.py:599] - < PING 5f 90 d5 67 [binary, 4 bytes]
2025-02-08 12:00:28,944 - DEBUG - [protocol.py:745] - > PONG 5f 90 d5 67 [binary, 4 bytes]
2025-02-08 12:00:48,903 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:00:48,905 - DEBUG - [protocol.py:745] - > PING 81 46 32 8d [binary, 4 bytes]
2025-02-08 12:00:48,914 - DEBUG - [protocol.py:599] - < PONG 81 46 32 8d [binary, 4 bytes]
2025-02-08 12:00:48,915 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:00:48,951 - DEBUG - [protocol.py:599] - < PING ee e5 a9 88 [binary, 4 bytes]
2025-02-08 12:00:48,953 - DEBUG - [protocol.py:745] - > PONG ee e5 a9 88 [binary, 4 bytes]
2025-02-08 12:01:08,912 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:01:08,913 - DEBUG - [protocol.py:745] - > PING 04 0f 75 d1 [binary, 4 bytes]
2025-02-08 12:01:08,922 - DEBUG - [protocol.py:599] - < PONG 04 0f 75 d1 [binary, 4 bytes]
2025-02-08 12:01:08,923 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:01:08,965 - DEBUG - [protocol.py:599] - < PING 5c 8d 19 55 [binary, 4 bytes]
2025-02-08 12:01:08,967 - DEBUG - [protocol.py:745] - > PONG 5c 8d 19 55 [binary, 4 bytes]
2025-02-08 12:01:28,945 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:01:28,945 - DEBUG - [protocol.py:745] - > PING 3a 74 ab e3 [binary, 4 bytes]
2025-02-08 12:01:28,952 - DEBUG - [protocol.py:599] - < PONG 3a 74 ab e3 [binary, 4 bytes]
2025-02-08 12:01:28,953 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:01:28,977 - DEBUG - [protocol.py:599] - < PING 6f 8b 9c c1 [binary, 4 bytes]
2025-02-08 12:01:28,977 - DEBUG - [protocol.py:745] - > PONG 6f 8b 9c c1 [binary, 4 bytes]
2025-02-08 12:01:48,959 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:01:48,960 - DEBUG - [protocol.py:745] - > PING 50 01 a0 7c [binary, 4 bytes]
2025-02-08 12:01:48,966 - DEBUG - [protocol.py:599] - < PONG 50 01 a0 7c [binary, 4 bytes]
2025-02-08 12:01:48,968 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:01:48,984 - DEBUG - [protocol.py:599] - < PING 7c 9e ba 5a [binary, 4 bytes]
2025-02-08 12:01:48,984 - DEBUG - [protocol.py:745] - > PONG 7c 9e ba 5a [binary, 4 bytes]
2025-02-08 12:02:08,984 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:02:08,985 - DEBUG - [protocol.py:745] - > PING 0d e9 14 f9 [binary, 4 bytes]
2025-02-08 12:02:08,991 - DEBUG - [protocol.py:599] - < PING d9 1e eb a4 [binary, 4 bytes]
2025-02-08 12:02:08,993 - DEBUG - [protocol.py:745] - > PONG d9 1e eb a4 [binary, 4 bytes]
2025-02-08 12:02:08,994 - DEBUG - [protocol.py:599] - < PONG 0d e9 14 f9 [binary, 4 bytes]
2025-02-08 12:02:08,995 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:02:28,988 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:02:28,988 - DEBUG - [protocol.py:745] - > PING 7a 92 00 ff [binary, 4 bytes]
2025-02-08 12:02:28,996 - DEBUG - [protocol.py:599] - < PONG 7a 92 00 ff [binary, 4 bytes]
2025-02-08 12:02:28,997 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:02:28,998 - DEBUG - [protocol.py:599] - < PING '윫N' [text, 4 bytes]
2025-02-08 12:02:28,998 - DEBUG - [protocol.py:745] - > PONG '윫N' [text, 4 bytes]
2025-02-08 12:02:49,005 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:02:49,006 - DEBUG - [protocol.py:745] - > PING b5 95 83 ec [binary, 4 bytes]
2025-02-08 12:02:49,008 - DEBUG - [protocol.py:599] - < PING a1 08 74 32 [binary, 4 bytes]
2025-02-08 12:02:49,009 - DEBUG - [protocol.py:745] - > PONG a1 08 74 32 [binary, 4 bytes]
2025-02-08 12:02:49,012 - DEBUG - [protocol.py:599] - < PONG b5 95 83 ec [binary, 4 bytes]
2025-02-08 12:02:49,013 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:03:09,016 - DEBUG - [protocol.py:599] - < PING b9 3d e6 63 [binary, 4 bytes]
2025-02-08 12:03:09,016 - DEBUG - [protocol.py:745] - > PONG b9 3d e6 63 [binary, 4 bytes]
2025-02-08 12:03:09,016 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:03:09,017 - DEBUG - [protocol.py:745] - > PING 67 a1 10 d3 [binary, 4 bytes]
2025-02-08 12:03:09,024 - DEBUG - [protocol.py:599] - < PONG 67 a1 10 d3 [binary, 4 bytes]
2025-02-08 12:03:09,024 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:03:29,012 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:03:29,012 - DEBUG - [protocol.py:745] - > PING 34 ca bc c2 [binary, 4 bytes]
2025-02-08 12:03:29,018 - DEBUG - [protocol.py:599] - < PONG 34 ca bc c2 [binary, 4 bytes]
2025-02-08 12:03:29,019 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:03:29,026 - DEBUG - [protocol.py:599] - < PING 89 9b 69 31 [binary, 4 bytes]
2025-02-08 12:03:29,028 - DEBUG - [protocol.py:745] - > PONG 89 9b 69 31 [binary, 4 bytes]
2025-02-08 12:03:45,102 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:03:45,103 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:03:45,103 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:03:45,104 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:03:45,137 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:03:45,139 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:03:45,140 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:03:45,141 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:03:45,142 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:03:45,143 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:03:45,144 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:45,324 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:45,325 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:03:45,325 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:03:45,325 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:03:45,325 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:03:45,325 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:03:45,326 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:03:45,326 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:45,517 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:45,517 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 12:03:45,518 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:03:45,518 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:45,733 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:45,733 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:03:45,734 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:03:45,734 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 12:03:45,734 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:03:45,734 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:03:45,735 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:03:45,735 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:45,896 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:45,897 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:03:45,897 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:03:45,897 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:03:45,897 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:46,052 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:46,054 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:03:46,054 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:03:46,054 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:03:46,054 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:46,254 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:46,254 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:03:46,255 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:03:46,255 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:03:46,255 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:46,414 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:46,415 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:03:46,415 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:03:46,415 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 12:03:46,415 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:03:46,415 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:03:46,415 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:46,570 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:46,571 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 12:03:46,571 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 12:03:46,571 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:03:46,572 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:03:46,573 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:03:46,573 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:03:46,573 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:03:46,573 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:03:46,603 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:03:46,604 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:03:46,604 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:03:46,605 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:03:46,605 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:03:46,605 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:03:46,606 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:03:46.605678",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:03:46,630 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:03:46,631 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:03:46,631 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:03:46,631 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:03:46,632 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:03:46,633 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:46,794 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:46,794 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:03:46,794 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:03:46,794 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:03:46,794 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:03:46,794 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:03:46,796 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:03:46,796 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:46,992 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:46,992 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:03:46,993 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:03:46,993 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:47,147 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:47,148 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:03:47,148 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:03:47,148 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:47,304 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:47,304 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:03:47,306 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:03:47,306 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:03:47,306 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:03:47,306 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:03:47,306 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:03:47,306 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:03:47,307 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:03:47,307 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:03:47,307 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:03:47,307 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:03:47,307 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:03:47,307 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:03:47,307 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:03:47,309 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:03:47,309 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:03:47,506 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:03:47,506 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:03:47,507 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:03:47,507 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:03:47,508 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:03:47,508 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:03:47,508 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:03:47,509 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:03:47,509 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:03:47,536 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:03:47,536 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:03:47,536 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:03:47,536 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:03:47,537 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:03:47,537 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:03:47,537 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:03:47.536212",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:03:47,561 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:03:47,561 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:03:49,032 - DEBUG - [protocol.py:599] - < PING a6 c3 14 b1 [binary, 4 bytes]
2025-02-08 12:03:49,034 - DEBUG - [protocol.py:745] - > PONG a6 c3 14 b1 [binary, 4 bytes]
2025-02-08 12:03:49,036 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:03:49,037 - DEBUG - [protocol.py:745] - > PING aa 26 26 14 [binary, 4 bytes]
2025-02-08 12:03:49,043 - DEBUG - [protocol.py:599] - < PONG aa 26 26 14 [binary, 4 bytes]
2025-02-08 12:03:49,044 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:04:09,041 - DEBUG - [protocol.py:599] - < PING b3 39 1b f9 [binary, 4 bytes]
2025-02-08 12:04:09,042 - DEBUG - [protocol.py:745] - > PONG b3 39 1b f9 [binary, 4 bytes]
2025-02-08 12:04:09,043 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:04:09,045 - DEBUG - [protocol.py:745] - > PING a7 b9 73 fc [binary, 4 bytes]
2025-02-08 12:04:09,049 - DEBUG - [protocol.py:599] - < PONG a7 b9 73 fc [binary, 4 bytes]
2025-02-08 12:04:09,051 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:04:29,046 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:04:29,048 - DEBUG - [protocol.py:745] - > PING eb bd 06 bb [binary, 4 bytes]
2025-02-08 12:04:29,060 - DEBUG - [protocol.py:599] - < PING 94 a2 48 8d [binary, 4 bytes]
2025-02-08 12:04:29,061 - DEBUG - [protocol.py:745] - > PONG 94 a2 48 8d [binary, 4 bytes]
2025-02-08 12:04:29,062 - DEBUG - [protocol.py:599] - < PONG eb bd 06 bb [binary, 4 bytes]
2025-02-08 12:04:29,064 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:04:49,063 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:04:49,063 - DEBUG - [protocol.py:745] - > PING 2c 94 a5 53 [binary, 4 bytes]
2025-02-08 12:04:49,069 - DEBUG - [protocol.py:599] - < PING 79 a6 c2 af [binary, 4 bytes]
2025-02-08 12:04:49,070 - DEBUG - [protocol.py:745] - > PONG 79 a6 c2 af [binary, 4 bytes]
2025-02-08 12:04:49,071 - DEBUG - [protocol.py:599] - < PONG 2c 94 a5 53 [binary, 4 bytes]
2025-02-08 12:04:49,072 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:05:09,066 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:05:09,067 - DEBUG - [protocol.py:745] - > PING 92 f4 af c7 [binary, 4 bytes]
2025-02-08 12:05:09,074 - DEBUG - [protocol.py:599] - < PONG 92 f4 af c7 [binary, 4 bytes]
2025-02-08 12:05:09,075 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:05:09,077 - DEBUG - [protocol.py:599] - < PING ce 9f ad 24 [binary, 4 bytes]
2025-02-08 12:05:09,077 - DEBUG - [protocol.py:745] - > PONG ce 9f ad 24 [binary, 4 bytes]
2025-02-08 12:05:29,085 - DEBUG - [protocol.py:599] - < PING 72 86 6d 56 [binary, 4 bytes]
2025-02-08 12:05:29,086 - DEBUG - [protocol.py:745] - > PONG 72 86 6d 56 [binary, 4 bytes]
2025-02-08 12:05:29,086 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:05:29,087 - DEBUG - [protocol.py:745] - > PING 15 ae 4b d7 [binary, 4 bytes]
2025-02-08 12:05:29,093 - DEBUG - [protocol.py:599] - < PONG 15 ae 4b d7 [binary, 4 bytes]
2025-02-08 12:05:29,094 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:05:49,098 - DEBUG - [protocol.py:599] - < PING 1c a0 c4 fc [binary, 4 bytes]
2025-02-08 12:05:49,101 - DEBUG - [protocol.py:745] - > PONG 1c a0 c4 fc [binary, 4 bytes]
2025-02-08 12:05:49,103 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:05:49,103 - DEBUG - [protocol.py:745] - > PING d4 58 30 1e [binary, 4 bytes]
2025-02-08 12:05:49,111 - DEBUG - [protocol.py:599] - < PONG d4 58 30 1e [binary, 4 bytes]
2025-02-08 12:05:49,112 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:06:09,108 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:06:09,110 - DEBUG - [protocol.py:745] - > PING 76 44 83 df [binary, 4 bytes]
2025-02-08 12:06:09,113 - DEBUG - [protocol.py:599] - < PING 'U\x1c3,' [text, 4 bytes]
2025-02-08 12:06:09,114 - DEBUG - [protocol.py:745] - > PONG 'U\x1c3,' [text, 4 bytes]
2025-02-08 12:06:09,116 - DEBUG - [protocol.py:599] - < PONG 76 44 83 df [binary, 4 bytes]
2025-02-08 12:06:09,117 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:06:29,116 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:06:29,118 - DEBUG - [protocol.py:745] - > PING 71 00 b6 95 [binary, 4 bytes]
2025-02-08 12:06:29,122 - DEBUG - [protocol.py:599] - < PING 03 36 a3 ae [binary, 4 bytes]
2025-02-08 12:06:29,123 - DEBUG - [protocol.py:745] - > PONG 03 36 a3 ae [binary, 4 bytes]
2025-02-08 12:06:29,124 - DEBUG - [protocol.py:599] - < PONG 71 00 b6 95 [binary, 4 bytes]
2025-02-08 12:06:29,125 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:06:49,131 - DEBUG - [protocol.py:599] - < PING d3 64 93 83 [binary, 4 bytes]
2025-02-08 12:06:49,132 - DEBUG - [protocol.py:745] - > PONG d3 64 93 83 [binary, 4 bytes]
2025-02-08 12:06:49,133 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:06:49,133 - DEBUG - [protocol.py:745] - > PING d9 7e 20 dd [binary, 4 bytes]
2025-02-08 12:06:49,140 - DEBUG - [protocol.py:599] - < PONG d9 7e 20 dd [binary, 4 bytes]
2025-02-08 12:06:49,140 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:07:09,139 - DEBUG - [protocol.py:599] - < PING e6 67 61 27 [binary, 4 bytes]
2025-02-08 12:07:09,140 - DEBUG - [protocol.py:745] - > PONG e6 67 61 27 [binary, 4 bytes]
2025-02-08 12:07:09,141 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:07:09,142 - DEBUG - [protocol.py:745] - > PING e9 2c 7f 7d [binary, 4 bytes]
2025-02-08 12:07:09,149 - DEBUG - [protocol.py:599] - < PONG e9 2c 7f 7d [binary, 4 bytes]
2025-02-08 12:07:09,151 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:07:29,145 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:07:29,146 - DEBUG - [protocol.py:745] - > PING 82 9f 82 57 [binary, 4 bytes]
2025-02-08 12:07:29,148 - DEBUG - [protocol.py:599] - < PING 43 8b 65 13 [binary, 4 bytes]
2025-02-08 12:07:29,148 - DEBUG - [protocol.py:745] - > PONG 43 8b 65 13 [binary, 4 bytes]
2025-02-08 12:07:29,151 - DEBUG - [protocol.py:599] - < PONG 82 9f 82 57 [binary, 4 bytes]
2025-02-08 12:07:29,152 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:07:49,151 - DEBUG - [protocol.py:599] - < PING 'x\x14e<' [text, 4 bytes]
2025-02-08 12:07:49,152 - DEBUG - [protocol.py:745] - > PONG 'x\x14e<' [text, 4 bytes]
2025-02-08 12:07:49,155 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:07:49,156 - DEBUG - [protocol.py:745] - > PING 5b e7 8e 07 [binary, 4 bytes]
2025-02-08 12:07:49,160 - DEBUG - [protocol.py:599] - < PONG 5b e7 8e 07 [binary, 4 bytes]
2025-02-08 12:07:49,161 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:08:09,158 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:08:09,159 - DEBUG - [protocol.py:745] - > PING de 57 88 9d [binary, 4 bytes]
2025-02-08 12:08:09,160 - DEBUG - [protocol.py:599] - < PING 28 5c 4c 85 [binary, 4 bytes]
2025-02-08 12:08:09,160 - DEBUG - [protocol.py:745] - > PONG 28 5c 4c 85 [binary, 4 bytes]
2025-02-08 12:08:09,165 - DEBUG - [protocol.py:599] - < PONG de 57 88 9d [binary, 4 bytes]
2025-02-08 12:08:09,165 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:08:29,163 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:08:29,164 - DEBUG - [protocol.py:745] - > PING 2d ba e9 f8 [binary, 4 bytes]
2025-02-08 12:08:29,166 - DEBUG - [protocol.py:599] - < PING 3f 27 d0 d5 [binary, 4 bytes]
2025-02-08 12:08:29,167 - DEBUG - [protocol.py:745] - > PONG 3f 27 d0 d5 [binary, 4 bytes]
2025-02-08 12:08:29,172 - DEBUG - [protocol.py:599] - < PONG 2d ba e9 f8 [binary, 4 bytes]
2025-02-08 12:08:29,173 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:08:48,677 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:08:48,678 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:08:48,678 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:08:48,678 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:08:48,706 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:08:48,707 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:08:48,707 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:08:48,708 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:08:48,708 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:08:48,709 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:08:48,709 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:48,930 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:48,931 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:08:48,931 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:08:48,931 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:08:48,931 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:08:48,931 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:08:48,931 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:08:48,933 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:49,194 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:49,195 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 12:08:49,195 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:08:49,195 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:49,464 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:49,465 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:08:49,465 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:08:49,467 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 12:08:49,467 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:08:49,468 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:08:49,468 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:08:49,469 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:49,758 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:49,759 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:08:49,759 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:08:49,760 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:08:49,760 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:49,939 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:49,939 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:08:49,939 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:08:49,939 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:08:49,940 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:50,103 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:50,104 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:08:50,105 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:08:50,105 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:08:50,105 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:50,305 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:50,305 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:08:50,306 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:08:50,306 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 12:08:50,306 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:08:50,307 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:08:50,307 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:50,465 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:50,466 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 12:08:50,466 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 12:08:50,466 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:08:50,466 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:08:50,467 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:08:50,467 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:08:50,467 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:08:50,467 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:08:50,468 - DEBUG - [protocol.py:599] - < PING 35 be 83 fb [binary, 4 bytes]
2025-02-08 12:08:50,469 - DEBUG - [protocol.py:745] - > PONG 35 be 83 fb [binary, 4 bytes]
2025-02-08 12:08:50,469 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:08:50,469 - DEBUG - [protocol.py:745] - > PING ca df 90 9d [binary, 4 bytes]
2025-02-08 12:08:50,476 - DEBUG - [protocol.py:599] - < PONG ca df 90 9d [binary, 4 bytes]
2025-02-08 12:08:50,476 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:08:50,499 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:08:50,499 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:08:50,500 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:08:50,501 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:08:50,501 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:08:50,501 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:08:50,502 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:08:50.501281",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:08:50,528 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:08:50,530 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:08:50,530 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:08:50,531 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:08:50,531 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:08:50,531 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:50,692 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:50,693 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:08:50,693 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:08:50,693 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:08:50,693 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:08:50,694 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:08:50,694 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:08:50,694 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:50,889 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:50,890 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:08:50,890 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:08:50,891 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:51,056 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:51,056 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:08:51,056 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:08:51,056 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:51,219 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:51,219 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:08:51,219 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:08:51,219 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:08:51,220 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:08:51,220 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:08:51,221 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:08:51,221 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:08:51,221 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:08:51,221 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:08:51,222 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:08:51,222 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:08:51,222 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:08:51,222 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:08:51,223 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:08:51,223 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:08:51,223 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:08:51,385 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:08:51,385 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:08:51,386 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:08:51,386 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:08:51,386 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:08:51,387 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:08:51,387 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:08:51,388 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:08:51,388 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:08:51,420 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:08:51,420 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:08:51,420 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:08:51,420 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:08:51,421 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:08:51,421 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:08:51,421 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:08:51.420043",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:08:51,448 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:08:51,449 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:09:10,476 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:09:10,476 - DEBUG - [protocol.py:745] - > PING 9e e4 a7 84 [binary, 4 bytes]
2025-02-08 12:09:10,477 - DEBUG - [protocol.py:599] - < PING '\x07>]w' [text, 4 bytes]
2025-02-08 12:09:10,477 - DEBUG - [protocol.py:745] - > PONG '\x07>]w' [text, 4 bytes]
2025-02-08 12:09:10,482 - DEBUG - [protocol.py:599] - < PONG 9e e4 a7 84 [binary, 4 bytes]
2025-02-08 12:09:10,483 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:09:30,484 - DEBUG - [protocol.py:599] - < PING a1 dd b4 1e [binary, 4 bytes]
2025-02-08 12:09:30,485 - DEBUG - [protocol.py:745] - > PONG a1 dd b4 1e [binary, 4 bytes]
2025-02-08 12:09:30,487 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:09:30,487 - DEBUG - [protocol.py:745] - > PING 71 3a 5b f7 [binary, 4 bytes]
2025-02-08 12:09:30,498 - DEBUG - [protocol.py:599] - < PONG 71 3a 5b f7 [binary, 4 bytes]
2025-02-08 12:09:30,499 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:09:50,492 - DEBUG - [protocol.py:599] - < PING d4 f6 0b b0 [binary, 4 bytes]
2025-02-08 12:09:50,493 - DEBUG - [protocol.py:745] - > PONG d4 f6 0b b0 [binary, 4 bytes]
2025-02-08 12:09:50,495 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:09:50,495 - DEBUG - [protocol.py:745] - > PING d0 84 dd 4e [binary, 4 bytes]
2025-02-08 12:09:50,501 - DEBUG - [protocol.py:599] - < PONG d0 84 dd 4e [binary, 4 bytes]
2025-02-08 12:09:50,502 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:10:10,501 - DEBUG - [protocol.py:599] - < PING d8 66 bc 14 [binary, 4 bytes]
2025-02-08 12:10:10,502 - DEBUG - [protocol.py:745] - > PONG d8 66 bc 14 [binary, 4 bytes]
2025-02-08 12:10:10,503 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:10:10,504 - DEBUG - [protocol.py:745] - > PING a0 d9 4a b8 [binary, 4 bytes]
2025-02-08 12:10:10,511 - DEBUG - [protocol.py:599] - < PONG a0 d9 4a b8 [binary, 4 bytes]
2025-02-08 12:10:10,511 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:10:30,510 - DEBUG - [protocol.py:599] - < PING 5d a2 98 36 [binary, 4 bytes]
2025-02-08 12:10:30,511 - DEBUG - [protocol.py:745] - > PONG 5d a2 98 36 [binary, 4 bytes]
2025-02-08 12:10:30,511 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:10:30,511 - DEBUG - [protocol.py:745] - > PING 28 05 61 fe [binary, 4 bytes]
2025-02-08 12:10:30,515 - DEBUG - [protocol.py:599] - < PONG 28 05 61 fe [binary, 4 bytes]
2025-02-08 12:10:30,517 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:10:50,518 - DEBUG - [protocol.py:599] - < PING 93 9b ae 68 [binary, 4 bytes]
2025-02-08 12:10:50,518 - DEBUG - [protocol.py:745] - > PONG 93 9b ae 68 [binary, 4 bytes]
2025-02-08 12:10:50,519 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:10:50,521 - DEBUG - [protocol.py:745] - > PING a9 9b bf f1 [binary, 4 bytes]
2025-02-08 12:10:50,527 - DEBUG - [protocol.py:599] - < PONG a9 9b bf f1 [binary, 4 bytes]
2025-02-08 12:10:50,528 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:11:10,529 - DEBUG - [protocol.py:599] - < PING 6d 92 4e 85 [binary, 4 bytes]
2025-02-08 12:11:10,529 - DEBUG - [protocol.py:745] - > PONG 6d 92 4e 85 [binary, 4 bytes]
2025-02-08 12:11:10,529 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:11:10,531 - DEBUG - [protocol.py:745] - > PING dd 32 65 32 [binary, 4 bytes]
2025-02-08 12:11:10,536 - DEBUG - [protocol.py:599] - < PONG dd 32 65 32 [binary, 4 bytes]
2025-02-08 12:11:10,537 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:11:30,529 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:11:30,532 - DEBUG - [protocol.py:745] - > PING ' a_J' [text, 4 bytes]
2025-02-08 12:11:30,535 - DEBUG - [protocol.py:599] - < PING cd 48 84 9b [binary, 4 bytes]
2025-02-08 12:11:30,536 - DEBUG - [protocol.py:745] - > PONG cd 48 84 9b [binary, 4 bytes]
2025-02-08 12:11:30,539 - DEBUG - [protocol.py:599] - < PONG ' a_J' [text, 4 bytes]
2025-02-08 12:11:30,541 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:11:50,536 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:11:50,536 - DEBUG - [protocol.py:745] - > PING 'pC~6' [text, 4 bytes]
2025-02-08 12:11:50,542 - DEBUG - [protocol.py:599] - < PONG 'pC~6' [text, 4 bytes]
2025-02-08 12:11:50,542 - DEBUG - [protocol.py:599] - < PING d6 f8 52 04 [binary, 4 bytes]
2025-02-08 12:11:50,542 - DEBUG - [protocol.py:745] - > PONG d6 f8 52 04 [binary, 4 bytes]
2025-02-08 12:11:50,544 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:12:10,544 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:12:10,546 - DEBUG - [protocol.py:745] - > PING ab 85 19 da [binary, 4 bytes]
2025-02-08 12:12:10,549 - DEBUG - [protocol.py:599] - < PING cc 07 ec 15 [binary, 4 bytes]
2025-02-08 12:12:10,551 - DEBUG - [protocol.py:745] - > PONG cc 07 ec 15 [binary, 4 bytes]
2025-02-08 12:12:10,554 - DEBUG - [protocol.py:599] - < PONG ab 85 19 da [binary, 4 bytes]
2025-02-08 12:12:10,555 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:12:30,543 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:12:30,543 - DEBUG - [protocol.py:745] - > PING 61 31 72 ec [binary, 4 bytes]
2025-02-08 12:12:30,552 - DEBUG - [protocol.py:599] - < PONG 61 31 72 ec [binary, 4 bytes]
2025-02-08 12:12:30,552 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:12:30,564 - DEBUG - [protocol.py:599] - < PING d7 6e 99 bf [binary, 4 bytes]
2025-02-08 12:12:30,565 - DEBUG - [protocol.py:745] - > PONG d7 6e 99 bf [binary, 4 bytes]
2025-02-08 12:12:50,558 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:12:50,558 - DEBUG - [protocol.py:745] - > PING 1f 81 41 ae [binary, 4 bytes]
2025-02-08 12:12:50,563 - DEBUG - [protocol.py:599] - < PONG 1f 81 41 ae [binary, 4 bytes]
2025-02-08 12:12:50,563 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:12:50,572 - DEBUG - [protocol.py:599] - < PING d2 c5 af 8f [binary, 4 bytes]
2025-02-08 12:12:50,572 - DEBUG - [protocol.py:745] - > PONG d2 c5 af 8f [binary, 4 bytes]
2025-02-08 12:13:10,563 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:13:10,563 - DEBUG - [protocol.py:745] - > PING e5 15 e9 ac [binary, 4 bytes]
2025-02-08 12:13:10,579 - DEBUG - [protocol.py:599] - < PONG e5 15 e9 ac [binary, 4 bytes]
2025-02-08 12:13:10,579 - DEBUG - [protocol.py:599] - < PING ab 49 f9 43 [binary, 4 bytes]
2025-02-08 12:13:10,580 - DEBUG - [protocol.py:745] - > PONG ab 49 f9 43 [binary, 4 bytes]
2025-02-08 12:13:10,581 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:13:30,572 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:13:30,573 - DEBUG - [protocol.py:745] - > PING 77 04 41 d7 [binary, 4 bytes]
2025-02-08 12:13:30,587 - DEBUG - [protocol.py:599] - < PONG 77 04 41 d7 [binary, 4 bytes]
2025-02-08 12:13:30,588 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:13:30,589 - DEBUG - [protocol.py:599] - < PING 5c 15 ce 07 [binary, 4 bytes]
2025-02-08 12:13:30,589 - DEBUG - [protocol.py:745] - > PONG 5c 15 ce 07 [binary, 4 bytes]
2025-02-08 12:13:50,579 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:13:50,580 - DEBUG - [protocol.py:745] - > PING 42 f7 5f d2 [binary, 4 bytes]
2025-02-08 12:13:50,587 - DEBUG - [protocol.py:599] - < PONG 42 f7 5f d2 [binary, 4 bytes]
2025-02-08 12:13:50,588 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:13:50,593 - DEBUG - [protocol.py:599] - < PING fe ec d2 39 [binary, 4 bytes]
2025-02-08 12:13:50,594 - DEBUG - [protocol.py:745] - > PONG fe ec d2 39 [binary, 4 bytes]
2025-02-08 12:13:52,567 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:13:52,568 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:13:52,568 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:13:52,568 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:13:52,599 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:13:52,599 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:13:52,599 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:13:52,600 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:13:52,600 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:13:52,601 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:13:52,602 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:52,865 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:52,865 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:13:52,865 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:13:52,865 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:13:52,866 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:13:52,866 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:13:52,867 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:13:52,867 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:53,053 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:53,054 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272340
2025-02-08 12:13:53,054 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:13:53,055 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:53,242 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:53,243 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:13:53,243 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:13:53,244 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272340, 'color_pages': 45056, 'bw_pages': None}
2025-02-08 12:13:53,244 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:13:53,245 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:13:53,246 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:13:53,246 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:53,465 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:53,465 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:13:53,465 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:13:53,465 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:13:53,466 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:53,631 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:53,631 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:13:53,632 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:13:53,632 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:13:53,632 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:53,808 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:53,808 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:13:53,808 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:13:53,810 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:13:53,810 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:53,990 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:53,991 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45056
2025-02-08 12:13:53,991 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:13:53,992 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45056, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45056, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45056, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45056, 'max': 100, 'percentage': 100}}}
2025-02-08 12:13:53,992 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:13:53,992 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:13:53,993 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:54,266 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:54,266 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 12:13:54,266 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 12:13:54,268 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:13:54,268 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272340,
    "color_pages": 45056,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45056,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:13:54,268 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:13:54,268 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:13:54,269 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:13:54,269 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:13:54,299 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:13:54,299 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:13:54,299 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:13:54,300 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:13:54,300 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:13:54,300 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:13:54,300 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:13:54.300800",
  "printer_data": {
    "counters": {
      "total_pages": 272340,
      "color_pages": 45056,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45056,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:13:54,327 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:13:54,327 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:13:54,329 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:13:54,329 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:13:54,329 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:13:54,330 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:54,520 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:54,521 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:13:54,521 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:13:54,521 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:13:54,521 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:13:54,521 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:13:54,522 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:13:54,522 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:54,697 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:54,697 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:13:54,698 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:13:54,698 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:54,898 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:54,898 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:13:54,900 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:13:54,900 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:55,061 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:55,062 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:13:55,062 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:13:55,062 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:13:55,063 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:13:55,063 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:13:55,063 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:13:55,063 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:13:55,064 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:13:55,064 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:13:55,064 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:13:55,064 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:13:55,064 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:13:55,064 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:13:55,066 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:13:55,066 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:13:55,066 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:13:55,340 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:13:55,342 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:13:55,342 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:13:55,342 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:13:55,343 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:13:55,343 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:13:55,344 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:13:55,344 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:13:55,344 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:13:55,382 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:13:55,383 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:13:55,383 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:13:55,383 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:13:55,384 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:13:55,384 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:13:55,384 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:13:55.383386",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:13:55,415 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:13:55,416 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:14:10,590 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:14:10,590 - DEBUG - [protocol.py:745] - > PING 2f 5d dd 65 [binary, 4 bytes]
2025-02-08 12:14:10,601 - DEBUG - [protocol.py:599] - < PONG 2f 5d dd 65 [binary, 4 bytes]
2025-02-08 12:14:10,601 - DEBUG - [protocol.py:599] - < PING b7 83 5c ec [binary, 4 bytes]
2025-02-08 12:14:10,602 - DEBUG - [protocol.py:745] - > PONG b7 83 5c ec [binary, 4 bytes]
2025-02-08 12:14:10,602 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:14:30,592 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:14:30,592 - DEBUG - [protocol.py:745] - > PING cc bb dc e8 [binary, 4 bytes]
2025-02-08 12:14:30,598 - DEBUG - [protocol.py:599] - < PONG cc bb dc e8 [binary, 4 bytes]
2025-02-08 12:14:30,599 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:14:30,607 - DEBUG - [protocol.py:599] - < PING 6b 79 b0 4b [binary, 4 bytes]
2025-02-08 12:14:30,609 - DEBUG - [protocol.py:745] - > PONG 6b 79 b0 4b [binary, 4 bytes]
2025-02-08 12:14:50,603 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:14:50,604 - DEBUG - [protocol.py:745] - > PING ce d2 e2 59 [binary, 4 bytes]
2025-02-08 12:14:50,611 - DEBUG - [protocol.py:599] - < PONG ce d2 e2 59 [binary, 4 bytes]
2025-02-08 12:14:50,612 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:14:50,615 - DEBUG - [protocol.py:599] - < PING 6b ca 70 bb [binary, 4 bytes]
2025-02-08 12:14:50,615 - DEBUG - [protocol.py:745] - > PONG 6b ca 70 bb [binary, 4 bytes]
2025-02-08 12:15:10,600 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:15:10,600 - DEBUG - [protocol.py:745] - > PING 30 25 cf 4c [binary, 4 bytes]
2025-02-08 12:15:10,606 - DEBUG - [protocol.py:599] - < PONG 30 25 cf 4c [binary, 4 bytes]
2025-02-08 12:15:10,606 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:15:10,646 - DEBUG - [protocol.py:599] - < PING b8 f9 f1 58 [binary, 4 bytes]
2025-02-08 12:15:10,646 - DEBUG - [protocol.py:745] - > PONG b8 f9 f1 58 [binary, 4 bytes]
2025-02-08 12:15:30,612 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:15:30,612 - DEBUG - [protocol.py:745] - > PING c1 97 72 61 [binary, 4 bytes]
2025-02-08 12:15:30,616 - DEBUG - [protocol.py:599] - < PONG c1 97 72 61 [binary, 4 bytes]
2025-02-08 12:15:30,616 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:15:30,654 - DEBUG - [protocol.py:599] - < PING 30 ac ea 46 [binary, 4 bytes]
2025-02-08 12:15:30,654 - DEBUG - [protocol.py:745] - > PONG 30 ac ea 46 [binary, 4 bytes]
2025-02-08 12:15:50,623 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:15:50,624 - DEBUG - [protocol.py:745] - > PING 46 df 26 82 [binary, 4 bytes]
2025-02-08 12:15:50,630 - DEBUG - [protocol.py:599] - < PONG 46 df 26 82 [binary, 4 bytes]
2025-02-08 12:15:50,630 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:15:50,661 - DEBUG - [protocol.py:599] - < PING b3 10 5e 17 [binary, 4 bytes]
2025-02-08 12:15:50,661 - DEBUG - [protocol.py:745] - > PONG b3 10 5e 17 [binary, 4 bytes]
2025-02-08 12:16:10,619 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:16:10,619 - DEBUG - [protocol.py:745] - > PING f6 76 57 5b [binary, 4 bytes]
2025-02-08 12:16:10,625 - DEBUG - [protocol.py:599] - < PONG f6 76 57 5b [binary, 4 bytes]
2025-02-08 12:16:10,626 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:16:10,666 - DEBUG - [protocol.py:599] - < PING 'M h:' [text, 4 bytes]
2025-02-08 12:16:10,667 - DEBUG - [protocol.py:745] - > PONG 'M h:' [text, 4 bytes]
2025-02-08 12:16:30,628 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:16:30,628 - DEBUG - [protocol.py:745] - > PING a3 7d e8 2f [binary, 4 bytes]
2025-02-08 12:16:30,634 - DEBUG - [protocol.py:599] - < PONG a3 7d e8 2f [binary, 4 bytes]
2025-02-08 12:16:30,635 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:16:30,673 - DEBUG - [protocol.py:599] - < PING 'Ă5u' [text, 4 bytes]
2025-02-08 12:16:30,673 - DEBUG - [protocol.py:745] - > PONG 'Ă5u' [text, 4 bytes]
2025-02-08 12:16:50,629 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:16:50,629 - DEBUG - [protocol.py:745] - > PING 33 01 82 db [binary, 4 bytes]
2025-02-08 12:16:50,637 - DEBUG - [protocol.py:599] - < PONG 33 01 82 db [binary, 4 bytes]
2025-02-08 12:16:50,637 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:16:50,681 - DEBUG - [protocol.py:599] - < PING 02 c6 dd 32 [binary, 4 bytes]
2025-02-08 12:16:50,681 - DEBUG - [protocol.py:745] - > PONG 02 c6 dd 32 [binary, 4 bytes]
2025-02-08 12:17:10,648 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:17:10,649 - DEBUG - [protocol.py:745] - > PING 7e 72 83 cb [binary, 4 bytes]
2025-02-08 12:17:10,658 - DEBUG - [protocol.py:599] - < PONG 7e 72 83 cb [binary, 4 bytes]
2025-02-08 12:17:10,659 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:17:10,690 - DEBUG - [protocol.py:599] - < PING a8 4e e5 f3 [binary, 4 bytes]
2025-02-08 12:17:10,691 - DEBUG - [protocol.py:745] - > PONG a8 4e e5 f3 [binary, 4 bytes]
2025-02-08 12:17:30,651 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:17:30,651 - DEBUG - [protocol.py:745] - > PING 5d 8c 67 5c [binary, 4 bytes]
2025-02-08 12:17:30,657 - DEBUG - [protocol.py:599] - < PONG 5d 8c 67 5c [binary, 4 bytes]
2025-02-08 12:17:30,658 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:17:30,699 - DEBUG - [protocol.py:599] - < PING 79 f7 d1 3e [binary, 4 bytes]
2025-02-08 12:17:30,699 - DEBUG - [protocol.py:745] - > PONG 79 f7 d1 3e [binary, 4 bytes]
2025-02-08 12:17:50,657 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:17:50,658 - DEBUG - [protocol.py:745] - > PING c7 d3 43 2f [binary, 4 bytes]
2025-02-08 12:17:50,666 - DEBUG - [protocol.py:599] - < PONG c7 d3 43 2f [binary, 4 bytes]
2025-02-08 12:17:50,669 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:17:50,707 - DEBUG - [protocol.py:599] - < PING 'ۚ\x16x' [text, 4 bytes]
2025-02-08 12:17:50,710 - DEBUG - [protocol.py:745] - > PONG 'ۚ\x16x' [text, 4 bytes]
2025-02-08 12:18:10,662 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:18:10,663 - DEBUG - [protocol.py:745] - > PING 52 a5 cb 79 [binary, 4 bytes]
2025-02-08 12:18:10,668 - DEBUG - [protocol.py:599] - < PONG 52 a5 cb 79 [binary, 4 bytes]
2025-02-08 12:18:10,669 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:18:10,715 - DEBUG - [protocol.py:599] - < PING 02 5f 55 94 [binary, 4 bytes]
2025-02-08 12:18:10,716 - DEBUG - [protocol.py:745] - > PONG 02 5f 55 94 [binary, 4 bytes]
2025-02-08 12:18:30,676 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:18:30,682 - DEBUG - [protocol.py:745] - > PING d5 d4 8e 87 [binary, 4 bytes]
2025-02-08 12:18:30,692 - DEBUG - [protocol.py:599] - < PONG d5 d4 8e 87 [binary, 4 bytes]
2025-02-08 12:18:30,693 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:18:30,738 - DEBUG - [protocol.py:599] - < PING bc de 25 a4 [binary, 4 bytes]
2025-02-08 12:18:30,739 - DEBUG - [protocol.py:745] - > PONG bc de 25 a4 [binary, 4 bytes]
2025-02-08 12:18:50,688 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:18:50,689 - DEBUG - [protocol.py:745] - > PING 40 ee f0 cc [binary, 4 bytes]
2025-02-08 12:18:50,699 - DEBUG - [protocol.py:599] - < PONG 40 ee f0 cc [binary, 4 bytes]
2025-02-08 12:18:50,701 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:18:50,746 - DEBUG - [protocol.py:599] - < PING ec 1b 99 a9 [binary, 4 bytes]
2025-02-08 12:18:50,747 - DEBUG - [protocol.py:745] - > PONG ec 1b 99 a9 [binary, 4 bytes]
2025-02-08 12:18:56,515 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:18:56,517 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:18:56,517 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:18:56,517 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:18:56,551 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:18:56,552 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:18:56,552 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:18:56,552 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:18:56,552 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:18:56,553 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:18:56,553 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:56,743 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:56,744 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:18:56,744 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:18:56,744 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:18:56,744 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:18:56,745 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:18:56,745 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:18:56,745 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:56,957 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:56,959 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:18:56,959 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:18:56,960 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:57,134 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:57,134 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:18:57,134 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:18:57,135 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:57,500 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:57,501 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:18:57,501 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:18:57,502 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:18:57,502 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:18:57,502 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:18:57,502 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:18:57,502 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:18:57,502 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:18:57,503 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:18:57,503 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:18:57,503 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:18:57,503 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:18:57,503 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:18:57,505 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:18:57,505 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:18:57,505 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:57,788 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:57,789 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 12:18:57,789 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 12:18:57,789 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:18:57,790 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:18:57,790 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:18:57,790 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:18:57,791 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:18:57,791 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:18:57,823 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:18:57,824 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:18:57,824 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:18:57,825 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:18:57,825 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:18:57,825 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:18:57,826 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:18:57.825524",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:18:57,857 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:18:57,859 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:18:57,859 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:18:57,859 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:18:57,859 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:18:57,860 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:58,083 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:58,084 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:18:58,084 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:18:58,084 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:18:58,084 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:18:58,084 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:18:58,085 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:18:58,085 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:58,251 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:58,252 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272376
2025-02-08 12:18:58,252 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:18:58,252 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:58,425 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:58,425 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45092
2025-02-08 12:18:58,425 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:18:58,425 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272376, 'color_pages': 45092, 'bw_pages': None}
2025-02-08 12:18:58,425 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:18:58,426 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:18:58,426 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:18:58,426 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:58,659 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:58,660 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45092
2025-02-08 12:18:58,660 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:18:58,660 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:18:58,660 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:58,823 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:58,824 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45092
2025-02-08 12:18:58,825 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:18:58,825 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:18:58,825 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:58,986 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:58,987 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45092
2025-02-08 12:18:58,987 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:18:58,987 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:18:58,987 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:59,293 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:59,295 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45092
2025-02-08 12:18:59,296 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:18:59,297 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45092, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45092, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45092, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45092, 'max': 100, 'percentage': 100}}}
2025-02-08 12:18:59,297 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:18:59,298 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:18:59,298 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:18:59,486 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:18:59,486 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:18:59,486 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:18:59,486 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:18:59,486 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272376,
    "color_pages": 45092,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45092,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45092,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45092,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45092,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:18:59,488 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:18:59,488 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:18:59,488 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:18:59,488 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:18:59,519 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:18:59,520 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:18:59,521 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:18:59,523 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:18:59,524 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:18:59,524 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:18:59,528 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:18:59.522425",
  "printer_data": {
    "counters": {
      "total_pages": 272376,
      "color_pages": 45092,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45092,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45092,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45092,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45092,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:18:59,575 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:18:59,576 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:19:10,692 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:19:10,692 - DEBUG - [protocol.py:745] - > PING 18 af 21 3e [binary, 4 bytes]
2025-02-08 12:19:10,699 - DEBUG - [protocol.py:599] - < PONG 18 af 21 3e [binary, 4 bytes]
2025-02-08 12:19:10,699 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:19:10,759 - DEBUG - [protocol.py:599] - < PING 2d 7d 97 a0 [binary, 4 bytes]
2025-02-08 12:19:10,760 - DEBUG - [protocol.py:745] - > PONG 2d 7d 97 a0 [binary, 4 bytes]
2025-02-08 12:19:30,713 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:19:30,713 - DEBUG - [protocol.py:745] - > PING a9 32 dd b1 [binary, 4 bytes]
2025-02-08 12:19:30,720 - DEBUG - [protocol.py:599] - < PONG a9 32 dd b1 [binary, 4 bytes]
2025-02-08 12:19:30,720 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:19:30,765 - DEBUG - [protocol.py:599] - < PING 97 31 48 e9 [binary, 4 bytes]
2025-02-08 12:19:30,766 - DEBUG - [protocol.py:745] - > PONG 97 31 48 e9 [binary, 4 bytes]
2025-02-08 12:19:50,722 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:19:50,725 - DEBUG - [protocol.py:745] - > PING b8 04 b7 1f [binary, 4 bytes]
2025-02-08 12:19:50,733 - DEBUG - [protocol.py:599] - < PONG b8 04 b7 1f [binary, 4 bytes]
2025-02-08 12:19:50,734 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:19:50,771 - DEBUG - [protocol.py:599] - < PING bf 0f eb d8 [binary, 4 bytes]
2025-02-08 12:19:50,772 - DEBUG - [protocol.py:745] - > PONG bf 0f eb d8 [binary, 4 bytes]
2025-02-08 12:20:10,732 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:20:10,733 - DEBUG - [protocol.py:745] - > PING 55 d3 b0 f3 [binary, 4 bytes]
2025-02-08 12:20:10,741 - DEBUG - [protocol.py:599] - < PONG 55 d3 b0 f3 [binary, 4 bytes]
2025-02-08 12:20:10,742 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:20:10,781 - DEBUG - [protocol.py:599] - < PING 94 9a 90 36 [binary, 4 bytes]
2025-02-08 12:20:10,783 - DEBUG - [protocol.py:745] - > PONG 94 9a 90 36 [binary, 4 bytes]
2025-02-08 12:20:30,723 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:20:30,724 - DEBUG - [protocol.py:745] - > PING 41 b5 de 3c [binary, 4 bytes]
2025-02-08 12:20:30,731 - DEBUG - [protocol.py:599] - < PONG 41 b5 de 3c [binary, 4 bytes]
2025-02-08 12:20:30,733 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:20:30,791 - DEBUG - [protocol.py:599] - < PING 74 64 79 fe [binary, 4 bytes]
2025-02-08 12:20:30,791 - DEBUG - [protocol.py:745] - > PONG 74 64 79 fe [binary, 4 bytes]
2025-02-08 12:20:50,740 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:20:50,740 - DEBUG - [protocol.py:745] - > PING da e7 36 98 [binary, 4 bytes]
2025-02-08 12:20:50,747 - DEBUG - [protocol.py:599] - < PONG da e7 36 98 [binary, 4 bytes]
2025-02-08 12:20:50,747 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:20:50,796 - DEBUG - [protocol.py:599] - < PING 6a 6a a2 56 [binary, 4 bytes]
2025-02-08 12:20:50,796 - DEBUG - [protocol.py:745] - > PONG 6a 6a a2 56 [binary, 4 bytes]
2025-02-08 12:21:10,762 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:21:10,763 - DEBUG - [protocol.py:745] - > PING 8c 79 b6 b6 [binary, 4 bytes]
2025-02-08 12:21:10,772 - DEBUG - [protocol.py:599] - < PONG 8c 79 b6 b6 [binary, 4 bytes]
2025-02-08 12:21:10,773 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:21:10,803 - DEBUG - [protocol.py:599] - < PING dc 61 fd ae [binary, 4 bytes]
2025-02-08 12:21:10,804 - DEBUG - [protocol.py:745] - > PONG dc 61 fd ae [binary, 4 bytes]
2025-02-08 12:21:30,770 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:21:30,770 - DEBUG - [protocol.py:745] - > PING 26 87 35 b6 [binary, 4 bytes]
2025-02-08 12:21:30,774 - DEBUG - [protocol.py:599] - < PONG 26 87 35 b6 [binary, 4 bytes]
2025-02-08 12:21:30,774 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:21:30,810 - DEBUG - [protocol.py:599] - < PING 06 34 3e ba [binary, 4 bytes]
2025-02-08 12:21:30,811 - DEBUG - [protocol.py:745] - > PONG 06 34 3e ba [binary, 4 bytes]
2025-02-08 12:21:50,795 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:21:50,796 - DEBUG - [protocol.py:745] - > PING bd 00 ce ca [binary, 4 bytes]
2025-02-08 12:21:50,803 - DEBUG - [protocol.py:599] - < PONG bd 00 ce ca [binary, 4 bytes]
2025-02-08 12:21:50,805 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:21:50,819 - DEBUG - [protocol.py:599] - < PING d4 fc 3c 2c [binary, 4 bytes]
2025-02-08 12:21:50,820 - DEBUG - [protocol.py:745] - > PONG d4 fc 3c 2c [binary, 4 bytes]
2025-02-08 12:22:10,800 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:22:10,801 - DEBUG - [protocol.py:745] - > PING 81 7e 7f e5 [binary, 4 bytes]
2025-02-08 12:22:10,812 - DEBUG - [protocol.py:599] - < PONG 81 7e 7f e5 [binary, 4 bytes]
2025-02-08 12:22:10,813 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:22:10,827 - DEBUG - [protocol.py:599] - < PING 6b 4f ad c8 [binary, 4 bytes]
2025-02-08 12:22:10,828 - DEBUG - [protocol.py:745] - > PONG 6b 4f ad c8 [binary, 4 bytes]
2025-02-08 12:22:30,828 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:22:30,829 - DEBUG - [protocol.py:745] - > PING c8 cc 10 ce [binary, 4 bytes]
2025-02-08 12:22:30,835 - DEBUG - [protocol.py:599] - < PING 44 8c 29 4d [binary, 4 bytes]
2025-02-08 12:22:30,836 - DEBUG - [protocol.py:745] - > PONG 44 8c 29 4d [binary, 4 bytes]
2025-02-08 12:22:30,837 - DEBUG - [protocol.py:599] - < PONG c8 cc 10 ce [binary, 4 bytes]
2025-02-08 12:22:30,837 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:22:50,828 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:22:50,830 - DEBUG - [protocol.py:745] - > PING 1e 5c c1 7a [binary, 4 bytes]
2025-02-08 12:22:50,837 - DEBUG - [protocol.py:599] - < PONG 1e 5c c1 7a [binary, 4 bytes]
2025-02-08 12:22:50,839 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:22:50,842 - DEBUG - [protocol.py:599] - < PING e9 c1 ea 0e [binary, 4 bytes]
2025-02-08 12:22:50,844 - DEBUG - [protocol.py:745] - > PONG e9 c1 ea 0e [binary, 4 bytes]
2025-02-08 12:23:10,844 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:23:10,846 - DEBUG - [protocol.py:745] - > PING 2f 72 52 cd [binary, 4 bytes]
2025-02-08 12:23:10,851 - DEBUG - [protocol.py:599] - < PING fd de 44 1b [binary, 4 bytes]
2025-02-08 12:23:10,854 - DEBUG - [protocol.py:745] - > PONG fd de 44 1b [binary, 4 bytes]
2025-02-08 12:23:10,856 - DEBUG - [protocol.py:599] - < PONG 2f 72 52 cd [binary, 4 bytes]
2025-02-08 12:23:10,859 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:23:30,851 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:23:30,852 - DEBUG - [protocol.py:745] - > PING e3 0d 4f 2a [binary, 4 bytes]
2025-02-08 12:23:30,861 - DEBUG - [protocol.py:599] - < PING da 56 0a 10 [binary, 4 bytes]
2025-02-08 12:23:30,862 - DEBUG - [protocol.py:745] - > PONG da 56 0a 10 [binary, 4 bytes]
2025-02-08 12:23:30,865 - DEBUG - [protocol.py:599] - < PONG e3 0d 4f 2a [binary, 4 bytes]
2025-02-08 12:23:30,866 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:23:50,864 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:23:50,865 - DEBUG - [protocol.py:745] - > PING a8 53 6f 18 [binary, 4 bytes]
2025-02-08 12:23:50,869 - DEBUG - [protocol.py:599] - < PING 5c 50 62 c9 [binary, 4 bytes]
2025-02-08 12:23:50,871 - DEBUG - [protocol.py:745] - > PONG 5c 50 62 c9 [binary, 4 bytes]
2025-02-08 12:23:50,874 - DEBUG - [protocol.py:599] - < PONG a8 53 6f 18 [binary, 4 bytes]
2025-02-08 12:23:50,875 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:24:00,663 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:24:00,663 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:24:00,664 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:24:00,664 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:24:00,694 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:24:00,694 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:24:00,694 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:24:00,696 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:24:00,696 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:24:00,696 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:24:00,696 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:00,867 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:00,868 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:24:00,869 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:24:00,869 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:24:00,869 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:24:00,870 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:24:00,870 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:24:00,870 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:01,026 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:01,026 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:24:01,026 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:24:01,026 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:01,230 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:01,232 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:24:01,232 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:24:01,232 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:01,446 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:01,447 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:24:01,447 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:24:01,448 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:24:01,448 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:24:01,448 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:24:01,448 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:24:01,448 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:24:01,449 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:24:01,449 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:24:01,449 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:24:01,449 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:24:01,449 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:24:01,449 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:24:01,450 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:24:01,450 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:24:01,450 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:01,656 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:01,656 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:24:01,657 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:24:01,657 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:24:01,657 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:24:01,657 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:24:01,657 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:24:01,657 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:24:01,658 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:24:01,689 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:24:01,690 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:24:01,690 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:24:01,690 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:24:01,691 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:24:01,693 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:24:01,693 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:24:01.690314",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:24:01,729 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:24:01,730 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:24:01,730 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:24:01,730 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:24:01,730 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:24:01,730 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:01,944 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:01,945 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:24:01,946 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:24:01,946 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:24:01,947 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:24:01,947 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:24:01,948 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:24:01,948 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:02,117 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:02,117 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272481
2025-02-08 12:24:02,117 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:24:02,117 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:02,273 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:02,273 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45197
2025-02-08 12:24:02,274 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:24:02,274 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272481, 'color_pages': 45197, 'bw_pages': None}
2025-02-08 12:24:02,274 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:24:02,274 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:24:02,275 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:24:02,275 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:02,429 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:02,430 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45197
2025-02-08 12:24:02,430 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:24:02,430 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:24:02,430 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:02,620 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:02,620 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45197
2025-02-08 12:24:02,621 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:24:02,621 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:24:02,621 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:02,776 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:02,776 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45197
2025-02-08 12:24:02,777 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:24:02,777 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:24:02,777 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:02,929 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:02,929 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45197
2025-02-08 12:24:02,930 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:24:02,930 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45197, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45197, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45197, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45197, 'max': 100, 'percentage': 100}}}
2025-02-08 12:24:02,930 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:24:02,930 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:24:02,931 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:24:03,120 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:24:03,120 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 4
2025-02-08 12:24:03,121 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'printing', 'details': 'Status code: 4', 'raw_status': 4}
2025-02-08 12:24:03,121 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:24:03,121 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272481,
    "color_pages": 45197,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45197,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45197,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45197,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45197,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:24:03,121 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:24:03,121 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:24:03,121 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:24:03,121 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:24:03,183 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:24:03,183 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:24:03,184 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:24:03,185 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:24:03,186 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:24:03,186 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:24:03,186 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:24:03.185057",
  "printer_data": {
    "counters": {
      "total_pages": 272481,
      "color_pages": 45197,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45197,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45197,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45197,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45197,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:24:03,263 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:24:03,266 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:24:10,881 - DEBUG - [protocol.py:599] - < PING d8 6a 4c 31 [binary, 4 bytes]
2025-02-08 12:24:10,883 - DEBUG - [protocol.py:745] - > PONG d8 6a 4c 31 [binary, 4 bytes]
2025-02-08 12:24:10,887 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:24:10,888 - DEBUG - [protocol.py:745] - > PING 00 37 ba 5e [binary, 4 bytes]
2025-02-08 12:24:10,897 - DEBUG - [protocol.py:599] - < PONG 00 37 ba 5e [binary, 4 bytes]
2025-02-08 12:24:10,899 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:24:30,891 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:24:30,893 - DEBUG - [protocol.py:745] - > PING 'Q\r\x13\x0b' [text, 4 bytes]
2025-02-08 12:24:30,896 - DEBUG - [protocol.py:599] - < PING 5e 1f 3a e4 [binary, 4 bytes]
2025-02-08 12:24:30,897 - DEBUG - [protocol.py:745] - > PONG 5e 1f 3a e4 [binary, 4 bytes]
2025-02-08 12:24:30,901 - DEBUG - [protocol.py:599] - < PONG 'Q\r\x13\x0b' [text, 4 bytes]
2025-02-08 12:24:30,902 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:24:50,899 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:24:50,901 - DEBUG - [protocol.py:745] - > PING 6c 7c 84 64 [binary, 4 bytes]
2025-02-08 12:24:50,902 - DEBUG - [protocol.py:599] - < PING 95 f9 16 d2 [binary, 4 bytes]
2025-02-08 12:24:50,903 - DEBUG - [protocol.py:745] - > PONG 95 f9 16 d2 [binary, 4 bytes]
2025-02-08 12:24:50,907 - DEBUG - [protocol.py:599] - < PONG 6c 7c 84 64 [binary, 4 bytes]
2025-02-08 12:24:50,908 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:25:10,909 - DEBUG - [protocol.py:599] - < PING 9b 86 34 60 [binary, 4 bytes]
2025-02-08 12:25:10,910 - DEBUG - [protocol.py:745] - > PONG 9b 86 34 60 [binary, 4 bytes]
2025-02-08 12:25:10,912 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:25:10,912 - DEBUG - [protocol.py:745] - > PING 38 21 ba dd [binary, 4 bytes]
2025-02-08 12:25:10,919 - DEBUG - [protocol.py:599] - < PONG 38 21 ba dd [binary, 4 bytes]
2025-02-08 12:25:10,920 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:25:30,918 - DEBUG - [protocol.py:599] - < PING 0f fa 1f f5 [binary, 4 bytes]
2025-02-08 12:25:30,920 - DEBUG - [protocol.py:745] - > PONG 0f fa 1f f5 [binary, 4 bytes]
2025-02-08 12:25:30,922 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:25:30,923 - DEBUG - [protocol.py:745] - > PING c9 47 ce 0b [binary, 4 bytes]
2025-02-08 12:25:30,930 - DEBUG - [protocol.py:599] - < PONG c9 47 ce 0b [binary, 4 bytes]
2025-02-08 12:25:30,933 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:25:50,927 - DEBUG - [protocol.py:599] - < PING 74 ca c2 b8 [binary, 4 bytes]
2025-02-08 12:25:50,928 - DEBUG - [protocol.py:745] - > PONG 74 ca c2 b8 [binary, 4 bytes]
2025-02-08 12:25:50,930 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:25:50,931 - DEBUG - [protocol.py:745] - > PING 83 12 ba c3 [binary, 4 bytes]
2025-02-08 12:25:50,939 - DEBUG - [protocol.py:599] - < PONG 83 12 ba c3 [binary, 4 bytes]
2025-02-08 12:25:50,941 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:26:10,938 - DEBUG - [protocol.py:599] - < PING 4d e9 8d f2 [binary, 4 bytes]
2025-02-08 12:26:10,940 - DEBUG - [protocol.py:745] - > PONG 4d e9 8d f2 [binary, 4 bytes]
2025-02-08 12:26:10,944 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:26:10,946 - DEBUG - [protocol.py:745] - > PING c1 10 a4 4a [binary, 4 bytes]
2025-02-08 12:26:10,954 - DEBUG - [protocol.py:599] - < PONG c1 10 a4 4a [binary, 4 bytes]
2025-02-08 12:26:10,957 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:26:30,949 - DEBUG - [protocol.py:599] - < PING 9e db c2 da [binary, 4 bytes]
2025-02-08 12:26:30,949 - DEBUG - [protocol.py:745] - > PONG 9e db c2 da [binary, 4 bytes]
2025-02-08 12:26:30,950 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:26:30,951 - DEBUG - [protocol.py:745] - > PING 'W3Hr' [text, 4 bytes]
2025-02-08 12:26:30,955 - DEBUG - [protocol.py:599] - < PONG 'W3Hr' [text, 4 bytes]
2025-02-08 12:26:30,956 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:26:50,954 - DEBUG - [protocol.py:599] - < PING 93 95 70 a9 [binary, 4 bytes]
2025-02-08 12:26:50,957 - DEBUG - [protocol.py:745] - > PONG 93 95 70 a9 [binary, 4 bytes]
2025-02-08 12:26:50,960 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:26:50,961 - DEBUG - [protocol.py:745] - > PING '\x0cY}\x0b' [text, 4 bytes]
2025-02-08 12:26:50,969 - DEBUG - [protocol.py:599] - < PONG '\x0cY}\x0b' [text, 4 bytes]
2025-02-08 12:26:50,970 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:27:10,967 - DEBUG - [protocol.py:599] - < PING ec 25 43 67 [binary, 4 bytes]
2025-02-08 12:27:10,968 - DEBUG - [protocol.py:745] - > PONG ec 25 43 67 [binary, 4 bytes]
2025-02-08 12:27:10,970 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:27:10,972 - DEBUG - [protocol.py:745] - > PING 24 9c 52 5f [binary, 4 bytes]
2025-02-08 12:27:10,976 - DEBUG - [protocol.py:599] - < PONG 24 9c 52 5f [binary, 4 bytes]
2025-02-08 12:27:10,977 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:27:30,976 - DEBUG - [protocol.py:599] - < PING 2c ed 49 6d [binary, 4 bytes]
2025-02-08 12:27:30,977 - DEBUG - [protocol.py:745] - > PONG 2c ed 49 6d [binary, 4 bytes]
2025-02-08 12:27:30,978 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:27:30,980 - DEBUG - [protocol.py:745] - > PING 69 1e 8c 7e [binary, 4 bytes]
2025-02-08 12:27:30,985 - DEBUG - [protocol.py:599] - < PONG 69 1e 8c 7e [binary, 4 bytes]
2025-02-08 12:27:30,986 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:27:50,985 - DEBUG - [protocol.py:599] - < PING 0c a8 94 f4 [binary, 4 bytes]
2025-02-08 12:27:50,987 - DEBUG - [protocol.py:745] - > PONG 0c a8 94 f4 [binary, 4 bytes]
2025-02-08 12:27:50,989 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:27:50,990 - DEBUG - [protocol.py:745] - > PING 5b 28 b2 4c [binary, 4 bytes]
2025-02-08 12:27:50,996 - DEBUG - [protocol.py:599] - < PONG 5b 28 b2 4c [binary, 4 bytes]
2025-02-08 12:27:50,998 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:28:10,994 - DEBUG - [protocol.py:599] - < PING b0 cf 9f d8 [binary, 4 bytes]
2025-02-08 12:28:10,996 - DEBUG - [protocol.py:745] - > PONG b0 cf 9f d8 [binary, 4 bytes]
2025-02-08 12:28:10,998 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:28:10,999 - DEBUG - [protocol.py:745] - > PING 48 2c c4 16 [binary, 4 bytes]
2025-02-08 12:28:11,004 - DEBUG - [protocol.py:599] - < PONG 48 2c c4 16 [binary, 4 bytes]
2025-02-08 12:28:11,006 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:28:30,996 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:28:30,998 - DEBUG - [protocol.py:745] - > PING 2f 9f c2 82 [binary, 4 bytes]
2025-02-08 12:28:31,005 - DEBUG - [protocol.py:599] - < PING 37 49 c2 15 [binary, 4 bytes]
2025-02-08 12:28:31,006 - DEBUG - [protocol.py:745] - > PONG 37 49 c2 15 [binary, 4 bytes]
2025-02-08 12:28:31,008 - DEBUG - [protocol.py:599] - < PONG 2f 9f c2 82 [binary, 4 bytes]
2025-02-08 12:28:31,009 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:28:51,003 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:28:51,006 - DEBUG - [protocol.py:745] - > PING 0d aa 80 66 [binary, 4 bytes]
2025-02-08 12:28:51,011 - DEBUG - [protocol.py:599] - < PING 'ŞƲ' [text, 4 bytes]
2025-02-08 12:28:51,012 - DEBUG - [protocol.py:745] - > PONG 'ŞƲ' [text, 4 bytes]
2025-02-08 12:28:51,014 - DEBUG - [protocol.py:599] - < PONG 0d aa 80 66 [binary, 4 bytes]
2025-02-08 12:28:51,015 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:29:04,436 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:29:04,437 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:29:04,438 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:29:04,438 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:29:04,532 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:29:04,532 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:29:04,533 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:29:04,533 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:29:04,534 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:29:04,535 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:29:04,536 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:04,713 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:04,714 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:29:04,714 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:29:04,714 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:29:04,714 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:29:04,715 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:29:04,715 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:29:04,715 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:04,875 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:04,875 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:29:04,875 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:29:04,875 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:05,061 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:05,061 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:29:05,061 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:29:05,061 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:05,322 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:05,322 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:29:05,323 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:29:05,323 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:29:05,323 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:29:05,323 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:29:05,324 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:29:05,324 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:29:05,324 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:29:05,324 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:29:05,324 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:29:05,324 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:29:05,325 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:29:05,325 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:29:05,325 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:29:05,325 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:29:05,325 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:05,507 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:05,508 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:29:05,508 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:29:05,508 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:29:05,508 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:29:05,509 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:29:05,509 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:29:05,509 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:29:05,509 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:29:05,553 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:29:05,553 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:29:05,554 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:29:05,554 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:29:05,554 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:29:05,555 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:29:05,555 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:29:05.554263",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:29:05,595 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:29:05,597 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:29:05,597 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:29:05,597 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:29:05,597 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:29:05,597 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:05,764 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:05,764 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:29:05,764 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:29:05,764 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:29:05,765 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:29:05,765 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:29:05,765 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:29:05,765 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:05,984 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:05,985 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272635
2025-02-08 12:29:05,985 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:29:05,986 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:06,162 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:06,163 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45351
2025-02-08 12:29:06,163 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:29:06,163 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272635, 'color_pages': 45351, 'bw_pages': None}
2025-02-08 12:29:06,163 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:29:06,164 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:29:06,164 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:29:06,164 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:06,349 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:06,349 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45351
2025-02-08 12:29:06,350 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:29:06,351 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:29:06,351 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:06,513 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:06,514 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45351
2025-02-08 12:29:06,514 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:29:06,514 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:29:06,514 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:06,723 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:06,723 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45351
2025-02-08 12:29:06,723 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:29:06,724 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:29:06,724 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:06,889 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:06,889 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45351
2025-02-08 12:29:06,890 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:29:06,890 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45351, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45351, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45351, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45351, 'max': 100, 'percentage': 100}}}
2025-02-08 12:29:06,890 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:29:06,891 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:29:06,891 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:29:07,055 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:29:07,055 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 4
2025-02-08 12:29:07,055 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'printing', 'details': 'Status code: 4', 'raw_status': 4}
2025-02-08 12:29:07,055 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:29:07,056 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272635,
    "color_pages": 45351,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45351,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45351,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45351,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45351,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:29:07,056 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:29:07,056 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:29:07,056 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:29:07,057 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:29:07,091 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:29:07,092 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:29:07,092 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:29:07,093 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:29:07,093 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:29:07,094 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:29:07,094 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:29:07.093748",
  "printer_data": {
    "counters": {
      "total_pages": 272635,
      "color_pages": 45351,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45351,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45351,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45351,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45351,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:29:07,124 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:29:07,125 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:29:11,019 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:29:11,019 - DEBUG - [protocol.py:745] - > PING ff f8 85 f6 [binary, 4 bytes]
2025-02-08 12:29:11,020 - DEBUG - [protocol.py:599] - < PING f4 df 11 10 [binary, 4 bytes]
2025-02-08 12:29:11,021 - DEBUG - [protocol.py:745] - > PONG f4 df 11 10 [binary, 4 bytes]
2025-02-08 12:29:11,027 - DEBUG - [protocol.py:599] - < PONG ff f8 85 f6 [binary, 4 bytes]
2025-02-08 12:29:11,027 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:29:31,028 - DEBUG - [protocol.py:599] - < PING ae f0 6d eb [binary, 4 bytes]
2025-02-08 12:29:31,029 - DEBUG - [protocol.py:745] - > PONG ae f0 6d eb [binary, 4 bytes]
2025-02-08 12:29:31,031 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:29:31,031 - DEBUG - [protocol.py:745] - > PING 80 b4 8a de [binary, 4 bytes]
2025-02-08 12:29:31,037 - DEBUG - [protocol.py:599] - < PONG 80 b4 8a de [binary, 4 bytes]
2025-02-08 12:29:31,038 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:29:51,036 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:29:51,038 - DEBUG - [protocol.py:745] - > PING a0 a5 3b f9 [binary, 4 bytes]
2025-02-08 12:29:51,041 - DEBUG - [protocol.py:599] - < PING 71 3b da 27 [binary, 4 bytes]
2025-02-08 12:29:51,042 - DEBUG - [protocol.py:745] - > PONG 71 3b da 27 [binary, 4 bytes]
2025-02-08 12:29:51,043 - DEBUG - [protocol.py:599] - < PONG a0 a5 3b f9 [binary, 4 bytes]
2025-02-08 12:29:51,044 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:30:11,045 - DEBUG - [protocol.py:599] - < PING b5 20 6f c2 [binary, 4 bytes]
2025-02-08 12:30:11,045 - DEBUG - [protocol.py:745] - > PONG b5 20 6f c2 [binary, 4 bytes]
2025-02-08 12:30:11,046 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:30:11,046 - DEBUG - [protocol.py:745] - > PING af 2f b7 69 [binary, 4 bytes]
2025-02-08 12:30:11,051 - DEBUG - [protocol.py:599] - < PONG af 2f b7 69 [binary, 4 bytes]
2025-02-08 12:30:11,052 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:30:31,047 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:30:31,049 - DEBUG - [protocol.py:745] - > PING af 95 17 83 [binary, 4 bytes]
2025-02-08 12:30:31,054 - DEBUG - [protocol.py:599] - < PING 0c bf 6e 90 [binary, 4 bytes]
2025-02-08 12:30:31,055 - DEBUG - [protocol.py:745] - > PONG 0c bf 6e 90 [binary, 4 bytes]
2025-02-08 12:30:31,058 - DEBUG - [protocol.py:599] - < PONG af 95 17 83 [binary, 4 bytes]
2025-02-08 12:30:31,059 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:30:51,046 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:30:51,048 - DEBUG - [protocol.py:745] - > PING 3e 38 ca df [binary, 4 bytes]
2025-02-08 12:30:51,055 - DEBUG - [protocol.py:599] - < PONG 3e 38 ca df [binary, 4 bytes]
2025-02-08 12:30:51,056 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:30:51,064 - DEBUG - [protocol.py:599] - < PING 86 97 e1 9e [binary, 4 bytes]
2025-02-08 12:30:51,065 - DEBUG - [protocol.py:745] - > PONG 86 97 e1 9e [binary, 4 bytes]
2025-02-08 12:31:11,037 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:31:11,039 - DEBUG - [protocol.py:745] - > PING ab 6f 11 de [binary, 4 bytes]
2025-02-08 12:31:11,047 - DEBUG - [protocol.py:599] - < PONG ab 6f 11 de [binary, 4 bytes]
2025-02-08 12:31:11,049 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:31:11,074 - DEBUG - [protocol.py:599] - < PING 13 65 b9 9e [binary, 4 bytes]
2025-02-08 12:31:11,076 - DEBUG - [protocol.py:745] - > PONG 13 65 b9 9e [binary, 4 bytes]
2025-02-08 12:31:31,074 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:31:31,074 - DEBUG - [protocol.py:745] - > PING 25 04 21 f1 [binary, 4 bytes]
2025-02-08 12:31:31,079 - DEBUG - [protocol.py:599] - < PONG 25 04 21 f1 [binary, 4 bytes]
2025-02-08 12:31:31,080 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:31:31,084 - DEBUG - [protocol.py:599] - < PING a1 f1 17 11 [binary, 4 bytes]
2025-02-08 12:31:31,084 - DEBUG - [protocol.py:745] - > PONG a1 f1 17 11 [binary, 4 bytes]
2025-02-08 12:31:51,082 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:31:51,084 - DEBUG - [protocol.py:745] - > PING c4 68 3d 48 [binary, 4 bytes]
2025-02-08 12:31:51,091 - DEBUG - [protocol.py:599] - < PING 82 e2 7a 19 [binary, 4 bytes]
2025-02-08 12:31:51,093 - DEBUG - [protocol.py:745] - > PONG 82 e2 7a 19 [binary, 4 bytes]
2025-02-08 12:31:51,097 - DEBUG - [protocol.py:599] - < PONG c4 68 3d 48 [binary, 4 bytes]
2025-02-08 12:31:51,099 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:32:11,095 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:32:11,095 - DEBUG - [protocol.py:745] - > PING 2e 7b ab f7 [binary, 4 bytes]
2025-02-08 12:32:11,102 - DEBUG - [protocol.py:599] - < PONG 2e 7b ab f7 [binary, 4 bytes]
2025-02-08 12:32:11,102 - DEBUG - [protocol.py:599] - < PING '<\x1d{\x05' [text, 4 bytes]
2025-02-08 12:32:11,104 - DEBUG - [protocol.py:745] - > PONG '<\x1d{\x05' [text, 4 bytes]
2025-02-08 12:32:11,104 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:32:31,099 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:32:31,100 - DEBUG - [protocol.py:745] - > PING 43 a5 28 f7 [binary, 4 bytes]
2025-02-08 12:32:31,109 - DEBUG - [protocol.py:599] - < PONG 43 a5 28 f7 [binary, 4 bytes]
2025-02-08 12:32:31,110 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:32:31,112 - DEBUG - [protocol.py:599] - < PING 81 0e 87 47 [binary, 4 bytes]
2025-02-08 12:32:31,113 - DEBUG - [protocol.py:745] - > PONG 81 0e 87 47 [binary, 4 bytes]
2025-02-08 12:32:51,100 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:32:51,100 - DEBUG - [protocol.py:745] - > PING 99 7b 1f 3a [binary, 4 bytes]
2025-02-08 12:32:51,109 - DEBUG - [protocol.py:599] - < PONG 99 7b 1f 3a [binary, 4 bytes]
2025-02-08 12:32:51,109 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:32:51,120 - DEBUG - [protocol.py:599] - < PING 00 d0 56 70 [binary, 4 bytes]
2025-02-08 12:32:51,120 - DEBUG - [protocol.py:745] - > PONG 00 d0 56 70 [binary, 4 bytes]
2025-02-08 12:33:11,111 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:33:11,113 - DEBUG - [protocol.py:745] - > PING 55 2d 95 33 [binary, 4 bytes]
2025-02-08 12:33:11,117 - DEBUG - [protocol.py:599] - < PONG 55 2d 95 33 [binary, 4 bytes]
2025-02-08 12:33:11,117 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:33:11,131 - DEBUG - [protocol.py:599] - < PING 92 0a b8 10 [binary, 4 bytes]
2025-02-08 12:33:11,132 - DEBUG - [protocol.py:745] - > PONG 92 0a b8 10 [binary, 4 bytes]
2025-02-08 12:33:31,132 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:33:31,134 - DEBUG - [protocol.py:745] - > PING 77 73 02 e2 [binary, 4 bytes]
2025-02-08 12:33:31,138 - DEBUG - [protocol.py:599] - < PONG 77 73 02 e2 [binary, 4 bytes]
2025-02-08 12:33:31,138 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:33:31,138 - DEBUG - [protocol.py:599] - < PING a4 51 07 79 [binary, 4 bytes]
2025-02-08 12:33:31,138 - DEBUG - [protocol.py:745] - > PONG a4 51 07 79 [binary, 4 bytes]
2025-02-08 12:33:51,150 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:33:51,150 - DEBUG - [protocol.py:745] - > PING d6 97 80 ac [binary, 4 bytes]
2025-02-08 12:33:51,152 - DEBUG - [protocol.py:599] - < PING 6f 8a 95 bc [binary, 4 bytes]
2025-02-08 12:33:51,155 - DEBUG - [protocol.py:745] - > PONG 6f 8a 95 bc [binary, 4 bytes]
2025-02-08 12:33:51,158 - DEBUG - [protocol.py:599] - < PONG d6 97 80 ac [binary, 4 bytes]
2025-02-08 12:33:51,158 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:34:08,254 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:34:08,255 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:34:08,256 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:34:08,256 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:34:08,288 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:34:08,289 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:34:08,289 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:34:08,290 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:34:08,291 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:34:08,291 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:34:08,292 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:08,495 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:08,496 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:34:08,496 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:34:08,496 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:34:08,497 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:34:08,497 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:34:08,497 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:34:08,497 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:08,656 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:08,656 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:34:08,657 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:34:08,657 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:08,817 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:08,818 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:34:08,818 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:34:08,818 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:08,975 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:08,975 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:34:08,975 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:34:08,975 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:34:08,976 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:34:08,976 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:34:08,976 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:34:08,976 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:34:08,977 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:34:08,977 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:34:08,977 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:34:08,977 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:34:08,977 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:34:08,977 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:34:08,979 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:34:08,979 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:34:08,979 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:09,188 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:09,188 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:34:09,189 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:34:09,189 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:34:09,189 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:34:09,190 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:34:09,190 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:34:09,190 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:34:09,190 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:34:09,221 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:34:09,221 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:34:09,221 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:34:09,222 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:34:09,222 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:34:09,222 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:34:09,223 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:34:09.222586",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:34:09,282 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:34:09,283 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:34:09,283 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:34:09,283 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:34:09,284 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:34:09,284 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:09,449 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:09,449 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:34:09,450 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:34:09,450 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:34:09,450 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:34:09,450 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:34:09,451 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:34:09,451 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:09,609 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:09,609 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272695
2025-02-08 12:34:09,610 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:34:09,610 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:09,802 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:09,802 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:34:09,803 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:34:09,804 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272695, 'color_pages': 45410, 'bw_pages': None}
2025-02-08 12:34:09,804 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:34:09,804 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:34:09,804 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:34:09,804 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:09,964 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:09,964 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:34:09,964 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:34:09,964 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:34:09,965 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:10,130 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:10,131 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:34:10,131 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:34:10,131 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:34:10,131 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:10,291 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:10,292 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:34:10,292 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:34:10,292 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:34:10,292 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:10,492 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:10,493 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:34:10,493 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:34:10,493 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45410, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45410, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45410, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45410, 'max': 100, 'percentage': 100}}}
2025-02-08 12:34:10,494 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:34:10,494 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:34:10,494 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:34:10,651 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:34:10,652 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:34:10,652 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:34:10,652 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:34:10,653 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272695,
    "color_pages": 45410,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:34:10,653 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:34:10,653 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:34:10,654 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:34:10,654 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:34:10,700 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:34:10,701 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:34:10,703 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:34:10,704 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:34:10,704 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:34:10,705 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:34:10,705 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:34:10.704083",
  "printer_data": {
    "counters": {
      "total_pages": 272695,
      "color_pages": 45410,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:34:10,746 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:34:10,748 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:34:11,159 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:34:11,160 - DEBUG - [protocol.py:745] - > PING 6e bd a9 76 [binary, 4 bytes]
2025-02-08 12:34:11,162 - DEBUG - [protocol.py:599] - < PING d8 17 e4 be [binary, 4 bytes]
2025-02-08 12:34:11,162 - DEBUG - [protocol.py:745] - > PONG d8 17 e4 be [binary, 4 bytes]
2025-02-08 12:34:11,166 - DEBUG - [protocol.py:599] - < PONG 6e bd a9 76 [binary, 4 bytes]
2025-02-08 12:34:11,167 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:34:31,168 - DEBUG - [protocol.py:599] - < PING b9 ea bd c8 [binary, 4 bytes]
2025-02-08 12:34:31,169 - DEBUG - [protocol.py:745] - > PONG b9 ea bd c8 [binary, 4 bytes]
2025-02-08 12:34:31,171 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:34:31,172 - DEBUG - [protocol.py:745] - > PING 8f be 8f de [binary, 4 bytes]
2025-02-08 12:34:31,177 - DEBUG - [protocol.py:599] - < PONG 8f be 8f de [binary, 4 bytes]
2025-02-08 12:34:31,178 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:34:51,171 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:34:51,172 - DEBUG - [protocol.py:745] - > PING d9 00 40 91 [binary, 4 bytes]
2025-02-08 12:34:51,177 - DEBUG - [protocol.py:599] - < PING 9a ce e2 79 [binary, 4 bytes]
2025-02-08 12:34:51,178 - DEBUG - [protocol.py:745] - > PONG 9a ce e2 79 [binary, 4 bytes]
2025-02-08 12:34:51,180 - DEBUG - [protocol.py:599] - < PONG d9 00 40 91 [binary, 4 bytes]
2025-02-08 12:34:51,181 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:35:11,175 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:35:11,177 - DEBUG - [protocol.py:745] - > PING 8e 66 b8 ae [binary, 4 bytes]
2025-02-08 12:35:11,187 - DEBUG - [protocol.py:599] - < PONG 8e 66 b8 ae [binary, 4 bytes]
2025-02-08 12:35:11,189 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:35:11,192 - DEBUG - [protocol.py:599] - < PING 88 64 42 34 [binary, 4 bytes]
2025-02-08 12:35:11,193 - DEBUG - [protocol.py:745] - > PONG 88 64 42 34 [binary, 4 bytes]
2025-02-08 12:35:31,181 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:35:31,183 - DEBUG - [protocol.py:745] - > PING d6 25 49 6b [binary, 4 bytes]
2025-02-08 12:35:31,192 - DEBUG - [protocol.py:599] - < PONG d6 25 49 6b [binary, 4 bytes]
2025-02-08 12:35:31,193 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:35:31,201 - DEBUG - [protocol.py:599] - < PING f9 0f 10 09 [binary, 4 bytes]
2025-02-08 12:35:31,202 - DEBUG - [protocol.py:745] - > PONG f9 0f 10 09 [binary, 4 bytes]
2025-02-08 12:35:51,194 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:35:51,195 - DEBUG - [protocol.py:745] - > PING fd 2c 2d e9 [binary, 4 bytes]
2025-02-08 12:35:51,202 - DEBUG - [protocol.py:599] - < PONG fd 2c 2d e9 [binary, 4 bytes]
2025-02-08 12:35:51,204 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:35:51,211 - DEBUG - [protocol.py:599] - < PING 0e 58 05 be [binary, 4 bytes]
2025-02-08 12:35:51,212 - DEBUG - [protocol.py:745] - > PONG 0e 58 05 be [binary, 4 bytes]
2025-02-08 12:36:11,210 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:36:11,210 - DEBUG - [protocol.py:745] - > PING a4 14 2a 78 [binary, 4 bytes]
2025-02-08 12:36:11,218 - DEBUG - [protocol.py:599] - < PONG a4 14 2a 78 [binary, 4 bytes]
2025-02-08 12:36:11,219 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:36:11,220 - DEBUG - [protocol.py:599] - < PING 73 ac 86 53 [binary, 4 bytes]
2025-02-08 12:36:11,220 - DEBUG - [protocol.py:745] - > PONG 73 ac 86 53 [binary, 4 bytes]
2025-02-08 12:36:31,227 - DEBUG - [protocol.py:599] - < PING f5 5e 93 5b [binary, 4 bytes]
2025-02-08 12:36:31,230 - DEBUG - [protocol.py:745] - > PONG f5 5e 93 5b [binary, 4 bytes]
2025-02-08 12:36:31,235 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:36:31,236 - DEBUG - [protocol.py:745] - > PING bc 4c 08 7b [binary, 4 bytes]
2025-02-08 12:36:31,238 - DEBUG - [protocol.py:599] - < PONG bc 4c 08 7b [binary, 4 bytes]
2025-02-08 12:36:31,240 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:36:51,239 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:36:51,240 - DEBUG - [protocol.py:745] - > PING 5d e8 9e 61 [binary, 4 bytes]
2025-02-08 12:36:51,240 - DEBUG - [protocol.py:599] - < PING 18 de 63 81 [binary, 4 bytes]
2025-02-08 12:36:51,241 - DEBUG - [protocol.py:745] - > PONG 18 de 63 81 [binary, 4 bytes]
2025-02-08 12:36:51,246 - DEBUG - [protocol.py:599] - < PONG 5d e8 9e 61 [binary, 4 bytes]
2025-02-08 12:36:51,246 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:37:11,248 - DEBUG - [protocol.py:599] - < PING 3c 6a ae 26 [binary, 4 bytes]
2025-02-08 12:37:11,249 - DEBUG - [protocol.py:745] - > PONG 3c 6a ae 26 [binary, 4 bytes]
2025-02-08 12:37:11,250 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:37:11,251 - DEBUG - [protocol.py:745] - > PING 16 f8 67 35 [binary, 4 bytes]
2025-02-08 12:37:11,257 - DEBUG - [protocol.py:599] - < PONG 16 f8 67 35 [binary, 4 bytes]
2025-02-08 12:37:11,258 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:37:31,255 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:37:31,259 - DEBUG - [protocol.py:745] - > PING 2b c8 3d 11 [binary, 4 bytes]
2025-02-08 12:37:31,259 - DEBUG - [protocol.py:599] - < PING 9c ff 19 a4 [binary, 4 bytes]
2025-02-08 12:37:31,259 - DEBUG - [protocol.py:745] - > PONG 9c ff 19 a4 [binary, 4 bytes]
2025-02-08 12:37:31,267 - DEBUG - [protocol.py:599] - < PONG 2b c8 3d 11 [binary, 4 bytes]
2025-02-08 12:37:31,270 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:37:51,263 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:37:51,265 - DEBUG - [protocol.py:745] - > PING 15 6f 01 8c [binary, 4 bytes]
2025-02-08 12:37:51,272 - DEBUG - [protocol.py:599] - < PING 'ɯ\x0b*' [text, 4 bytes]
2025-02-08 12:37:51,274 - DEBUG - [protocol.py:745] - > PONG 'ɯ\x0b*' [text, 4 bytes]
2025-02-08 12:37:51,276 - DEBUG - [protocol.py:599] - < PONG 15 6f 01 8c [binary, 4 bytes]
2025-02-08 12:37:51,278 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:38:11,268 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:38:11,269 - DEBUG - [protocol.py:745] - > PING 0a 27 a3 73 [binary, 4 bytes]
2025-02-08 12:38:11,277 - DEBUG - [protocol.py:599] - < PONG 0a 27 a3 73 [binary, 4 bytes]
2025-02-08 12:38:11,279 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:38:11,282 - DEBUG - [protocol.py:599] - < PING 00 a6 d5 09 [binary, 4 bytes]
2025-02-08 12:38:11,285 - DEBUG - [protocol.py:745] - > PONG 00 a6 d5 09 [binary, 4 bytes]
2025-02-08 12:38:31,277 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:38:31,280 - DEBUG - [protocol.py:745] - > PING 5b 38 87 3b [binary, 4 bytes]
2025-02-08 12:38:31,289 - DEBUG - [protocol.py:599] - < PONG 5b 38 87 3b [binary, 4 bytes]
2025-02-08 12:38:31,289 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:38:31,295 - DEBUG - [protocol.py:599] - < PING b5 a2 6e e5 [binary, 4 bytes]
2025-02-08 12:38:31,296 - DEBUG - [protocol.py:745] - > PONG b5 a2 6e e5 [binary, 4 bytes]
2025-02-08 12:38:51,293 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:38:51,296 - DEBUG - [protocol.py:745] - > PING 48 c4 2d 7c [binary, 4 bytes]
2025-02-08 12:38:51,299 - DEBUG - [protocol.py:599] - < PONG 48 c4 2d 7c [binary, 4 bytes]
2025-02-08 12:38:51,299 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:38:51,300 - DEBUG - [protocol.py:599] - < PING 1d 63 d5 db [binary, 4 bytes]
2025-02-08 12:38:51,301 - DEBUG - [protocol.py:745] - > PONG 1d 63 d5 db [binary, 4 bytes]
2025-02-08 12:39:11,810 - DEBUG - [protocol.py:599] - < PING 'm5!b' [text, 4 bytes]
2025-02-08 12:39:11,810 - DEBUG - [protocol.py:745] - > PONG 'm5!b' [text, 4 bytes]
2025-02-08 12:39:11,811 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:39:11,811 - DEBUG - [protocol.py:745] - > PING 3a 54 09 d0 [binary, 4 bytes]
2025-02-08 12:39:11,816 - DEBUG - [protocol.py:599] - < PONG 3a 54 09 d0 [binary, 4 bytes]
2025-02-08 12:39:11,818 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:39:11,865 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:39:11,867 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:39:11,867 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:39:11,868 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:39:11,909 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:39:11,910 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:39:11,911 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:39:11,913 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:39:11,913 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:39:11,914 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:39:11,915 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:12,109 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:12,109 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:39:12,109 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:39:12,110 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:39:12,110 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:39:12,110 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:39:12,110 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:39:12,111 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:12,302 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:12,304 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:39:12,304 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:39:12,304 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:12,461 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:12,462 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:39:12,463 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:39:12,463 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:12,620 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:12,620 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:39:12,621 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:39:12,622 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:39:12,622 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:39:12,622 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:39:12,622 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:39:12,622 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:39:12,622 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:39:12,622 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:39:12,623 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:39:12,623 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:39:12,623 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:39:12,623 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:39:12,624 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:39:12,624 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:39:12,624 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:12,781 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:12,781 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:39:12,781 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:39:12,781 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:39:12,783 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:39:12,783 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:39:12,783 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:39:12,784 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:39:12,784 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:39:12,814 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:39:12,815 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:39:12,815 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:39:12,816 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:39:12,816 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:39:12,816 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:39:12,816 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:39:12.815535",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:39:12,851 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:39:12,851 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:39:12,852 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:39:12,852 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:39:12,852 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:39:12,853 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:13,057 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:13,058 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:39:13,058 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:39:13,058 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:39:13,058 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:39:13,059 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:39:13,059 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:39:13,060 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:13,218 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:13,218 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272695
2025-02-08 12:39:13,218 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:39:13,218 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:13,373 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:13,373 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:39:13,374 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:39:13,374 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272695, 'color_pages': 45410, 'bw_pages': None}
2025-02-08 12:39:13,374 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:39:13,374 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:39:13,374 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:39:13,374 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:13,570 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:13,571 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:39:13,571 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:39:13,571 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:39:13,571 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:13,732 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:13,732 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:39:13,732 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:39:13,733 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:39:13,733 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:13,891 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:13,891 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:39:13,892 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:39:13,892 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:39:13,892 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:14,047 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:14,047 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:39:14,048 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:39:14,048 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45410, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45410, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45410, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45410, 'max': 100, 'percentage': 100}}}
2025-02-08 12:39:14,048 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:39:14,048 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:39:14,049 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:39:14,246 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:39:14,246 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 12:39:14,246 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 12:39:14,246 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:39:14,247 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272695,
    "color_pages": 45410,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:39:14,247 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:39:14,247 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:39:14,247 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:39:14,247 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:39:14,283 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:39:14,284 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:39:14,287 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:39:14,288 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:39:14,289 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:39:14,290 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:39:14,292 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:39:14.288837",
  "printer_data": {
    "counters": {
      "total_pages": 272695,
      "color_pages": 45410,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:39:14,329 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:39:14,329 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:39:31,817 - DEBUG - [protocol.py:599] - < PING 07 e8 2b 03 [binary, 4 bytes]
2025-02-08 12:39:31,818 - DEBUG - [protocol.py:745] - > PONG 07 e8 2b 03 [binary, 4 bytes]
2025-02-08 12:39:31,821 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:39:31,822 - DEBUG - [protocol.py:745] - > PING d9 ef dd 32 [binary, 4 bytes]
2025-02-08 12:39:31,827 - DEBUG - [protocol.py:599] - < PONG d9 ef dd 32 [binary, 4 bytes]
2025-02-08 12:39:31,829 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:39:51,830 - DEBUG - [protocol.py:599] - < PING 81 e7 b0 61 [binary, 4 bytes]
2025-02-08 12:39:51,831 - DEBUG - [protocol.py:745] - > PONG 81 e7 b0 61 [binary, 4 bytes]
2025-02-08 12:39:51,833 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:39:51,835 - DEBUG - [protocol.py:745] - > PING bb 09 a5 ba [binary, 4 bytes]
2025-02-08 12:39:51,840 - DEBUG - [protocol.py:599] - < PONG bb 09 a5 ba [binary, 4 bytes]
2025-02-08 12:39:51,842 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:40:11,848 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:40:11,849 - DEBUG - [protocol.py:745] - > PING '*\x12K&' [text, 4 bytes]
2025-02-08 12:40:11,873 - DEBUG - [protocol.py:599] - < PING 69 c8 fe 2a [binary, 4 bytes]
2025-02-08 12:40:11,874 - DEBUG - [protocol.py:745] - > PONG 69 c8 fe 2a [binary, 4 bytes]
2025-02-08 12:40:11,875 - DEBUG - [protocol.py:599] - < PONG '*\x12K&' [text, 4 bytes]
2025-02-08 12:40:11,877 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:40:31,864 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:40:31,867 - DEBUG - [protocol.py:745] - > PING 8f d5 ad 3f [binary, 4 bytes]
2025-02-08 12:40:31,879 - DEBUG - [protocol.py:599] - < PONG 8f d5 ad 3f [binary, 4 bytes]
2025-02-08 12:40:31,885 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:40:31,890 - DEBUG - [protocol.py:599] - < PING ed 4e 4b b4 [binary, 4 bytes]
2025-02-08 12:40:31,891 - DEBUG - [protocol.py:745] - > PONG ed 4e 4b b4 [binary, 4 bytes]
2025-02-08 12:40:51,887 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:40:51,888 - DEBUG - [protocol.py:745] - > PING e9 5d d9 b2 [binary, 4 bytes]
2025-02-08 12:40:51,896 - DEBUG - [protocol.py:599] - < PONG e9 5d d9 b2 [binary, 4 bytes]
2025-02-08 12:40:51,896 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:40:51,898 - DEBUG - [protocol.py:599] - < PING 04 b0 a1 be [binary, 4 bytes]
2025-02-08 12:40:51,900 - DEBUG - [protocol.py:745] - > PONG 04 b0 a1 be [binary, 4 bytes]
2025-02-08 12:41:11,896 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:41:11,898 - DEBUG - [protocol.py:745] - > PING '\x1fS\t-' [text, 4 bytes]
2025-02-08 12:41:11,906 - DEBUG - [protocol.py:599] - < PONG '\x1fS\t-' [text, 4 bytes]
2025-02-08 12:41:11,908 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:41:11,910 - DEBUG - [protocol.py:599] - < PING b3 b6 af f9 [binary, 4 bytes]
2025-02-08 12:41:11,912 - DEBUG - [protocol.py:745] - > PONG b3 b6 af f9 [binary, 4 bytes]
2025-02-08 12:41:31,920 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:41:31,920 - DEBUG - [protocol.py:745] - > PING 'y.)\x0b' [text, 4 bytes]
2025-02-08 12:41:31,921 - DEBUG - [protocol.py:599] - < PING 83 07 2a 39 [binary, 4 bytes]
2025-02-08 12:41:31,921 - DEBUG - [protocol.py:745] - > PONG 83 07 2a 39 [binary, 4 bytes]
2025-02-08 12:41:31,926 - DEBUG - [protocol.py:599] - < PONG 'y.)\x0b' [text, 4 bytes]
2025-02-08 12:41:31,927 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:41:51,919 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:41:51,920 - DEBUG - [protocol.py:745] - > PING 87 8f 0a f6 [binary, 4 bytes]
2025-02-08 12:41:51,926 - DEBUG - [protocol.py:599] - < PONG 87 8f 0a f6 [binary, 4 bytes]
2025-02-08 12:41:51,927 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:41:51,929 - DEBUG - [protocol.py:599] - < PING 55 d7 81 e7 [binary, 4 bytes]
2025-02-08 12:41:51,930 - DEBUG - [protocol.py:745] - > PONG 55 d7 81 e7 [binary, 4 bytes]
2025-02-08 12:42:11,930 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:42:11,932 - DEBUG - [protocol.py:745] - > PING 04 99 51 66 [binary, 4 bytes]
2025-02-08 12:42:11,937 - DEBUG - [protocol.py:599] - < PING 01 6e 9a 9e [binary, 4 bytes]
2025-02-08 12:42:11,939 - DEBUG - [protocol.py:745] - > PONG 01 6e 9a 9e [binary, 4 bytes]
2025-02-08 12:42:11,941 - DEBUG - [protocol.py:599] - < PONG 04 99 51 66 [binary, 4 bytes]
2025-02-08 12:42:11,943 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:42:31,940 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:42:31,942 - DEBUG - [protocol.py:745] - > PING '6StG' [text, 4 bytes]
2025-02-08 12:42:31,946 - DEBUG - [protocol.py:599] - < PING 6a 82 93 99 [binary, 4 bytes]
2025-02-08 12:42:31,947 - DEBUG - [protocol.py:745] - > PONG 6a 82 93 99 [binary, 4 bytes]
2025-02-08 12:42:31,949 - DEBUG - [protocol.py:599] - < PONG '6StG' [text, 4 bytes]
2025-02-08 12:42:31,950 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:42:51,955 - DEBUG - [protocol.py:599] - < PING '=Y\x00\x07' [text, 4 bytes]
2025-02-08 12:42:51,955 - DEBUG - [protocol.py:745] - > PONG '=Y\x00\x07' [text, 4 bytes]
2025-02-08 12:42:51,958 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:42:51,958 - DEBUG - [protocol.py:745] - > PING fb cf 85 77 [binary, 4 bytes]
2025-02-08 12:42:51,968 - DEBUG - [protocol.py:599] - < PONG fb cf 85 77 [binary, 4 bytes]
2025-02-08 12:42:51,968 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:43:11,964 - DEBUG - [protocol.py:599] - < PING 4e 85 11 8d [binary, 4 bytes]
2025-02-08 12:43:11,965 - DEBUG - [protocol.py:745] - > PONG 4e 85 11 8d [binary, 4 bytes]
2025-02-08 12:43:11,966 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:43:11,966 - DEBUG - [protocol.py:745] - > PING bb 6c ab a8 [binary, 4 bytes]
2025-02-08 12:43:11,973 - DEBUG - [protocol.py:599] - < PONG bb 6c ab a8 [binary, 4 bytes]
2025-02-08 12:43:11,974 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:43:31,968 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:43:31,969 - DEBUG - [protocol.py:745] - > PING fa 51 76 ce [binary, 4 bytes]
2025-02-08 12:43:31,972 - DEBUG - [protocol.py:599] - < PING ba 34 22 0a [binary, 4 bytes]
2025-02-08 12:43:31,973 - DEBUG - [protocol.py:745] - > PONG ba 34 22 0a [binary, 4 bytes]
2025-02-08 12:43:31,975 - DEBUG - [protocol.py:599] - < PONG fa 51 76 ce [binary, 4 bytes]
2025-02-08 12:43:31,976 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:43:51,975 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:43:51,976 - DEBUG - [protocol.py:745] - > PING 69 f1 b5 f7 [binary, 4 bytes]
2025-02-08 12:43:51,980 - DEBUG - [protocol.py:599] - < PING 36 fd 81 9f [binary, 4 bytes]
2025-02-08 12:43:51,980 - DEBUG - [protocol.py:745] - > PONG 36 fd 81 9f [binary, 4 bytes]
2025-02-08 12:43:51,981 - DEBUG - [protocol.py:599] - < PONG 69 f1 b5 f7 [binary, 4 bytes]
2025-02-08 12:43:51,982 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:44:11,988 - DEBUG - [protocol.py:599] - < PING ae 13 64 53 [binary, 4 bytes]
2025-02-08 12:44:11,989 - DEBUG - [protocol.py:745] - > PONG ae 13 64 53 [binary, 4 bytes]
2025-02-08 12:44:11,990 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:44:11,991 - DEBUG - [protocol.py:745] - > PING 5c 63 0a e7 [binary, 4 bytes]
2025-02-08 12:44:11,996 - DEBUG - [protocol.py:599] - < PONG 5c 63 0a e7 [binary, 4 bytes]
2025-02-08 12:44:11,997 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:44:15,460 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:44:15,460 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:44:15,460 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:44:15,460 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:44:15,486 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:44:15,493 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:44:15,493 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:44:15,494 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:44:15,495 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:44:15,496 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:44:15,496 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:15,662 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:15,662 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:44:15,666 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:44:15,666 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:44:15,666 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:44:15,666 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:44:15,666 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:44:15,666 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:15,819 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:15,819 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:44:15,819 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:44:15,819 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:16,017 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:16,017 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:44:16,017 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:44:16,017 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:16,179 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:16,179 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:44:16,179 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:44:16,179 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:44:16,179 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:44:16,184 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:44:16,184 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:44:16,184 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:44:16,184 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:44:16,185 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:44:16,185 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:44:16,185 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:44:16,185 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:44:16,185 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:44:16,186 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:44:16,186 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:44:16,186 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:16,331 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:16,331 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 12:44:16,331 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 12:44:16,331 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:44:16,337 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:44:16,337 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:44:16,337 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:44:16,337 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:44:16,337 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:44:16,360 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:44:16,369 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:44:16,369 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:44:16,369 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:44:16,369 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:44:16,369 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:44:16,369 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:44:16.369661",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:44:16,393 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:44:16,393 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:44:16,393 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:44:16,393 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:44:16,393 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:44:16,393 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:16,559 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:16,559 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:44:16,560 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:44:16,560 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:44:16,560 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:44:16,560 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:44:16,561 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:44:16,561 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:16,758 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:16,758 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272695
2025-02-08 12:44:16,758 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:44:16,758 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:16,913 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:16,913 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:44:16,913 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:44:16,913 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272695, 'color_pages': 45410, 'bw_pages': None}
2025-02-08 12:44:16,913 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:44:16,913 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:44:16,918 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:44:16,918 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:17,069 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:17,069 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:44:17,069 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:44:17,069 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:44:17,069 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:17,261 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:17,263 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:44:17,263 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:44:17,263 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:44:17,263 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:17,416 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:17,416 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:44:17,416 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:44:17,416 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:44:17,418 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:17,570 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:17,570 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:44:17,570 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:44:17,570 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45410, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45410, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45410, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45410, 'max': 100, 'percentage': 100}}}
2025-02-08 12:44:17,570 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:44:17,570 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:44:17,570 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:44:17,722 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:44:17,722 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 12:44:17,722 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 12:44:17,722 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:44:17,724 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272695,
    "color_pages": 45410,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:44:17,724 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:44:17,724 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:44:17,724 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:44:17,724 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:44:17,755 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:44:17,755 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:44:17,755 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:44:17,757 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:44:17,757 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:44:17,757 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:44:17,757 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:44:17.757033",
  "printer_data": {
    "counters": {
      "total_pages": 272695,
      "color_pages": 45410,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:44:17,793 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:44:17,794 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:44:31,995 - DEBUG - [protocol.py:599] - < PING 5a d7 3c 69 [binary, 4 bytes]
2025-02-08 12:44:31,996 - DEBUG - [protocol.py:745] - > PONG 5a d7 3c 69 [binary, 4 bytes]
2025-02-08 12:44:31,996 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:44:31,996 - DEBUG - [protocol.py:745] - > PING 74 e2 86 0b [binary, 4 bytes]
2025-02-08 12:44:32,003 - DEBUG - [protocol.py:599] - < PONG 74 e2 86 0b [binary, 4 bytes]
2025-02-08 12:44:32,004 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:44:51,990 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:44:51,990 - DEBUG - [protocol.py:745] - > PING b4 93 56 91 [binary, 4 bytes]
2025-02-08 12:44:51,999 - DEBUG - [protocol.py:599] - < PONG b4 93 56 91 [binary, 4 bytes]
2025-02-08 12:44:52,000 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:44:52,002 - DEBUG - [protocol.py:599] - < PING '\x19\x16\x03#' [text, 4 bytes]
2025-02-08 12:44:52,002 - DEBUG - [protocol.py:745] - > PONG '\x19\x16\x03#' [text, 4 bytes]
2025-02-08 12:45:11,996 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:45:11,998 - DEBUG - [protocol.py:745] - > PING 81 41 cc 7c [binary, 4 bytes]
2025-02-08 12:45:12,006 - DEBUG - [protocol.py:599] - < PONG 81 41 cc 7c [binary, 4 bytes]
2025-02-08 12:45:12,007 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:45:12,013 - DEBUG - [protocol.py:599] - < PING 75 85 31 b7 [binary, 4 bytes]
2025-02-08 12:45:12,014 - DEBUG - [protocol.py:745] - > PONG 75 85 31 b7 [binary, 4 bytes]
2025-02-08 12:45:32,002 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:45:32,005 - DEBUG - [protocol.py:745] - > PING 36 ec e8 d8 [binary, 4 bytes]
2025-02-08 12:45:32,015 - DEBUG - [protocol.py:599] - < PONG 36 ec e8 d8 [binary, 4 bytes]
2025-02-08 12:45:32,018 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:45:32,021 - DEBUG - [protocol.py:599] - < PING 1d 19 97 35 [binary, 4 bytes]
2025-02-08 12:45:32,022 - DEBUG - [protocol.py:745] - > PONG 1d 19 97 35 [binary, 4 bytes]
2025-02-08 12:45:52,028 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:45:52,029 - DEBUG - [protocol.py:745] - > PING d3 24 32 14 [binary, 4 bytes]
2025-02-08 12:45:52,029 - DEBUG - [protocol.py:599] - < PING 03 22 fc 03 [binary, 4 bytes]
2025-02-08 12:45:52,030 - DEBUG - [protocol.py:745] - > PONG 03 22 fc 03 [binary, 4 bytes]
2025-02-08 12:45:52,033 - DEBUG - [protocol.py:599] - < PONG d3 24 32 14 [binary, 4 bytes]
2025-02-08 12:45:52,033 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:46:12,035 - DEBUG - [protocol.py:599] - < PING 5a 53 4a 93 [binary, 4 bytes]
2025-02-08 12:46:12,037 - DEBUG - [protocol.py:745] - > PONG 5a 53 4a 93 [binary, 4 bytes]
2025-02-08 12:46:12,039 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:46:12,040 - DEBUG - [protocol.py:745] - > PING b5 94 0a 26 [binary, 4 bytes]
2025-02-08 12:46:12,047 - DEBUG - [protocol.py:599] - < PONG b5 94 0a 26 [binary, 4 bytes]
2025-02-08 12:46:12,048 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:46:32,044 - DEBUG - [protocol.py:599] - < PING b7 9d e0 81 [binary, 4 bytes]
2025-02-08 12:46:32,074 - DEBUG - [protocol.py:745] - > PONG b7 9d e0 81 [binary, 4 bytes]
2025-02-08 12:46:32,076 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:46:32,101 - DEBUG - [protocol.py:745] - > PING 49 73 63 e0 [binary, 4 bytes]
2025-02-08 12:46:32,108 - DEBUG - [protocol.py:599] - < PONG 49 73 63 e0 [binary, 4 bytes]
2025-02-08 12:46:32,108 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:46:52,082 - DEBUG - [protocol.py:599] - < PING b4 f0 95 08 [binary, 4 bytes]
2025-02-08 12:46:52,083 - DEBUG - [protocol.py:745] - > PONG b4 f0 95 08 [binary, 4 bytes]
2025-02-08 12:46:52,085 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:46:52,086 - DEBUG - [protocol.py:745] - > PING 2f 78 1d ab [binary, 4 bytes]
2025-02-08 12:46:52,092 - DEBUG - [protocol.py:599] - < PONG 2f 78 1d ab [binary, 4 bytes]
2025-02-08 12:46:52,093 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:47:12,091 - DEBUG - [protocol.py:599] - < PING 1c bb e8 74 [binary, 4 bytes]
2025-02-08 12:47:12,093 - DEBUG - [protocol.py:745] - > PONG 1c bb e8 74 [binary, 4 bytes]
2025-02-08 12:47:12,095 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:47:12,095 - DEBUG - [protocol.py:745] - > PING 77 a9 2a e5 [binary, 4 bytes]
2025-02-08 12:47:12,104 - DEBUG - [protocol.py:599] - < PONG 77 a9 2a e5 [binary, 4 bytes]
2025-02-08 12:47:12,105 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:47:32,100 - DEBUG - [protocol.py:599] - < PING ba ab 61 ef [binary, 4 bytes]
2025-02-08 12:47:32,100 - DEBUG - [protocol.py:745] - > PONG ba ab 61 ef [binary, 4 bytes]
2025-02-08 12:47:32,101 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:47:32,101 - DEBUG - [protocol.py:745] - > PING 69 b6 59 b8 [binary, 4 bytes]
2025-02-08 12:47:32,107 - DEBUG - [protocol.py:599] - < PONG 69 b6 59 b8 [binary, 4 bytes]
2025-02-08 12:47:32,107 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:47:52,106 - DEBUG - [protocol.py:599] - < PING b7 c9 5d d1 [binary, 4 bytes]
2025-02-08 12:47:52,108 - DEBUG - [protocol.py:745] - > PONG b7 c9 5d d1 [binary, 4 bytes]
2025-02-08 12:47:52,108 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:47:52,108 - DEBUG - [protocol.py:745] - > PING c8 18 1a f9 [binary, 4 bytes]
2025-02-08 12:47:52,112 - DEBUG - [protocol.py:599] - < PONG c8 18 1a f9 [binary, 4 bytes]
2025-02-08 12:47:52,112 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:48:12,115 - DEBUG - [protocol.py:599] - < PING "'\x08\x8a" [text, 4 bytes]
2025-02-08 12:48:12,118 - DEBUG - [protocol.py:745] - > PONG "'\x08\x8a" [text, 4 bytes]
2025-02-08 12:48:12,123 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:48:12,124 - DEBUG - [protocol.py:745] - > PING 71 b0 f0 69 [binary, 4 bytes]
2025-02-08 12:48:12,130 - DEBUG - [protocol.py:599] - < PONG 71 b0 f0 69 [binary, 4 bytes]
2025-02-08 12:48:12,137 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:48:32,128 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:48:32,129 - DEBUG - [protocol.py:745] - > PING d4 3d 37 28 [binary, 4 bytes]
2025-02-08 12:48:32,139 - DEBUG - [protocol.py:599] - < PING f7 32 80 a3 [binary, 4 bytes]
2025-02-08 12:48:32,139 - DEBUG - [protocol.py:745] - > PONG f7 32 80 a3 [binary, 4 bytes]
2025-02-08 12:48:32,140 - DEBUG - [protocol.py:599] - < PONG d4 3d 37 28 [binary, 4 bytes]
2025-02-08 12:48:32,141 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:48:52,147 - DEBUG - [protocol.py:599] - < PING 5e 7d 68 d6 [binary, 4 bytes]
2025-02-08 12:48:52,147 - DEBUG - [protocol.py:745] - > PONG 5e 7d 68 d6 [binary, 4 bytes]
2025-02-08 12:48:52,147 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:48:52,148 - DEBUG - [protocol.py:745] - > PING e4 01 a8 0b [binary, 4 bytes]
2025-02-08 12:48:52,154 - DEBUG - [protocol.py:599] - < PONG e4 01 a8 0b [binary, 4 bytes]
2025-02-08 12:48:52,155 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:49:12,154 - DEBUG - [protocol.py:599] - < PING f4 05 de 7f [binary, 4 bytes]
2025-02-08 12:49:12,155 - DEBUG - [protocol.py:745] - > PONG f4 05 de 7f [binary, 4 bytes]
2025-02-08 12:49:12,159 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:49:12,160 - DEBUG - [protocol.py:745] - > PING 78 cc 2f c0 [binary, 4 bytes]
2025-02-08 12:49:12,165 - DEBUG - [protocol.py:599] - < PONG 78 cc 2f c0 [binary, 4 bytes]
2025-02-08 12:49:12,167 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:49:18,907 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:49:18,907 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:49:18,907 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:49:18,909 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:49:18,961 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:49:18,961 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:49:18,962 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:49:18,962 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:49:18,963 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:49:18,964 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:49:18,965 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:19,225 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:19,225 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.1.1.0: RICOH MP C3004 1.43 / RICOH Network Printer C model / RICOH Network Scanner C model
2025-02-08 12:49:19,225 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.41 responde correctamente
2025-02-08 12:49:19,226 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Ricoh
2025-02-08 12:49:19,227 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.41
2025-02-08 12:49:19,227 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:49:19,227 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.43.10.2.1.4.1.1
2025-02-08 12:49:19,227 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:21,071 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:21,072 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.43.10.2.1.4.1.1: 272695
2025-02-08 12:49:21,074 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:49:21,074 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:21,302 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:21,302 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:49:21,303 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:49:21,303 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.41: {'total_pages': 272695, 'color_pages': 45410, 'bw_pages': None}
2025-02-08 12:49:21,303 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.41
2025-02-08 12:49:21,303 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Ricoh",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": "1.3.6.1.2.1.43.10.2.1.4.1.1",
    "oid_total_color_pages": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_total_bw_pages": null,
    "oid_black_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_cyan_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_magenta_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "oid_yellow_toner_level": "1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11",
    "id": 5
  }
]
2025-02-08 12:49:21,305 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:49:21,305 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:21,654 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:21,654 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:49:21,655 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:49:21,655 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:49:21,655 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:21,853 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:21,853 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:49:21,854 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:49:21,854 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:49:21,854 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:22,103 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:22,103 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:49:22,104 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:49:22,104 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11
2025-02-08 12:49:22,104 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:22,308 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:22,308 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.4.1.367.3.2.1.2.19.5.1.9.11: 45410
2025-02-08 12:49:22,308 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.41
2025-02-08 12:49:22,308 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.41: {'toners': {'black': {'level': 45410, 'max': 100, 'percentage': 100}, 'cyan': {'level': 45410, 'max': 100, 'percentage': 100}, 'magenta': {'level': 45410, 'max': 100, 'percentage': 100}, 'yellow': {'level': 45410, 'max': 100, 'percentage': 100}}}
2025-02-08 12:49:22,309 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.41
2025-02-08 12:49:22,309 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:49:22,309 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:22,528 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:22,529 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.41 - 1.3.6.1.2.1.25.3.5.1.1.1: 3
2025-02-08 12:49:22,529 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.41: {'status': 'idle', 'details': 'Status code: 3', 'raw_status': 3}
2025-02-08 12:49:22,529 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.41
2025-02-08 12:49:22,530 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 272695,
    "color_pages": 45410,
    "bw_pages": null
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "cyan": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "magenta": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      },
      "yellow": {
        "level": 45410,
        "max": 100,
        "percentage": 100
      }
    }
  },
  "error": null
}
2025-02-08 12:49:22,530 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:49:22,530 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:49:22,530 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:49:22,531 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:49:22,570 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:49:22,571 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:49:22,571 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:49:22,572 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:49:22,573 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:49:22,573 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:49:22,574 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:49:22.572526",
  "printer_data": {
    "counters": {
      "total_pages": 272695,
      "color_pages": 45410,
      "bw_pages": null
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "cyan": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "magenta": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        },
        "yellow": {
          "level": 45410,
          "max": 100,
          "percentage": 100
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:49:22,626 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:49:22,627 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:49:22,627 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:49:22,629 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:49:22,629 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:49:22,630 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:22,796 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:22,796 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.1.1.0: Canon iR-ADV C3525 III /P
2025-02-08 12:49:22,796 - INFO - [printer_monitor_service.py:581] - ✅ Impresora 192.168.18.27 responde correctamente
2025-02-08 12:49:22,796 - DEBUG - [printer_monitor_service.py:180] - 📎 Usando OIDs cacheados para Canon
2025-02-08 12:49:22,796 - DEBUG - [printer_monitor_service.py:222] - 📊 Obteniendo contadores para 192.168.18.27
2025-02-08 12:49:22,797 - DEBUG - [printer_monitor_service.py:223] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:49:22,797 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:49:22,797 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:22,959 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:22,959 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:49:22,959 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:49:22,959 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:23,157 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:23,157 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:49:23,158 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: .1.3.6.1.4.1.1602.1.11.2.1.1.3.2
2025-02-08 12:49:23,158 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:23,316 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:23,317 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - .1.3.6.1.4.1.1602.1.11.2.1.1.3.2: 88199
2025-02-08 12:49:23,317 - DEBUG - [printer_monitor_service.py:238] - 📊 Contadores obtenidos para 192.168.18.27: {'total_pages': 88199, 'color_pages': 88199, 'bw_pages': 88199}
2025-02-08 12:49:23,317 - DEBUG - [printer_monitor_service.py:256] - 🔋 Obteniendo suministros para 192.168.18.27
2025-02-08 12:49:23,317 - DEBUG - [printer_monitor_service.py:257] - 🔧 OIDs configurados: [
  {
    "brand": "Canon",
    "model_family": "Color",
    "description": "",
    "oid_total_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_color_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_total_bw_pages": ".1.3.6.1.4.1.1602.1.11.2.1.1.3.2",
    "oid_black_toner_level": "",
    "oid_cyan_toner_level": "",
    "oid_magenta_toner_level": "",
    "oid_yellow_toner_level": "",
    "id": 6
  }
]
2025-02-08 12:49:23,317 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:49:23,317 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:49:23,318 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:49:23,319 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:49:23,319 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:49:23,319 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:49:23,319 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:49:23,319 - WARNING - [printer_monitor_service.py:315] - ⚠️ OID nulo para 192.168.18.27
2025-02-08 12:49:23,319 - DEBUG - [printer_monitor_service.py:295] - 🔋 Suministros obtenidos para 192.168.18.27: {'toners': {'black': {'level': 0, 'max': 100, 'percentage': 0}, 'cyan': {'level': 0, 'max': 100, 'percentage': 0}, 'magenta': {'level': 0, 'max': 100, 'percentage': 0}, 'yellow': {'level': 0, 'max': 100, 'percentage': 0}}}
2025-02-08 12:49:23,319 - INFO - [printer_monitor_service.py:602] - 🔍 Obteniendo estado de impresora 192.168.18.27
2025-02-08 12:49:23,320 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.25.3.5.1.1.1
2025-02-08 12:49:23,320 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:49:23,494 - INFO - [printer_monitor_service.py:385] - ✅ Conexión exitosa con CommunityData
2025-02-08 12:49:23,496 - DEBUG - [printer_monitor_service.py:386] - 📥 Valor SNMP obtenido para 192.168.18.27 - 1.3.6.1.2.1.25.3.5.1.1.1: 1
2025-02-08 12:49:23,497 - INFO - [printer_monitor_service.py:633] - 📊 Estado obtenido para 192.168.18.27: {'status': 'other', 'details': 'Status code: 1', 'raw_status': 1}
2025-02-08 12:49:23,499 - INFO - [printer_monitor_service.py:153] - ✅ Datos recolectados exitosamente para 192.168.18.27
2025-02-08 12:49:23,499 - DEBUG - [printer_monitor_service.py:154] - 📊 Datos recolectados: {
  "ip_address": null,
  "brand": null,
  "last_check": null,
  "status": null,
  "counters": {
    "total_pages": 88199,
    "color_pages": 88199,
    "bw_pages": 88199
  },
  "supplies": {
    "toners": {
      "black": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "cyan": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "magenta": {
        "level": 0,
        "max": 100,
        "percentage": 0
      },
      "yellow": {
        "level": 0,
        "max": 100,
        "percentage": 0
      }
    }
  },
  "error": null
}
2025-02-08 12:49:23,501 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:49:23,501 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:49:23,501 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:49:23,501 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:49:23,530 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:49:23,531 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:49:23,531 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:49:23,531 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:49:23,533 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:49:23,533 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:49:23,533 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:49:23.531704",
  "printer_data": {
    "counters": {
      "total_pages": 88199,
      "color_pages": 88199,
      "bw_pages": 88199
    },
    "supplies": {
      "toners": {
        "black": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "cyan": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "magenta": {
          "level": 0,
          "max": 100,
          "percentage": 0
        },
        "yellow": {
          "level": 0,
          "max": 100,
          "percentage": 0
        }
      }
    },
    "status": null
  }
}
2025-02-08 12:49:23,571 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:49:23,572 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-08 12:49:32,171 - DEBUG - [protocol.py:599] - < PING 8b 1f 53 9b [binary, 4 bytes]
2025-02-08 12:49:32,172 - DEBUG - [protocol.py:745] - > PONG 8b 1f 53 9b [binary, 4 bytes]
2025-02-08 12:49:32,173 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:49:32,173 - DEBUG - [protocol.py:745] - > PING ba cc cb 91 [binary, 4 bytes]
2025-02-08 12:49:32,180 - DEBUG - [protocol.py:599] - < PONG ba cc cb 91 [binary, 4 bytes]
2025-02-08 12:49:32,182 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:49:52,180 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:49:52,180 - DEBUG - [protocol.py:745] - > PING 6a 00 e5 98 [binary, 4 bytes]
2025-02-08 12:49:52,181 - DEBUG - [protocol.py:599] - < PING 19 d1 35 7b [binary, 4 bytes]
2025-02-08 12:49:52,181 - DEBUG - [protocol.py:745] - > PONG 19 d1 35 7b [binary, 4 bytes]
2025-02-08 12:49:52,186 - DEBUG - [protocol.py:599] - < PONG 6a 00 e5 98 [binary, 4 bytes]
2025-02-08 12:49:52,187 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:50:12,188 - DEBUG - [protocol.py:599] - < PING 44 ba da 3b [binary, 4 bytes]
2025-02-08 12:50:12,189 - DEBUG - [protocol.py:745] - > PONG 44 ba da 3b [binary, 4 bytes]
2025-02-08 12:50:12,189 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:50:12,189 - DEBUG - [protocol.py:745] - > PING ee ea 96 55 [binary, 4 bytes]
2025-02-08 12:50:12,197 - DEBUG - [protocol.py:599] - < PONG ee ea 96 55 [binary, 4 bytes]
2025-02-08 12:50:12,197 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:50:32,185 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:50:32,186 - DEBUG - [protocol.py:745] - > PING c8 5c fe 19 [binary, 4 bytes]
2025-02-08 12:50:32,194 - DEBUG - [protocol.py:599] - < PONG c8 5c fe 19 [binary, 4 bytes]
2025-02-08 12:50:32,194 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:50:32,199 - DEBUG - [protocol.py:599] - < PING 90 da d3 3b [binary, 4 bytes]
2025-02-08 12:50:32,205 - DEBUG - [protocol.py:745] - > PONG 90 da d3 3b [binary, 4 bytes]
2025-02-08 12:50:52,176 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:50:52,177 - DEBUG - [protocol.py:745] - > PING cd 91 e2 82 [binary, 4 bytes]
2025-02-08 12:50:52,185 - DEBUG - [protocol.py:599] - < PONG cd 91 e2 82 [binary, 4 bytes]
2025-02-08 12:50:52,186 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:50:52,213 - DEBUG - [protocol.py:599] - < PING e7 cc 8e 20 [binary, 4 bytes]
2025-02-08 12:50:52,214 - DEBUG - [protocol.py:745] - > PONG e7 cc 8e 20 [binary, 4 bytes]
2025-02-08 12:51:12,191 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:51:12,191 - DEBUG - [protocol.py:745] - > PING c3 f6 80 dc [binary, 4 bytes]
2025-02-08 12:51:12,197 - DEBUG - [protocol.py:599] - < PONG c3 f6 80 dc [binary, 4 bytes]
2025-02-08 12:51:12,199 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:51:12,220 - DEBUG - [protocol.py:599] - < PING 73 c1 18 05 [binary, 4 bytes]
2025-02-08 12:51:12,232 - DEBUG - [protocol.py:745] - > PONG 73 c1 18 05 [binary, 4 bytes]
2025-02-08 12:51:32,204 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:51:32,206 - DEBUG - [protocol.py:745] - > PING 7c 6a 42 fb [binary, 4 bytes]
2025-02-08 12:51:32,208 - DEBUG - [protocol.py:599] - < PONG 7c 6a 42 fb [binary, 4 bytes]
2025-02-08 12:51:32,208 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:51:32,242 - DEBUG - [protocol.py:599] - < PING f9 71 69 06 [binary, 4 bytes]
2025-02-08 12:51:32,244 - DEBUG - [protocol.py:745] - > PONG f9 71 69 06 [binary, 4 bytes]
2025-02-08 12:51:52,207 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:51:52,209 - DEBUG - [protocol.py:745] - > PING 59 b7 42 9e [binary, 4 bytes]
2025-02-08 12:51:52,215 - DEBUG - [protocol.py:599] - < PONG 59 b7 42 9e [binary, 4 bytes]
2025-02-08 12:51:52,215 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:51:52,253 - DEBUG - [protocol.py:599] - < PING 77 00 84 df [binary, 4 bytes]
2025-02-08 12:51:52,254 - DEBUG - [protocol.py:745] - > PONG 77 00 84 df [binary, 4 bytes]
2025-02-08 12:52:12,215 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:52:12,216 - DEBUG - [protocol.py:745] - > PING bc 4a ba 9f [binary, 4 bytes]
2025-02-08 12:52:12,223 - DEBUG - [protocol.py:599] - < PONG bc 4a ba 9f [binary, 4 bytes]
2025-02-08 12:52:12,225 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:52:12,259 - DEBUG - [protocol.py:599] - < PING 1c d3 5d 66 [binary, 4 bytes]
2025-02-08 12:52:12,260 - DEBUG - [protocol.py:745] - > PONG 1c d3 5d 66 [binary, 4 bytes]
2025-02-08 12:52:32,216 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:52:32,216 - DEBUG - [protocol.py:745] - > PING '\x07\x0b%\\' [text, 4 bytes]
2025-02-08 12:52:32,223 - DEBUG - [protocol.py:599] - < PONG '\x07\x0b%\\' [text, 4 bytes]
2025-02-08 12:52:32,224 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:52:32,266 - DEBUG - [protocol.py:599] - < PING b8 12 b1 85 [binary, 4 bytes]
2025-02-08 12:52:32,266 - DEBUG - [protocol.py:745] - > PONG b8 12 b1 85 [binary, 4 bytes]
2025-02-08 12:52:52,234 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:52:52,234 - DEBUG - [protocol.py:745] - > PING c3 6a 59 96 [binary, 4 bytes]
2025-02-08 12:52:52,240 - DEBUG - [protocol.py:599] - < PONG c3 6a 59 96 [binary, 4 bytes]
2025-02-08 12:52:52,241 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:52:52,275 - DEBUG - [protocol.py:599] - < PING 22 13 ca df [binary, 4 bytes]
2025-02-08 12:52:52,276 - DEBUG - [protocol.py:745] - > PONG 22 13 ca df [binary, 4 bytes]
2025-02-08 12:53:12,235 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:53:12,235 - DEBUG - [protocol.py:745] - > PING fa a1 2e 58 [binary, 4 bytes]
2025-02-08 12:53:12,243 - DEBUG - [protocol.py:599] - < PONG fa a1 2e 58 [binary, 4 bytes]
2025-02-08 12:53:12,244 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:53:12,282 - DEBUG - [protocol.py:599] - < PING e3 65 06 5d [binary, 4 bytes]
2025-02-08 12:53:12,283 - DEBUG - [protocol.py:745] - > PONG e3 65 06 5d [binary, 4 bytes]
2025-02-08 12:53:32,243 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:53:32,245 - DEBUG - [protocol.py:745] - > PING '\x12\x19\rD' [text, 4 bytes]
2025-02-08 12:53:32,255 - DEBUG - [protocol.py:599] - < PONG '\x12\x19\rD' [text, 4 bytes]
2025-02-08 12:53:32,256 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:53:32,289 - DEBUG - [protocol.py:599] - < PING f9 2a 10 e2 [binary, 4 bytes]
2025-02-08 12:53:32,290 - DEBUG - [protocol.py:745] - > PONG f9 2a 10 e2 [binary, 4 bytes]
2025-02-08 12:53:52,258 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:53:52,258 - DEBUG - [protocol.py:745] - > PING ee 21 32 18 [binary, 4 bytes]
2025-02-08 12:53:52,264 - DEBUG - [protocol.py:599] - < PONG ee 21 32 18 [binary, 4 bytes]
2025-02-08 12:53:52,265 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:53:52,300 - DEBUG - [protocol.py:599] - < PING 31 7d b6 93 [binary, 4 bytes]
2025-02-08 12:53:52,301 - DEBUG - [protocol.py:745] - > PONG 31 7d b6 93 [binary, 4 bytes]
2025-02-08 12:54:12,260 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:54:12,262 - DEBUG - [protocol.py:745] - > PING 5a 16 d4 79 [binary, 4 bytes]
2025-02-08 12:54:12,311 - DEBUG - [protocol.py:599] - < PONG 5a 16 d4 79 [binary, 4 bytes]
2025-02-08 12:54:12,312 - DEBUG - [protocol.py:599] - < PING b9 e3 48 a1 [binary, 4 bytes]
2025-02-08 12:54:12,313 - DEBUG - [protocol.py:745] - > PONG b9 e3 48 a1 [binary, 4 bytes]
2025-02-08 12:54:12,316 - DEBUG - [connection.py:811] - % received keepalive pong
2025-02-08 12:54:24,680 - INFO - [agent_service.py:423] - ✅ Actualización exitosa en el servidor.
2025-02-08 12:54:24,680 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:54:24,681 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:54:24,681 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:54:24,715 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:54:24,715 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:54:24,716 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:54:24,716 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.41, Marca: Ricoh
2025-02-08 12:54:24,717 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.41
2025-02-08 12:54:24,717 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.41 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:54:24,717 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:54:34,047 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:54:34,047 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:54:43,475 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:54:43,476 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:54:52,788 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:54:52,789 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:55:02,106 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:55:02,106 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:55:11,477 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:55:11,477 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:55:20,857 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:55:20,858 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:55:30,213 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:55:30,215 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:55:39,556 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:55:39,557 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:55:48,923 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:55:48,924 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:55:58,232 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:55:58,232 - ERROR - [printer_monitor_service.py:396] - ❌ No se pudo obtener valor SNMP para 192.168.18.41 después de probar todas las configuraciones
2025-02-08 12:55:58,232 - WARNING - [printer_monitor_service.py:583] - ⚠️ Impresora 192.168.18.41 no responde
2025-02-08 12:55:58,232 - ERROR - [printer_monitor_service.py:123] - ❌ Impresora 192.168.18.41 no responde
2025-02-08 12:55:58,233 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.41
2025-02-08 12:55:58,233 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:55:58,233 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:55:58,235 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:55:58,236 - DEBUG - [protocol.py:599] - < PING 01 c5 12 65 [binary, 4 bytes]
2025-02-08 12:55:58,236 - DEBUG - [protocol.py:745] - > PONG 01 c5 12 65 [binary, 4 bytes]
2025-02-08 12:55:58,237 - DEBUG - [connection.py:800] - % sending keepalive ping
2025-02-08 12:55:58,237 - DEBUG - [protocol.py:745] - > PING 6c 77 0a ae [binary, 4 bytes]
2025-02-08 12:55:58,238 - DEBUG - [protocol.py:599] - < CLOSE 1011 (internal error) keepalive ping timeout [24 bytes]
2025-02-08 12:55:58,238 - DEBUG - [protocol.py:745] - > CLOSE 1011 (internal error) keepalive ping timeout [24 bytes]
2025-02-08 12:55:58,238 - DEBUG - [protocol.py:175] - = connection is CLOSING
2025-02-08 12:55:58,239 - DEBUG - [protocol.py:649] - < EOF
2025-02-08 12:55:58,239 - DEBUG - [protocol.py:757] - > EOF
2025-02-08 12:55:58,239 - DEBUG - [protocol.py:175] - = connection is CLOSED
2025-02-08 12:55:58,240 - DEBUG - [connection.py:951] - x half-closing TCP connection
2025-02-08 12:55:58,240 - INFO - [agent_service.py:166] - Conexión cerrada por el servidor
2025-02-08 12:55:58,270 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","status":null,"client_id":4},{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","sta...
2025-02-08 12:55:58,271 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:55:58,271 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:55:58,272 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:55:58,272 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:55:58,272 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:55:58,272 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.41",
  "name": "RRhh",
  "brand": "Ricoh",
  "model": "MPC 3004",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:55:58.272198",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 12:55:58,315 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.41
2025-02-08 12:55:58,316 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.41
2025-02-08 12:55:58,316 - INFO - [printer_monitor_service.py:119] - 🔄 Iniciando recolección de datos - IP: 192.168.18.27, Marca: Canon
2025-02-08 12:55:58,316 - INFO - [printer_monitor_service.py:572] - 🔌 Verificando conexión con impresora 192.168.18.27
2025-02-08 12:55:58,316 - DEBUG - [printer_monitor_service.py:355] - 🔍 Intentando conexión SNMP con 192.168.18.27 - OID: 1.3.6.1.2.1.1.1.0
2025-02-08 12:55:58,317 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:56:07,674 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:56:07,675 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:56:17,051 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:56:17,053 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:56:26,384 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:56:26,387 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: CommunityData
2025-02-08 12:56:35,688 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:56:35,689 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:56:45,001 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:56:45,033 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:56:54,424 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:56:54,425 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:57:03,765 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:57:03,767 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:57:13,126 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:57:13,129 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:57:22,504 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:57:22,504 - DEBUG - [printer_monitor_service.py:360] - Probando configuración SNMP: UsmUserData
2025-02-08 12:57:32,081 - DEBUG - [printer_monitor_service.py:373] - Intento fallido: No SNMP response received before timeout
2025-02-08 12:57:32,081 - ERROR - [printer_monitor_service.py:396] - ❌ No se pudo obtener valor SNMP para 192.168.18.27 después de probar todas las configuraciones
2025-02-08 12:57:32,084 - WARNING - [printer_monitor_service.py:583] - ⚠️ Impresora 192.168.18.27 no responde
2025-02-08 12:57:32,084 - ERROR - [printer_monitor_service.py:123] - ❌ Impresora 192.168.18.27 no responde
2025-02-08 12:57:32,084 - INFO - [printer_monitor_service.py:481] - Preparando actualización de datos para 192.168.18.27
2025-02-08 12:57:32,084 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-08 12:57:32,084 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-08 12:57:32,084 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:57:32,131 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): [{"ip_address":"192.168.18.27","brand":"Canon","model":"iR-ADV C3525 III","name":"RRRR","status":null,"client_id":4},{"ip_address":"192.168.18.41","brand":"Ricoh","model":"MPC 3004","name":"RRhh","sta...
2025-02-08 12:57:32,131 - INFO - [printer_monitor_service.py:90] - ✅ Se obtuvieron 2 impresoras
2025-02-08 12:57:32,131 - DEBUG - [printer_monitor_service.py:91] - 📋 Lista de impresoras: [
  {
    "ip_address": "192.168.18.27",
    "brand": "Canon",
    "model": "iR-ADV C3525 III",
    "name": "RRRR",
    "status": null,
    "client_id": 4
  },
  {
    "ip_address": "192.168.18.41",
    "brand": "Ricoh",
    "model": "MPC 3004",
    "name": "RRhh",
    "status": null,
    "client_id": 4
  }
]
2025-02-08 12:57:32,134 - DEBUG - [printer_monitor_service.py:533] - Enviando datos a http://161.132.39.159:8000/api/v1/monitor/printers/update
2025-02-08 12:57:32,134 - DEBUG - [printer_monitor_service.py:534] - Headers: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-08 12:57:32,134 - DEBUG - [printer_monitor_service.py:535] - Parámetros: {'agent_id': '1'}
2025-02-08 12:57:32,134 - DEBUG - [printer_monitor_service.py:536] - Datos: {
  "ip_address": "192.168.18.27",
  "name": "RRRR",
  "brand": "Canon",
  "model": "iR-ADV C3525 III",
  "client_id": 4,
  "status": null,
  "last_check": "2025-02-08T17:57:32.134489",
  "printer_data": {
    "counters": {},
    "supplies": {},
    "status": null
  }
}
2025-02-08 12:57:32,176 - INFO - [printer_monitor_service.py:547] - Datos actualizados exitosamente para 192.168.18.27
2025-02-08 12:57:32,176 - DEBUG - [agent_service.py:377] - Datos actualizados para 192.168.18.27
2025-02-10 08:12:39,945 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:12:39,945 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:12:39,945 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:12:39,951 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:12:42,018 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:17:45,228 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:17:45,228 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:17:45,231 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:17:45,233 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:17:47,295 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:22:50,450 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:22:50,450 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:22:50,450 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:22:50,450 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:22:52,506 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:27:55,640 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:27:55,641 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:27:55,643 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:27:55,644 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:27:57,707 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:33:00,863 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:33:00,865 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:33:00,870 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:33:00,871 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:33:02,942 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:38:06,078 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:38:06,078 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:38:06,078 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:38:06,087 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:38:08,141 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:43:11,253 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:43:11,253 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:43:11,253 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:43:11,253 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:43:13,320 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:48:16,464 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:48:16,465 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:48:16,467 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:48:16,469 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:48:18,587 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:53:21,705 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:53:21,705 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:53:21,742 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:53:21,743 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:53:23,814 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:58:26,953 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 08:58:26,954 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 08:58:26,957 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 08:58:26,957 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 08:58:29,022 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:03:32,177 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:03:32,180 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:03:32,187 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:03:32,188 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:03:34,270 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:08:37,421 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:08:37,421 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:08:37,424 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:08:37,427 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:08:39,487 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:13:42,606 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:13:42,607 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:13:42,609 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:13:42,609 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:13:44,661 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:18:47,819 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:18:47,820 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:18:47,830 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:18:47,831 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:18:49,909 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:23:53,051 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:23:53,052 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:23:53,057 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:23:53,059 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:23:55,112 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:28:58,238 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:28:58,238 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:28:58,244 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:28:58,246 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:29:00,305 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:34:03,455 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:34:03,472 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:34:03,472 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:34:03,473 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:34:05,536 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:39:08,672 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:39:08,672 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:39:08,672 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:39:08,686 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:39:10,750 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:44:13,867 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:44:13,868 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:44:13,873 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:44:13,873 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:44:15,948 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:49:19,101 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:49:19,102 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:49:19,107 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:49:19,108 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:49:21,162 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:54:24,358 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:54:24,360 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:54:24,365 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:54:24,366 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:54:26,430 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:59:29,596 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 09:59:29,598 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 09:59:29,602 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 09:59:29,603 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 09:59:31,665 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:04:32,747 - ERROR - [agent_service.py:425] - ❌ Error en la actualización: {'detail': 'Not Found'}
2025-02-10 10:04:32,748 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 10:04:32,749 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 10:04:32,749 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 10:04:32,770 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (404): {"detail":"Not Found"}...
2025-02-10 10:04:32,771 - ERROR - [printer_monitor_service.py:94] - ❌ Error 404: {"detail":"Not Found"}
2025-02-10 10:09:35,881 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:09:35,887 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 10:09:35,890 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 10:09:35,890 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 10:09:37,954 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:14:41,098 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:14:41,098 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 10:14:41,101 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 10:14:41,101 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 10:14:43,164 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:19:46,287 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:19:46,288 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 10:19:46,293 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 10:19:46,295 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 10:19:48,373 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:24:51,504 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:24:51,515 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 10:24:51,517 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 10:24:51,517 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 10:24:53,596 - ERROR - [printer_monitor_service.py:101] - ❌ Error de conexión: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1115, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 104, in start_connection
    raise first_exception
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 82, in start_connection
    sock = await _connect_sock(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohappyeyeballs\impl.py", line 174, in _connect_sock
    await loop.sock_connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 704, in sock_connect
    return await self._proactor.connect(sock, address)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 812, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] El equipo remoto rechazó la conexión de red

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 84, in get_monitored_printers
    async with session.get(url, headers=headers) as response:
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\client.py", line 703, in _request
    conn = await self._connector.connect(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 548, in connect
    proto = await self._create_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1056, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1400, in _create_direct_connection
    raise last_exc
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1369, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\site-packages\aiohttp\connector.py", line 1130, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host 161.132.39.159:8000 ssl:default [El equipo remoto rechazó la conexión de red]
2025-02-10 10:29:54,699 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: 200, message='Attempt to decode JSON with unexpected mimetype: text/html; charset=utf-8', url='ws://161.132.39.159:8000/auth/login'
2025-02-10 10:29:54,700 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 10:29:54,702 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 10:29:54,702 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 10:29:54,735 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión - Printer Management</title>
   ...
2025-02-10 10:29:54,739 - ERROR - [printer_monitor_service.py:98] - ❌ Error decodificando JSON: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 89, in get_monitored_printers
    printers = json.loads(response_text)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-02-10 10:34:55,886 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: 200, message='Attempt to decode JSON with unexpected mimetype: text/html; charset=utf-8', url='ws://161.132.39.159:8000/auth/login'
2025-02-10 10:34:55,896 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 10:34:55,896 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 10:34:55,898 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 10:34:55,923 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión - Printer Management</title>
   ...
2025-02-10 10:34:55,923 - ERROR - [printer_monitor_service.py:98] - ❌ Error decodificando JSON: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 89, in get_monitored_printers
    printers = json.loads(response_text)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-02-10 10:39:57,032 - ERROR - [agent_service.py:428] - 🚨 Error en la actualización del agente: 200, message='Attempt to decode JSON with unexpected mimetype: text/html; charset=utf-8', url='ws://161.132.39.159:8000/auth/login'
2025-02-10 10:39:57,033 - INFO - [printer_monitor_service.py:68] - 📝 Obteniendo lista de impresoras del servidor
2025-02-10 10:39:57,035 - DEBUG - [printer_monitor_service.py:80] - 🔍 Request URL: ws://161.132.39.159:8000/api/v1/monitor/printers
2025-02-10 10:39:57,035 - DEBUG - [printer_monitor_service.py:81] - 🔑 Headers configurados: {'Authorization': 'Bearer agt_32499ebe03d94fee8d8e5dd9446f46a6', 'Content-Type': 'application/json'}
2025-02-10 10:39:57,062 - DEBUG - [printer_monitor_service.py:86] - 📥 Respuesta (200): <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión - Printer Management</title>
   ...
2025-02-10 10:39:57,062 - ERROR - [printer_monitor_service.py:98] - ❌ Error decodificando JSON: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "C:\Users\pc\Desktop\printer_management\agent\app\services\printer_monitor_service.py", line 89, in get_monitored_printers
    printers = json.loads(response_text)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "C:\Users\pc\AppData\Local\Programs\Python\Python310\lib\json\decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
